(this["webpackJsonpnimflow-portal"]=this["webpackJsonpnimflow-portal"]||[]).push([[14],{116:function(e,t,n){"use strict";n.d(t,"i",(function(){return u})),n.d(t,"h",(function(){return s})),n.d(t,"g",(function(){return d})),n.d(t,"d",(function(){return l})),n.d(t,"c",(function(){return b})),n.d(t,"f",(function(){return f})),n.d(t,"a",(function(){return v})),n.d(t,"b",(function(){return g})),n.d(t,"e",(function(){return y}));var a=n(15),r=n(2478),c=(n(2364),n(2432),n(240),n(80),["MilestoneReached","MilestoneCleared"]),i=["TaskCreated","TaskUpdated","TaskArchived","ResponseSent"],o=["ActionDispatched","ContextsRecalculationCompleted","ContextRecalculationError"].concat(i,c);["RequestProcessed"].concat(Object(a.a)(o),["CustomEvent"]);function u(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.settings;return!n&&t&&(e.settings=n={}),n}function s(e){var t,n=null===(t=u(e))||void 0===t?void 0:t.commandText;return Object(r.a)(n)?e.name:n}function d(e){var t,n=null===(t=u(e))||void 0===t?void 0:t.actionInProgressText;return n||e.name}var l={id:"string",typeName:"string",reference:"string",state:"record",dateCreated:"dateTime",dateModified:"dateTime",version:"string",contextTypeVersion:"number",milestones:"array",tags:"array",metrics:"array"},b={id:"string",contextId:"string",contextTypeName:"string",contextReference:"string",typeName:"string",title:"string",data:"record",labels:"array",dateCreated:"dateTime",dateUpdated:"dateTime",assignedTo:"string",status:"string",archived:"boolean",dueDate:"string",importance:"number",focused:"boolean"},f={event:"string",timestamp:"dateTime",requestTypeName:"string",contextTypeName:"string",sentBy:"string",reference:"string",subject:"string",contextIsNew:"boolean",action:"string",message:"string",dueDate:"dateTime",taskTypeName:"string",assignedTo:"string",importance:"number",responseTypeName:"string",oldImportance:"number",oldLabels:"array",oldDueDate:"dateTime",oldAssignedTo:"string",milestoneName:"string",value:"dateTime",tags:"array",metrics:"array"},j=function(e){var t=["string","number","boolean","dateTime"];return Object.keys(e).filter((function(n){return t.includes(e[n])})).sort()},m=function(e){return Object.keys(e).filter((function(t){return"array"===e[t]})).sort()},h=function(e){return Object.keys(e).filter((function(t){return"record"===e[t]})).sort()},v=j(l),O=m(l),p=h(l),g=([].concat(Object(a.a)(v),Object(a.a)(O),Object(a.a)(p)),j(b)),x=(m(b),h(b)),y=([].concat(Object(a.a)(g),Object(a.a)(x)),j(f)),I=m(f);[].concat(Object(a.a)(y),Object(a.a)(I))},120:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(2),r=n(33),c=n(420),i=n.n(c),o=n(259);i.a.registerHelper("translate",(function(e,t){var n={ns:o.b};return"object"===typeof t&&"hash"in t&&(n=Object(a.a)(Object(a.a)({},n),t.hash)),r.a.t(e,n)}));var u=function(e,t,n,a){return function(e,t){return i.a.compile(e,t)}(e,n)(t,a)}},136:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var a=n(4),r=n(6),c=n(10),i=n(11),o=n(3),u=n(910),s=n(2435),d=n(2436),l=n(2437),b=n(243),f=n.n(b),j=n(31),m=function(e){var t=e.error,n=e.stack;return Object(j.jsxs)(s.a,{children:[Object(j.jsx)(l.a,{expandIcon:Object(j.jsx)(f.a,{}),children:Object(j.jsx)(u.a,{variant:"h5",color:"error",children:t})}),Object(j.jsx)(d.a,{children:Object(j.jsx)("pre",{children:n})})]})},h=function(e){Object(c.a)(n,e);var t=Object(i.a)(n);function n(){var e;Object(a.a)(this,n);for(var r=arguments.length,c=new Array(r),i=0;i<r;i++)c[i]=arguments[i];return(e=t.call.apply(t,[this].concat(c))).state={hasError:!1},e}return Object(r.a)(n,[{key:"componentDidCatch",value:function(e,t){console.log({error:e,errorInfo:t}),this.setState({errorInfo:t})}},{key:"render",value:function(){var e,t,n=this.state,a=n.hasError,r=n.error,c=n.errorInfo;return a?Object(j.jsx)(m,{error:null!==(e=null===r||void 0===r?void 0:r.message)&&void 0!==e?e:"",stack:null!==(t=null===c||void 0===c?void 0:c.componentStack)&&void 0!==t?t:""}):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return{hasError:!0,error:e}}}]),n}(o.Component)},157:function(e,t,n){"use strict";n.d(t,"b",(function(){return f})),n.d(t,"a",(function(){return j}));var a=n(430),r=n.n(a),c=n(552),i=n.n(c),o=n(280),u=n.n(o),s=n(33),d=u.a;function l(e){n(320)("./".concat(e,"/index")).then((function(e){"function"===typeof(null===e||void 0===e?void 0:e.default)&&(d=e.default)})).catch((function(){var t=e.indexOf("-");t>0&&l(e.substring(0,t))}))}s.a.language&&l(s.a.language),s.a.on("languageChanged",(function(e){l(e)}));var b=new r.a({allErrors:!0,addUsedSchema:!1});i()(b),b.addKeyword({keyword:"markdownDescription",schemaType:"string",valid:!0});var f=function(e){var t;return b.validateSchema(e)?{type:"success"}:(b.errors&&d&&d(b.errors),{type:"failure",errors:null!==(t=b.errors)&&void 0!==t?t:[]})},j=function(e){return d&&d(e),e}},1958:function(e,t,n){"use strict";var a=n(73),r=n(76);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var c=r(n(3)),i=(0,a(n(77)).default)(c.createElement("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckCircle");t.default=i},222:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return u}));var a=n(2),r=n(80),c=n(2450),i=function(e,t){var n,i=null===(n=e.definitions)||void 0===n?void 0:n[t];if(!Object(r.isPresent)(i))throw new Error("Invalid definition ".concat(t));if("boolean"===typeof i)throw new Error("Invalid definition ".concat(t));var o=Object(c.a)(i);return delete o.definitions,e=Object(a.a)(Object(a.a)({},e),o)},o=function(e,t,n){if(e.jsonSchema){var a=JSON.parse(e.jsonSchema),r=e.tasks.find((function(e){return e.name===t})),c=null===r||void 0===r?void 0:r.validResponses.find((function(e){return e.name===n})),o=null===c||void 0===c?void 0:c.payloadSchemaDefinitionName;if(o)return i(a,o)}},u=function(e,t){if(e.jsonSchema){var n=JSON.parse(e.jsonSchema),a=e.actions.find((function(e){return e.name===t})),r=null===a||void 0===a?void 0:a.payloadSchemaDefinitionName;if(r)return i(n,r)}}},2462:function(e,t,n){"use strict";n.r(t),n.d(t,"DispatchActionStepper",(function(){return he}));var a=n(1),r=n(3),c=n(895),i=n(892),o=n(2398),u=n(2444),s=n(2441),d=n(2442),l=n(2476),b=n(2),f=n(18),j=n(908),m=n(31),h=["children","className"],v=Object(c.a)((function(e){return Object(i.a)({paper:{padding:e.spacing(2),color:e.palette.text.secondary}})})),O=function(e){var t=e.children,n=e.className,a=Object(f.a)(e,h),r=v();return Object(m.jsx)(j.a,Object(b.a)(Object(b.a)({className:"".concat(r.paper," ").concat(n),elevation:3},a),{},{children:t}))},p=n(953),g=n(910),x=["children"],y=function(e){var t=e.children,n=Object(f.a)(e,x);return Object(m.jsx)(g.a,Object(b.a)(Object(b.a)({variant:"h5"},n),{},{children:t}))},I=Object(c.a)((function(e){return Object(i.a)({grow:{flexGrow:1},actionToolbarButtons:{display:"flex"}})})),C=function(e){var t=e.title,n=e.actions,a=Object(f.a)(e,["title","actions"]),r=I();return Object(m.jsxs)(p.a,Object(b.a)(Object(b.a)({variant:"dense"},a),{},{children:[t&&Object(m.jsx)(y,{children:t}),Object(m.jsx)("div",{className:r.grow}),n&&Object(m.jsx)("div",{className:r.actionToolbarButtons,children:n})]}))},k=n(5),w=n.n(k),P=n(32),S=n(96),M=n(1906),N=n(909),D=n(2415),T=n(2420),z=n(2421),L=n(2440),A=n(2427),E=n(2464),R=n(366),B=n.n(R),V=n(98),F=n(2395),H=function(e){return Object(m.jsxs)(F.a,Object(b.a)(Object(b.a)({viewBox:"0 0 64 64"},e),{},{children:[Object(m.jsx)("path",{d:"M58 13H6c-1.103 0-2-.897-2-2s.897-2 2-2h52c1.103 0 2 .897 2 2S59.103 13 58 13zM6 10c-.552 0-1 .449-1 1s.448 1 1 1h52c.552 0 1-.449 1-1s-.448-1-1-1H6zM36.5 20h-9c-1.379 0-2.5-1.122-2.5-2.5s1.121-2.5 2.5-2.5h9c1.379 0 2.5 1.122 2.5 2.5S37.879 20 36.5 20zM27.5 16c-.827 0-1.5.673-1.5 1.5s.673 1.5 1.5 1.5h9c.827 0 1.5-.673 1.5-1.5S37.327 16 36.5 16H27.5zM18.497 45h-6c-1.379 0-2.5-1.122-2.5-2.5s1.121-2.5 2.5-2.5h6c1.379 0 2.5 1.122 2.5 2.5S19.876 45 18.497 45zM12.497 41c-.827 0-1.5.673-1.5 1.5s.673 1.5 1.5 1.5h6c.827 0 1.5-.673 1.5-1.5s-.673-1.5-1.5-1.5H12.497zM51.497 45h-6c-1.379 0-2.5-1.122-2.5-2.5s1.121-2.5 2.5-2.5h6c1.379 0 2.5 1.122 2.5 2.5S52.876 45 51.497 45zM45.497 41c-.827 0-1.5.673-1.5 1.5s.673 1.5 1.5 1.5h6c.827 0 1.5-.673 1.5-1.5s-.673-1.5-1.5-1.5H45.497zM29.5 28h-10c-.276 0-.5-.224-.5-.5v-4c0-.276.224-.5.5-.5h10c.276 0 .5.224.5.5v4C30 27.776 29.776 28 29.5 28zM20 27h9v-3h-9V27zM44.5 28h-10c-.276 0-.5-.224-.5-.5v-4c0-.276.224-.5.5-.5h10c.276 0 .5.224.5.5v4C45 27.776 44.776 28 44.5 28zM35 27h9v-3h-9V27zM29.5 36h-8c-.276 0-.5-.224-.5-.5v-4c0-.276.224-.5.5-.5h8c.276 0 .5.224.5.5v4C30 35.776 29.776 36 29.5 36zM22 35h7v-3h-7V35zM43.5 36h-8c-.276 0-.5-.224-.5-.5v-4c0-.276.224-.5.5-.5h8c.276 0 .5.224.5.5v4C44 35.776 43.776 36 43.5 36zM36 35h7v-3h-7V35z"}),Object(m.jsx)("path",{d:"M56.5,48h-49C7.224,48,7,47.776,7,47.5v-35C7,12.224,7.224,12,7.5,12h49c0.276,0,0.5,0.224,0.5,0.5v35    C57,47.776,56.776,48,56.5,48z M8,47h48V13H8V47z"}),Object(m.jsx)("rect",{width:"1",height:"3",x:"31.5",y:"6.5"}),Object(m.jsx)("path",{d:"M32 7c-1.103 0-2-.897-2-2s.897-2 2-2 2 .897 2 2S33.103 7 32 7zM32 4c-.552 0-1 .449-1 1s.448 1 1 1 1-.449 1-1S32.552 4 32 4zM21.5 61h-4c-.152 0-.297-.069-.392-.188-.095-.12-.13-.275-.096-.424l3-13C20.065 47.161 20.268 47 20.5 47h4c.152 0 .297.069.392.188.095.12.13.275.096.424l-3 13C21.935 60.839 21.732 61 21.5 61zM18.129 60h2.974l2.769-12h-2.974L18.129 60zM46.5 61h-4c-.232 0-.435-.161-.487-.388l-3-13c-.034-.148.001-.304.096-.424C39.203 47.069 39.348 47 39.5 47h4c.232 0 .435.161.487.388l3 13c.034.148-.001.304-.096.424C46.797 60.931 46.652 61 46.5 61zM42.897 60h2.974l-2.769-12h-2.974L42.897 60z"}),Object(m.jsx)("path",{d:"M41.974 56H22.026l.922-4h18.104L41.974 56zM23.282 55h17.436l-.461-2H23.743L23.282 55zM15.48 37.008c-.128 0-.256-.049-.354-.146l-3.008-3.008c-.195-.195-.195-.512 0-.707l3.008-3.008c.195-.195.512-.195.707 0l3.008 3.008c.195.195.195.512 0 .707l-3.008 3.008C15.736 36.959 15.608 37.008 15.48 37.008zM13.18 33.5l2.301 2.301 2.301-2.301-2.301-2.301L13.18 33.5zM32.48 46.008c-.128 0-.256-.049-.354-.146l-3.008-3.008c-.195-.195-.195-.512 0-.707l3.008-3.008c.195-.195.512-.195.707 0l3.008 3.008c.195.195.195.512 0 .707l-3.008 3.008C32.736 45.959 32.608 46.008 32.48 46.008zM30.18 42.5l2.301 2.301 2.301-2.301-2.301-2.301L30.18 42.5zM32 22c-.276 0-.5-.224-.5-.5v-2c0-.276.224-.5.5-.5s.5.224.5.5v2C32.5 21.776 32.276 22 32 22z"}),Object(m.jsx)("path",{d:"M39.5 24c-.276 0-.5-.224-.5-.5V22H25v1.5c0 .276-.224.5-.5.5S24 23.776 24 23.5v-2c0-.276.224-.5.5-.5h15c.276 0 .5.224.5.5v2C40 23.776 39.776 24 39.5 24zM15.5 31c-.276 0-.5-.224-.5-.5v-5c0-.276.224-.5.5-.5h4c.276 0 .5.224.5.5S19.776 26 19.5 26H16v4.5C16 30.776 15.776 31 15.5 31zM32.48 39.992c-.234.01-.501-.225-.5-.501L31.998 34H29.5c-.276 0-.5-.224-.5-.5s.224-.5.5-.5h3c.133 0 .261.053.354.147S33 33.369 33 33.501l-.02 5.992C32.979 39.77 32.756 39.992 32.48 39.992z"}),Object(m.jsx)("path",{d:"M32.52 39.992c-.275 0-.499-.223-.5-.499L32 33.501c0-.133.052-.26.146-.354S32.367 33 32.5 33h3c.276 0 .5.224.5.5S35.776 34 35.5 34h-2.498l.018 5.491c.001.276-.223.5-.498.501C32.521 39.992 32.521 39.992 32.52 39.992zM15.5 41c-.276 0-.5-.224-.5-.5v-3.992c0-.276.224-.5.5-.5s.5.224.5.5V40.5C16 40.776 15.776 41 15.5 41zM39.5 32c-.276 0-.5-.224-.5-.5v-3.992c0-.276.224-.5.5-.5s.5.224.5.5V31.5C40 31.776 39.776 32 39.5 32zM21.5 34h-3.012c-.276 0-.5-.224-.5-.5s.224-.5.5-.5H21.5c.276 0 .5.224.5.5S21.776 34 21.5 34zM29.5 43h-9.012c-.276 0-.5-.224-.5-.5s.224-.5.5-.5H29.5c.276 0 .5.224.5.5S29.776 43 29.5 43zM43.497 43h-8.009c-.276 0-.5-.224-.5-.5s.224-.5.5-.5h8.009c.276 0 .5.224.5.5S43.773 43 43.497 43z"}),Object(m.jsxs)("g",{children:[Object(m.jsx)("defs",{children:Object(m.jsx)("rect",{id:"SVGID_1_",width:"675.5",height:"132.688",x:"-1235.486",y:"289.422"})}),Object(m.jsx)("clipPath",{id:"SVGID_2_",children:Object(m.jsx)("use",{overflow:"visible",href:"#SVGID_1_"})})]})]}))},U=n(930),W=n(918),_=Object(c.a)((function(e){return Object(i.a)({button:{marginRight:e.spacing(1)},content:{maxHeight:"60vh",overflowY:"auto"}})})),G=function(e){var t=e.onNext,n=e.onBack,a=e.onSkip,r=e.nextActionCaption,c=e.children,i=_(),u=Object(l.a)().t;return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(o.a,{container:!0,children:Object(m.jsx)(o.a,{item:!0,xs:12,className:i.content,children:c})}),Object(m.jsx)(o.a,{container:!0,children:Object(m.jsxs)(o.a,{item:!0,xs:12,children:[Object(m.jsx)(W.a,{disabled:!n,onClick:n,className:i.button,children:u("Back")}),!!a&&Object(m.jsx)(W.a,{onClick:a,className:i.button,children:u("Skip")}),!!t&&Object(m.jsx)(W.a,{onClick:t,className:i.button,children:null!==r&&void 0!==r?r:u("Next")})]})})]})},J=Object(c.a)((function(e){return Object(i.a)({root:{flexGrow:1}})})),q=function(e,t){if(!e)return[];if(!t)return e;var n=t.toLowerCase();return e.filter((function(e){return e.name.toLowerCase().includes(n)||e.description&&e.description.includes(n)}))},Z=n(80),$=Object(c.a)((function(e){return Object(i.a)({root:{flexGrow:1,width:"100%",marginTop:"20px",marginBottom:"20px"}})})),Y=n(2450),K=n(222),Q=n(157),X=n(116),ee=n(338),te=Object(c.a)((function(e){return Object(i.a)({root:{flexGrow:1,width:"100%",marginBottom:"20px"},textField:{width:"100%"},content:{padding:"8px 24px","&:first-child":{paddingTop:20}}})})),ne=n(2473),ae=n(715),re=n(449),ce=n.n(re),ie=n(1958),oe=n.n(ie),ue=n(690),se=n(107),de=n(269),le=Object(c.a)((function(e){return Object(i.a)({button:{marginRight:e.spacing(1)},icon:{textAlign:"center"}})})),be=function(e){var t=e.icon,n=e.title,a=e.details,r=le();return Object(m.jsx)(ae.a,{pt:"50px",pb:"50px",maxHeight:"60vh",children:Object(m.jsxs)(o.a,{container:!0,justifyContent:"center",alignItems:"center",spacing:4,children:[!!t&&Object(m.jsx)(o.a,{item:!0,xs:12,className:r.icon,children:t}),Object(m.jsx)(o.a,{item:!0,xs:12,children:Object(m.jsx)(g.a,{variant:"h4",align:"center",children:n})}),!!a&&Object(m.jsx)(o.a,{item:!0,xs:12,children:"string"===typeof a?Object(m.jsx)(g.a,{variant:"h6",align:"center",children:a}):Object(m.jsx)("div",{children:a})})]})})},fe=function(e){var t=e.action,n=e.onDispatchCompleted,a=e.onBack,r=le(),c=Object(l.a)().t,i=Object(V.c)().contexts_DispatchAction,u=Object(ne.a)(Object(P.a)(w.a.mark((function e(){return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),[i,t]),s=u.loading,d=u.value,b=u.error;return s?Object(m.jsx)(se.b,{children:c("ExecutingAction")}):Object(m.jsxs)(m.Fragment,{children:[!b&&Object(m.jsx)(be,{icon:Object(m.jsx)(oe.a,{style:{color:ue.a[500],fontSize:60}}),title:c("ActionCompleted"),details:c("DispatchActionResult",{id:null===d||void 0===d?void 0:d.contextId})}),!!b&&Object(m.jsx)(be,{icon:Object(m.jsx)(ce.a,{color:"error",style:{fontSize:60}}),title:c("ActionFailed"),details:Object(m.jsx)(de.a,{error:b})}),Object(m.jsx)(o.a,{container:!0,children:Object(m.jsxs)(o.a,{item:!0,xs:12,children:[!!b&&Object(m.jsx)(W.a,{onClick:a,className:r.button,children:c("Back")}),Object(m.jsx)(W.a,{onClick:n,className:r.button,children:c("Ok")})]})})]})},je=Object(c.a)((function(e){return Object(i.a)({root:{width:"100%"},button:{marginRight:e.spacing(1)},content:{maxHeight:"60vh",overflowY:"auto"}})})),me=[function(e){var t=e.value,n=e.onNext,c=J(),i=Object(r.useState)(""),o=Object(a.a)(i,2),u=o[0],s=o[1],d=function(e){var t=Object(V.c)().contextTypes_Search,n=Object(S.a)("/ContextTypes/Search",Object(P.a)(w.a.mark((function e(){var n;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t({limit:100});case 2:return n=e.sent,e.abrupt("return",Object(M.a)((function(e){return e.name}),n));case 4:case"end":return e.stop()}}),e)})))),a=n.data,c=n.error,i=n.isValidating,o=n.mutate;return Object(r.useMemo)((function(){return{data:q(a,e),isValidating:i,error:c,mutate:o}}),[a,e,i,c,o])}(u),l=d.data,b=d.error,f=d.isValidating,j=Object(r.useCallback)((function(e){t.contextTypeName===e?n(t):n({contextTypeName:e})}),[t,n]);return Object(m.jsxs)(G,{children:[Object(m.jsx)(C,{actions:Object(m.jsx)(U.a,{value:u,onChange:s})}),Object(m.jsx)(D.a,{className:c.root,style:{maxHeight:"400",overflowY:"auto"},children:l.map((function(e,t){return Object(m.jsxs)(T.a,{children:[Object(m.jsx)(A.a,{children:Object(m.jsx)(H,{})}),Object(m.jsx)(z.a,{primary:e.name,secondary:e.description}),Object(m.jsx)(L.a,{children:Object(m.jsx)(N.a,{edge:"end",onClick:function(){return j(e.name)},children:Object(m.jsx)(B.a,{})})})]},e.name)}))}),!f&&!!b&&Object(m.jsx)(E.a,{severity:"error",children:b.toString()})]})},function(e){var t=e.value,n=e.onBack,a=e.onNext,c=$(),i=function(e){var t=Object(V.c)().contextTypes_FindOne,n=Object(S.a)("/ContextType/".concat(e),Object(P.a)(w.a.mark((function n(){return w.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t({name:e});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}}),n)}))),{revalidateOnFocus:!1}),a=n.data,c=n.error,i=n.isValidating,o=n.mutate;return Object(r.useMemo)((function(){return{contextType:a,isValidating:i,error:c,mutate:o}}),[a,i,o,c])}(t.contextTypeName),u=i.contextType,s=i.error,d=i.isValidating,l=Object(r.useMemo)((function(){return u?u.initialActions.map((function(e){return u.actions.find((function(t){return t.name===e}))})).filter(Z.isPresent):[]}),[u]),b=Object(r.useCallback)((function(e){t.action===e?a(t):a({contextTypeName:t.contextTypeName,action:e})}),[t,a]);return!d&&s?Object(m.jsx)(E.a,{severity:"error",children:s.toString()}):d||!u?null:Object(m.jsx)(G,{onBack:n,children:Object(m.jsx)(o.a,{container:!0,direction:"column",alignItems:"center",spacing:3,className:c.root,children:l.map((function(e){return Object(m.jsx)(o.a,{item:!0,xs:10,children:Object(m.jsx)(W.a,{variant:"outlined",onClick:function(){return b(e.name)},children:e.name})},e.name)}))})})},function(e){var t,n=e.value,c=e.onBack,i=e.onNext,u=te(),s=Object(l.a)().t,d=function(e){var t=Object(V.c)().contextTypes_FindOne,n=Object(S.a)("/ContextType/".concat(e),Object(P.a)(w.a.mark((function n(){return w.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t({name:e});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}}),n)}))),{revalidateOnFocus:!1}),a=n.data,c=n.error,i=n.isValidating,o=n.mutate;return Object(r.useMemo)((function(){return{contextType:a,isValidating:i,error:c,revalidate:o}}),[a,i,o,c])}(n.contextTypeName),f=d.contextType,j=d.error,h=d.isValidating,v=Object(r.useState)({reference:n.reference,contextId:n.contextId}),O=Object(a.a)(v,2),p=O[0],g=O[1],x=Object(r.useState)(null!==(t=n.payload)&&void 0!==t?t:{}),y=Object(a.a)(x,2),I=y[0],C=y[1],k=Object(r.useRef)(),M=Object(r.useRef)(),N=Object(r.useMemo)((function(){return null===f||void 0===f?void 0:f.actions.find((function(e){return e.name===n.action}))}),[f,n]),D=Object(r.useCallback)((function(){N&&f&&(k.current&&k.current.length>0||M.current&&M.current.length>0||i(Object(b.a)(Object(b.a)(Object(b.a)({},n),p),{},{payload:I})))}),[i,N,f,p,I,n]),T=Object(r.useMemo)((function(){return{type:"object",properties:{reference:{type:"string"}},required:["reference"]}}),[]),z=Object(r.useMemo)((function(){return function(e,t){if(e&&t&&e.payloadSchemaDefinitionName)return Object(K.a)(t,e.name)}(N,f)}),[N,f]),L=Object(r.useMemo)((function(){var e,t=N?null===(e=Object(X.i)(N))||void 0===e?void 0:e.uiSchema:void 0;if(t)return JSON.parse(t)}),[N]),A=Object(r.useCallback)((function(e){e.errors&&e.errors.length>0?(Object(Q.a)(e.errors.map((function(e){return Object(b.a)(Object(b.a)({},e),{},{instancePath:e.dataPath})}))),k.current=Object(Y.a)(e.errors)):(g(e.data),k.current=void 0)}),[g]),R=Object(r.useCallback)((function(e){e.errors&&e.errors.length>0?(Object(Q.a)(e.errors.map((function(e){return Object(b.a)(Object(b.a)({},e),{},{instancePath:e.dataPath})}))),M.current=Object(Y.a)(e.errors)):(C(e.data),M.current=void 0)}),[C]),B=Object(r.useMemo)((function(){var e;if(f){var t=null===(e=Object(X.i)(f))||void 0===e?void 0:e.uiSchemaCommon;if(t)return JSON.parse(t)}}),[f]);return!h&&j?Object(m.jsx)(E.a,{severity:"error",children:j.toString()}):f&&N?Object(m.jsx)(G,{onBack:c,onNext:D,nextActionCaption:s("ExecuteAction"),children:Object(m.jsxs)(o.a,{container:!0,spacing:2,className:u.root,children:[Object(m.jsx)(o.a,{item:!0,xs:12,className:u.content,children:Object(m.jsx)(ee.a,{schema:T,data:p,onChange:A,uiSchemaLibrary:B})}),Object(m.jsx)(o.a,{item:!0,xs:12,className:u.content,children:!!z&&Object(m.jsx)(ee.a,{schema:z,uischema:L,data:I,onChange:R,uiSchemaLibrary:B})})]})}):null}],he=function(){var e=Object(l.a)().t,t=je(),n=Object(r.useState)(0),c=Object(a.a)(n,2),i=c[0],b=c[1],f=Object(r.useState)({}),j=Object(a.a)(f,2),h=j[0],v=j[1],p=Object(r.useMemo)((function(){return[i>0?e("SelectedContextType",{name:h.contextTypeName}):e("SelectContextType"),i>1?e("SelectedActionType",{name:h.action}):e("SelectActionType"),e("CompleteActionData")]}),[i,h,e]),g=Object(r.useCallback)((function(e){v(e),b((function(e){return e+1}))}),[b]),x=Object(r.useCallback)((function(){b((function(e){return e+1}))}),[b]),y=Object(r.useCallback)((function(){b((function(e){return e-1}))}),[b]),I=Object(r.useCallback)((function(){b(0),v({})}),[]),k=function(){var e=me[i];return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(u.a,{activeStep:i,alternativeLabel:!0,children:p.map((function(e,t){return Object(m.jsx)(s.a,{children:Object(m.jsx)(d.a,{children:e})},t)}))}),!!e&&Object(m.jsx)(e,{value:h,onNext:g,onBack:y,onSkip:x})]})};return Object(m.jsx)(o.a,{container:!0,spacing:3,justifyContent:"center",children:Object(m.jsx)(o.a,{item:!0,xs:9,children:Object(m.jsxs)(O,{className:t.root,children:[Object(m.jsx)(C,{title:e("DispatchingAction")}),i<3?Object(m.jsx)(k,{}):Object(m.jsx)(fe,{action:h,onDispatchCompleted:I,onBack:y})]})})})};t.default=he},320:function(e,t,n){var a={"./ar/index":[620,22],"./ca/index":[621,23],"./cs/index":[622,24],"./de/index":[623,25],"./en/index":[280],"./es/index":[624,26],"./fr/index":[625,27],"./hu/index":[626,28],"./id/index":[627,29],"./it/index":[628,30],"./ja/index":[629,31],"./ko/index":[630,32],"./nb/index":[631,33],"./nl/index":[632,34],"./pl/index":[633,35],"./pt-BR/index":[634,36],"./ru/index":[635,37],"./sk/index":[636,38],"./sv/index":[637,39],"./th/index":[638,40],"./zh-TW/index":[640,41],"./zh/index":[639,42]};function r(e){if(!n.o(a,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=a[e],r=t[0];return Promise.all(t.slice(1).map(n.e)).then((function(){return n.t(r,7)}))}r.keys=function(){return Object.keys(a)},r.id=320,e.exports=r},332:function(e){e.exports=JSON.parse('{"$schema":"http://json-schema.org/draft-07/schema#","$id":"http://nimflow.com/schemas/recognized-image-batch.schema.json","type":"object","title":"Recognized image batch schema","allOf":[{"$ref":"#/definitions/RecognizedImageBatch"}],"definitions":{"RecognizedImageBatch":{"type":"object","properties":{"fileUrls":{"type":"array","items":{"type":"string"}},"documents":{"type":"array","items":{"$ref":"#/definitions/Document"}}},"required":["fileUrls"]},"Document":{"type":"object","properties":{"schemaId":{"type":"string"},"pages":{"type":"array","items":{"$ref":"#/definitions/PageImageLocation"}},"action":{"type":"string","enum":["saveAsDraft","send","dontSend"]},"data":true},"required":["schemaId","action"]},"PageImageLocation":{"type":"object","properties":{"fileIndex":{"type":"integer"},"filePageNumber":{"type":"integer"}},"required":["fileIndex","filePageNumber"]}}}')},338:function(e,t,n){"use strict";n.d(t,"a",(function(){return Ia})),n.d(t,"c",(function(){return Ca})),n.d(t,"b",(function(){return ka}));var a=n(15),r=n(183),c=n(3),i=n.n(c),o=n(1287),u=n(290),s=n(74),d=n(72),l=n(19),b=n(2),f=n(1),j=n(2428),m=n(31),h=function(){throw new Error("You forgot to wrap your component in <JsonFormsContextProvider>.")},v=Object(c.createContext)({context:{},bindContext:!0,uiSchemaLibrary:{},registerValidationProvider:h,unregisterValidationProvider:h,validationProviderUpdated:h}),O=function(e){var t=e.context,n=e.bindContext,a=e.uiSchemaLibrary,r=e.children,i=e.onErrorsChange,o=Object(c.useState)({}),u=Object(f.a)(o,2),s=u[0],d=u[1];Object(c.useEffect)((function(){var e=Object.values(s).flatMap((function(e){return e}));null===i||void 0===i||i(e)}),[s,i]);var h=Object(c.useCallback)((function(e){d((function(t){return Object(b.a)(Object(b.a)({},t),{},Object(l.a)({},e,[]))}))}),[]),O=Object(c.useCallback)((function(e){d((function(t){return Object(j.a)([e],t)}))}),[]),p=Object(c.useCallback)((function(e,t){d((function(n){return e in n?Object(b.a)(Object(b.a)({},n),{},Object(l.a)({},e,t)):n}))}),[]);return Object(m.jsx)(v.Provider,{value:{context:null!==t&&void 0!==t?t:{},bindContext:null===n||void 0===n||n,uiSchemaLibrary:null!==a&&void 0!==a?a:{},registerValidationProvider:h,unregisterValidationProvider:O,validationProviderUpdated:p},children:r})},p=function(){return Object(c.useContext)(v)},g=n(120),x=Object(d.withJsonFormsLayoutProps)((function(e){var t=e.uischema,n=e.visible,a=e.data,r=e.path,i=p(),s=i.bindContext,d=i.context,l=Object(c.useMemo)((function(){var e=t;if(e||"text"in e){var n={data:a,path:r};return s&&Object.assign(n,d),Object(g.a)(e.text,n)}}),[t,a,r,s,d]);return l?Object(m.jsx)(o.a,{xsUp:!n,children:Object(m.jsx)("div",{children:Object(m.jsx)(u.a,{children:l})})}):null})),y=Object(s.rankWith)(3,Object(s.uiTypeIs)("Markdown")),I=n(895),C=n(892),k=Object(I.a)((function(e){return Object(C.a)({viewer:{width:"100%",minHeight:"800px"}})})),w=Object(d.withJsonFormsLayoutProps)((function(e){var t=k(),n=e.uischema,a=e.visible,r=e.data,i=e.path,u=p(),s=u.bindContext,d=u.context,l=Object(c.useMemo)((function(){var e=n;if(e||"url"in e){var t={data:r,path:i};return s&&Object.assign(t,d),Object(g.a)(e.url,t)}}),[n,r,i,s,d]);return l?Object(m.jsx)(o.a,{xsUp:!a||!l,children:Object(m.jsx)("object",{data:l,type:"application/pdf",className:t.viewer,children:Object(m.jsx)("embed",{src:l,type:"application/pdf"})})}):null})),P=Object(s.rankWith)(3,Object(s.uiTypeIs)("Pdf")),S=n(18),M=n(0),N=n(80),D=["uischema","schema","path","renderers"],T=Object(d.withJsonFormsLayoutProps)((function(e){var t=e.uischema,n=e.schema,a=e.path,r=e.renderers,i=Object(S.a)(e,D),o=Object(d.useJsonForms)().core,u=p().uiSchemaLibrary,l="Use"===t.type?t:void 0,f=l?u[l.name]:void 0,j=l?s.Resolve.schema(n,l.scope):void 0,h=Object(c.useMemo)((function(){if(r&&f&&j)return function(e,t){var n,a=-1,r=void 0,c=Object(M.a)(e);try{for(c.s();!(n=c.n()).done;){var i=n.value,o=t(i);o>a&&(a=o,r=i)}}catch(u){c.e(u)}finally{c.f()}return r}(r,(function(e){return e.tester(f,j)}))}),[f,r,j]);if(!f||!l||!j)return null;var v=Object(s.composeWithUi)(l,a),O=s.Resolve.data(null===o||void 0===o?void 0:o.data,v);if(Object(N.isPresent)(h)&&-1!==h.tester(f,j)){var g=h.renderer;return Object(m.jsx)(g,Object(b.a)({uischema:f,schema:j,path:v,data:O,renderers:r},i))}return Object(m.jsx)(d.UnknownRenderer,{type:"renderer"})})),z=Object(s.rankWith)(3,Object(s.uiTypeIs)("Use")),L=n(5),A=n.n(L),E=n(32),R=n(96),B=n(215),V=n(192),F=Object(d.withJsonFormsControlProps)((function(e){var t=e.uischema.options.optionsSource,n=t.moduleName,a=t.functionName,i=Object(B.a)().call,o=Object(R.a)("function/".concat(n,"/").concat(a),Object(E.a)(A.a.mark((function e(){var t,r,c,o,u,s,d,l,b;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],e.next=3,i(n,a);case 3:if(r=e.sent,Array.isArray(r)){c=Object(M.a)(r);try{for(c.s();!(o=c.n()).done;)u=o.value,s=void 0,d=void 0,Object(V.a)(u)?(s=u.value,"string"===typeof u.label&&(d=u.label)):s=u,Object(N.isPresent)(s)&&(b={label:null!==(l=d)&&void 0!==l?l:"string"===typeof s?s:JSON.stringify(s),value:s},t.push(b))}catch(f){c.e(f)}finally{c.f()}}return e.abrupt("return",t);case 6:case"end":return e.stop()}}),e)}))),{fallbackData:[],revalidateOnMount:!0,revalidateOnFocus:!1}).data,u=Object(c.useMemo)((function(){return Object(b.a)(Object(b.a)({},e),{},{options:o})}),[e,o]);return Object(m.jsx)(r.MaterialInputControl,Object(b.a)(Object(b.a)({},u),{},{input:r.MuiSelect}))})),H=Object(s.rankWith)(3,Object(s.and)(s.isControl,(function(e){var t,n=null===(t=e.options)||void 0===t?void 0:t.optionsSource;return!!n&&!!n.moduleName&&!!n.functionName}))),U=n(223),W=n(2476),_=n(1284),G=n(67),J=n(2420),q=n(932),Z=n(910),$=n(2423),Y=n(2438),K=n(449),Q=n.n(K),X=n(2451),ee=n(382),te=n(659),ne=n(36),ae=n(2468),re=n(2452),ce=n(581),ie=n.n(ce),oe=n(285),ue=n.n(oe),se=n(214),de=n.n(se),le=n(657),be=n(600),fe=n.n(be),je=n(98),me=n(163),he=["image/png","image/jpeg","image/webp"],ve=function(e){return new Promise((function(t,n){var a=new Image;a.crossOrigin="anonymous",a.addEventListener("load",(function(){return t(a)})),a.addEventListener("error",(function(e){return n(e)})),a.src=e}))},Oe=function(){var e=Object(E.a)(A.a.mark((function e(t,n){var a,r,c;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=new Blob([t.content],{type:t.mimeType}),r=URL.createObjectURL(a),e.prev=2,e.next=5,ve(r);case 5:c=e.sent,t.pages.push({getImageData:function(){var e=document.createElement("canvas"),t=e.getContext("2d");return e.width=c.naturalWidth,e.height=c.naturalHeight,t.drawImage(c,0,0),t.getImageData(0,0,c.naturalWidth,c.naturalHeight)},width:c.naturalWidth,height:c.naturalHeight,fileIndex:n,filePageNumber:0,pageIndex:0});case 7:return e.prev=7,URL.revokeObjectURL(r),e.finish(7);case 10:case"end":return e.stop()}}),e,null,[[2,,7,10]])})));return function(t,n){return e.apply(this,arguments)}}(),pe=function(){var e=Object(E.a)(A.a.mark((function e(t,n){var a,r,c,i;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a=new ue.a({buffer:t.content}),r=function(e,r){a.setDirectory(e);var c={getImageData:function(){a.setDirectory(e);var t=a.readRGBAImage();return new ImageData(new Uint8ClampedArray(t),a.width(),a.height())},width:a.width(),height:a.height(),fileIndex:n,filePageNumber:e,pageIndex:0};t.pages.push(c)},c=0,i=a.countDirectory();c<i;++c)r(c);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),ge=function(){var e=Object(E.a)(A.a.mark((function e(t,n){var a,r,c,i,o,u;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=new Uint8Array(t.content),e.next=3,le.a.getDocument(a).promise;case 3:for(r=e.sent,c=[],i=new Array(r.numPages),o=function(e){c.push(r.getPage(e+1).then(function(){var t=Object(E.a)(A.a.mark((function t(a){var r,c;return A.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=2*window.devicePixelRatio,c=a.getViewport({scale:r}),i[e]={getImageData:function(){var e=Object(E.a)(A.a.mark((function e(){var t,n;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=document.createElement("canvas")).style.width="".concat(c.width/r,"px"),t.style.height="".concat(c.height/r,"px"),t.height=c.height,t.width=c.width,n=t.getContext("2d"),e.next=8,a.render({canvasContext:n,viewport:c}).promise;case 8:return e.abrupt("return",n.getImageData(0,0,t.width,t.height));case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),width:c.width,height:c.height,fileIndex:n,filePageNumber:e,pageIndex:0};case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()))},u=0;u<r.numPages;u++)o(u);return e.next=10,Promise.all(c);case 10:t.pages=i;case 11:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),xe=function(){var e=Object(E.a)(A.a.mark((function e(t,n,a){var r,c,i,o,u,s;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=t.lastIndexOf("/"),i=c>=0?t.substring(c+1):t,o={url:t,status:"loaded",name:i,mimeType:a.headers["content-type"],content:a.data,pages:[],pageStartIndex:0},u=null===(r=a.headers)||void 0===r?void 0:r["content-disposition"],(s=u?/filename="?([^"]*?)"?(;|$)/g.exec(u):void 0)&&s.length>1&&(o.name=s[1]),o.mimeType&&!he.includes(o.mimeType)){e.next=11;break}return e.next=9,Oe(o,n);case 9:e.next=19;break;case 11:if("image/tiff"!==o.mimeType){e.next=16;break}return e.next=14,pe(o,n);case 14:e.next=19;break;case 16:if("application/pdf"!==o.mimeType){e.next=19;break}return e.next=19,ge(o,n);case 19:return e.abrupt("return",o);case 20:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),ye=function(e,t){return Object(ne.a)(e,(function(e){null===t||void 0===t||t.forEach((function(t,n){t.pages.forEach((function(t,a){var r=e[t.fileIndex];if("loaded"===(null===r||void 0===r?void 0:r.status)){var c=r.pages[t.filePageNumber];c.documentIndex=n,c.documentOrder=a}}))}));var n,a=0,r=Object(M.a)(e);try{for(r.s();!(n=r.n()).done;){var c=n.value;if("loaded"===c.status){c.pageStartIndex=a;var i,o=Object(M.a)(c.pages);try{for(o.s();!(i=o.n()).done;){i.value.pageIndex=a++}}catch(u){o.e(u)}finally{o.f()}}}}catch(u){r.e(u)}finally{r.f()}}))},Ie=n(157),Ce=Symbol("marker"),ke=Object(s.createAjv)({allErrors:!0,addUsedSchema:!1,useDefaults:!0});ke.addFormat("image",(function(){return!0})),ke.addKeyword("patternMask",{type:"string",valid:!0,errors:!1});var we=function(e,t){var n=function(e){for(var t="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=new Uint8Array(e),r=a.byteLength,c=r%3,i=r-c,o=0;o<i;o+=3){var u=a[o]<<16|a[o+1]<<8|a[o+2],s=(258048&u)>>12,d=(4032&u)>>6,l=63&u;t+=n[(16515072&u)>>18]+n[s]+n[d]+n[l]}if(1===c){var b=a[i],f=(3&b)<<4;t+=n[(252&b)>>2]+n[f]+"=="}else if(2===c){var j=a[i]<<8|a[i+1],m=(1008&j)>>4,h=(15&j)<<2;t+=n[(64512&j)>>10]+n[m]+n[h]+"="}return t}(e);return"data:".concat(t,";base64,").concat(n)};var Pe=function(){throw new Error("You forgot to wrap your component in <BatchProcessorContextProvider>.")},Se={fileInfos:[],documentInfos:[],loadingImages:!1,setCurrentDocumentLocation:Pe,updateCurrentDocument:Pe,updateBatch:Pe,movePage:Pe,findByPageIndex:Pe,deleteDocument:Pe,addDocument:Pe,updateDocument:Pe,getDocument:Pe,setCurrentDocumentEditionState:Pe,canModify:!0,getDisplayableDataUrl:Pe},Me=Object(c.createContext)(Se),Ne=function(e,t){var n,a=Object(M.a)(t);try{for(a.s();!(n=a.n()).done;){var r,c=n.value,i="loaded"===c.status?c.pages:[],o=Object(M.a)(i);try{for(o.s();!(r=o.n()).done;){var u=r.value;if(u.pageIndex===e)return u}}catch(s){o.e(s)}finally{o.f()}}}catch(s){a.e(s)}finally{a.f()}},De=function(e){return ie()(e).map((function(e){return e-1}))},Te=function(e,t,n){var a=e;return a&&(a+=","),a+=t.toString(),t!==n&&(a+="-".concat(n)),a},ze=function(e){if(0===e.length)return"";for(var t=e.map((function(e){return e+1})),n=t[0],a=n,r="",c=1;c<t.length;c++){var i=t[c];i===a+1&&a>=n||i===a-1&&a<=n?a=i:(r=Te(r,n,a),n=a=i)}return r=Te(r,n,a)},Le=function(e,t){var n=new Array(e.length);return t.forEach((function(t,a){"loaded"===t.status&&t.pages.forEach((function(t,r){var c=e.indexOf(t.pageIndex);c>=0&&(n[c]={fileIndex:a,filePageNumber:r})}))})),n},Ae=function(e,t){return t&&!ke.validate(t,e.data)&&ke.errors?Object(Ie.a)(ke.errors.map((function(e){return Object(b.a)(Object(b.a)({},e),{},{instancePath:e.dataPath})}))):[]},Ee=function(e){var t=e.basePath,n=e.batch,r=e.documentSchemasSource,i=e.readonly,o=e.children,u=!i,j=Object(c.useState)(n),h=Object(f.a)(j,1)[0],v=function(e){var t=e.moduleName,n=e.functionName,a=Object(B.a)().call,r=Object(R.a)("function/".concat(t,"/").concat(n),Object(E.a)(A.a.mark((function e(){var r,c,i,o,u;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=[],e.next=3,a(t,n);case 3:if(c=e.sent,Array.isArray(c)){i=Object(M.a)(c);try{for(i.s();!(o=i.n()).done;)u=o.value,"success"===Object(Ie.b)(u).type&&r.push(u)}catch(s){i.e(s)}finally{i.f()}}return e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)}))),{revalidateOnFocus:!1}),i=r.data,o=r.isValidating,u=r.error;return{documentSchemas:Object(c.useMemo)((function(){return null!==i&&void 0!==i?i:[]}),[i]),loading:o,error:u}}(r).documentSchemas,O=Object(d.useJsonForms)().dispatch,g=function(e,t){var n=Object(me.c)().hubBaseUrl,a=Object(je.c)().getConfiguredAxiosInstance,r=Object(c.useState)((function(){return e.fileUrls.map((function(e){var t=fe()(e);return t.is("relative")&&n&&(t=fe.a.joinPaths("BlobStorage",t).absoluteTo(n)),{url:t.valueOf(),status:"loading",name:t.filename()}}))})),i=Object(f.a)(r,2),o=i[0],u=i[1],s=Object(c.useState)(t&&e.fileUrls.length>0),d=Object(f.a)(s,2),l=d[0],b=d[1];return Object(c.useEffect)((function(){if(t){var r=de.a.CancelToken.source(),c=de.a.create({responseType:"arraybuffer",cancelToken:r.token}),i=a({responseType:"arraybuffer",cancelToken:r.token});return e.fileUrls.map((function(t,a){var r=fe()(t),o=c;return r.is("relative")&&n&&(r=fe.a.joinPaths("BlobStorage",r),o=i),t=r.valueOf(),o.get(t).then((function(n){return xe(t,a,n).then((function(t){u((function(n){var r=Object(ne.a)(n,(function(e){e[a]=t}));return r.every((function(e){return"loading"!==e.status}))&&(r=ye(r,e.documents),b(!1)),r}))}))})).catch((function(n){u((function(r){var c=Object(ne.a)(r,(function(e){e[a]=function(e,t){var n=e.lastIndexOf("/"),a=n>=0?e.substring(n+1):e,r={url:e,status:"failed",name:a,error:t.message};return t.response&&(r.error="Code: ".concat(t.response.status,"\nData: ").concat(t.response.data)),r}(t,n)}));return c.every((function(e){return"loading"!==e.status}))&&(c=ye(c,e.documents),b(!1)),c}))}))})),function(){r.cancel(),b(!1)}}u((function(e){return e.map((function(e){return{name:e.name,status:"loaded",url:e.url,content:new ArrayBuffer(0),pages:[],pageStartIndex:0}}))}))}),[t,a,n,e.documents,e.fileUrls]),{loadingFileInfos:l,fileInfos:o,setFileInfos:u}}(h,u),x=g.fileInfos,y=g.loadingFileInfos,I=g.setFileInfos,C=Object(c.useState)({documentIndex:h.documents.length>0?0:void 0}),k=Object(f.a)(C,2),w=k[0],P=k[1],S=Object(c.useState)([]),D=Object(f.a)(S,2),T=D[0],z=D[1],L=function(e){var t=p(),n=t.registerValidationProvider,a=t.unregisterValidationProvider,r=t.validationProviderUpdated,i=Object(c.useState)(),o=Object(f.a)(i,2),u=o[0],s=o[1];Object(c.useEffect)((function(){return n(e),function(){return a(e)}}),[e,n,a]),Object(c.useEffect)((function(){var t=(null!==u&&void 0!==u?u:[]).map((function(t){var n="".concat(e,".").concat(t.dataPath);return Object(b.a)(Object(b.a)({},t),{},{dataPath:n,instancePath:n})}));r(e,t)}),[u,e,r]);var d=Object(c.useCallback)((function(e){s((function(t){return Object(_.a)(t,e)?t:e}))}),[]);return Object(c.useMemo)((function(){return{updateErrors:d}}),[d])}(t).updateErrors,V=Object(c.useMemo)((function(){return n.documents.map((function(e,t){var n;return{schemaId:e.schemaId,action:e.action,errors:null!==(n=T[t])&&void 0!==n?n:[]}}))}),[n.documents,T]);Object(c.useEffect)((function(){if(v&&0!==h.documents.length){var e=h.documents.map((function(e){var t=v.find((function(t){return t.$id===e.schemaId}));return Ae(e,t)}));z((function(t){return e.map((function(e,n){return t[n]?t[n]:e}))}))}}),[h,v]);var F=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Object(c.useRef)(e),r=n.current;if(e!==r)if(r.length!==e.length)n.current=e;else if(t)for(var i=Object(a.a)(e),o=0;o<r.length;o++){var u=i.indexOf(r[o]);if(-1===u){n.current=e;break}i[u]=Ce}else for(var s=0;s<r.length;s++)if(r[s]!==e[s]){n.current=e;break}return n.current}(n.documents.reduce((function(e,t,n){return"send"===t.action&&e.push(n),e}),[]),!0);Object(c.useEffect)((function(){var e=F.flatMap((function(e){var t,n;return null!==(t=null===(n=T[e])||void 0===n?void 0:n.map((function(t){var n="documents[".concat(e,"].data.").concat(t.instancePath);return Object(b.a)(Object(b.a)({},t),{},{instancePath:n,dataPath:n})})))&&void 0!==t?t:[]}));u&&L(e)}),[u,T,F,L]);var H=Object(c.useCallback)((function(e,n){var a="function"===typeof n?n:function(){return n};null===O||void 0===O||O(Object(s.update)(Object(U.compose)(t,e),a))}),[O]),W=Object(c.useMemo)((function(){return Object(N.isPresent)(w.documentIndex)?n.documents[w.documentIndex]:void 0}),[n.documents,w.documentIndex]),G=Object(c.useCallback)((function(e){var t=null!==e&&void 0!==e?e:{};P((function(e){return e.documentIndex!==t.documentIndex||e.pageIndex!==t.pageIndex?t:e}))}),[]),J=Object(c.useCallback)((function(e){var t=null===w||void 0===w?void 0:w.documentIndex;Object(N.isPresent)(t)&&H("documents[".concat(t,"]"),e)}),[null===w||void 0===w?void 0:w.documentIndex,H]),q=Object(N.isPresent)(w.documentIndex)?T[w.documentIndex]:void 0,Z=Object(c.useMemo)((function(){if(W&&q)return{document:W,errors:q}}),[W,q]),$=Object(c.useCallback)((function(e){var t=w.documentIndex;z((function(n){var a,r=W?{document:W,errors:n[t]}:void 0,c="function"===typeof e?e(r):e,i=Object(_.a)(null===c||void 0===c?void 0:c.errors,null===r||void 0===r?void 0:r.errors),o=Object(_.a)(null===c||void 0===c?void 0:c.document,null===r||void 0===r?void 0:r.document);if(i&&o)return n;var u=null===c||void 0===c?void 0:c.document;return u&&!o&&J(u),Object(ae.a)(t,null!==(a=null===c||void 0===c?void 0:c.errors)&&void 0!==a?a:[],n)}))}),[W,w.documentIndex,J]),Y=Object(c.useCallback)((function(e,t){var a=Object(ne.a)({fileInfos:x,docs:n.documents},(function(n){var a=Ne(e,n.fileInfos);if(a){var r,c=[],i=[],o=a.documentIndex===(null===t||void 0===t?void 0:t.documentIndex),u=Object(M.a)(n.fileInfos);try{for(u.s();!(r=u.n()).done;){var s=r.value;if("loaded"===s.status){var d,l=Object(M.a)(s.pages);try{for(l.s();!(d=l.n()).done;){var b=d.value;Object(N.isPresent)(a.documentIndex)&&b.documentIndex===a.documentIndex&&c.push(b),Object(N.isPresent)(t)&&b.documentIndex===t.documentIndex&&!o&&i.push(b)}}catch(g){l.e(g)}finally{l.f()}}}}catch(g){u.e(g)}finally{u.f()}c.sort(Object(X.a)((function(e,t){return e.documentOrder<t.documentOrder}))),i.sort(Object(X.a)((function(e,t){return e.documentOrder<t.documentOrder})));var f=a.documentIndex;if(Object(N.isPresent)(f)){var j=n.docs[f];c.splice(a.documentOrder,1),o?c.splice(t.documentOrder,0,a):(a.documentIndex=void 0,a.documentOrder=void 0);for(var m=0;m<c.length;m++)c[m].documentOrder=m;j&&(j.pages=c.map((function(e){return{fileIndex:e.fileIndex,filePageNumber:e.filePageNumber}})))}if(Object(N.isPresent)(t)&&!o){var h=t.documentIndex,v=t.documentOrder,O=n.docs[h];i.splice(v,0,a),a.documentIndex=h,a.documentOrder=v;for(var p=0;p<i.length;p++)i[p].documentOrder=p;O&&(O.pages=i.map((function(e){return{fileIndex:e.fileIndex,filePageNumber:e.filePageNumber}})))}}}));I(a.fileInfos),H("documents",a.docs)}),[n.documents,x,I,H]),K=Object(c.useCallback)((function(e){return Ne(e,x)}),[x]),Q=Object(c.useCallback)((function(e){if(Object(N.isPresent)(n.documents[e])){var t=Object(a.a)(n.documents);t.splice(e,1),setTimeout((function(){return H("documents",t)}),0),z((function(t){return Object(re.a)(e,1,t)})),I((function(t){return Object(ne.a)(t,(function(t){var n,a=Object(M.a)(t);try{for(a.s();!(n=a.n()).done;){var r=n.value;if("loaded"===r.status){var c,i=Object(M.a)(r.pages);try{for(i.s();!(c=i.n()).done;){var o=c.value;o.documentIndex===e&&(o.documentIndex=void 0,o.documentOrder=void 0)}}catch(u){i.e(u)}finally{i.f()}}}}catch(u){a.e(u)}finally{a.f()}}))})),P((function(t){return t.documentIndex===e?{}:t}))}}),[n.documents,I,H]),ee=Object(c.useCallback)((function(e){var t=n.documents.length,r=[].concat(Object(a.a)(n.documents),[e]);return H("documents",r),z((function(e){return[].concat(Object(a.a)(e),[[]])})),e.pages.length>0&&I((function(n){return Object(ne.a)(n,(function(n){e.pages.forEach((function(e,a){var r=n[e.fileIndex];if("loaded"===(null===r||void 0===r?void 0:r.status)){var c=r.pages[e.filePageNumber];c&&(c.documentIndex=t,c.documentOrder=a)}}))}))})),t}),[n.documents,I,H]),te=Object(c.useCallback)((function(e,t){var r=Object(a.a)(n.documents),c=r[e].schemaId,i=r[e].pages;r[e]=t,H("documents",r);var o=t.pages;if(i!==o&&I((function(t){return Object(ne.a)(t,(function(t){var n,a=Object(M.a)(i.filter(N.isPresent));try{for(a.s();!(n=a.n()).done;){var r=n.value,c=t[r.fileIndex];if("loaded"===c.status){var u=c.pages[r.filePageNumber];u.documentIndex=void 0,u.documentOrder=void 0}}}catch(f){a.e(f)}finally{a.f()}for(var s=0;s<o.length;s++){var d=o[s];if(d){var l=t[d.fileIndex];if("loaded"===l.status){var b=l.pages[d.filePageNumber];b.documentIndex=e,b.documentOrder=s}}}}))})),c!==t.schemaId){var u=null===v||void 0===v?void 0:v.find((function(e){return e.$id===t.schemaId})),s=Ae(t,u);z((function(t){return Object(ae.a)(e,s,t)}))}return e}),[n.documents,v,I,H]),ce=Object(c.useCallback)((function(e){return n.documents[e]}),[n.documents]),ie=Object(c.useState)({}),oe=Object(f.a)(ie,2),se=oe[0],le=oe[1],be=Object(c.useCallback)((function(e){var t=se[e];if(!t){var n=e.indexOf(",");if(!e.startsWith("data:")||-1===n)return e;if("image/tiff"===e.substring(5,n).split(";")[0]){var a=function(e){for(var t=atob(e.split(",")[1]),n=new ArrayBuffer(t.length),a=new Uint8Array(n),r=0;r<t.length;r++)a[r]=t.charCodeAt(r);return n}(e),r=new ue.a({buffer:a});t=r.toDataURL()}else t=e;le((function(n){return Object(b.a)(Object(b.a)({},n),{},Object(l.a)({},e,t))}))}return t}),[se]),he=Object(c.useMemo)((function(){return{fileInfos:x,documentSchemas:v,loadingImages:y,documentInfos:V,currentDocumentLocation:w,setCurrentDocumentLocation:G,currentDocument:W,updateCurrentDocument:J,updateBatch:H,movePage:Y,findByPageIndex:K,deleteDocument:Q,addDocument:ee,updateDocument:te,getDocument:ce,currentDocumentEditionState:Z,setCurrentDocumentEditionState:$,canModify:u,getDisplayableDataUrl:be}}),[ee,u,W,Z,w,Q,V,v,x,be,ce,K,$,G,y,Y,H,J,te]);return Object(m.jsx)(Me.Provider,{value:he,children:o})},Re=function(){return Object(c.useContext)(Me)},Be=n(107),Ve=n(2395),Fe=function(e){return Object(m.jsx)(Ve.a,Object(b.a)(Object(b.a)({viewBox:"0 0 512 512"},e),{},{children:Object(m.jsx)("path",{d:"M9.5 1.4C2.3 4.6 0 9.7 0 22.6V32h32V0h-9.7c-5.9.1-11 .6-12.8 1.4zM62 16v16h29V0H62v16zM121 16v16h29V0h-29v16zM180 16v16h29V0h-29v16zM239 16v16h29V0h-29v16zM298 16v16h29V0h-29v16zM357 16v16h29V0h-29v16zM416 15.9V32h32.2l-.4-10.9c-.2-9.2-.6-11.4-2.4-13.7-4.4-6-6.7-6.9-18.5-7.2L416-.2v16.1zM0 76.5V91h32V62H0v14.5zM416 76.5V91h32V62h-32v14.5zM0 135.5V150h32v-29H0v14.5zM416 135.5V150h32v-29h-32v14.5zM0 194.5V209h32v-29H0v14.5zM416 194.5V209h32v-29h-32v14.5zM297.5 225.4c-4.1 1.8-8.3 6.9-9 10.9-.3 1.8-.4 62.2-.3 134.4.3 130.7.3 131.2 2.4 133.9 4.9 6.7 13 9.1 19.5 6 1.9-.9 20.5-15.3 41.4-32.1l38-30.4 54.8-.1c59.9 0 58.9.1 64-5.9 3-3.7 4.2-8.5 3.2-13.9-.6-3.3-11.6-14.6-99.3-102.6-57.7-57.7-100-99.4-101.9-100.2-4-1.7-8.9-1.7-12.8 0zM417.7 416l-39.4.5-3.9 3c-2.1 1.6-15 11.8-28.6 22.7-13.6 10.9-25 19.8-25.3 19.8-.3 0-.5-41.3-.5-91.7v-91.8l68.5 68.5 68.5 68.5-39.3.5zM0 253.5V268h32v-29H0v14.5zM416 253.5V268h32v-29h-32v14.5zM0 312.5V327h32v-29H0v14.5zM0 371.5V386h32v-29H0v14.5zM.2 426.9c.3 11.8 1.2 14.1 7.2 18.5 2.3 1.8 4.5 2.2 13.7 2.4l10.9.4V416H-.2l.4 10.9zM62 432v16h29v-32H62v16zM121 432v16h29v-32h-29v16zM180 432v16h29v-32h-29v16z"})}))},He=function(e){return function(e){return"object"===typeof e&&"then"in e}(e)?e:Promise.resolve(e)},Ue=n(601),We=n.n(Ue),_e=Object(I.a)((function(e){return Object(C.a)({listContainer:{width:"100%",height:"100%"},imageItem:{width:"100%",display:"flex",justifyContent:"center",position:"relative"},imageContainer:{width:"100%"},image:{padding:3,borderRadius:e.shape.borderRadius,boxShadow:e.shadows[4]},divider:{marginTop:20,marginBottom:10},name:{textAlign:"center",marginTop:e.spacing(2)},extractIcon:{position:"absolute",bottom:e.spacing(4),right:e.spacing(2)}})})),Ge=function(e){var t=e.page,n=e.onImageExtractionRequested,a=e.listWidth,r=e.readonly,i=_e(),o=Object(W.a)().t,u=Object(c.useRef)(null),s=Object(c.useState)(),d=Object(f.a)(s,2),l=d[0],b=d[1],j=a-40,h=Object(c.useMemo)((function(){return j*t.height/t.width}),[t.height,t.width,j]),v=Object(c.useState)(),O=Object(f.a)(v,2),p=O[0],g=O[1],x=Object(c.useState)(),y=Object(f.a)(x,2),I=y[0],C=y[1],k=Object(c.useState)(!1),w=Object(f.a)(k,2),P=w[0],S=w[1];Object(c.useEffect)((function(){return function(){g(void 0),C(void 0)}}),[]),Object(c.useEffect)((function(){He(t.getImageData()).then((function(e){g(e)}))}),[t]),Object(c.useEffect)((function(){if(p){var e=function(e,t,n){var a=document.createElement("canvas");a.width=e.width,a.height=e.height;var r=a.getContext("2d");r.imageSmoothingEnabled=!1,r.putImageData(e,0,0);var c=document.createElement("canvas");c.width=t,c.height=n;var i=c.getContext("2d");return i.imageSmoothingEnabled=!1,i.drawImage(a,0,0,e.width,e.height,0,0,c.width,c.height),i.getImageData(0,0,t,n)}(p,j,h);C(e)}else C(void 0)}),[h,p,j]),Object(c.useEffect)((function(){var e=u.current;if(e){var n=e.getContext("2d"),a=null!==l&&void 0!==l?l:{x:0,y:0},r=a.x,c=a.y;if(l||P||!I||n.putImageData(I,0,0),P&&p){var i=r*t.width/e.width,o=c*t.height/e.height;n.putImageData(p,r-i,c-o)}else I&&n.putImageData(I,0,0)}}),[p,l,t.height,t.width,I,P]);var M=Object(c.useCallback)((function(){}),[]),D=Object(c.useCallback)((function(){}),[]),T=Object(c.useCallback)((function(e){var t=u.current;if(t&&(null===e||void 0===e?void 0:e.altKey)){var n=t.getBoundingClientRect(),a=n.left,r=n.top;b({x:e.pageX-a,y:e.pageY-r})}}),[]),z=Object(c.useCallback)((function(e){(null===e||void 0===e?void 0:e.altKey)&&S(!0)}),[S]),L=Object(c.useCallback)((function(){S(!1)}),[S]),A=Object(c.useCallback)((function(){S(!1)}),[S]);return Object(m.jsx)(J.a,{className:Object(G.default)(i.imageItem,"page-index-".concat(t.pageIndex)),children:Object(m.jsxs)("div",{className:i.imageContainer,children:[Object(m.jsx)(We.a,{upHandler:L,downHandler:A,children:Object(m.jsx)("canvas",{tabIndex:0,onKeyDown:z,ref:u,width:j,height:h,className:i.image,onMouseOver:M,onMouseOut:D,onMouseMove:T})}),Object(m.jsx)(Z.a,{className:i.name,children:t.name}),Object(m.jsx)($.a,{variant:"fullWidth",className:i.divider}),Object(N.isPresent)(t.documentIndex)&&!r&&Object(m.jsx)(q.a,{title:o("ExtractImages"),children:Object(m.jsx)(Y.a,{className:i.extractIcon,color:"secondary",size:"small",onClick:function(){return null===n||void 0===n?void 0:n(t.pageIndex)},children:Object(m.jsx)(Fe,{})})})]})})},Je=i.a.memo((function(e){var t=e.filteredPages,n=e.width,a=e.height,r=e.onImageExtractionRequested,i=e.readonly,o=_e(),u=Object(c.useCallback)((function(e){if(!Object(N.isPresent)(n))return 0;var a=t[e];return"loaded"!==a.status?100:(n-40)*a.height/a.width+100}),[t,n]);return Object(m.jsx)(te.a,{height:a,itemCount:t.length,itemSize:u,width:n,children:function(e){var a=e.index,c=e.style,u=t[a];return"loaded"!==u.status?Object(m.jsxs)(J.a,{className:o.imageItem,style:c,children:["loading"===u.status&&Object(m.jsx)(Be.a,{}),"failed"===u.status&&Object(m.jsx)(Q.a,{color:"error"}),Object(m.jsx)(Z.a,{style:{textAlign:"center"},children:u.name})]},a):Object(m.jsx)("div",{style:c,children:Object(m.jsx)(Ge,{page:u,onImageExtractionRequested:r,listWidth:n,readonly:i})},u.pageIndex)}})})),qe=function(e){var t=e.onImageExtractionRequested,n=Re(),a=n.fileInfos,r=n.currentDocumentLocation,i=n.currentDocument,o=_e(),u=Object(ee.a)({}),s=u.width,d=u.height,l=u.ref,b=Object(c.useMemo)((function(){var e=a.flatMap((function(e){return"loaded"!==e.status?[{finfo:e}]:e.pages.map((function(t,n){return{finfo:e,pinfo:t,pinfoOrder:n}}))}));return e.map((function(e){var t=e.finfo,n=e.pinfo,a=e.pinfoOrder;if("loaded"!==t.status)return{status:t.status,name:t.name};var r="".concat(n.pageIndex+1," - ").concat(t.name);return t.pages.length>1&&(r+=" / ".concat(a+1)),{status:t.status,name:r,getImageData:n.getImageData,width:n.width,height:n.height,fileInfoIndex:n.fileIndex,filePageNumber:n.filePageNumber,pageIndex:n.pageIndex,documentIndex:n.documentIndex,documentOrder:n.documentOrder}}))}),[a]),f=Object(c.useMemo)((function(){if(!r)return b;var e=r.pageIndex;if(Object(N.isPresent)(e))return b.filter((function(t){return"loaded"===t.status&&t.pageIndex===e}));var t=r.documentIndex,n=b.filter((function(e){return"loaded"===e.status&&e.documentIndex===t}));return Object(N.isPresent)(t)?n.sort(Object(X.a)((function(e,t){return e.documentOrder<t.documentOrder}))):n.sort(Object(X.a)((function(e,t){return e.pageIndex<t.pageIndex}))),n}),[b,r]);return Object(m.jsx)("div",{ref:l,className:o.listContainer,children:Object(N.isPresent)(s)&&Object(N.isPresent)(d)&&Object(m.jsx)(Je,{filteredPages:f,width:s,height:d,onImageExtractionRequested:t,readonly:"dontSend"===(null===i||void 0===i?void 0:i.action)})})},Ze=n(909),$e=n(953),Ye=n(153),Ke=n.n(Ye),Qe=n(201),Xe=n.n(Qe),et=n(251),tt=n.n(et),nt=n(605),at=n.n(nt),rt=n(606),ct=n.n(rt),it=n(33),ot=n(656),ut=n(451),st=n.n(ut),dt=n(145),lt=n(2400),bt=n(2416),ft=n(2406),jt=n(2405),mt=n(918),ht=n(912),vt=n(943),Ot=n(2398),pt=n(1906),gt=n(2453),xt=n(188),yt=n(658),It=["saveAsDraft","send","dontSend"];Object.freeze(It);var Ct,kt=n(136),wt=function e(t){var n={};if(t)for(var a=function(){var a=c[r];Array.isArray(t[a])?t[a].forEach((function(t,r){var c=n[a];Object(N.isPresent)(c)||(n[a]=c=[]),c[r]=e(t)})):"object"===typeof t[a]&&null!==t[a]?n[a]=e(t[a]):n[a]=!0},r=0,c=Object.keys(t);r<c.length;r++)a();return n},Pt=["name","debounce","onChange","onBlur","helperText","error","disabled","controlValueAdapter"],St=function(e){var t=e.name,n=e.debounce,a=e.onChange,r=e.onBlur,i=e.helperText,o=(e.error,e.disabled),u=e.controlValueAdapter,s=Object(S.a)(e,Pt),d=Object(xt.d)().isSubmitting,l=Object(xt.c)({name:t}),j=Object(f.a)(l,3),h=j[0],v=j[1],O=j[2],p=v.error,g=v.touched&&!!p,x=Object(c.useState)(h.value),y=Object(f.a)(x,2),I=y[0],C=y[1],k=Object(c.useState)(),w=Object(f.a)(k,2),P=w[0],M=w[1];Object(c.useEffect)((function(){C(h.value)}),[h.value]);var D=Object(c.useCallback)((function(e){var t=e.target.value;O.setValue(u?u(t):t),null===a||void 0===a||a(e)}),[u,O,a]),T=Object(c.useCallback)((function(e){C((function(t){var n=e.target.value;return n||t})),Object(N.isPresent)(n)?(e.persist(),P&&clearTimeout(P),M(setTimeout((function(){return D(e)}),n))):D(e)}),[D,n,P]),z=Object(c.useCallback)((function(e){h.onBlur(e),null===r||void 0===r||r(e)}),[h,r]);return Object(m.jsx)(m.Fragment,{children:Object(m.jsx)(ht.a,Object(b.a)(Object(b.a)({},h),{},{value:null!==I&&void 0!==I?I:"",onChange:T,onBlur:z,error:g,helperText:g?p:i,disabled:null!==o&&void 0!==o?o:d},s))})},Mt=n(2482),Nt=["name","controlValueAdapter","onChange","onBlur","renderInput","multiple","loading","disabled"],Dt=function(e){var t,n=e.name,a=e.controlValueAdapter,r=e.onChange,i=e.onBlur,o=e.renderInput,u=e.multiple,s=e.loading,d=e.disabled,l=Object(S.a)(e,Nt),j=Object(xt.d)(),h=j.isSubmitting,v=j.setFieldTouched,O=Object(xt.c)({name:n}),p=Object(f.a)(O,3),g=p[0],x=p[1],y=p[2],I=x.error,C=x.touched&&!!I,k=Object(c.useCallback)((function(e,t,n,c){var i=a?a(t):t;y.setValue(null!==i&&void 0!==i?i:void 0),null===r||void 0===r||r(e,t,n,c)}),[a,y,r]),w=Object(c.useCallback)((function(e){v(g.name),g.onBlur(e),null===i||void 0===i||i(e)}),[g,i,v]),P=Object(c.useCallback)((function(e){return o?o(Object(b.a)(Object(b.a)({},e),{},{error:C,helperText:C?I:void 0})):null}),[I,o,C]);return Object(m.jsx)(m.Fragment,{children:Object(m.jsx)(Mt.a,Object(b.a)(Object(b.a)({},g),{},{value:null!==(t=g.value)&&void 0!==t?t:null,onChange:k,onBlur:w,renderInput:P,disabled:null!==d&&void 0!==d?d:h,loading:s||h,multiple:u},l))})},Tt=Object(I.a)((function(e){return Object(C.a)({dialogPaper:{},dialogContent:{}})})),zt=function(e){var t=Object(W.a)().t,n=Re().documentSchemas,a=Object(c.useMemo)((function(){var e={};if(n){var t,a=Object(M.a)(n);try{for(a.s();!(t=a.n()).done;){var r,c=t.value;c.$id&&(e[c.$id]={label:null!==(r=c.title)&&void 0!==r?r:c.$id,description:c.description})}}catch(i){a.e(i)}finally{a.f()}}return e}),[n]),r=Object(c.useMemo)((function(){var e=Object.keys(a);return Object(pt.a)((function(e){return a[e].label}),e)}),[a]);return Object(m.jsxs)(Ot.a,{container:!0,spacing:3,children:[Object(m.jsx)(Ot.a,{item:!0,xs:12,children:Object(m.jsx)(Dt,{name:"schemaId",options:r,getOptionLabel:function(e){var t;return null===(t=a[e])||void 0===t?void 0:t.label},renderInput:function(e){return Object(m.jsx)(ht.a,Object(b.a)(Object(b.a)({},e),{},{label:t("Schema"),InputLabelProps:{required:!0},required:!0,autoFocus:!0}))},fullWidth:!0})}),Object(m.jsx)(Ot.a,{item:!0,xs:12,children:Object(m.jsx)(St,{name:"pages",label:t("Pages"),fullWidth:!0})}),Object(m.jsx)(Ot.a,{item:!0,xs:12,children:Object(m.jsx)(St,{select:!0,name:"action",label:t("Action"),fullWidth:!0,children:It.map((function(e){return Object(m.jsx)(vt.a,{value:e,children:t("RecognizedDocumentAction.".concat(e))},e)}))})})]})},Lt="(\\d+(\\s*-\\s*\\d+)?)",At="^\\s*".concat(Lt,"(\\s*,\\s*").concat(Lt,")*\\s*$"),Et=new RegExp(At),Rt=function(e){var t=e.open,n=e.document,r=e.availablePageIndices,i=e.onChange,o=e.onClose,u=Object(W.a)().t,s=Tt(),d=Re(),l=d.documentSchemas,b=d.fileInfos,f=Object(c.useMemo)((function(){var e,t=n?function(e,t){return e.map((function(e){var n=t[e.fileIndex];return"loaded"===n.status?n.pages[e.filePageNumber].pageIndex:-1}))}(n.pages,b):r;return{schemaId:null===n||void 0===n?void 0:n.schemaId,pages:ze(t),action:null!==(e=null===n||void 0===n?void 0:n.action)&&void 0!==e?e:"send"}}),[r,n,b]),j=Object(c.useRef)(),h=Object(c.useMemo)((function(){return function(e,t){return yt.a().shape({schemaId:yt.b().required().test({test:function(e){return!e||!("string"!==typeof e||!t.find((function(t){return t.$id===e})))||this.createError({path:this.path,message:it.a.t("UnknownDocumentSchema",{schemaId:e})})}}),pages:yt.b().test({test:function(t){if(!t)return!0;if("string"!==typeof t||!Et.test(t))return this.createError({path:this.path,message:it.a.t("InvalidPageRange",{range:t})});var n=De(t),a=Object(gt.a)(n,e);return!(a.length>0)||(a.sort(),this.createError({path:this.path,message:it.a.t("PagesAlreadyUsedInOtherDocuments",{pages:a.map((function(e){return e+1})).join(", ")})}))}}),action:yt.b().required().oneOf(Object(a.a)(It))})}(r,null!==l&&void 0!==l?l:[])}),[r,l]),v=Object(c.useCallback)((function(){var e=j.current;e&&function(e){e.validateForm().then((function(t){Object.keys(t).length>0?e.setTouched(wt(t)):e.handleSubmit()}))}(e)}),[]),O=Object(c.useCallback)(function(){var e=Object(E.a)(A.a.mark((function e(t,a){var r,c;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{r={schemaId:t.schemaId,pages:[],data:null===n||void 0===n?void 0:n.data,action:t.action},t.pages&&(c=De(t.pages),r.pages=Le(c,b)),null===i||void 0===i||i(r),null===o||void 0===o||o()}finally{a.setSubmitting(!1)}case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),[null===n||void 0===n?void 0:n.data,b,i,o]),p=Object(c.useCallback)((function(){null===o||void 0===o||o()}),[o]),g=Object(c.useCallback)(function(){var e=Object(E.a)(A.a.mark((function e(t,n){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"backdropClick"!==n&&(null===o||void 0===o||o());case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),[o]);return Object(m.jsxs)(lt.a,{open:t,onClose:g,maxWidth:"sm",fullWidth:!0,classes:{paper:s.dialogPaper},children:[Object(m.jsx)(jt.a,{children:u(n?"EditingDocument":"AddingDocument")}),Object(m.jsx)(ft.a,{className:s.dialogContent,children:Object(m.jsx)(kt.a,{children:Object(m.jsx)(xt.b,{innerRef:function(e){return j.current=e},initialValues:f,onSubmit:O,validationSchema:h,validateOnChange:!0,validateOnBlur:!0,children:Object(m.jsx)(xt.a,{autoComplete:"off",children:Object(m.jsx)(zt,{availablePageIndices:r})})})})}),Object(m.jsxs)(bt.a,{children:[Object(m.jsx)(mt.a,{onClick:v,color:"primary",children:u("Accept")}),Object(m.jsx)(mt.a,{onClick:p,color:"primary",children:u("Cancel")})]})]})},Bt=function(e){return Object(m.jsxs)(Ve.a,Object(b.a)(Object(b.a)({viewBox:"0 0 1000 1000"},e),{},{children:[Object(m.jsx)("path",{d:"M808.3 950h-725C42.9 950 10 917.1 10 876.7V171.6c0-40.4 32.9-73.3 73.3-73.3h502.1c18.6 0 33.6 15.1 33.6 33.6 0 18.6-15.1 33.6-33.6 33.6H83.3c-3.4 0-6.1 2.7-6.1 6.1v705.1c0 3.4 2.7 6.1 6.1 6.1h724.9c3.4 0 6.1-2.7 6.1-6.1V492c0-18.6 15-33.6 33.6-33.6s33.6 15.1 33.6 33.6v384.7c.1 40.4-32.8 73.3-73.2 73.3z"}),Object(m.jsx)("path",{d:"M307.3 781.2c-16.1 0-31.1-8.1-40.1-21.7-8.9-13.5-10.5-30.4-4.1-45.3l83.4-196.8 431-431C801 62.9 832.3 50 865.5 50s64.5 13 88 36.5c48.5 48.6 48.5 127.5 0 176.1l-431 431-196.3 83.8c-6 2.5-12.4 3.8-18.9 3.8zm96-225.5-59.8 141.1 140.8-60.1L906 215c22.3-22.3 22.3-58.7 0-81-10.8-10.8-25.2-16.8-40.5-16.8s-29.7 6-40.5 16.8L403.3 555.7z"}),Object(m.jsx)("path",{d:"M398.4 502.3 530 633.8l-47.5 47.5-131.6-131.5 47.5-47.5zM800.2 100.5 931.8 232l-47.5 47.5L752.7 148l47.5-47.5z"})]}))},Vt=Object(I.a)((function(e){return Object(C.a)({toolbar:{minHeight:"48px",paddingLeft:0,borderBottom:"solid 2px ".concat(e.palette.divider)},tree:{"& .rst__collapseButton":{backgroundColor:"dark"===e.palette.type?e.palette.background.paper:void 0,backgroundImage:"dark"===e.palette.type?"url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCI+PGNpcmNsZSBjeD0iOSIgY3k9IjkiIHI9IjgiIGZpbGw9Im5vbmUiLz48ZyBzdHJva2U9IiNGRkYiIHN0cm9rZS13aWR0aD0iMS45IiA+PHBhdGggZD0iTTQuNSA5aDkiLz48L2c+Cjwvc3ZnPg==)":void 0},"& .rst__expandButton":{backgroundColor:"dark"===e.palette.type?e.palette.background.paper:void 0,backgroundImage:"dark"===e.palette.type?"url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCI+PGNpcmNsZSBjeD0iOSIgY3k9IjkiIHI9IjgiIGZpbGw9Im5vbmUiLz48ZyBzdHJva2U9IiNGRkYiIHN0cm9rZS13aWR0aD0iMS45IiA+PHBhdGggZD0iTTQuNSA5aDkiLz48cGF0aCBkPSJNOSA0LjV2OSIvPjwvZz4KPC9zdmc+)":void 0},"& .rst__collapseButton:focus, & .rst__expandButton:focus":{boxShadow:"dark"===e.palette.type?"0 0 0 1px #000":void 0,outline:"initial"}},node:{"& .rst__rowContents":{cursor:"pointer",backgroundColor:e.palette.background.default},"& .rst__moveHandle":{backgroundColor:"dark"===e.palette.type?e.palette.background.paper:void 0}},selectedNode:{"& .rst__rowContents":{backgroundColor:e.palette.action.selected}},actionIcon:{marginLeft:5,verticalAlign:"bottom"},sendActionIcon:{marginLeft:5,color:st.a[500],verticalAlign:"bottom"},documentWithErrors:{textDecoration:"underline wavy ".concat(e.palette.error.main)}})})),Ft=function(e){return Object(N.isPresent)(e.documentIndex)&&!Object(N.isPresent)(e.pageIndex)},Ht=function(e){return!Object(N.isPresent)(e.documentIndex)&&!Object(N.isPresent)(e.pageIndex)},Ut=function(e){return Object(N.isPresent)(e.pageIndex)},Wt=function(e){var t=e.node;return Ut(t)?"p-".concat(t.pageIndex):Ft(t)?"d-".concat(t.documentIndex):"o"},_t=function(e){return!Ut(e)},Gt=function(e){return Ut(e.node)},Jt=function(e){var t=e.node,n=e.nextParent,a=t;return!!n&&(!!Object(N.isPresent)(a.documentIndex)||!Ht(n))},qt=function(){var e=Re(),t=e.documentSchemas,n=e.fileInfos,r=e.documentInfos,i=e.canModify,o=Object(c.useState)([]),u=Object(f.a)(o,2),s=u[0],d=u[1];return Object(c.useEffect)((function(){d((function(e){var c=i?function(e,t,n){var r,c=[],i=[],o=Object(M.a)(e);try{var u=function(){var e=r.value;if("loaded"!==e.status)return"continue";e.pages.forEach((function(t,n){var a="".concat(t.pageIndex+1," - ").concat(e.name);e.pages.length>1&&(a+=" / ".concat(n+1));var r=t.documentIndex,o={title:a,pageIndex:t.pageIndex,documentIndex:r};if(Object(N.isPresent)(r)&&Object(N.isPresent)(t.documentOrder)){var u=i[r];u||(i[r]=u=[]),u[t.documentOrder]=o}else c.push(o)}))};for(o.s();!(r=o.n()).done;)u()}catch(s){o.e(s)}finally{o.f()}return[].concat(Object(a.a)(i.map((function(e,a){var r=it.a.t("DocumentN",{index:a+1}),c=t[a].schemaId;if(c){var i=null===n||void 0===n?void 0:n.find((function(e){return e.$id===c}));if(i){var o=i.title;if(!o){var u=c.lastIndexOf("/");(o=c.substring(u+1)).toLocaleLowerCase().endsWith(".json")&&(o=o.substring(0,o.length-5))}r="".concat(a+1," - ").concat(o)}}return{documentIndex:a,title:r,action:t[a].action,errors:t[a].errors,children:null!==e&&void 0!==e?e:[]}}))),[{title:it.a.t("OrphanPages"),children:c}])}(n,r,t):function(e,t){return e.map((function(n,a){var r=it.a.t("DocumentN",{index:a+1}),c=e[a].schemaId;if(c){var i=null===t||void 0===t?void 0:t.find((function(e){return e.$id===c}));if(i){var o=i.title;if(!o){var u=c.lastIndexOf("/");(o=c.substring(u+1)).toLocaleLowerCase().endsWith(".json")&&(o=o.substring(0,o.length-5))}r="".concat(a+1," - ").concat(o)}}return{documentIndex:a,title:r,action:e[a].action,errors:e[a].errors,children:[]}}))}(r,t);if(e.length>0){for(var o=0;o<Math.min(c.length,e.length-1);o++)c[o].expanded=e[o].expanded;c[c.length-1].expanded=e[e.length-1].expanded}return c}))}),[i,r,t,n]),{treeData:s,setTreeData:d}},Zt=function(e){var t=e.node,n=Object(W.a)().t,a=Vt(),r="send"===t.action?Object(m.jsx)(at.a,{className:a.sendActionIcon}):"dontSend"===t.action?Object(m.jsx)(ct.a,{className:a.actionIcon,color:"error"}):Object(m.jsx)(Bt,{className:a.actionIcon});return Object(m.jsx)(q.a,{title:n("RecognizedDocumentAction.".concat(t.action)),children:Object(m.jsx)("span",{children:r})})},$t=function(e){var t=e.node,n=e.canModify,a=Vt(),r="send"===t.action&&t.errors.length>0&&n?a.documentWithErrors:void 0;return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)("span",{className:r,children:t.title}),Object(m.jsx)(Zt,{node:t})]})},Yt=function(e){var t=e.description,n=e.onClick,a=e.icon;return Object(m.jsx)(q.a,{title:t,children:Object(m.jsx)(Ze.a,{size:"small",onClick:n,children:a})})},Kt=function(e){var t=e.node,n=e.unusedPageIndices,r=Object(W.a)().t,i=Object(c.useState)(),o=Object(f.a)(i,2),u=o[0],s=o[1],d=Re(),l=d.updateDocument,b=d.getDocument,j=d.fileInfos,h=Object(c.useMemo)((function(){var e=n;if(Object(N.isPresent)(u)){var t=b(u).pages.map((function(e){var t=j[e.fileIndex];if("loaded"===t.status)return t.pages[e.filePageNumber].pageIndex})).filter(N.isPresent);t.push.apply(t,Object(a.a)(e)),e=t.sort()}return e}),[u,j,b,n]),v=Object(c.useCallback)((function(e,t){s(t)}),[]),O=Object(c.useCallback)((function(e){b(u).schemaId!==e.schemaId&&(e.data={}),l(u,e)}),[u,b,l]);return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(Yt,{description:r("Edit"),icon:Object(m.jsx)(tt.a,{}),onClick:function(e){return v(e,t.documentIndex)}}),Object(N.isPresent)(u)&&Object(m.jsx)(Rt,{open:Object(N.isPresent)(u),document:b(u),availablePageIndices:h,onChange:O,onClose:function(){return s(void 0)}})]})},Qt=function(e){var t=e.node,n=Object(W.a)().t,a=Object(dt.c)(),r=Re().deleteDocument,i=Object(c.useCallback)(function(){var e=Object(E.a)(A.a.mark((function e(t,c,i){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.stopPropagation(),e.next=3,a({description:n("ConfirmDeleteBatchDocument",{name:i})});case 3:if(e.sent){e.next=6;break}return e.abrupt("return");case 6:r(c);case 7:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),[a,r,n]);return Object(m.jsx)(Yt,{description:n("Delete"),icon:Object(m.jsx)(Ke.a,{}),onClick:function(e){return i(e,t.documentIndex,t.title)}})},Xt=function(e){var t=e.unusedPageIndices,n=Object(W.a)().t,a=Object(c.useState)(!1),r=Object(f.a)(a,2),i=r[0],o=r[1],u=Re(),s=u.setCurrentDocumentLocation,d=u.addDocument,l=Object(c.useCallback)((function(){o(!0)}),[]),b=Object(c.useCallback)((function(e){e.data={};var t=d(e);s({documentIndex:t})}),[d,s]);return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(q.a,{title:n("AddDocument"),children:Object(m.jsx)(Ze.a,{onClick:l,children:Object(m.jsx)(Xe.a,{})})}),i&&Object(m.jsx)(Rt,{open:i,availablePageIndices:t,onChange:b,onClose:function(){return o(!1)}})]})},en=function(e){var t=Vt(),n=Re(),a=n.fileInfos,r=n.loadingImages,i=n.movePage,o=n.currentDocumentLocation,u=n.setCurrentDocumentLocation,s=n.canModify,d=qt(),b=d.treeData,f=d.setTreeData,j=Object(c.useMemo)((function(){return a.flatMap((function(e){return"loaded"!==e.status?[]:e.pages.filter((function(e){return!Object(N.isPresent)(e.documentOrder)})).map((function(e){return e.pageIndex}))}))}),[a]),h=Object(c.useCallback)((function(e){!function(e){var t=e[e.length-1],n=t.children;Ht(t)&&Array.isArray(n)&&n.sort(Object(X.a)((function(e,t){return e.pageIndex<t.pageIndex})))}(e),f(e)}),[f]),v=Object(c.useCallback)((function(e){var t=e.node,n=e.nextParentNode,a=e.prevTreeIndex,r=e.nextTreeIndex;if(n&&a!==r){var c=t,o=n;if(!Ht(o)||Object(N.isPresent)(c.documentIndex))if(Ft(o)){var u=o.documentIndex,s=o.children.findIndex((function(e){return e.pageIndex===c.pageIndex}));i(c.pageIndex,{documentIndex:u,documentOrder:s})}else Ht(o)&&i(c.pageIndex)}}),[i]),O=Object(c.useCallback)((function(e,t){var n,a,r=e.target;if(!0!==(null===(n=r.classList)||void 0===n?void 0:n.contains("rst__collapseButton"))&&!0!==(null===(a=r.classList)||void 0===a?void 0:a.contains("rst__expandButton"))){var c=t;u({documentIndex:c.documentIndex,pageIndex:c.pageIndex})}}),[u]),p=Object(c.useCallback)((function(e){var n=e.node,a=o&&n.documentIndex===o.documentIndex&&n.pageIndex===o.pageIndex,r={onClick:function(t){return O(t,e.node)},className:Object(G.default)(t.node,Object(l.a)({},t.selectedNode,a))};if(Ft(n)){if(s){var c=Object(m.jsx)(Kt,{node:n,unusedPageIndices:j}),i=Object(m.jsx)(Qt,{node:n});r.buttons=[c,i]}r.title=function(){return Object(m.jsx)($t,{node:n,canModify:s})}}return r}),[s,t.node,t.selectedNode,o,O,j]);return r?null:Object(m.jsxs)(m.Fragment,{children:[s&&Object(m.jsx)($e.a,{className:t.toolbar,children:Object(m.jsx)(Xt,{unusedPageIndices:j})}),Object(m.jsx)(ot.a,{treeData:b,onChange:h,onMoveNode:v,getNodeKey:Wt,canDrag:Gt,canDrop:Jt,canNodeHaveChildren:_t,isVirtualized:!1,generateNodeProps:p,className:t.tree})]})},tn=n(914),nn=n(2410),an=n(917),rn=n(328),cn=n(38),on=Object(I.a)((function(e){return Object(C.a)({image:{marginTop:e.spacing(2),width:"max-content",maxWidth:"100%"},imagePlaceholder:{marginTop:e.spacing(6),height:50}})})),un=Object(d.withJsonFormsControlProps)((function(e){var t=e.uischema,n=e.config,a=e.id,r=e.data,c=e.visible,i=e.errors,u=e.label,d=e.required,l=e.description,b=on(),f=0===i.length,j=Object(rn.merge)({},n,t.options),h=!Object(s.isDescriptionHidden)(c,null!==l&&void 0!==l?l:"",!1,j.showUnfocusedDescription),v=Re().getDisplayableDataUrl,O=h?l:f?null:i,p=h&&!f?i:null;return Object(m.jsx)(o.a,{xsUp:!c,children:Object(m.jsxs)(tn.a,{fullWidth:!j.trim,id:a,children:[Object(m.jsx)(nn.a,{htmlFor:a+"-input",error:!f,shrink:"string"===typeof r,children:Object(s.computeLabel)(Object(s.isPlainLabel)(u)?u:u.default,!!d,j.hideRequiredAsterisk)}),Object(m.jsxs)("div",{children:["string"===typeof r&&Object(m.jsx)("img",{src:v(r),alt:"",className:b.image}),"string"!==typeof r&&Object(m.jsx)("img",{src:"".concat(Object(cn.a)(),"images/image-placeholder.png"),alt:"placeholder",className:b.imagePlaceholder})]}),Object(m.jsx)(an.a,{error:!f&&!h,children:O}),Object(m.jsx)(an.a,{error:!f,children:p})]})})})),sn=Object(s.rankWith)(4,Object(s.and)(s.isControl,(function(e,t){var n=s.Resolve.schema(t,e.scope);return n&&"string"===n.type&&"image"===n.format}))),dn=n(660),ln=n(99),bn=n.n(ln),fn=n(133),jn=n(913),mn=n(931),hn=n(439),vn=n.n(hn),On=(Ct=jn.a,Object(dn.a)((function(e){return Object(m.jsx)(Ct,Object(b.a)({},e))}))),pn=i.a.memo((function(e){var t,n,a,r,i=Object(c.useState)(!1),o=Object(f.a)(i,2),u=o[0],s=o[1],d=e.data,l=e.config,b=e.className,j=e.id,h=e.enabled,v=e.uischema,O=e.isValid,p=e.path,g=e.handleChange,x=e.schema,y=e.muiInputProps,I=x.maxLength,C=bn()({},l,v.options);r=C.restrict?{maxLength:I}:{};var k=Object(c.useMemo)((function(){return x.patternMask}),[x]);r=bn()(r,y),C.trim&&void 0!==I&&(r.size=I);var w=Object(fn.a)(),P=(null===(t=w.jsonforms)||void 0===t||null===(n=t.input)||void 0===n||null===(a=n.delete)||void 0===a?void 0:a.background)||w.palette.background.default,S=Object(c.useCallback)((function(e){g(p,e)}),[g,p]);return Object(m.jsx)(On,{mask:k,onAccept:S,type:"text",className:b,id:j,value:d,disabled:!h,autoFocus:C.focus,multiline:C.multi,fullWidth:!C.trim||void 0===I,inputProps:r,error:!O,onPointerEnter:function(){return s(!0)},onPointerLeave:function(){return s(!1)},endAdornment:Object(m.jsx)(mn.a,{position:"end",style:{display:u&&h&&void 0!==d?"flex":"none",position:"absolute",right:0},children:Object(m.jsx)(Ze.a,{"aria-label":"Clear input field",onClick:function(){return g(p,void 0)},children:Object(m.jsx)(vn.a,{style:{background:P,borderRadius:"50%"}})})})})}),d.areEqual),gn=Object(d.withJsonFormsControlProps)((function(e){return Object(m.jsx)(r.MaterialInputControl,Object(b.a)(Object(b.a)({},e),{},{input:pn}))})),xn=Object(s.rankWith)(4,Object(s.and)(s.isControl,(function(e,t){var n=s.Resolve.schema(t,e.scope);return n&&"string"===n.type&&"string"===typeof n.patternMask}))),yn=Object(I.a)((function(e){return Object(C.a)({content:{display:"grid",gridTemplateColumns:"auto",gridTemplateRows:"auto",rowGap:"5px",height:"100%",overflowY:"hidden"},editorPane:{gridRow:"1 / 2",gridColumn:"1 / 2",overflow:"auto"},listPane:{gridRow:"2 / 3",gridColumn:"1 / 2",overflow:"auto",borderTop:"solid 2px ".concat(e.palette.divider),paddingTop:10},listPaneHeader:{display:"flex",flexDirection:"row",placeItems:"center"},list:{display:"flex",flexDirection:"row",padding:0},listItem:{width:"inherit",marginTop:10,marginLeft:10,marginRight:10,border:"solid 2px ".concat(e.palette.divider),height:125},imageItem:{},image:{maxWidth:300,maxHeight:100},grow:{flexGrow:1}})})),In=function(e){var t,n=Re(),r=n.documentSchemas,i=n.currentDocumentEditionState,o=n.setCurrentDocumentEditionState,u=n.canModify,s=yn(),l=Object(c.useRef)(null===i||void 0===i?void 0:i.document.data),f=Object(c.useRef)(!1);Object(c.useMemo)((function(){l.current=null===i||void 0===i?void 0:i.document.data}),[null===i||void 0===i?void 0:i.document.data]);var j=Object(c.useMemo)((function(){return[].concat(Object(a.a)(Ca),[{tester:sn,renderer:un},{tester:xn,renderer:gn}])}),[]),h=Object(c.useCallback)((function(e){f.current=!!e.errors&&e.errors.length>0;var t=f.current?Object(Ie.a)(e.errors.map((function(e){return Object(b.a)(Object(b.a)({},e),{},{instancePath:e.dataPath})}))):void 0;f.current||l.current===e.data||(l.current=e.data,f.current=!1),o((function(n){var a,r;return Object(_.a)(e.data,null===n||void 0===n?void 0:n.document)&&Object(_.a)(t,null===n||void 0===n?void 0:n.errors)?n:{document:Object(b.a)(Object(b.a)({},n.document),{},{data:null!==(a=e.data)&&void 0!==a?a:null===n||void 0===n||null===(r=n.document)||void 0===r?void 0:r.data}),errors:t}}))}),[o]);if(!(null===i||void 0===i?void 0:i.document))return null;var v=null===r||void 0===r?void 0:r.find((function(e){return e.$id===(null===i||void 0===i?void 0:i.document.schemaId)}));return Object(m.jsx)("div",{className:s.content,children:Object(m.jsx)("div",{className:s.editorPane,children:Object(m.jsx)(d.JsonForms,{data:null!==(t=null===i||void 0===i?void 0:i.document.data)&&void 0!==t?t:{},schema:v,onChange:h,renderers:j,cells:ka,ajv:ke,readonly:!u||"dontSend"===(null===i||void 0===i?void 0:i.document.action)})})})},Cn=n(2415),kn=n(607),wn=n.n(kn),Pn=n(2478),Sn=n(608),Mn=n.n(Sn),Nn=n(609),Dn=n.n(Nn),Tn=n(2471),zn=n(610),Ln=n.n(zn),An=n(1956),En=[n(332)],Rn=Object(An.a)((function(e){return e[0]}),Object(Tn.a)((function(e){return e.$id}),En)),Bn={resolve:{nimflow:{order:1,canRead:function(e){return!!Rn[e.url]},read:function(e){return Object(j.a)(["$id"],Rn[e.url])}}}},Vn=function(e){return Ln.a.dereference(e,Bn)},Fn=Object(I.a)((function(e){return Object(C.a)({dialogPaper:{height:"90vh"},dialogContent:{display:"grid",gridTemplateColumns:"auto ".concat(400,"px"),gridTemplateRows:"auto",rowGap:"5px",height:"100%",overflowY:"hidden"},imagePane:{gridRow:"1 / 2",gridColumn:"1 / 2",overflow:"auto"},listPane:{gridRow:"1 / 2",gridColumn:"2 / 3",overflow:"auto",borderLeft:"solid 2px ".concat(e.palette.divider),paddingLeft:10},cropper:{height:"100%",width:"100%"},cropperDisabled:{"& .cropper-crop-box":{display:"none"},"& .cropper-drag-box":{opacity:0}},imageItem:{width:"100%",position:"relative"},imageTitle:{textDecoration:"underline"},image:{maxWidth:"100%",marginTop:10,marginBottom:10},imagePlaceholder:{marginTop:10,height:50},imageActions:{marginLeft:-10},deleteButton:{},grow:{flexGrow:1},degreesEdit:{marginLeft:20,width:"5em"}})})),Hn=function(e){var t=null===e||void 0===e?void 0:e.current;return null===t||void 0===t?void 0:t.cropper},Un=function e(t,n,r,c,i,o){if("string"!==n.type||"image"!==n.format){if(!(o.includes(t)||"array"!==n.type&&"object"!==n.type))if("array"===n.type&&Array.isArray(t)&&"object"===typeof n.items){var u;if(Array.isArray(n.items)){var s=n.items.filter(V.b);if(1!==s.length)return;u=s[0]}else u=n.items;o.push(t);for(var d=0;d<t.length;d++)try{c.push(d),i.push(d.toString()),e(t[d],u,r,c,i,o)}finally{c.pop(),i.pop()}}else if("object"===n.type&&(Object(V.b)(t)||!Object(N.isPresent)(t))){if(t){o.push(t);for(var l=0,b=Object.entries(t);l<b.length;l++){var j,m,h=Object(f.a)(b[l],2),v=h[0],O=h[1],p=null!==(j=null===(m=n.properties)||void 0===m?void 0:m[v])&&void 0!==j?j:n.additionalProperties;if("object"===typeof p)try{var g;c.push(v),i.push(null!==(g=p.title)&&void 0!==g?g:v),e(O,p,r,c,i,o)}finally{c.pop(),i.pop()}}}if(n.properties)for(var x=0,y=Object.entries(n.properties);x<y.length;x++){var I=Object(f.a)(y[x],2),C=I[0],k=I[1];if("object"===typeof k&&(!t||!(C in t)))try{var w;c.push(C),i.push(null!==(w=k.title)&&void 0!==w?w:C),e(void 0,k,r,c,i,o)}finally{c.pop(),i.pop()}}}}else{var P=c.map((function(e){return e.toString()})).join(".");if(-1===r.findIndex((function(e){return e.id===P}))){var S=i.join(" -> ");r.push({id:P,path:Object(a.a)(c),title:S,value:t,originalValue:t})}}},Wn=function(e,t){var n=[];return Un(e,t,n,[],[],[]),n},_n=function(e,t){Object(N.isPresent)(t.value)&&!e&&(e={});for(var n=e,a=0;a<t.path.length-1;a++){var r=t.path[a],c=n[r];if(!n){if(!t.value)return e;n[r]=c={}}n=c}if(Object(N.isPresent)(n)){var i=t.path[t.path.length-1];Object(N.isPresent)(t.value)?n[i]=t.value:delete n[i]}return e},Gn=function(e){var t=e.open,n=e.pageIndex,r=e.onClose,i=e.outputImageFormat,o=Re(),u=o.findByPageIndex,s=o.getDisplayableDataUrl,d=Object(W.a)().t,l=Fn(),j=Object(c.useState)(180),h=Object(f.a)(j,2),v=h[0],O=h[1],p=Object(c.useRef)(null),g=Object(c.useState)(!1),x=Object(f.a)(g,2),y=x[0],I=x[1],C=function(){var e=Re(),t=e.documentSchemas,n=e.currentDocumentEditionState,r=e.setCurrentDocumentEditionState,i=Object(c.useState)([]),o=Object(f.a)(i,2),u=o[0],s=o[1];Object(R.a)(["documentSchema/".concat(null===n||void 0===n?void 0:n.document.schemaId),document],Object(E.a)(A.a.mark((function e(){var a,r,c,i,o;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=null===n||void 0===n?void 0:n.document.schemaId,r=null===t||void 0===t?void 0:t.find((function(e){return e.$id===a}))){e.next=4;break}return e.abrupt("return",void 0);case 4:return e.next=6,Vn(r);case 6:return c=e.sent,i=wn()(c,{ignoreAdditionalProperties:!0}),o=Wn(null===n||void 0===n?void 0:n.document.data,i),s(o),e.abrupt("return",i);case 11:case"end":return e.stop()}}),e)}))),{revalidateOnFocus:!1});var d=Object(c.useCallback)((function(e,t){s((function(n){var r=Object(a.a)(n);return r[t]=Object(b.a)(Object(b.a)({},n[t]),{},{value:e}),r}))}),[s]),l=Object(c.useCallback)((function(e){s((function(t){var n,r=Object(a.a)(t);return null===(n=r[e])||void 0===n||delete n.value,r}))}),[s]),j=Object(c.useCallback)((function(){var e=u.filter((function(e){return e.originalValue!==e.value}));r((function(t){if(e.length>0&&t.document){var n=Object(ne.a)(t.document.data,(function(t){var n,a=Object(M.a)(e);try{for(a.s();!(n=a.n()).done;){var r=n.value;if(0===r.path.length)return r.value;t=_n(t,r)}}catch(c){a.e(c)}finally{a.f()}return t})),a=Object(b.a)(Object(b.a)({},t.document),{},{data:n});return Object(b.a)(Object(b.a)({},t),{},{document:a})}}))}),[u,r]);return{imageFields:u,setImageAt:d,deleteImageAt:l,applyImagesToDocument:j}}(),k=C.imageFields,w=C.setImageAt,P=C.deleteImageAt,S=C.applyImagesToDocument,N=Object(c.useMemo)((function(){return u(n)}),[u,n]),D=Object(c.useCallback)((function(){var e=Hn(p);e&&e.clear(),I(!1)}),[]),T=Object(c.useCallback)((function(){S(),null===r||void 0===r||r()}),[S,r]),z=Object(c.useCallback)((function(){null===r||void 0===r||r()}),[r]),L=Object(c.useCallback)((function(e,t){"backdropClick"!==t&&(null===r||void 0===r||r())}),[r]),B=Object(c.useCallback)((function(e){y&&"Escape"===e.key&&(e.preventDefault(),e.stopPropagation(),D())}),[y,D]),V=Object(c.useCallback)((function(e){var t=Hn(p);if(t){var n=function(e,t){if("image/tiff"===t){var n=e.getContext("2d").getImageData(0,0,e.width,e.height),a=new Uint8Array(n.data.buffer),r=Dn.a.encodeImage(a,n.width,n.height);return we(r,"image/tiff")}return e.toDataURL()}(t.getCroppedCanvas(),i);D(),w(n,e)}}),[D,i,w]);Object(c.useEffect)((function(){var e=void 0;return N&&setTimeout((function(){var t=p.current;if(t){var n=t.getContext("2d");n&&He(N.getImageData()).then((function(a){n.putImageData(a,0,0),(e=new Mn.a(t,{dragMode:"crop",initialAspectRatio:Number.NaN,guides:!1,crop:function(){var t,n=null===(t=e)||void 0===t?void 0:t.getCropBoxData();n&&!Object(Pn.a)(n)&&I(!0)},viewMode:1,autoCrop:!1})).clear()}))}}),0),function(){var t;null===(t=e)||void 0===t||t.destroy()}}),[N]);var F=Object(c.useCallback)((function(e){var t=parseInt(e.target.value);isNaN(t)||O(t)}),[]),H=Object(c.useCallback)((function(){var e=Hn(p);e&&!isNaN(v)&&e.rotate(v)}),[v]);return Object(m.jsxs)(lt.a,{open:t,onClose:L,maxWidth:"lg",fullWidth:!0,classes:{paper:l.dialogPaper},onKeyDown:B,children:[Object(m.jsx)(jt.a,{children:d("ExtractingImages")}),Object(m.jsxs)(ft.a,{className:l.dialogContent,children:[Object(m.jsx)("div",{className:l.imagePane,children:!!N&&Object(m.jsx)("canvas",{ref:p,width:N.width,height:N.height,style:{visibility:"hidden"}})}),Object(m.jsx)("div",{className:l.listPane,children:Object(m.jsx)(Cn.a,{children:k.map((function(e,t){return Object(m.jsx)(J.a,{children:Object(m.jsxs)("div",{className:l.imageItem,children:[Object(m.jsx)(Z.a,{variant:"subtitle1",className:l.imageTitle,children:e.title}),e.value&&Object(m.jsx)("img",{src:s(e.value),alt:"",className:l.image}),!e.value&&Object(m.jsx)("img",{src:"".concat(Object(cn.a)(),"images/image-placeholder.png"),alt:"placeholder",className:l.imagePlaceholder}),Object(m.jsxs)("div",{className:l.imageActions,children:[Object(m.jsx)(q.a,{title:d("CaptureCurrentSelection"),children:Object(m.jsx)("span",{children:Object(m.jsx)(Ze.a,{onClick:function(){return V(t)},disabled:!y,children:Object(m.jsx)(Fe,{})})})}),Object(m.jsx)(q.a,{title:d("Delete"),children:Object(m.jsx)(Ze.a,{onClick:function(){return P(t)},children:Object(m.jsx)(Ke.a,{})})})]})]})},t)}))})})]}),Object(m.jsxs)(bt.a,{children:[Object(m.jsx)(ht.a,{type:"number",value:v,onChange:F,className:l.degreesEdit}),Object(m.jsx)(mt.a,{onClick:H,color:"primary",children:d("Rotate")}),Object(m.jsx)("div",{className:l.grow}),Object(m.jsx)(mt.a,{onClick:T,color:"primary",children:d("Accept")}),Object(m.jsx)(mt.a,{onClick:z,color:"primary",children:d("Cancel")})]})]})},Jn=Object(I.a)((function(e){return Object(C.a)({content:{height:"75vh",minWidth:900,display:"flex",flexDirection:"row"},treePane:{flexGrow:1,overflow:"auto",width:function(e){return e.canModify?"25%":"40%"}},imageListPane:{flexGrow:1,width:"41%",overflowY:"auto",borderLeft:"2px solid ".concat(e.palette.divider),paddingLeft:10},editorPane:{width:function(e){return e.canModify?"33%":"59%"},flexGrow:1,overflow:"auto",borderLeft:"2px solid ".concat(e.palette.divider),paddingLeft:10}})})),qn=function(e){var t=e.outputImageFormat,n=Object(W.a)().t,a=Re(),r=a.loadingImages,i=a.documentSchemas,o=a.canModify,u=Jn({canModify:o}),s=Object(c.useState)(),d=Object(f.a)(s,2),l=d[0],b=d[1],j=Object(c.useCallback)((function(e){b(e)}),[]),h=Object(c.useCallback)((function(){b(void 0)}),[]);return i?r?Object(m.jsx)(Be.b,{children:n("LoadingImages")}):Object(m.jsxs)("div",{className:u.content,children:[Object(m.jsx)("div",{className:u.treePane,children:Object(m.jsx)(en,{})}),o&&Object(m.jsx)("div",{className:u.imageListPane,children:Object(m.jsx)(qe,{onImageExtractionRequested:j})}),Object(m.jsx)("div",{className:u.editorPane,children:Object(m.jsx)(In,{})}),Object(N.isPresent)(l)&&Object(m.jsx)(Gn,{open:Object(N.isPresent)(l),pageIndex:l,onClose:h,outputImageFormat:t})]}):null},Zn=function(e){var t,n=Object(d.useJsonForms)(),r=Object(s.mapStateToControlProps)({jsonforms:Object(b.a)({},n)},e),i=r.data,u=r.path,l=r.visible,f=r.uischema,j=null===i||void 0===i?void 0:i.documents,h=Object(c.useMemo)((function(){return j?function(e){if(!Array.isArray(e))return[];for(var t=e,n=0;n<t.length;n++){var r=t[n];if(!Object(N.isPresent)(r.data)||!r.action){var c,i,o=Object(b.a)(Object(b.a)({},r),{},{data:null!==(c=r.data)&&void 0!==c?c:{},action:null!==(i=r.action)&&void 0!==i?i:"send"});t===e&&(t=Object(a.a)(e)),t[n]=o}}return t}(j):[]}),[j]);if(Object(c.useEffect)((function(){var e;h===j||Object(_.a)(h,j)||(null===(e=n.dispatch)||void 0===e||e.call(n,Object(s.update)(Object(U.compose)(u,"documents"),(function(){return h}))))}),[n,j,h,u]),h!==j&&!Object(_.a)(h,j))return null;if("ImageBatchRecognition"!==f.type)return null;var v=f;return Object(m.jsx)(o.a,{xsUp:!l,children:Object(m.jsx)(kt.a,{children:Object(m.jsx)(Ee,{basePath:u,batch:i,documentSchemasSource:v.documentSchemasSource,readonly:null!==(t=v.readonly)&&void 0!==t&&t,children:Object(m.jsx)(qn,{outputImageFormat:v.outputImageFormat})})})})},$n=Object(s.rankWith)(3,Object(s.uiTypeIs)("ImageBatchRecognition")),Yn=n(4),Kn=n(6),Qn=n(10),Xn=n(11),ea=n(225),ta=n.n(ea),na=n(226),aa=n.n(na),ra=n(227),ca=n.n(ra),ia=n(719),oa=n(1385),ua=n(2454),sa=function(e){Object(Qn.a)(n,e);var t=Object(Xn.a)(n);function n(){return Object(Yn.a)(this,n),t.apply(this,arguments)}return Object(Kn.a)(n,[{key:"render",value:function(){var e=this.props,t=e.description,n=e.id,a=e.errors,r=e.label,c=e.uischema,i=e.visible,u=e.enabled,d=e.required,l=e.path,b=e.handleChange,f=e.data,j=e.config,h=r,v=0===a.length,O=bn()({},j,c.options),p=!Object(s.isDescriptionHidden)(i,null!==t&&void 0!==t?t:"",this.state.isFocused,O.showUnfocusedDescription),g=Object(s.isPlainLabel)(r)?r:h;return Object(m.jsx)(o.a,{xsUp:!i,children:Object(m.jsx)(ia.b,{id:n+"-input",label:Object(s.computeLabel)(g,null!==d&&void 0!==d&&d,O.hideRequiredAsterisk),error:!v,fullWidth:!O.trim,helperText:v?p?t:" ":a,InputLabelProps:{shrink:!0},value:f?Object(oa.default)(f):null,onChange:function(e){return b(l,e&&!isNaN(e.valueOf())?Object(ua.a)(e,{representation:"date"}):"")},format:it.a.t("DATE_FORMAT"),clearable:!0,disabled:!u,autoFocus:O.focus,onFocus:this.onFocus,onBlur:this.onBlur,okLabel:it.a.t("OK"),cancelLabel:it.a.t("Cancel"),clearLabel:it.a.t("Clear"),leftArrowIcon:Object(m.jsx)(ta.a,{}),rightArrowIcon:Object(m.jsx)(aa.a,{}),keyboardIcon:Object(m.jsx)(ca.a,{}),InputProps:{}})})}}]),n}(d.Control),da=Object(s.rankWith)(10,s.isDateControl),la=Object(d.withJsonFormsControlProps)(sa),ba=n(374),fa=n.n(ba),ja=n(440),ma=n.n(ja),ha=n(722),va=function(e){Object(Qn.a)(n,e);var t=Object(Xn.a)(n);function n(){return Object(Yn.a)(this,n),t.apply(this,arguments)}return Object(Kn.a)(n,[{key:"render",value:function(){var e=this.props,t=e.id,n=e.description,a=e.errors,r=e.label,c=e.uischema,i=e.visible,u=e.enabled,d=e.required,l=e.path,b=e.handleChange,f=e.data,j=e.config,h=bn()({},j,c.options),v=0===a.length;return Object(m.jsx)(o.a,{xsUp:!i,children:Object(m.jsx)(ha.b,{id:t+"-input",label:Object(s.computeLabel)(Object(s.isPlainLabel)(r)?r:r.default,null!==d&&void 0!==d&&d,h.hideRequiredAsterisk),error:!v,fullWidth:!h.trim,onFocus:this.onFocus,onBlur:this.onBlur,helperText:v?n:a,InputLabelProps:{shrink:!0},value:f||null,onChange:function(e){return b(l,e&&!isNaN(e.valueOf())?e.toISOString():"")},format:it.a.t("DATETIME_FORMAT"),clearable:!0,disabled:!u,autoFocus:h.focus,okLabel:it.a.t("OK"),cancelLabel:it.a.t("Cancel"),clearLabel:it.a.t("Clear"),leftArrowIcon:Object(m.jsx)(ta.a,{}),rightArrowIcon:Object(m.jsx)(aa.a,{}),dateRangeIcon:Object(m.jsx)(fa.a,{}),keyboardIcon:Object(m.jsx)(ca.a,{}),timeIcon:Object(m.jsx)(ma.a,{}),InputProps:{}})})}}]),n}(d.Control),Oa=Object(s.rankWith)(10,s.isDateTimeControl),pa=Object(d.withJsonFormsControlProps)(va),ga=n(2473),xa=n(2417),ya=["context","bindContext","uiSchemaLibrary","schema","onChange"],Ia=function(e){var t=e.context,n=e.bindContext,r=e.uiSchemaLibrary,i=e.schema,o=e.onChange,u=Object(S.a)(e,ya),s=function(e){var t=Object(ga.a)(Object(E.a)(A.a.mark((function t(){var n;return A.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=2;break}return t.abrupt("return",void 0);case 2:return t.next=4,Vn(e);case 4:return n=t.sent,t.abrupt("return",n);case 6:case"end":return t.stop()}}),t)}))),[e]);return{resolvedSchema:t.value,loading:t.loading,error:t.error}}(i),l=s.resolvedSchema,j=s.loading,h=s.error,v=Object(c.useState)(),p=Object(f.a)(v,2),g=p[0],x=p[1],y=Object(c.useState)([]),I=Object(f.a)(y,2),C=I[0],k=I[1],w=Object(c.useState)(),P=Object(f.a)(w,2),M=P[0],N=P[1],D=Object(c.useCallback)((function(e){x(e)}),[]),T=Object(c.useCallback)((function(e){k(e)}),[]);if(Object(c.useEffect)((function(){if(g||0!==C.length){var e=function(e,t){var n={data:void 0};return t.length>0||(null===e||void 0===e?void 0:e.errors)&&e.errors.length>0?(n.errors=n.errors?[].concat(Object(a.a)(n.errors),Object(a.a)(t)):t,n.errors=Object(xa.a)([Object(X.a)((function(e,t){var n,a;return e.dataPath<t.dataPath||e.dataPath===t.dataPath&&(null!==(n=e.message)&&void 0!==n?n:"")<(null!==(a=t.message)&&void 0!==a?a:"")}))],n.errors)):n.data=null===e||void 0===e?void 0:e.data,n}(g,C);N((function(t){return Object(_.a)(t,e)?t:e}))}}),[C,g]),Object(c.useEffect)((function(){M&&(null===o||void 0===o||o(M))}),[M,o]),j)return Object(m.jsx)(Be.a,{});if(h)throw h;return Object(m.jsx)(O,{context:t,bindContext:n,uiSchemaLibrary:r,onErrorsChange:T,children:Object(m.jsx)(d.JsonForms,Object(b.a)({renderers:Ca,cells:ka,schema:l,onChange:D},u))})},Ca=[].concat(Object(a.a)(r.materialRenderers),[{tester:y,renderer:x},{tester:P,renderer:w},{tester:z,renderer:T},{tester:H,renderer:F},{tester:$n,renderer:Zn},{tester:da,renderer:la},{tester:Oa,renderer:pa}]),ka=r.materialCells},447:function(e,t){},566:function(e,t){},568:function(e,t){},569:function(e,t){},582:function(e,t){},583:function(e,t){},586:function(e,t){},587:function(e,t){},588:function(e,t){},589:function(e,t){},590:function(e,t){},592:function(e,t){},594:function(e,t){},595:function(e,t){},596:function(e,t){},597:function(e,t){},598:function(e,t){},612:function(e,t){}}]);
//# sourceMappingURL=14.411002a1.chunk.js.map