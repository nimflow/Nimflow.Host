(this["webpackJsonpnimflow-portal"]=this["webpackJsonpnimflow-portal"]||[]).push([[14],{116:function(e,t,n){"use strict";n.d(t,"i",(function(){return u})),n.d(t,"h",(function(){return s})),n.d(t,"g",(function(){return l})),n.d(t,"d",(function(){return d})),n.d(t,"c",(function(){return b})),n.d(t,"f",(function(){return j})),n.d(t,"a",(function(){return O})),n.d(t,"b",(function(){return g})),n.d(t,"e",(function(){return y}));var a=n(15),r=n(2496),c=(n(2382),n(2450),n(250),n(81),["MilestoneReached","MilestoneCleared"]),o=["TaskCreated","TaskUpdated","TaskArchived","ResponseSent"],i=["ActionDispatched","ContextsRecalculationCompleted","ContextRecalculationError"].concat(o,c);["RequestProcessed"].concat(Object(a.a)(i),["CustomEvent"]);function u(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.settings;return!n&&t&&(e.settings=n={}),n}function s(e){var t,n=null===(t=u(e))||void 0===t?void 0:t.commandText;return Object(r.a)(n)?e.name:n}function l(e){var t,n=null===(t=u(e))||void 0===t?void 0:t.actionInProgressText;return n||e.name}var d={id:"string",typeName:"string",reference:"string",state:"record",dateCreated:"dateTime",dateModified:"dateTime",version:"string",contextTypeVersion:"number",milestones:"array",tags:"array",metrics:"array"},b={id:"string",contextId:"string",contextTypeName:"string",contextReference:"string",typeName:"string",title:"string",data:"record",labels:"array",dateCreated:"dateTime",dateUpdated:"dateTime",assignedTo:"string",status:"string",archived:"boolean",dueDate:"string",importance:"number",focused:"boolean"},j={event:"string",timestamp:"dateTime",requestTypeName:"string",contextTypeName:"string",sentBy:"string",reference:"string",subject:"string",contextIsNew:"boolean",action:"string",message:"string",dueDate:"dateTime",taskTypeName:"string",assignedTo:"string",importance:"number",responseTypeName:"string",oldImportance:"number",oldLabels:"array",oldDueDate:"dateTime",oldAssignedTo:"string",milestoneName:"string",value:"dateTime",tags:"array",metrics:"array"},f=function(e){var t=["string","number","boolean","dateTime"];return Object.keys(e).filter((function(n){return t.includes(e[n])})).sort()},v=function(e){return Object.keys(e).filter((function(t){return"array"===e[t]})).sort()},h=function(e){return Object.keys(e).filter((function(t){return"record"===e[t]})).sort()},O=f(d),m=v(d),p=h(d),g=([].concat(Object(a.a)(O),Object(a.a)(m),Object(a.a)(p)),f(b)),x=(v(b),h(b)),y=([].concat(Object(a.a)(g),Object(a.a)(x)),f(j)),I=v(j);[].concat(Object(a.a)(y),Object(a.a)(I))},122:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(2),r=n(33),c=n(430),o=n.n(c),i=n(271);o.a.registerHelper("translate",(function(e,t){var n={ns:i.b};return"object"===typeof t&&"hash"in t&&(n=Object(a.a)(Object(a.a)({},n),t.hash)),r.a.t(e,n)}));var u=function(e,t,n,a){return function(e,t){return o.a.compile(e,t)}(e,n)(t,a)}},139:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var a=n(4),r=n(6),c=n(10),o=n(11),i=n(3),u=n(926),s=n(2453),l=n(2454),d=n(2455),b=n(186),j=n.n(b),f=n(31),v=function(e){var t=e.error,n=e.stack;return Object(f.jsxs)(s.a,{children:[Object(f.jsx)(d.a,{expandIcon:Object(f.jsx)(j.a,{}),children:Object(f.jsx)(u.a,{variant:"h5",color:"error",children:t})}),Object(f.jsx)(l.a,{children:Object(f.jsx)("pre",{children:n})})]})},h=function(e){Object(c.a)(n,e);var t=Object(o.a)(n);function n(){var e;Object(a.a)(this,n);for(var r=arguments.length,c=new Array(r),o=0;o<r;o++)c[o]=arguments[o];return(e=t.call.apply(t,[this].concat(c))).state={hasError:!1},e}return Object(r.a)(n,[{key:"componentDidCatch",value:function(e,t){console.log({error:e,errorInfo:t}),this.setState({errorInfo:t})}},{key:"render",value:function(){var e,t,n=this.state,a=n.hasError,r=n.error,c=n.errorInfo;return a?Object(f.jsx)(v,{error:null!==(e=null===r||void 0===r?void 0:r.message)&&void 0!==e?e:"",stack:null!==(t=null===c||void 0===c?void 0:c.componentStack)&&void 0!==t?t:""}):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return{hasError:!0,error:e}}}]),n}(i.Component)},160:function(e,t,n){"use strict";n.d(t,"b",(function(){return j})),n.d(t,"a",(function(){return f}));var a=n(440),r=n.n(a),c=n(561),o=n.n(c),i=n(289),u=n.n(i),s=n(33),l=u.a;function d(e){n(329)("./".concat(e,"/index")).then((function(e){"function"===typeof(null===e||void 0===e?void 0:e.default)&&(l=e.default)})).catch((function(){var t=e.indexOf("-");t>0&&d(e.substring(0,t))}))}s.a.language&&d(s.a.language),s.a.on("languageChanged",(function(e){d(e)}));var b=new r.a({allErrors:!0,addUsedSchema:!1});o()(b),b.addKeyword({keyword:"markdownDescription",schemaType:"string",valid:!0});var j=function(e){var t;return b.validateSchema(e)?{type:"success"}:(b.errors&&l&&l(b.errors),{type:"failure",errors:null!==(t=b.errors)&&void 0!==t?t:[]})},f=function(e){return l&&l(e),e}},1975:function(e,t,n){"use strict";var a=n(73),r=n(76);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var c=r(n(3)),o=(0,a(n(77)).default)(c.createElement("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckCircle");t.default=o},1976:function(e,t,n){"use strict";var a=n(73),r=n(76);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var c=r(n(3)),o=(0,a(n(77)).default)(c.createElement("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"}),"Error");t.default=o},232:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return u}));var a=n(2),r=n(81),c=n(2467),o=function(e,t){var n,o=null===(n=e.definitions)||void 0===n?void 0:n[t];if(!Object(r.isPresent)(o))throw new Error("Invalid definition ".concat(t));if("boolean"===typeof o)throw new Error("Invalid definition ".concat(t));var i=Object(c.a)(o);return delete i.definitions,e=Object(a.a)(Object(a.a)({},e),i)},i=function(e,t,n){if(e.jsonSchema){var a=JSON.parse(e.jsonSchema),r=e.tasks.find((function(e){return e.name===t})),c=null===r||void 0===r?void 0:r.validResponses.find((function(e){return e.name===n})),i=null===c||void 0===c?void 0:c.payloadSchemaDefinitionName;if(i)return o(a,i)}},u=function(e,t){if(e.jsonSchema){var n=JSON.parse(e.jsonSchema),a=e.actions.find((function(e){return e.name===t})),r=null===a||void 0===a?void 0:a.payloadSchemaDefinitionName;if(r)return o(n,r)}}},2480:function(e,t,n){"use strict";n.r(t),n.d(t,"DispatchActionStepper",(function(){return he}));var a=n(1),r=n(3),c=n(911),o=n(908),i=n(2416),u=n(2461),s=n(2458),l=n(2459),d=n(2494),b=n(2),j=n(18),f=n(924),v=n(31),h=["children","className"],O=Object(c.a)((function(e){return Object(o.a)({paper:{padding:e.spacing(2),color:e.palette.text.secondary}})})),m=function(e){var t=e.children,n=e.className,a=Object(j.a)(e,h),r=O();return Object(v.jsx)(f.a,Object(b.a)(Object(b.a)({className:"".concat(r.paper," ").concat(n),elevation:3},a),{},{children:t}))},p=n(969),g=n(926),x=["children"],y=function(e){var t=e.children,n=Object(j.a)(e,x);return Object(v.jsx)(g.a,Object(b.a)(Object(b.a)({variant:"h5"},n),{},{children:t}))},I=Object(c.a)((function(e){return Object(o.a)({grow:{flexGrow:1},actionToolbarButtons:{display:"flex"}})})),C=function(e){var t=e.title,n=e.actions,a=Object(j.a)(e,["title","actions"]),r=I();return Object(v.jsxs)(p.a,Object(b.a)(Object(b.a)({variant:"dense"},a),{},{children:[t&&Object(v.jsx)(y,{children:t}),Object(v.jsx)("div",{className:r.grow}),n&&Object(v.jsx)("div",{className:r.actionToolbarButtons,children:n})]}))},k=n(5),P=n.n(k),w=n(32),S=n(99),M=n(1922),N=n(925),D=n(2433),z=n(2438),L=n(2439),A=n(2457),T=n(2445),E=n(2482),R=n(372),B=n.n(R),V=n(97),F=n(2413),H=function(e){return Object(v.jsxs)(F.a,Object(b.a)(Object(b.a)({viewBox:"0 0 64 64"},e),{},{children:[Object(v.jsx)("path",{d:"M58 13H6c-1.103 0-2-.897-2-2s.897-2 2-2h52c1.103 0 2 .897 2 2S59.103 13 58 13zM6 10c-.552 0-1 .449-1 1s.448 1 1 1h52c.552 0 1-.449 1-1s-.448-1-1-1H6zM36.5 20h-9c-1.379 0-2.5-1.122-2.5-2.5s1.121-2.5 2.5-2.5h9c1.379 0 2.5 1.122 2.5 2.5S37.879 20 36.5 20zM27.5 16c-.827 0-1.5.673-1.5 1.5s.673 1.5 1.5 1.5h9c.827 0 1.5-.673 1.5-1.5S37.327 16 36.5 16H27.5zM18.497 45h-6c-1.379 0-2.5-1.122-2.5-2.5s1.121-2.5 2.5-2.5h6c1.379 0 2.5 1.122 2.5 2.5S19.876 45 18.497 45zM12.497 41c-.827 0-1.5.673-1.5 1.5s.673 1.5 1.5 1.5h6c.827 0 1.5-.673 1.5-1.5s-.673-1.5-1.5-1.5H12.497zM51.497 45h-6c-1.379 0-2.5-1.122-2.5-2.5s1.121-2.5 2.5-2.5h6c1.379 0 2.5 1.122 2.5 2.5S52.876 45 51.497 45zM45.497 41c-.827 0-1.5.673-1.5 1.5s.673 1.5 1.5 1.5h6c.827 0 1.5-.673 1.5-1.5s-.673-1.5-1.5-1.5H45.497zM29.5 28h-10c-.276 0-.5-.224-.5-.5v-4c0-.276.224-.5.5-.5h10c.276 0 .5.224.5.5v4C30 27.776 29.776 28 29.5 28zM20 27h9v-3h-9V27zM44.5 28h-10c-.276 0-.5-.224-.5-.5v-4c0-.276.224-.5.5-.5h10c.276 0 .5.224.5.5v4C45 27.776 44.776 28 44.5 28zM35 27h9v-3h-9V27zM29.5 36h-8c-.276 0-.5-.224-.5-.5v-4c0-.276.224-.5.5-.5h8c.276 0 .5.224.5.5v4C30 35.776 29.776 36 29.5 36zM22 35h7v-3h-7V35zM43.5 36h-8c-.276 0-.5-.224-.5-.5v-4c0-.276.224-.5.5-.5h8c.276 0 .5.224.5.5v4C44 35.776 43.776 36 43.5 36zM36 35h7v-3h-7V35z"}),Object(v.jsx)("path",{d:"M56.5,48h-49C7.224,48,7,47.776,7,47.5v-35C7,12.224,7.224,12,7.5,12h49c0.276,0,0.5,0.224,0.5,0.5v35    C57,47.776,56.776,48,56.5,48z M8,47h48V13H8V47z"}),Object(v.jsx)("rect",{width:"1",height:"3",x:"31.5",y:"6.5"}),Object(v.jsx)("path",{d:"M32 7c-1.103 0-2-.897-2-2s.897-2 2-2 2 .897 2 2S33.103 7 32 7zM32 4c-.552 0-1 .449-1 1s.448 1 1 1 1-.449 1-1S32.552 4 32 4zM21.5 61h-4c-.152 0-.297-.069-.392-.188-.095-.12-.13-.275-.096-.424l3-13C20.065 47.161 20.268 47 20.5 47h4c.152 0 .297.069.392.188.095.12.13.275.096.424l-3 13C21.935 60.839 21.732 61 21.5 61zM18.129 60h2.974l2.769-12h-2.974L18.129 60zM46.5 61h-4c-.232 0-.435-.161-.487-.388l-3-13c-.034-.148.001-.304.096-.424C39.203 47.069 39.348 47 39.5 47h4c.232 0 .435.161.487.388l3 13c.034.148-.001.304-.096.424C46.797 60.931 46.652 61 46.5 61zM42.897 60h2.974l-2.769-12h-2.974L42.897 60z"}),Object(v.jsx)("path",{d:"M41.974 56H22.026l.922-4h18.104L41.974 56zM23.282 55h17.436l-.461-2H23.743L23.282 55zM15.48 37.008c-.128 0-.256-.049-.354-.146l-3.008-3.008c-.195-.195-.195-.512 0-.707l3.008-3.008c.195-.195.512-.195.707 0l3.008 3.008c.195.195.195.512 0 .707l-3.008 3.008C15.736 36.959 15.608 37.008 15.48 37.008zM13.18 33.5l2.301 2.301 2.301-2.301-2.301-2.301L13.18 33.5zM32.48 46.008c-.128 0-.256-.049-.354-.146l-3.008-3.008c-.195-.195-.195-.512 0-.707l3.008-3.008c.195-.195.512-.195.707 0l3.008 3.008c.195.195.195.512 0 .707l-3.008 3.008C32.736 45.959 32.608 46.008 32.48 46.008zM30.18 42.5l2.301 2.301 2.301-2.301-2.301-2.301L30.18 42.5zM32 22c-.276 0-.5-.224-.5-.5v-2c0-.276.224-.5.5-.5s.5.224.5.5v2C32.5 21.776 32.276 22 32 22z"}),Object(v.jsx)("path",{d:"M39.5 24c-.276 0-.5-.224-.5-.5V22H25v1.5c0 .276-.224.5-.5.5S24 23.776 24 23.5v-2c0-.276.224-.5.5-.5h15c.276 0 .5.224.5.5v2C40 23.776 39.776 24 39.5 24zM15.5 31c-.276 0-.5-.224-.5-.5v-5c0-.276.224-.5.5-.5h4c.276 0 .5.224.5.5S19.776 26 19.5 26H16v4.5C16 30.776 15.776 31 15.5 31zM32.48 39.992c-.234.01-.501-.225-.5-.501L31.998 34H29.5c-.276 0-.5-.224-.5-.5s.224-.5.5-.5h3c.133 0 .261.053.354.147S33 33.369 33 33.501l-.02 5.992C32.979 39.77 32.756 39.992 32.48 39.992z"}),Object(v.jsx)("path",{d:"M32.52 39.992c-.275 0-.499-.223-.5-.499L32 33.501c0-.133.052-.26.146-.354S32.367 33 32.5 33h3c.276 0 .5.224.5.5S35.776 34 35.5 34h-2.498l.018 5.491c.001.276-.223.5-.498.501C32.521 39.992 32.521 39.992 32.52 39.992zM15.5 41c-.276 0-.5-.224-.5-.5v-3.992c0-.276.224-.5.5-.5s.5.224.5.5V40.5C16 40.776 15.776 41 15.5 41zM39.5 32c-.276 0-.5-.224-.5-.5v-3.992c0-.276.224-.5.5-.5s.5.224.5.5V31.5C40 31.776 39.776 32 39.5 32zM21.5 34h-3.012c-.276 0-.5-.224-.5-.5s.224-.5.5-.5H21.5c.276 0 .5.224.5.5S21.776 34 21.5 34zM29.5 43h-9.012c-.276 0-.5-.224-.5-.5s.224-.5.5-.5H29.5c.276 0 .5.224.5.5S29.776 43 29.5 43zM43.497 43h-8.009c-.276 0-.5-.224-.5-.5s.224-.5.5-.5h8.009c.276 0 .5.224.5.5S43.773 43 43.497 43z"}),Object(v.jsxs)("g",{children:[Object(v.jsx)("defs",{children:Object(v.jsx)("rect",{id:"SVGID_1_",width:"675.5",height:"132.688",x:"-1235.486",y:"289.422"})}),Object(v.jsx)("clipPath",{id:"SVGID_2_",children:Object(v.jsx)("use",{overflow:"visible",href:"#SVGID_1_"})})]})]}))},U=n(946),_=n(934),W=Object(c.a)((function(e){return Object(o.a)({button:{marginRight:e.spacing(1)},content:{maxHeight:"60vh",overflowY:"auto"}})})),G=function(e){var t=e.onNext,n=e.onBack,a=e.onSkip,r=e.nextActionCaption,c=e.children,o=W(),u=Object(d.a)().t;return Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(i.a,{container:!0,children:Object(v.jsx)(i.a,{item:!0,xs:12,className:o.content,children:c})}),Object(v.jsx)(i.a,{container:!0,children:Object(v.jsxs)(i.a,{item:!0,xs:12,children:[Object(v.jsx)(_.a,{disabled:!n,onClick:n,className:o.button,children:u("Back")}),!!a&&Object(v.jsx)(_.a,{onClick:a,className:o.button,children:u("Skip")}),!!t&&Object(v.jsx)(_.a,{onClick:t,className:o.button,children:null!==r&&void 0!==r?r:u("Next")})]})})]})},J=Object(c.a)((function(e){return Object(o.a)({root:{flexGrow:1}})})),K=function(e,t){if(!e)return[];if(!t)return e;var n=t.toLowerCase();return e.filter((function(e){return e.name.toLowerCase().includes(n)||e.description&&e.description.includes(n)}))},$=n(81),Z=Object(c.a)((function(e){return Object(o.a)({root:{flexGrow:1,width:"100%",marginTop:"20px",marginBottom:"20px"}})})),q=n(2467),Y=n(232),Q=n(160),X=n(116),ee=n(347),te=Object(c.a)((function(e){return Object(o.a)({root:{flexGrow:1,width:"100%",marginBottom:"20px"},textField:{width:"100%"},content:{padding:"8px 24px","&:first-child":{paddingTop:20}}})})),ne=n(2491),ae=n(731),re=n(1976),ce=n.n(re),oe=n(1975),ie=n.n(oe),ue=n(706),se=n(114),le=n(278),de=Object(c.a)((function(e){return Object(o.a)({button:{marginRight:e.spacing(1)},icon:{textAlign:"center"}})})),be=function(e){var t=e.icon,n=e.title,a=e.details,r=de();return Object(v.jsx)(ae.a,{pt:"50px",pb:"50px",maxHeight:"60vh",children:Object(v.jsxs)(i.a,{container:!0,justifyContent:"center",alignItems:"center",spacing:4,children:[!!t&&Object(v.jsx)(i.a,{item:!0,xs:12,className:r.icon,children:t}),Object(v.jsx)(i.a,{item:!0,xs:12,children:Object(v.jsx)(g.a,{variant:"h4",align:"center",children:n})}),!!a&&Object(v.jsx)(i.a,{item:!0,xs:12,children:"string"===typeof a?Object(v.jsx)(g.a,{variant:"h6",align:"center",children:a}):Object(v.jsx)("div",{children:a})})]})})},je=function(e){var t=e.action,n=e.onDispatchCompleted,a=e.onBack,r=de(),c=Object(d.a)().t,o=Object(V.c)().contexts_DispatchAction,u=Object(ne.a)(Object(w.a)(P.a.mark((function e(){return P.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),[o,t]),s=u.loading,l=u.value,b=u.error;return s?Object(v.jsx)(se.b,{children:c("ExecutingAction")}):Object(v.jsxs)(v.Fragment,{children:[!b&&Object(v.jsx)(be,{icon:Object(v.jsx)(ie.a,{style:{color:ue.a[500],fontSize:60}}),title:c("ActionCompleted"),details:c("DispatchActionResult",{id:null===l||void 0===l?void 0:l.contextId})}),!!b&&Object(v.jsx)(be,{icon:Object(v.jsx)(ce.a,{color:"error",style:{fontSize:60}}),title:c("ActionFailed"),details:Object(v.jsx)(le.a,{error:b})}),Object(v.jsx)(i.a,{container:!0,children:Object(v.jsxs)(i.a,{item:!0,xs:12,children:[!!b&&Object(v.jsx)(_.a,{onClick:a,className:r.button,children:c("Back")}),Object(v.jsx)(_.a,{onClick:n,className:r.button,children:c("Ok")})]})})]})},fe=Object(c.a)((function(e){return Object(o.a)({root:{width:"100%"},button:{marginRight:e.spacing(1)},content:{maxHeight:"60vh",overflowY:"auto"}})})),ve=[function(e){var t=e.value,n=e.onNext,c=J(),o=Object(r.useState)(""),i=Object(a.a)(o,2),u=i[0],s=i[1],l=function(e){var t=Object(V.c)().contextTypes_Search,n=Object(S.a)("/ContextTypes/Search",Object(w.a)(P.a.mark((function e(){var n;return P.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t({limit:100});case 2:return n=e.sent,e.abrupt("return",Object(M.a)((function(e){return e.name}),n));case 4:case"end":return e.stop()}}),e)})))),a=n.data,c=n.error,o=n.isValidating,i=n.mutate;return Object(r.useMemo)((function(){return{data:K(a,e),isValidating:o,error:c,mutate:i}}),[a,e,o,c,i])}(u),d=l.data,b=l.error,j=l.isValidating,f=Object(r.useCallback)((function(e){t.contextTypeName===e?n(t):n({contextTypeName:e})}),[t,n]);return Object(v.jsxs)(G,{children:[Object(v.jsx)(C,{actions:Object(v.jsx)(U.a,{value:u,onChange:s})}),Object(v.jsx)(D.a,{className:c.root,style:{maxHeight:"400",overflowY:"auto"},children:d.map((function(e,t){return Object(v.jsxs)(z.a,{children:[Object(v.jsx)(T.a,{children:Object(v.jsx)(H,{})}),Object(v.jsx)(L.a,{primary:e.name,secondary:e.description}),Object(v.jsx)(A.a,{children:Object(v.jsx)(N.a,{edge:"end",onClick:function(){return f(e.name)},children:Object(v.jsx)(B.a,{})})})]},e.name)}))}),!j&&!!b&&Object(v.jsx)(E.a,{severity:"error",children:b.toString()})]})},function(e){var t=e.value,n=e.onBack,a=e.onNext,c=Z(),o=function(e){var t=Object(V.c)().contextTypes_FindOne,n=Object(S.a)("/ContextType/".concat(e),Object(w.a)(P.a.mark((function n(){return P.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t({name:e});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}}),n)}))),{revalidateOnFocus:!1}),a=n.data,c=n.error,o=n.isValidating,i=n.mutate;return Object(r.useMemo)((function(){return{contextType:a,isValidating:o,error:c,mutate:i}}),[a,o,i,c])}(t.contextTypeName),u=o.contextType,s=o.error,l=o.isValidating,d=Object(r.useMemo)((function(){return u?u.initialActions.map((function(e){return u.actions.find((function(t){return t.name===e}))})).filter($.isPresent):[]}),[u]),b=Object(r.useCallback)((function(e){t.action===e?a(t):a({contextTypeName:t.contextTypeName,action:e})}),[t,a]);return!l&&s?Object(v.jsx)(E.a,{severity:"error",children:s.toString()}):l||!u?null:Object(v.jsx)(G,{onBack:n,children:Object(v.jsx)(i.a,{container:!0,direction:"column",alignItems:"center",spacing:3,className:c.root,children:d.map((function(e){return Object(v.jsx)(i.a,{item:!0,xs:10,children:Object(v.jsx)(_.a,{variant:"outlined",onClick:function(){return b(e.name)},children:e.name})},e.name)}))})})},function(e){var t,n=e.value,c=e.onBack,o=e.onNext,u=te(),s=Object(d.a)().t,l=function(e){var t=Object(V.c)().contextTypes_FindOne,n=Object(S.a)("/ContextType/".concat(e),Object(w.a)(P.a.mark((function n(){return P.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t({name:e});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}}),n)}))),{revalidateOnFocus:!1}),a=n.data,c=n.error,o=n.isValidating,i=n.mutate;return Object(r.useMemo)((function(){return{contextType:a,isValidating:o,error:c,revalidate:i}}),[a,o,i,c])}(n.contextTypeName),j=l.contextType,f=l.error,h=l.isValidating,O=Object(r.useState)({reference:n.reference,contextId:n.contextId}),m=Object(a.a)(O,2),p=m[0],g=m[1],x=Object(r.useState)(null!==(t=n.payload)&&void 0!==t?t:{}),y=Object(a.a)(x,2),I=y[0],C=y[1],k=Object(r.useRef)(),M=Object(r.useRef)(),N=Object(r.useMemo)((function(){return null===j||void 0===j?void 0:j.actions.find((function(e){return e.name===n.action}))}),[j,n]),D=Object(r.useCallback)((function(){N&&j&&(k.current&&k.current.length>0||M.current&&M.current.length>0||o(Object(b.a)(Object(b.a)(Object(b.a)({},n),p),{},{payload:I})))}),[o,N,j,p,I,n]),z=Object(r.useMemo)((function(){return{type:"object",properties:{reference:{type:"string"}},required:["reference"]}}),[]),L=Object(r.useMemo)((function(){return function(e,t){if(e&&t&&e.payloadSchemaDefinitionName)return Object(Y.a)(t,e.name)}(N,j)}),[N,j]),A=Object(r.useMemo)((function(){var e,t=N?null===(e=Object(X.i)(N))||void 0===e?void 0:e.uiSchema:void 0;if(t)return JSON.parse(t)}),[N]),T=Object(r.useCallback)((function(e){e.errors&&e.errors.length>0?(Object(Q.a)(e.errors.map((function(e){return Object(b.a)(Object(b.a)({},e),{},{instancePath:e.dataPath})}))),k.current=Object(q.a)(e.errors)):(g(e.data),k.current=void 0)}),[g]),R=Object(r.useCallback)((function(e){e.errors&&e.errors.length>0?(Object(Q.a)(e.errors.map((function(e){return Object(b.a)(Object(b.a)({},e),{},{instancePath:e.dataPath})}))),M.current=Object(q.a)(e.errors)):(C(e.data),M.current=void 0)}),[C]),B=Object(r.useMemo)((function(){var e;if(j){var t=null===(e=Object(X.i)(j))||void 0===e?void 0:e.uiSchemaCommon;if(t)return JSON.parse(t)}}),[j]);return!h&&f?Object(v.jsx)(E.a,{severity:"error",children:f.toString()}):j&&N?Object(v.jsx)(G,{onBack:c,onNext:D,nextActionCaption:s("ExecuteAction"),children:Object(v.jsxs)(i.a,{container:!0,spacing:2,className:u.root,children:[Object(v.jsx)(i.a,{item:!0,xs:12,className:u.content,children:Object(v.jsx)(ee.a,{schema:z,data:p,onChange:T,uiSchemaLibrary:B})}),Object(v.jsx)(i.a,{item:!0,xs:12,className:u.content,children:!!L&&Object(v.jsx)(ee.a,{schema:L,uischema:A,data:I,onChange:R,uiSchemaLibrary:B})})]})}):null}],he=function(){var e=Object(d.a)().t,t=fe(),n=Object(r.useState)(0),c=Object(a.a)(n,2),o=c[0],b=c[1],j=Object(r.useState)({}),f=Object(a.a)(j,2),h=f[0],O=f[1],p=Object(r.useMemo)((function(){return[o>0?e("SelectedContextType",{name:h.contextTypeName}):e("SelectContextType"),o>1?e("SelectedActionType",{name:h.action}):e("SelectActionType"),e("CompleteActionData")]}),[o,h,e]),g=Object(r.useCallback)((function(e){O(e),b((function(e){return e+1}))}),[b]),x=Object(r.useCallback)((function(){b((function(e){return e+1}))}),[b]),y=Object(r.useCallback)((function(){b((function(e){return e-1}))}),[b]),I=Object(r.useCallback)((function(){b(0),O({})}),[]),k=function(){var e=ve[o];return Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(u.a,{activeStep:o,alternativeLabel:!0,children:p.map((function(e,t){return Object(v.jsx)(s.a,{children:Object(v.jsx)(l.a,{children:e})},t)}))}),!!e&&Object(v.jsx)(e,{value:h,onNext:g,onBack:y,onSkip:x})]})};return Object(v.jsx)(i.a,{container:!0,spacing:3,justifyContent:"center",children:Object(v.jsx)(i.a,{item:!0,xs:9,children:Object(v.jsxs)(m,{className:t.root,children:[Object(v.jsx)(C,{title:e("DispatchingAction")}),o<3?Object(v.jsx)(k,{}):Object(v.jsx)(je,{action:h,onDispatchCompleted:I,onBack:y})]})})})};t.default=he},329:function(e,t,n){var a={"./ar/index":[635,22],"./ca/index":[636,23],"./cs/index":[637,24],"./de/index":[638,25],"./en/index":[289],"./es/index":[639,26],"./fr/index":[640,27],"./hu/index":[641,28],"./id/index":[642,29],"./it/index":[643,30],"./ja/index":[644,31],"./ko/index":[645,32],"./nb/index":[646,33],"./nl/index":[647,34],"./pl/index":[648,35],"./pt-BR/index":[649,36],"./ru/index":[650,37],"./sk/index":[651,38],"./sv/index":[652,39],"./th/index":[653,40],"./zh-TW/index":[655,41],"./zh/index":[654,42]};function r(e){if(!n.o(a,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=a[e],r=t[0];return Promise.all(t.slice(1).map(n.e)).then((function(){return n.t(r,7)}))}r.keys=function(){return Object.keys(a)},r.id=329,e.exports=r},339:function(e){e.exports=JSON.parse('{"$schema":"http://json-schema.org/draft-07/schema#","$id":"http://nimflow.com/schemas/recognized-image-batch.schema.json","type":"object","title":"Recognized image batch schema","allOf":[{"$ref":"#/definitions/RecognizedImageBatch"}],"definitions":{"RecognizedImageBatch":{"type":"object","properties":{"fileUrls":{"type":"array","items":{"type":"string"}},"documents":{"type":"array","items":{"$ref":"#/definitions/Document"}}},"required":["fileUrls"]},"Document":{"type":"object","properties":{"schemaId":{"type":"string"},"pages":{"type":"array","items":{"$ref":"#/definitions/PageImageLocation"}},"action":{"type":"string","enum":["saveAsDraft","send","dontSend"]},"data":true},"required":["schemaId","action"]},"PageImageLocation":{"type":"object","properties":{"fileIndex":{"type":"integer"},"filePageNumber":{"type":"integer"}},"required":["fileIndex","filePageNumber"]}}}')},347:function(e,t,n){"use strict";n.d(t,"a",(function(){return er})),n.d(t,"c",(function(){return tr})),n.d(t,"b",(function(){return nr}));var a=n(15),r=n(179),c=n(589),o=n(3),i=n.n(o),u=n(1302),s=n(301),l=n(74),d=n(71),b=n(19),j=n(2),f=n(1),v=n(2446),h=n(31),O=function(){throw new Error("You forgot to wrap your component in <JsonFormsContextProvider>.")},m=Object(o.createContext)({context:{},bindContext:!0,uiSchemaLibrary:{},registerValidationProvider:O,unregisterValidationProvider:O,validationProviderUpdated:O}),p=function(e){var t=e.context,n=e.bindContext,a=e.uiSchemaLibrary,r=e.children,c=e.onErrorsChange,i=Object(o.useState)({}),u=Object(f.a)(i,2),s=u[0],l=u[1];Object(o.useEffect)((function(){var e=Object.values(s).flatMap((function(e){return e}));null===c||void 0===c||c(e)}),[s,c]);var d=Object(o.useCallback)((function(e){l((function(t){return Object(j.a)(Object(j.a)({},t),{},Object(b.a)({},e,[]))}))}),[]),O=Object(o.useCallback)((function(e){l((function(t){return Object(v.a)([e],t)}))}),[]),p=Object(o.useCallback)((function(e,t){l((function(n){return e in n?Object(j.a)(Object(j.a)({},n),{},Object(b.a)({},e,t)):n}))}),[]);return Object(h.jsx)(m.Provider,{value:{context:null!==t&&void 0!==t?t:{},bindContext:null===n||void 0===n||n,uiSchemaLibrary:null!==a&&void 0!==a?a:{},registerValidationProvider:d,unregisterValidationProvider:O,validationProviderUpdated:p},children:r})},g=function(){return Object(o.useContext)(m)},x=n(122),y=Object(d.withJsonFormsLayoutProps)((function(e){var t=e.uischema,n=e.visible,a=e.data,r=e.path,c=g(),i=c.bindContext,l=c.context,d=Object(o.useMemo)((function(){var e=t;if(e||"text"in e){var n={data:a,path:r};return i&&Object.assign(n,l),Object(x.a)(e.text,n)}}),[t,a,r,i,l]);return d?Object(h.jsx)(u.a,{xsUp:!n,children:Object(h.jsx)("div",{children:Object(h.jsx)(s.a,{children:d})})}):null})),I=Object(l.rankWith)(3,Object(l.uiTypeIs)("Markdown")),C=n(911),k=n(908),P=Object(C.a)((function(e){return Object(k.a)({viewer:{width:"100%",minHeight:"800px"}})})),w=Object(d.withJsonFormsLayoutProps)((function(e){var t=P(),n=e.uischema,a=e.visible,r=e.data,c=e.path,i=g(),s=i.bindContext,l=i.context,d=Object(o.useMemo)((function(){var e=n;if(e||"url"in e){var t={data:r,path:c};return s&&Object.assign(t,l),Object(x.a)(e.url,t)}}),[n,r,c,s,l]);return d?Object(h.jsx)(u.a,{xsUp:!a||!d,children:Object(h.jsx)("object",{data:d,type:"application/pdf",className:t.viewer,children:Object(h.jsx)("embed",{src:d,type:"application/pdf"})})}):null})),S=Object(l.rankWith)(3,Object(l.uiTypeIs)("Pdf")),M=n(18),N=n(0),D=n(81),z=["uischema","schema","path","renderers"],L=Object(d.withJsonFormsLayoutProps)((function(e){var t=e.uischema,n=e.schema,a=e.path,r=e.renderers,c=Object(M.a)(e,z),i=Object(d.useJsonForms)().core,u=g().uiSchemaLibrary,s="Use"===t.type?t:void 0,b=s?u[s.name]:void 0,f=s?l.Resolve.schema(n,s.scope):void 0,v=Object(o.useMemo)((function(){if(r&&b&&f)return function(e,t){var n,a=-1,r=void 0,c=Object(N.a)(e);try{for(c.s();!(n=c.n()).done;){var o=n.value,i=t(o);i>a&&(a=i,r=o)}}catch(u){c.e(u)}finally{c.f()}return r}(r,(function(e){return e.tester(b,f)}))}),[b,r,f]);if(!b||!s||!f)return null;var O=Object(l.composeWithUi)(s,a),m=l.Resolve.data(null===i||void 0===i?void 0:i.data,O);if(Object(D.isPresent)(v)&&-1!==v.tester(b,f)){var p=v.renderer;return Object(h.jsx)(p,Object(j.a)({uischema:b,schema:f,path:O,data:m,renderers:r},c))}return Object(h.jsx)(d.UnknownRenderer,{type:"renderer"})})),A=Object(l.rankWith)(3,Object(l.uiTypeIs)("Use")),T=n(5),E=n.n(T),R=n(32),B=n(99),V=n(226),F=n(200),H=Object(d.withJsonFormsControlProps)((function(e){var t=e.uischema.options.optionsSource,n=t.moduleName,a=t.functionName,c=Object(V.a)().call,i=Object(B.a)("function/".concat(n,"/").concat(a),Object(R.a)(E.a.mark((function e(){var t,r,o,i,u,s,l,d,b;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],e.next=3,c(n,a);case 3:if(r=e.sent,Array.isArray(r)){o=Object(N.a)(r);try{for(o.s();!(i=o.n()).done;)u=i.value,s=void 0,l=void 0,Object(F.a)(u)?(s=u.value,"string"===typeof u.label&&(l=u.label)):s=u,Object(D.isPresent)(s)&&(b={label:null!==(d=l)&&void 0!==d?d:"string"===typeof s?s:JSON.stringify(s),value:s},t.push(b))}catch(j){o.e(j)}finally{o.f()}}return e.abrupt("return",t);case 6:case"end":return e.stop()}}),e)}))),{fallbackData:[],revalidateOnMount:!0,revalidateOnFocus:!1}).data,u=Object(o.useMemo)((function(){return Object(j.a)(Object(j.a)({},e),{},{options:i})}),[e,i]);return Object(h.jsx)(r.MaterialInputControl,Object(j.a)(Object(j.a)({},u),{},{input:r.MuiSelect}))})),U=Object(l.rankWith)(3,Object(l.and)(l.isControl,(function(e){var t,n=null===(t=e.options)||void 0===t?void 0:t.optionsSource;return!!n&&!!n.moduleName&&!!n.functionName}))),_=n(233),W=n(2494),G=n(1299),J=n(36),K=n(2486),$=n(2468),Z=n(591),q=n.n(Z),Y=n(294),Q=n.n(Y),X=n(224),ee=n.n(X),te=n(672),ne=n(610),ae=n.n(ne),re=n(97),ce=n(166),oe=["image/png","image/jpeg","image/webp"],ie=function(e){return new Promise((function(t,n){var a=new Image;a.crossOrigin="anonymous",a.addEventListener("load",(function(){return t(a)})),a.addEventListener("error",(function(e){return n(e)})),a.src=e}))},ue=function(){var e=Object(R.a)(E.a.mark((function e(t,n){var a,r,c;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=new Blob([t.content],{type:t.mimeType}),r=URL.createObjectURL(a),e.prev=2,e.next=5,ie(r);case 5:c=e.sent,t.pages.push({getImageData:function(){var e=document.createElement("canvas"),t=e.getContext("2d");return e.width=c.naturalWidth,e.height=c.naturalHeight,t.drawImage(c,0,0),t.getImageData(0,0,c.naturalWidth,c.naturalHeight)},width:c.naturalWidth,height:c.naturalHeight,fileIndex:n,filePageNumber:0,pageIndex:0}),t.pageStates.push({rotate:0});case 8:return e.prev=8,URL.revokeObjectURL(r),e.finish(8);case 11:case"end":return e.stop()}}),e,null,[[2,,8,11]])})));return function(t,n){return e.apply(this,arguments)}}(),se=function(){var e=Object(R.a)(E.a.mark((function e(t,n){var a,r,c,o;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a=new Q.a({buffer:t.content}),r=function(e,r){a.setDirectory(e);var c={getImageData:function(){a.setDirectory(e);var t=a.readRGBAImage();return new ImageData(new Uint8ClampedArray(t),a.width(),a.height())},width:a.width(),height:a.height(),fileIndex:n,filePageNumber:e,pageIndex:0};t.pages.push(c),t.pageStates.push({rotate:0})},c=0,o=a.countDirectory();c<o;++c)r(c);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),le=function(){var e=Object(R.a)(E.a.mark((function e(t,n){var a,r,c,o,i,u,s;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=new Uint8Array(t.content),e.next=3,te.a.getDocument(a).promise;case 3:for(r=e.sent,c=[],o=new Array(r.numPages),i=new Array(r.numPages),u=function(e){c.push(r.getPage(e+1).then(function(){var t=Object(R.a)(E.a.mark((function t(a){var r,c;return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=2*window.devicePixelRatio,c=a.getViewport({scale:r}),o[e]={getImageData:function(){var e=Object(R.a)(E.a.mark((function e(){var t,n;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=document.createElement("canvas")).style.width="".concat(c.width/r,"px"),t.style.height="".concat(c.height/r,"px"),t.height=c.height,t.width=c.width,n=t.getContext("2d"),e.next=8,a.render({canvasContext:n,viewport:c}).promise;case 8:return e.abrupt("return",n.getImageData(0,0,t.width,t.height));case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),width:c.width,height:c.height,fileIndex:n,filePageNumber:e,pageIndex:0},i[e]={rotate:0};case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()))},s=0;s<r.numPages;s++)u(s);return e.next=11,Promise.all(c);case 11:t.pages=o;case 12:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),de=function(){var e=Object(R.a)(E.a.mark((function e(t,n,a){var r,c,o,i,u,s;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=t.lastIndexOf("/"),o=c>=0?t.substring(c+1):t,i={url:t,status:"loaded",name:o,mimeType:a.headers["content-type"],content:a.data,pages:[],pageStartIndex:0,pageStates:[]},u=null===(r=a.headers)||void 0===r?void 0:r["content-disposition"],(s=u?/filename="?([^"]*?)"?(;|$)/g.exec(u):void 0)&&s.length>1&&(i.name=s[1]),i.mimeType&&!oe.includes(i.mimeType)){e.next=11;break}return e.next=9,ue(i,n);case 9:e.next=19;break;case 11:if("image/tiff"!==i.mimeType){e.next=16;break}return e.next=14,se(i,n);case 14:e.next=19;break;case 16:if("application/pdf"!==i.mimeType){e.next=19;break}return e.next=19,le(i,n);case 19:return e.abrupt("return",i);case 20:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),be=function(e,t){return Object(J.a)(e,(function(e){null===t||void 0===t||t.forEach((function(t,n){t.pages.forEach((function(t,a){var r=e[t.fileIndex];if("loaded"===(null===r||void 0===r?void 0:r.status)){var c,o=r.pageStates[t.filePageNumber];o.documentIndex=n,o.documentOrder=a,o.rotate=null!==(c=t.rotate)&&void 0!==c?c:0}}))}));var n,a=0,r=Object(N.a)(e);try{for(r.s();!(n=r.n()).done;){var c=n.value;if("loaded"===c.status){c.pageStartIndex=a;var o,i=Object(N.a)(c.pages);try{for(i.s();!(o=i.n()).done;){o.value.pageIndex=a++}}catch(u){i.e(u)}finally{i.f()}}}}catch(u){r.e(u)}finally{r.f()}}))},je=n(160),fe=Symbol("marker"),ve=Object(l.createAjv)({allErrors:!0,addUsedSchema:!1,useDefaults:!0});ve.addFormat("image",(function(){return!0})),ve.addKeyword("patternMask",{type:"string",valid:!0,errors:!1});var he=function(e,t){var n=function(e){for(var t="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=new Uint8Array(e),r=a.byteLength,c=r%3,o=r-c,i=0;i<o;i+=3){var u=a[i]<<16|a[i+1]<<8|a[i+2],s=(258048&u)>>12,l=(4032&u)>>6,d=63&u;t+=n[(16515072&u)>>18]+n[s]+n[l]+n[d]}if(1===c){var b=a[o],j=(3&b)<<4;t+=n[(252&b)>>2]+n[j]+"=="}else if(2===c){var f=a[o]<<8|a[o+1],v=(1008&f)>>4,h=(15&f)<<2;t+=n[(64512&f)>>10]+n[v]+n[h]+"="}return t}(e);return"data:".concat(t,";base64,").concat(n)};var Oe=function(){throw new Error("You forgot to wrap your component in <BatchProcessorContextProvider>.")},me={fileInfos:[],documentInfos:[],loadingImages:!1,setCurrentDocumentLocation:Oe,updateCurrentDocument:Oe,updateBatch:Oe,movePage:Oe,findByPageIndex:Oe,deleteDocument:Oe,addDocument:Oe,updateDocument:Oe,getDocument:Oe,setCurrentDocumentEditionState:Oe,canModify:!0,getDisplayableDataUrl:Oe,rotateImage:Oe,rotateAllImages:Oe},pe=Object(o.createContext)(me),ge=function(e,t){var n,a=Object(N.a)(t);try{for(a.s();!(n=a.n()).done;){var r,c=n.value,o="loaded"===c.status?c.pages:[],i=Object(N.a)(o);try{for(i.s();!(r=i.n()).done;){var u=r.value;if(u.pageIndex===e)return u}}catch(s){i.e(s)}finally{i.f()}}}catch(s){a.e(s)}finally{a.f()}},xe=function(e){return q()(e).map((function(e){return e-1}))},ye=function(e,t,n){var a=e;return a&&(a+=","),a+=t.toString(),t!==n&&(a+="-".concat(n)),a},Ie=function(e){if(0===e.length)return"";for(var t=e.map((function(e){return e+1})),n=t[0],a=n,r="",c=1;c<t.length;c++){var o=t[c];o===a+1&&a>=n||o===a-1&&a<=n?a=o:(r=ye(r,n,a),n=a=o)}return r=ye(r,n,a)},Ce=function(e,t){var n=new Array(e.length);return t.forEach((function(t,a){"loaded"===t.status&&t.pages.forEach((function(t,r){var c=e.indexOf(t.pageIndex);c>=0&&(n[c]={fileIndex:a,filePageNumber:r})}))})),n},ke=function(e,t){return t&&!ve.validate(t,e.data)&&ve.errors?Object(je.a)(ve.errors.map((function(e){return Object(j.a)(Object(j.a)({},e),{},{instancePath:e.dataPath})}))):[]},Pe=function(e,t){for(var n=e+t;n<0;)n+=360;for(;n>=360;)n-=360;return n},we=function(e,t){var n,a=Pe(null!==(n=e.rotate)&&void 0!==n?n:0,t);0===a?delete e.rotate:e.rotate=a},Se=function(e){var t=e.basePath,n=e.batch,r=e.documentSchemasSource,c=e.readonly,i=e.children,u=!c,s=Object(o.useState)(n),v=Object(f.a)(s,1)[0],O=function(e){var t=e.moduleName,n=e.functionName,a=Object(V.a)().call,r=Object(B.a)("function/".concat(t,"/").concat(n),Object(R.a)(E.a.mark((function e(){var r,c,o,i,u,s;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=[],e.next=3,a(t,n);case 3:if(c=e.sent,Array.isArray(c)){o=Object(N.a)(c);try{for(o.s();!(i=o.n()).done;)u=i.value,"success"===(s=Object(je.b)(u)).type?r.push(u):console.error("Error validating schema ".concat(null===u||void 0===u?void 0:u.$id,". It will be ignored."),s.errors)}catch(l){o.e(l)}finally{o.f()}}return e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)}))),{revalidateOnFocus:!1}),c=r.data,i=r.isValidating,u=r.error;return{documentSchemas:Object(o.useMemo)((function(){return null!==c&&void 0!==c?c:[]}),[c]),loading:i,error:u}}(r).documentSchemas,m=Object(d.useJsonForms)().dispatch,p=function(e,t){var n=Object(ce.c)().hubBaseUrl,a=Object(re.c)().getConfiguredAxiosInstance,r=Object(o.useState)((function(){return e.fileUrls.map((function(e){var t=ae()(e);return t.is("relative")&&n&&(t=ae.a.joinPaths("BlobStorage",t).absoluteTo(n)),{url:t.valueOf(),status:"loading",name:t.filename()}}))})),c=Object(f.a)(r,2),i=c[0],u=c[1],s=Object(o.useState)(t&&e.fileUrls.length>0),l=Object(f.a)(s,2),d=l[0],b=l[1];return Object(o.useEffect)((function(){if(t){var r=ee.a.CancelToken.source(),c=ee.a.create({responseType:"arraybuffer",cancelToken:r.token}),o=a({responseType:"arraybuffer",cancelToken:r.token});return e.fileUrls.map((function(t,a){var r=ae()(t),i=c;return r.is("relative")&&n&&(r=ae.a.joinPaths("BlobStorage",r),i=o),t=r.valueOf(),i.get(t).then((function(n){return de(t,a,n).then((function(t){u((function(n){var r=Object(J.a)(n,(function(e){e[a]=t}));return r.every((function(e){return"loading"!==e.status}))&&(r=be(r,e.documents),b(!1)),r}))}))})).catch((function(n){u((function(r){var c=Object(J.a)(r,(function(e){e[a]=function(e,t){var n=e.lastIndexOf("/"),a=n>=0?e.substring(n+1):e,r={url:e,status:"failed",name:a,error:t.message};return t.response&&(r.error="Code: ".concat(t.response.status,"\nData: ").concat(t.response.data)),r}(t,n)}));return c.every((function(e){return"loading"!==e.status}))&&(c=be(c,e.documents),b(!1)),c}))}))})),function(){r.cancel(),b(!1)}}u((function(e){return e.map((function(e){return{name:e.name,status:"loaded",url:e.url,content:new ArrayBuffer(0),pages:[],pageStartIndex:0,pageStates:[]}}))}))}),[t,a,n,e.documents,e.fileUrls]),{loadingFileInfos:d,fileInfos:i,setFileInfos:u}}(v,u),x=p.fileInfos,y=p.loadingFileInfos,I=p.setFileInfos,C=Object(o.useState)({documentIndex:v.documents.length>0?0:void 0}),k=Object(f.a)(C,2),P=k[0],w=k[1],S=Object(o.useState)([]),M=Object(f.a)(S,2),z=M[0],L=M[1],A=function(e){var t=g(),n=t.registerValidationProvider,a=t.unregisterValidationProvider,r=t.validationProviderUpdated,c=Object(o.useState)(),i=Object(f.a)(c,2),u=i[0],s=i[1];Object(o.useEffect)((function(){return n(e),function(){return a(e)}}),[e,n,a]),Object(o.useEffect)((function(){var t=(null!==u&&void 0!==u?u:[]).map((function(t){var n="".concat(e,".").concat(t.dataPath);return Object(j.a)(Object(j.a)({},t),{},{dataPath:n,instancePath:n})}));r(e,t)}),[u,e,r]);var l=Object(o.useCallback)((function(e){s((function(t){return Object(G.a)(t,e)?t:e}))}),[]);return Object(o.useMemo)((function(){return{updateErrors:l}}),[l])}(t).updateErrors,T=Object(o.useMemo)((function(){return n.documents.map((function(e,t){var n;return{schemaId:e.schemaId,action:e.action,errors:null!==(n=z[t])&&void 0!==n?n:[]}}))}),[n.documents,z]);Object(o.useEffect)((function(){if(O&&0!==v.documents.length){var e=v.documents.map((function(e){var t=O.find((function(t){return t.$id===e.schemaId}));return ke(e,t)}));L((function(t){return e.map((function(e,n){return t[n]?t[n]:e}))}))}}),[v,O]);var F=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Object(o.useRef)(e),r=n.current;if(e!==r)if(r.length!==e.length)n.current=e;else if(t)for(var c=Object(a.a)(e),i=0;i<r.length;i++){var u=c.indexOf(r[i]);if(-1===u){n.current=e;break}c[u]=fe}else for(var s=0;s<r.length;s++)if(r[s]!==e[s]){n.current=e;break}return n.current}(n.documents.reduce((function(e,t,n){return"send"===t.action&&e.push(n),e}),[]),!0);Object(o.useEffect)((function(){var e=F.flatMap((function(e){var t,n;return null!==(t=null===(n=z[e])||void 0===n?void 0:n.map((function(t){var n="documents[".concat(e,"].data.").concat(t.instancePath);return Object(j.a)(Object(j.a)({},t),{},{instancePath:n,dataPath:n})})))&&void 0!==t?t:[]}));u&&A(e)}),[u,z,F,A]);var H=Object(o.useCallback)((function(e,n){var a="function"===typeof n?n:function(){return n};null===m||void 0===m||m(Object(l.update)(Object(_.compose)(t,e),a))}),[m]),U=Object(o.useMemo)((function(){return Object(D.isPresent)(P.documentIndex)?n.documents[P.documentIndex]:void 0}),[n.documents,P.documentIndex]),W=Object(o.useCallback)((function(e){var t=null!==e&&void 0!==e?e:{};w((function(e){return e.documentIndex!==t.documentIndex||e.pageIndex!==t.pageIndex?t:e}))}),[]),Z=Object(o.useCallback)((function(e){var t=null===P||void 0===P?void 0:P.documentIndex;Object(D.isPresent)(t)&&H("documents[".concat(t,"]"),e)}),[null===P||void 0===P?void 0:P.documentIndex,H]),q=Object(D.isPresent)(P.documentIndex)?z[P.documentIndex]:void 0,Y=Object(o.useMemo)((function(){if(U&&q)return{document:U,errors:q}}),[U,q]),X=Object(o.useCallback)((function(e){var t=P.documentIndex;L((function(n){var a,r=U?{document:U,errors:n[t]}:void 0,c="function"===typeof e?e(r):e,o=Object(G.a)(null===c||void 0===c?void 0:c.errors,null===r||void 0===r?void 0:r.errors),i=Object(G.a)(null===c||void 0===c?void 0:c.document,null===r||void 0===r?void 0:r.document);if(o&&i)return n;var u=null===c||void 0===c?void 0:c.document;return u&&!i&&Z(u),Object(K.a)(t,null!==(a=null===c||void 0===c?void 0:c.errors)&&void 0!==a?a:[],n)}))}),[U,P.documentIndex,Z]),te=Object(o.useCallback)((function(e,t){var a=Object(J.a)({fileInfos:x,docs:n.documents},(function(n){var a=ge(e,n.fileInfos),r=function(e,t){var n,a=Object(N.a)(t);try{for(a.s();!(n=a.n()).done;){var r=n.value;if("loaded"===r.status)for(var c=r.pages,o=0;o<c.length;o++)if(c[o].pageIndex===e)return r.pageStates[o]}}catch(i){a.e(i)}finally{a.f()}}(e,n.fileInfos);if(a&&r){var c,o=[],i=[],u=[],s=[],l=r.documentIndex===(null===t||void 0===t?void 0:t.documentIndex),d=Object(N.a)(n.fileInfos);try{for(d.s();!(c=d.n()).done;){var b=c.value;if("loaded"===b.status)for(var j=0;j<b.pageStates.length;j++){var f=b.pageStates[j],v=f.documentOrder;Object(D.isPresent)(r.documentIndex)&&f.documentIndex===r.documentIndex&&(u[v]=f,o[v]=b.pages[j]),Object(D.isPresent)(t)&&f.documentIndex===t.documentIndex&&!l&&(s[v]=f,i[v]=b.pages[j])}}}catch(I){d.e(I)}finally{d.f()}var h=r.documentIndex;if(Object(D.isPresent)(h)){var O=n.docs[h];o.splice(r.documentOrder,1),u.splice(r.documentOrder,1),l?(o.splice(t.documentOrder,0,a),u.splice(t.documentOrder,0,r)):(r.documentIndex=void 0,r.documentOrder=void 0);for(var m=0;m<u.length;m++)u[m].documentOrder=m;O&&(O.pages=o.map((function(e){return{fileIndex:e.fileIndex,filePageNumber:e.filePageNumber}})))}if(Object(D.isPresent)(t)&&!l){var p=t.documentIndex,g=t.documentOrder,x=n.docs[p];i.splice(g,0,a),s.splice(g,0,r),r.documentIndex=p,r.documentOrder=g;for(var y=0;y<s.length;y++)s[y].documentOrder=y;x&&(x.pages=i.map((function(e){return{fileIndex:e.fileIndex,filePageNumber:e.filePageNumber}})))}}}));I(a.fileInfos),H("documents",a.docs)}),[n.documents,x,I,H]),ne=Object(o.useCallback)((function(e){return ge(e,x)}),[x]),oe=Object(o.useCallback)((function(e){if(Object(D.isPresent)(n.documents[e])){var t=Object(a.a)(n.documents);t.splice(e,1),setTimeout((function(){return H("documents",t)}),0),L((function(t){return Object($.a)(e,1,t)})),I((function(t){return Object(J.a)(t,(function(t){var n,a=Object(N.a)(t);try{for(a.s();!(n=a.n()).done;){var r=n.value;if("loaded"===r.status){var c,o=Object(N.a)(r.pageStates);try{for(o.s();!(c=o.n()).done;){var i=c.value;i.documentIndex===e&&(i.documentIndex=void 0,i.documentOrder=void 0)}}catch(u){o.e(u)}finally{o.f()}}}}catch(u){a.e(u)}finally{a.f()}}))})),w((function(t){return t.documentIndex===e?{}:t}))}}),[n.documents,I,H]),ie=Object(o.useCallback)((function(e){var t=n.documents.length,r=[].concat(Object(a.a)(n.documents),[e]);return H("documents",r),L((function(e){return[].concat(Object(a.a)(e),[[]])})),e.pages.length>0&&I((function(n){return Object(J.a)(n,(function(n){e.pages.forEach((function(e,a){var r=n[e.fileIndex];if("loaded"===(null===r||void 0===r?void 0:r.status)){var c=r.pageStates[e.filePageNumber];c&&(c.documentIndex=t,c.documentOrder=a)}}))}))})),t}),[n.documents,I,H]),ue=Object(o.useCallback)((function(e,t){var r=Object(a.a)(n.documents),c=r[e].schemaId,o=r[e].pages;r[e]=t,H("documents",r);var i=t.pages;if(o!==i&&I((function(t){return Object(J.a)(t,(function(t){var n,a=Object(N.a)(o.filter(D.isPresent));try{for(a.s();!(n=a.n()).done;){var r=n.value,c=t[r.fileIndex];if("loaded"===c.status){var u=c.pageStates[r.filePageNumber];u.documentIndex=void 0,u.documentOrder=void 0}}}catch(j){a.e(j)}finally{a.f()}for(var s=0;s<i.length;s++){var l=i[s];if(l){var d=t[l.fileIndex];if("loaded"===d.status){var b=d.pageStates[l.filePageNumber];b.documentIndex=e,b.documentOrder=s}}}}))})),c!==t.schemaId){var u=null===O||void 0===O?void 0:O.find((function(e){return e.$id===t.schemaId})),s=ke(t,u);L((function(t){return Object(K.a)(e,s,t)}))}return e}),[n.documents,O,I,H]),se=Object(o.useCallback)((function(e){return n.documents[e]}),[n.documents]),le=Object(o.useState)({}),ve=Object(f.a)(le,2),he=ve[0],Oe=ve[1],me=Object(o.useCallback)((function(e){var t=he[e];if(!t){var n=e.indexOf(",");if(!e.startsWith("data:")||-1===n)return e;if("image/tiff"===e.substring(5,n).split(";")[0]){var a=function(e){for(var t=atob(e.split(",")[1]),n=new ArrayBuffer(t.length),a=new Uint8Array(n),r=0;r<t.length;r++)a[r]=t.charCodeAt(r);return n}(e),r=new Q.a({buffer:a});t=r.toDataURL()}else t=e;Oe((function(n){return Object(j.a)(Object(j.a)({},n),{},Object(b.a)({},e,t))}))}return t}),[he]),xe=Object(o.useCallback)((function(e,t){var a=-1,r=-1;I((function(n){return Object(J.a)(n,(function(n){for(var c=n.length-1;c>=0;c--){var o=n[c];if("loaded"===o.status&&o.pageStartIndex<=e){for(var i=0;i<o.pages.length;i++){var u=o.pages[i];if(e===u.pageIndex){var s=o.pageStates[i];s.rotate=Pe(s.rotate,t),a=u.fileIndex,r=u.filePageNumber;break}}break}}}))})),a>-1&&r>-1&&H("documents",Object(J.a)(n.documents,(function(e){var n,c=null===(n=e[a])||void 0===n?void 0:n.pages[r];c&&we(c,t)})))}),[n.documents,I,H]),ye=Object(o.useCallback)((function(e){I((function(t){return Object(J.a)(t,(function(t){var n,a=Object(N.a)(t);try{for(a.s();!(n=a.n()).done;){var r=n.value;if("loaded"===r.status){var c,o=Object(N.a)(r.pageStates);try{for(o.s();!(c=o.n()).done;){var i=c.value;i.rotate=Pe(i.rotate,e)}}catch(u){o.e(u)}finally{o.f()}}}}catch(u){a.e(u)}finally{a.f()}}))})),H("documents",Object(J.a)(n.documents,(function(t){var n,a=Object(N.a)(t.flatMap((function(e){return e.pages})));try{for(a.s();!(n=a.n()).done;){var r=n.value;we(r,e)}}catch(c){a.e(c)}finally{a.f()}})))}),[n.documents,I,H]),Ie=Object(o.useMemo)((function(){return{fileInfos:x,documentSchemas:O,loadingImages:y,documentInfos:T,currentDocumentLocation:P,setCurrentDocumentLocation:W,currentDocument:U,updateCurrentDocument:Z,updateBatch:H,movePage:te,findByPageIndex:ne,deleteDocument:oe,addDocument:ie,updateDocument:ue,getDocument:se,currentDocumentEditionState:Y,setCurrentDocumentEditionState:X,canModify:u,getDisplayableDataUrl:me,rotateImage:xe,rotateAllImages:ye}}),[ie,u,U,Y,P,oe,T,O,x,me,se,ne,X,W,y,te,ye,xe,H,Z,ue]);return Object(h.jsx)(pe.Provider,{value:Ie,children:i})},Me=function(){return Object(o.useContext)(pe)},Ne=n(114),De=n(68),ze=n(925),Le=n(948),Ae=n(969),Te=n(133),Ee=n.n(Te),Re=n(208),Be=n.n(Re),Ve=n(260),Fe=n.n(Ve),He=n(614),Ue=n.n(He),_e=n(615),We=n.n(_e),Ge=n(33),Je=n(2470),Ke=n(671),$e=n(460),Ze=n.n($e),qe=n(147),Ye=n(2418),Qe=n(2434),Xe=n(2424),et=n(2423),tt=n(934),nt=n(928),at=n(959),rt=n(2416),ct=n(1922),ot=n(2469),it=n(193),ut=n(673),st=["saveAsDraft","send","dontSend"];Object.freeze(st);var lt,dt=n(139),bt=function e(t){var n={};if(t)for(var a=function(){var a=c[r];Array.isArray(t[a])?t[a].forEach((function(t,r){var c=n[a];Object(D.isPresent)(c)||(n[a]=c=[]),c[r]=e(t)})):"object"===typeof t[a]&&null!==t[a]?n[a]=e(t[a]):n[a]=!0},r=0,c=Object.keys(t);r<c.length;r++)a();return n},jt=["name","debounce","onChange","onBlur","helperText","error","disabled","controlValueAdapter"],ft=function(e){var t=e.name,n=e.debounce,a=e.onChange,r=e.onBlur,c=e.helperText,i=(e.error,e.disabled),u=e.controlValueAdapter,s=Object(M.a)(e,jt),l=Object(it.d)().isSubmitting,d=Object(it.c)({name:t}),b=Object(f.a)(d,3),v=b[0],O=b[1],m=b[2],p=O.error,g=O.touched&&!!p,x=Object(o.useState)(v.value),y=Object(f.a)(x,2),I=y[0],C=y[1],k=Object(o.useState)(),P=Object(f.a)(k,2),w=P[0],S=P[1];Object(o.useEffect)((function(){C(v.value)}),[v.value]);var N=Object(o.useCallback)((function(e){var t=e.target.value;m.setValue(u?u(t):t),null===a||void 0===a||a(e)}),[u,m,a]),z=Object(o.useCallback)((function(e){C((function(t){var n=e.target.value;return n||t})),Object(D.isPresent)(n)?(e.persist(),w&&clearTimeout(w),S(setTimeout((function(){return N(e)}),n))):N(e)}),[N,n,w]),L=Object(o.useCallback)((function(e){v.onBlur(e),null===r||void 0===r||r(e)}),[v,r]);return Object(h.jsx)(h.Fragment,{children:Object(h.jsx)(nt.a,Object(j.a)(Object(j.a)({},v),{},{value:null!==I&&void 0!==I?I:"",onChange:z,onBlur:L,error:g,helperText:g?p:c,disabled:null!==i&&void 0!==i?i:l},s))})},vt=n(1316),ht=["name","controlValueAdapter","onChange","onBlur","renderInput","multiple","loading","disabled"],Ot=function(e){var t,n=e.name,a=e.controlValueAdapter,r=e.onChange,c=e.onBlur,i=e.renderInput,u=e.multiple,s=e.loading,l=e.disabled,d=Object(M.a)(e,ht),b=Object(it.d)(),v=b.isSubmitting,O=b.setFieldTouched,m=Object(it.c)({name:n}),p=Object(f.a)(m,3),g=p[0],x=p[1],y=p[2],I=x.error,C=x.touched&&!!I,k=Object(o.useCallback)((function(e,t,n,c){var o=a?a(t):t;y.setValue(null!==o&&void 0!==o?o:void 0),null===r||void 0===r||r(e,t,n,c)}),[a,y,r]),P=Object(o.useCallback)((function(e){O(g.name),g.onBlur(e),null===c||void 0===c||c(e)}),[g,c,O]),w=Object(o.useCallback)((function(e){return i?i(Object(j.a)(Object(j.a)({},e),{},{error:C,helperText:C?I:void 0})):null}),[I,i,C]);return Object(h.jsx)(h.Fragment,{children:Object(h.jsx)(vt.a,Object(j.a)(Object(j.a)({},g),{},{value:null!==(t=g.value)&&void 0!==t?t:null,onChange:k,onBlur:P,renderInput:w,disabled:null!==l&&void 0!==l?l:v,loading:s||v,multiple:u},d))})},mt=Object(C.a)((function(e){return Object(k.a)({dialogPaper:{},dialogContent:{}})})),pt=function(e){var t=Object(W.a)().t,n=Me().documentSchemas,a=Object(o.useMemo)((function(){var e={};if(n){var t,a=Object(N.a)(n);try{for(a.s();!(t=a.n()).done;){var r,c=t.value;c.$id&&(e[c.$id]={label:null!==(r=c.title)&&void 0!==r?r:c.$id,description:c.description})}}catch(o){a.e(o)}finally{a.f()}}return e}),[n]),r=Object(o.useMemo)((function(){var e=Object.keys(a);return Object(ct.a)((function(e){return a[e].label}),e)}),[a]);return Object(h.jsxs)(rt.a,{container:!0,spacing:3,children:[Object(h.jsx)(rt.a,{item:!0,xs:12,children:Object(h.jsx)(Ot,{name:"schemaId",options:r,getOptionLabel:function(e){var t;return null===(t=a[e])||void 0===t?void 0:t.label},renderInput:function(e){return Object(h.jsx)(nt.a,Object(j.a)(Object(j.a)({},e),{},{label:t("DocumentType"),InputLabelProps:{required:!0},required:!0,autoFocus:!0}))},fullWidth:!0})}),Object(h.jsx)(rt.a,{item:!0,xs:12,children:Object(h.jsx)(ft,{name:"pages",label:t("Pages"),fullWidth:!0})}),Object(h.jsx)(rt.a,{item:!0,xs:12,children:Object(h.jsx)(ft,{select:!0,name:"action",label:t("Action"),fullWidth:!0,children:st.map((function(e){return Object(h.jsx)(at.a,{value:e,children:t("RecognizedDocumentAction.".concat(e))},e)}))})})]})},gt="(\\d+(\\s*-\\s*\\d+)?)",xt="^\\s*".concat(gt,"(\\s*,\\s*").concat(gt,")*\\s*$"),yt=new RegExp(xt),It=function(e){var t=e.open,n=e.document,r=e.availablePageIndices,c=e.onChange,i=e.onClose,u=Object(W.a)().t,s=mt(),l=Me(),d=l.documentSchemas,b=l.fileInfos,j=Object(o.useMemo)((function(){var e,t=n?function(e,t){return e.map((function(e){var n=t[e.fileIndex];return"loaded"===n.status?n.pages[e.filePageNumber].pageIndex:-1}))}(n.pages,b):r;return{schemaId:null===n||void 0===n?void 0:n.schemaId,pages:Ie(t),action:null!==(e=null===n||void 0===n?void 0:n.action)&&void 0!==e?e:"send"}}),[r,n,b]),f=Object(o.useRef)(),v=Object(o.useMemo)((function(){return function(e,t){return ut.a().shape({schemaId:ut.b().required().test({test:function(e){return!e||!("string"!==typeof e||!t.find((function(t){return t.$id===e})))||this.createError({path:this.path,message:Ge.a.t("UnknownDocumentSchema",{schemaId:e})})}}),pages:ut.b().test({test:function(t){if(!t)return!0;if("string"!==typeof t||!yt.test(t))return this.createError({path:this.path,message:Ge.a.t("InvalidPageRange",{range:t})});var n=xe(t),a=Object(ot.a)(n,e);return!(a.length>0)||(a.sort(),this.createError({path:this.path,message:Ge.a.t("PagesAlreadyUsedInOtherDocuments",{pages:a.map((function(e){return e+1})).join(", ")})}))}}),action:ut.b().required().oneOf(Object(a.a)(st))})}(r,null!==d&&void 0!==d?d:[])}),[r,d]),O=Object(o.useCallback)((function(){var e=f.current;e&&function(e){e.validateForm().then((function(t){Object.keys(t).length>0?e.setTouched(bt(t)):e.handleSubmit()}))}(e)}),[]),m=Object(o.useCallback)(function(){var e=Object(R.a)(E.a.mark((function e(t,a){var r,o;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{r={schemaId:t.schemaId,pages:[],data:null===n||void 0===n?void 0:n.data,action:t.action},t.pages&&(o=xe(t.pages),r.pages=Ce(o,b)),null===c||void 0===c||c(r),null===i||void 0===i||i()}finally{a.setSubmitting(!1)}case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),[null===n||void 0===n?void 0:n.data,b,c,i]),p=Object(o.useCallback)((function(){null===i||void 0===i||i()}),[i]),g=Object(o.useCallback)(function(){var e=Object(R.a)(E.a.mark((function e(t,n){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"backdropClick"!==n&&(null===i||void 0===i||i());case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),[i]);return Object(h.jsxs)(Ye.a,{open:t,onClose:g,maxWidth:"sm",fullWidth:!0,classes:{paper:s.dialogPaper},children:[Object(h.jsx)(et.a,{children:u(n?"EditingDocument":"AddingDocument")}),Object(h.jsx)(Xe.a,{className:s.dialogContent,children:Object(h.jsx)(dt.a,{children:Object(h.jsx)(it.b,{innerRef:function(e){return f.current=e},initialValues:j,onSubmit:m,validationSchema:v,validateOnChange:!0,validateOnBlur:!0,children:Object(h.jsx)(it.a,{autoComplete:"off",children:Object(h.jsx)(pt,{availablePageIndices:r})})})})}),Object(h.jsxs)(Qe.a,{children:[Object(h.jsx)(tt.a,{onClick:O,color:"primary",children:u("Accept")}),Object(h.jsx)(tt.a,{onClick:p,color:"primary",children:u("Cancel")})]})]})},Ct=n(2413),kt=function(e){return Object(h.jsxs)(Ct.a,Object(j.a)(Object(j.a)({viewBox:"0 0 1000 1000"},e),{},{children:[Object(h.jsx)("path",{d:"M808.3 950h-725C42.9 950 10 917.1 10 876.7V171.6c0-40.4 32.9-73.3 73.3-73.3h502.1c18.6 0 33.6 15.1 33.6 33.6 0 18.6-15.1 33.6-33.6 33.6H83.3c-3.4 0-6.1 2.7-6.1 6.1v705.1c0 3.4 2.7 6.1 6.1 6.1h724.9c3.4 0 6.1-2.7 6.1-6.1V492c0-18.6 15-33.6 33.6-33.6s33.6 15.1 33.6 33.6v384.7c.1 40.4-32.8 73.3-73.2 73.3z"}),Object(h.jsx)("path",{d:"M307.3 781.2c-16.1 0-31.1-8.1-40.1-21.7-8.9-13.5-10.5-30.4-4.1-45.3l83.4-196.8 431-431C801 62.9 832.3 50 865.5 50s64.5 13 88 36.5c48.5 48.6 48.5 127.5 0 176.1l-431 431-196.3 83.8c-6 2.5-12.4 3.8-18.9 3.8zm96-225.5-59.8 141.1 140.8-60.1L906 215c22.3-22.3 22.3-58.7 0-81-10.8-10.8-25.2-16.8-40.5-16.8s-29.7 6-40.5 16.8L403.3 555.7z"}),Object(h.jsx)("path",{d:"M398.4 502.3 530 633.8l-47.5 47.5-131.6-131.5 47.5-47.5zM800.2 100.5 931.8 232l-47.5 47.5L752.7 148l47.5-47.5z"})]}))},Pt=n(212),wt=Object(C.a)((function(e){return Object(k.a)({toolbar:{minHeight:"48px",paddingLeft:0,borderBottom:"solid 2px ".concat(e.palette.divider)},tree:{"& .rst__collapseButton":{backgroundColor:"dark"===e.palette.type?e.palette.background.paper:void 0,backgroundImage:"dark"===e.palette.type?"url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCI+PGNpcmNsZSBjeD0iOSIgY3k9IjkiIHI9IjgiIGZpbGw9Im5vbmUiLz48ZyBzdHJva2U9IiNGRkYiIHN0cm9rZS13aWR0aD0iMS45IiA+PHBhdGggZD0iTTQuNSA5aDkiLz48L2c+Cjwvc3ZnPg==)":void 0},"& .rst__expandButton":{backgroundColor:"dark"===e.palette.type?e.palette.background.paper:void 0,backgroundImage:"dark"===e.palette.type?"url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCI+PGNpcmNsZSBjeD0iOSIgY3k9IjkiIHI9IjgiIGZpbGw9Im5vbmUiLz48ZyBzdHJva2U9IiNGRkYiIHN0cm9rZS13aWR0aD0iMS45IiA+PHBhdGggZD0iTTQuNSA5aDkiLz48cGF0aCBkPSJNOSA0LjV2OSIvPjwvZz4KPC9zdmc+)":void 0},"& .rst__collapseButton:focus, & .rst__expandButton:focus":{boxShadow:"dark"===e.palette.type?"0 0 0 1px #000":void 0,outline:"initial"}},node:{"& .rst__rowContents":{cursor:"pointer",backgroundColor:e.palette.background.default},"& .rst__moveHandle":{backgroundColor:"dark"===e.palette.type?e.palette.background.paper:void 0}},selectedNode:{"& .rst__rowContents":{backgroundColor:e.palette.action.selected}},actionIcon:{marginLeft:5,verticalAlign:"bottom"},sendActionIcon:{marginLeft:5,color:Ze.a[500],verticalAlign:"bottom"},documentWithErrors:{textDecoration:"underline wavy ".concat(e.palette.error.main)}})})),St=function(e){return!!e&&Object(D.isPresent)(e.documentIndex)&&!Object(D.isPresent)(e.pageIndex)},Mt=function(e){return!!e&&!Object(D.isPresent)(e.documentIndex)&&!Object(D.isPresent)(e.pageIndex)},Nt=function(e){return!!e&&Object(D.isPresent)(e.pageIndex)},Dt=function(e){var t=e.node;return Nt(t)?"p-".concat(t.pageIndex):St(t)?"d-".concat(t.documentIndex):"o"},zt=function(e){return!Nt(e)},Lt=function(e){return Nt(e.node)},At=function(e){var t=e.node,n=e.nextParent,a=t;return!!n&&(!!Object(D.isPresent)(a.documentIndex)||!Mt(n))},Tt=function(){var e=Me(),t=e.documentSchemas,n=e.fileInfos,r=e.documentInfos,c=e.canModify,i=e.setCurrentDocumentLocation,u=Object(o.useState)([]),s=Object(f.a)(u,2),l=s[0],d=s[1];return Object(o.useEffect)((function(){d((function(e){var o=c?function(e,t,n){var r,c=[],o=[],i=Object(N.a)(e);try{var u=function(){var e=r.value;if("loaded"!==e.status)return"continue";e.pages.forEach((function(t,n){var a=e.pageStates[n],r=Ge.a.t("PageN",{index:t.pageIndex+1}),i=a.documentIndex,u={title:r,pageIndex:t.pageIndex,documentIndex:i};if(Object(D.isPresent)(i)&&Object(D.isPresent)(a.documentOrder)){var s=o[i];s||(o[i]=s=[]),s[a.documentOrder]=u}else c.push(u)}))};for(i.s();!(r=i.n()).done;)u()}catch(s){i.e(s)}finally{i.f()}return[].concat(Object(a.a)(o.map((function(e,a){var r=Ge.a.t("DocumentN",{index:a+1}),c=t[a].schemaId;if(c){var o=null===n||void 0===n?void 0:n.find((function(e){return e.$id===c}));if(o){var i=o.title;if(!i){var u=c.lastIndexOf("/");(i=c.substring(u+1)).toLocaleLowerCase().endsWith(".json")&&(i=i.substring(0,i.length-5))}r="".concat(a+1," - ").concat(i)}}return{documentIndex:a,title:r,action:t[a].action,errors:t[a].errors,children:null!==e&&void 0!==e?e:[]}}))),[{title:Ge.a.t("OrphanPages"),children:c}])}(n,r,t):function(e,t){return e.map((function(n,a){var r=Ge.a.t("DocumentN",{index:a+1}),c=e[a].schemaId;if(c){var o=null===t||void 0===t?void 0:t.find((function(e){return e.$id===c}));if(o){var i=o.title;if(!i){var u=c.lastIndexOf("/");(i=c.substring(u+1)).toLocaleLowerCase().endsWith(".json")&&(i=i.substring(0,i.length-5))}r="".concat(a+1," - ").concat(i)}}return{documentIndex:a,title:r,action:e[a].action,errors:e[a].errors,children:[]}}))}(r,t);if(e.length>0){for(var i=0;i<Math.min(o.length,e.length-1);i++)o[i].expanded=e[i].expanded;o[o.length-1].expanded=e[e.length-1].expanded}return o}))}),[c,r,t,n,i]),{treeData:l,setTreeData:d}},Et=function(e){var t=e.node,n=Object(W.a)().t,a=wt(),r="send"===t.action?Object(h.jsx)(Ue.a,{className:a.sendActionIcon}):"dontSend"===t.action?Object(h.jsx)(We.a,{className:a.actionIcon,color:"error"}):Object(h.jsx)(kt,{className:a.actionIcon});return Object(h.jsx)(Le.a,{title:n("RecognizedDocumentAction.".concat(t.action)),children:Object(h.jsx)("span",{children:r})})},Rt=function(e){var t=e.node,n=e.canModify,a=wt(),r="send"===t.action&&t.errors.length>0&&n?a.documentWithErrors:void 0;return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("span",{className:r,children:t.title}),Object(h.jsx)(Et,{node:t})]})},Bt=function(e){var t=e.description,n=e.onClick,a=e.icon;return Object(h.jsx)(Le.a,{title:t,children:Object(h.jsx)(ze.a,{size:"small",onClick:n,children:a})})},Vt=function(e){var t=e.node,n=e.unusedPageIndices,r=Object(W.a)().t,c=Object(o.useState)(),i=Object(f.a)(c,2),u=i[0],s=i[1],l=Me(),d=l.updateDocument,b=l.getDocument,j=l.fileInfos,v=Object(o.useMemo)((function(){var e=n;if(Object(D.isPresent)(u)){var t=b(u).pages.map((function(e){var t=j[e.fileIndex];if("loaded"===t.status)return t.pages[e.filePageNumber].pageIndex})).filter(D.isPresent);t.push.apply(t,Object(a.a)(e)),e=t.sort()}return e}),[u,j,b,n]),O=Object(o.useCallback)((function(e,t){s(t)}),[]),m=Object(o.useCallback)((function(e){b(u).schemaId!==e.schemaId&&(e.data={}),d(u,e)}),[u,b,d]);return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(Bt,{description:r("Edit"),icon:Object(h.jsx)(Fe.a,{}),onClick:function(e){return O(e,t.documentIndex)}}),Object(D.isPresent)(u)&&Object(h.jsx)(It,{open:Object(D.isPresent)(u),document:b(u),availablePageIndices:v,onChange:m,onClose:function(){return s(void 0)}})]})},Ft=function(e){var t=e.node,n=Object(W.a)().t,a=Object(qe.c)(),r=Me().deleteDocument,c=Object(o.useCallback)(function(){var e=Object(R.a)(E.a.mark((function e(t,c,o){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.stopPropagation(),e.next=3,a({description:n("ConfirmDeleteBatchDocument",{name:o})});case 3:if(e.sent){e.next=6;break}return e.abrupt("return");case 6:r(c);case 7:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),[a,r,n]);return Object(h.jsx)(Bt,{description:n("Delete"),icon:Object(h.jsx)(Ee.a,{}),onClick:function(e){return c(e,t.documentIndex,t.title)}})},Ht=function(e){var t=e.unusedPageIndices,n=Object(W.a)().t,a=Object(o.useState)(!1),r=Object(f.a)(a,2),c=r[0],i=r[1],u=Me(),s=u.setCurrentDocumentLocation,l=u.addDocument,d=Object(o.useCallback)((function(){i(!0)}),[]),b=Object(o.useCallback)((function(e){e.data={};var t=l(e);s({documentIndex:t})}),[l,s]);return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(Le.a,{title:n("AddDocument"),children:Object(h.jsx)(ze.a,{onClick:d,size:"small",children:Object(h.jsx)(Be.a,{})})}),c&&Object(h.jsx)(It,{open:c,availablePageIndices:t,onChange:b,onClose:function(){return i(!1)}})]})},Ut=function(e){var t=wt(),n=Me(),a=n.fileInfos,r=n.loadingImages,c=n.movePage,i=n.currentDocumentLocation,u=n.setCurrentDocumentLocation,s=n.canModify,l=Tt(),d=l.treeData,f=l.setTreeData;Object(o.useEffect)((function(){if(!r&&s&&i&&Object(D.isPresent)(i.documentIndex)&&!Object(D.isPresent)(i.pageIndex)){var e,t=Object(N.a)(d);try{for(t.s();!(e=t.n()).done;){var n=e.value;if(St(n)&&n.documentIndex===i.documentIndex&&Array.isArray(n.children)){var a=n.children[0];Nt(a)&&u(Object(j.a)(Object(j.a)({},i),{},{pageIndex:a.pageIndex}))}}}catch(c){t.e(c)}finally{t.f()}}}),[s,i,r,u,d]);var v=Object(o.useMemo)((function(){return a.flatMap((function(e){var t=[];return"loaded"===e.status&&e.pageStates.forEach((function(n,a){Object(D.isPresent)(n.documentOrder)||t.push(e.pages[a].pageIndex)})),t}))}),[a]),O=Object(o.useCallback)((function(e){!function(e){var t=e[e.length-1],n=t.children;Mt(t)&&Array.isArray(n)&&n.sort(Object(Je.a)((function(e,t){return e.pageIndex<t.pageIndex})))}(e),f(e)}),[f]),m=Object(o.useCallback)((function(e){var t=e.node,n=e.nextParentNode,a=e.prevTreeIndex,r=e.nextTreeIndex;if(n&&a!==r){var o=t,i=n;if(!Mt(i)||Object(D.isPresent)(o.documentIndex))if(St(i)){var u=i.documentIndex,s=i.children.findIndex((function(e){return e.pageIndex===o.pageIndex}));c(o.pageIndex,{documentIndex:u,documentOrder:s})}else Mt(i)&&c(o.pageIndex)}}),[c]),p=Object(o.useCallback)((function(e,t){var n,a,r=e.target;if(!0!==(null===(n=r.classList)||void 0===n?void 0:n.contains("rst__collapseButton"))&&!0!==(null===(a=r.classList)||void 0===a?void 0:a.contains("rst__expandButton"))){var c=t,o=c.pageIndex;Object(D.isPresent)(o)||!Array.isArray(c.children)||Object(Pt.isEmpty)(c.children)||(o=c.children[0].pageIndex),u({documentIndex:c.documentIndex,pageIndex:o})}}),[u]),g=Object(o.useCallback)((function(e){var n=e.node,a=i&&n.documentIndex===i.documentIndex&&(St(n)||n.pageIndex===i.pageIndex),r={onClick:function(t){return p(t,e.node)},className:Object(De.default)(t.node,Object(b.a)({},t.selectedNode,a))};if(St(n)){if(s){var c=Object(h.jsx)(Vt,{node:n,unusedPageIndices:v}),o=Object(h.jsx)(Ft,{node:n});r.buttons=[c,o]}r.title=function(){return Object(h.jsx)(Rt,{node:n,canModify:s})}}return r}),[s,t.node,t.selectedNode,i,p,v]);return r?null:Object(h.jsxs)(h.Fragment,{children:[s&&Object(h.jsx)(Ae.a,{className:t.toolbar,children:Object(h.jsx)(Ht,{unusedPageIndices:v})}),Object(h.jsx)(Ke.a,{treeData:d,onChange:O,onMoveNode:m,getNodeKey:Dt,canDrag:Lt,canDrop:At,canNodeHaveChildren:zt,isVirtualized:!1,generateNodeProps:g,className:t.tree})]})},_t=n(930),Wt=n(933),Gt=n(2428),Jt=n(38),Kt=function(e){return Object(h.jsx)(Ct.a,Object(j.a)(Object(j.a)({viewBox:"0 0 512 512"},e),{},{children:Object(h.jsx)("path",{d:"M9.5 1.4C2.3 4.6 0 9.7 0 22.6V32h32V0h-9.7c-5.9.1-11 .6-12.8 1.4zM62 16v16h29V0H62v16zM121 16v16h29V0h-29v16zM180 16v16h29V0h-29v16zM239 16v16h29V0h-29v16zM298 16v16h29V0h-29v16zM357 16v16h29V0h-29v16zM416 15.9V32h32.2l-.4-10.9c-.2-9.2-.6-11.4-2.4-13.7-4.4-6-6.7-6.9-18.5-7.2L416-.2v16.1zM0 76.5V91h32V62H0v14.5zM416 76.5V91h32V62h-32v14.5zM0 135.5V150h32v-29H0v14.5zM416 135.5V150h32v-29h-32v14.5zM0 194.5V209h32v-29H0v14.5zM416 194.5V209h32v-29h-32v14.5zM297.5 225.4c-4.1 1.8-8.3 6.9-9 10.9-.3 1.8-.4 62.2-.3 134.4.3 130.7.3 131.2 2.4 133.9 4.9 6.7 13 9.1 19.5 6 1.9-.9 20.5-15.3 41.4-32.1l38-30.4 54.8-.1c59.9 0 58.9.1 64-5.9 3-3.7 4.2-8.5 3.2-13.9-.6-3.3-11.6-14.6-99.3-102.6-57.7-57.7-100-99.4-101.9-100.2-4-1.7-8.9-1.7-12.8 0zM417.7 416l-39.4.5-3.9 3c-2.1 1.6-15 11.8-28.6 22.7-13.6 10.9-25 19.8-25.3 19.8-.3 0-.5-41.3-.5-91.7v-91.8l68.5 68.5 68.5 68.5-39.3.5zM0 253.5V268h32v-29H0v14.5zM416 253.5V268h32v-29h-32v14.5zM0 312.5V327h32v-29H0v14.5zM0 371.5V386h32v-29H0v14.5zM.2 426.9c.3 11.8 1.2 14.1 7.2 18.5 2.3 1.8 4.5 2.2 13.7 2.4l10.9.4V416H-.2l.4 10.9zM62 432v16h29v-32H62v16zM121 432v16h29v-32h-29v16zM180 432v16h29v-32h-29v16z"})}))},$t=n(297),Zt=n.n($t),qt=function(){throw new Error("You forgot to wrap your component in <ImageCaptureContextProvider>.")},Yt={captureAvailable:!1,captureImage:qt,setCurrentCropper:qt},Qt=Object(o.createContext)(Yt),Xt=function(e){var t=e.outputImageFormat,n=e.children,a=Object(o.useState)(),r=Object(f.a)(a,2),c=r[0],i=r[1],u=Object(o.useCallback)((function(){if(c){var e=function(e,t){if("image/tiff"===t){var n=e.getContext("2d").getImageData(0,0,e.width,e.height),a=new Uint8Array(n.data.buffer),r=Zt.a.encodeImage(a,n.width,n.height);return he(r,"image/tiff")}return e.toDataURL()}(c.getCroppedCanvas(),t);return c.clear(),i(void 0),e}}),[c,t]),s=Object(o.useMemo)((function(){return{captureAvailable:!!c,captureImage:u,setCurrentCropper:i}}),[u,c]);return Object(h.jsx)(Qt.Provider,{value:s,children:n})},en=function(){return Object(o.useContext)(Qt)},tn=Object(C.a)((function(e){return Object(k.a)({image:{marginTop:e.spacing(2),width:"max-content",maxWidth:"100%"},imagePlaceholder:{marginTop:e.spacing(6),height:50},imageActions:{marginLeft:-10}})})),nn=Object(d.withJsonFormsControlProps)((function(e){var t=e.uischema,n=e.config,a=e.id,r=e.data,c=e.visible,i=e.errors,s=e.label,d=e.required,b=e.description,j=e.path,f=e.handleChange,v=Object(W.a)().t,O=tn(),m=0===i.length,p=Object(Pt.merge)({},n,t.options),g=!Object(l.isDescriptionHidden)(c,null!==b&&void 0!==b?b:"",!1,p.showUnfocusedDescription),x=Me().getDisplayableDataUrl,y=en(),I=y.captureAvailable,C=y.captureImage,k=Object(o.useCallback)((function(){if(I){var e=C();f(j,e)}}),[I,C,f,j]),P=Object(o.useCallback)((function(){f(j,void 0)}),[f,j]),w=g?b:m?null:i,S=g&&!m?i:null;return Object(h.jsx)(u.a,{xsUp:!c,children:Object(h.jsxs)(_t.a,{fullWidth:!p.trim,id:a,children:[Object(h.jsx)(Gt.a,{htmlFor:a+"-input",error:!m,shrink:"string"===typeof r,children:Object(l.computeLabel)(Object(l.isPlainLabel)(s)?s:s.default,!!d,p.hideRequiredAsterisk)}),Object(h.jsxs)("div",{children:["string"===typeof r&&Object(h.jsx)("img",{src:x(r),alt:"",className:O.image}),"string"!==typeof r&&Object(h.jsx)("img",{src:"".concat(Object(Jt.a)(),"images/image-placeholder.png"),alt:"placeholder",className:O.imagePlaceholder})]}),Object(h.jsxs)("div",{className:O.imageActions,children:[Object(h.jsx)(Le.a,{title:v("CaptureCurrentSelection"),children:Object(h.jsx)("span",{children:Object(h.jsx)(ze.a,{onClick:k,disabled:!I,children:Object(h.jsx)(Kt,{})})})}),Object(h.jsx)(Le.a,{title:v("Delete"),children:Object(h.jsx)(ze.a,{onClick:P,children:Object(h.jsx)(Ee.a,{})})})]}),Object(h.jsx)(Wt.a,{error:!m&&!g,children:w}),Object(h.jsx)(Wt.a,{error:!m,children:S})]})})})),an=Object(l.rankWith)(4,Object(l.and)(l.isControl,(function(e,t){var n=l.Resolve.schema(t,e.scope);return n&&"string"===n.type&&"image"===n.format}))),rn=n(674),cn=n(98),on=n.n(cn),un=n(136),sn=n(929),ln=n(947),dn=n(449),bn=n.n(dn),jn=(lt=sn.a,Object(rn.a)((function(e){return Object(h.jsx)(lt,Object(j.a)({},e))}))),fn=i.a.memo((function(e){var t,n,a,r,c=Object(o.useState)(!1),i=Object(f.a)(c,2),u=i[0],s=i[1],l=e.data,d=e.config,b=e.className,j=e.id,v=e.enabled,O=e.uischema,m=e.isValid,p=e.path,g=e.handleChange,x=e.schema,y=e.muiInputProps,I=x.maxLength,C=on()({},d,O.options);r=C.restrict?{maxLength:I}:{};var k=Object(o.useMemo)((function(){return x.patternMask}),[x]);r=on()(r,y),C.trim&&void 0!==I&&(r.size=I);var P=Object(un.a)(),w=(null===(t=P.jsonforms)||void 0===t||null===(n=t.input)||void 0===n||null===(a=n.delete)||void 0===a?void 0:a.background)||P.palette.background.default,S=Object(o.useCallback)((function(e){g(p,e)}),[g,p]);return Object(h.jsx)(jn,{mask:k,onAccept:S,type:"text",className:b,id:j,value:l,disabled:!v,autoFocus:C.focus,multiline:C.multi,fullWidth:!C.trim||void 0===I,inputProps:r,error:!m,onPointerEnter:function(){return s(!0)},onPointerLeave:function(){return s(!1)},endAdornment:Object(h.jsx)(ln.a,{position:"end",style:{display:u&&v&&void 0!==l?"flex":"none",position:"absolute",right:0},children:Object(h.jsx)(ze.a,{"aria-label":"Clear input field",onClick:function(){return g(p,void 0)},children:Object(h.jsx)(bn.a,{style:{background:w,borderRadius:"50%"}})})})})}),d.areEqual),vn=Object(d.withJsonFormsControlProps)((function(e){return Object(h.jsx)(r.MaterialInputControl,Object(j.a)(Object(j.a)({},e),{},{input:fn}))})),hn=Object(l.rankWith)(4,Object(l.and)(l.isControl,(function(e,t){var n=l.Resolve.schema(t,e.scope);return n&&"string"===n.type&&"string"===typeof n.patternMask}))),On=Object(C.a)((function(e){return Object(k.a)({content:{maxHeight:"100%",width:"99%",overflowY:"auto",overflowX:"visible"}})})),mn=function(e){var t,n=Me(),r=n.documentSchemas,c=n.currentDocument,i=n.currentDocumentEditionState,u=n.setCurrentDocumentEditionState,s=n.canModify,l=n.updateCurrentDocument,b=On(),f=Object(W.a)().t,v=Object(o.useRef)(null===i||void 0===i?void 0:i.document.data),O=Object(o.useRef)(!1);Object(o.useMemo)((function(){v.current=null===i||void 0===i?void 0:i.document.data}),[null===i||void 0===i?void 0:i.document.data]);var m=Object(o.useMemo)((function(){var e={};if(r){var t,n=Object(N.a)(r);try{for(n.s();!(t=n.n()).done;){var a,c=t.value;c.$id&&(e[c.$id]={label:null!==(a=c.title)&&void 0!==a?a:c.$id,description:c.description})}}catch(o){n.e(o)}finally{n.f()}}return e}),[r]),p=Object(o.useMemo)((function(){var e=Object.keys(m);return Object(ct.a)((function(e){return m[e].label}),e)}),[m]),g=Object(o.useMemo)((function(){return[].concat(Object(a.a)(tr),[{tester:an,renderer:nn},{tester:hn,renderer:vn}])}),[]),x=Object(o.useCallback)((function(e){O.current=!!e.errors&&e.errors.length>0;var t=O.current?Object(je.a)(e.errors.map((function(e){return Object(j.a)(Object(j.a)({},e),{},{instancePath:e.dataPath})}))):void 0;O.current||v.current===e.data||(v.current=e.data,O.current=!1),u((function(n){var a,r;return Object(G.a)(e.data,null===n||void 0===n?void 0:n.document)&&Object(G.a)(t,null===n||void 0===n?void 0:n.errors)?n:{document:Object(j.a)(Object(j.a)({},n.document),{},{data:null!==(a=e.data)&&void 0!==a?a:null===n||void 0===n||null===(r=n.document)||void 0===r?void 0:r.data}),errors:t}}))}),[u]),y=Object(o.useCallback)((function(e){var t=Object(j.a)(Object(j.a)({},c),{},{action:e.target.value});l(t)}),[c,l]),I=Object(o.useCallback)((function(e,t){if(t&&(null===c||void 0===c?void 0:c.schemaId)!==t){var n=Object(j.a)(Object(j.a)({},c),{},{schemaId:t,data:{}});l(n)}}),[c,l]);if(!(null===i||void 0===i?void 0:i.document))return null;var C=null===r||void 0===r?void 0:r.find((function(e){return e.$id===(null===i||void 0===i?void 0:i.document.schemaId)}));return Object(h.jsxs)(rt.a,{container:!0,spacing:1,className:b.content,children:[Object(h.jsx)(rt.a,{item:!0,xs:12,children:Object(h.jsx)(vt.a,{value:null===c||void 0===c?void 0:c.schemaId,options:p,onChange:I,getOptionLabel:function(e){var t;return null===(t=m[e])||void 0===t?void 0:t.label},disableClearable:!0,renderInput:function(e){return Object(h.jsx)(nt.a,Object(j.a)(Object(j.a)({},e),{},{label:f("DocumentType"),InputLabelProps:{required:!0},required:!0,autoFocus:!0}))},fullWidth:!0})}),Object(h.jsx)(rt.a,{item:!0,xs:12,children:Object(h.jsx)(nt.a,{select:!0,value:null===c||void 0===c?void 0:c.action,onChange:y,label:f("Action"),fullWidth:!0,children:st.map((function(e){return Object(h.jsx)(at.a,{value:e,children:f("RecognizedDocumentAction.".concat(e))},e)}))})}),Object(h.jsx)(rt.a,{item:!0,xs:12,children:Object(h.jsx)(d.JsonForms,{data:null!==(t=null===i||void 0===i?void 0:i.document.data)&&void 0!==t?t:{},schema:C,onChange:x,renderers:g,cells:nr,ajv:ve,readonly:!s||"dontSend"===(null===i||void 0===i?void 0:i.document.action)})})]})},pn=n(2433),gn=n(2438),xn=n(926),yn=n(616),In=n.n(yn),Cn=n(2496),kn=n(299),Pn=n.n(kn),wn=n(2489),Sn=n(617),Mn=n.n(Sn),Nn=n(1972),Dn=[n(339)],zn=Object(Nn.a)((function(e){return e[0]}),Object(wn.a)((function(e){return e.$id}),Dn)),Ln={resolve:{nimflow:{order:1,canRead:function(e){return!!zn[e.url]},read:function(e){return Object(v.a)(["$id"],zn[e.url])}}}},An=function(e){return Mn.a.dereference(e,Ln)},Tn=function(e){return function(e){return"object"===typeof e&&"then"in e}(e)?e:Promise.resolve(e)},En=Object(C.a)((function(e){return Object(k.a)({dialogPaper:{height:"90vh"},dialogContent:{display:"grid",gridTemplateColumns:"auto ".concat(400,"px"),gridTemplateRows:"auto",rowGap:"5px",height:"100%",overflowY:"hidden"},imagePane:{gridRow:"1 / 2",gridColumn:"1 / 2",overflow:"auto"},listPane:{gridRow:"1 / 2",gridColumn:"2 / 3",overflow:"auto",borderLeft:"solid 2px ".concat(e.palette.divider),paddingLeft:10},cropper:{height:"100%",width:"100%"},cropperDisabled:{"& .cropper-crop-box":{display:"none"},"& .cropper-drag-box":{opacity:0}},imageItem:{width:"100%",position:"relative"},imageTitle:{textDecoration:"underline"},image:{maxWidth:"100%",marginTop:10,marginBottom:10},imagePlaceholder:{marginTop:10,height:50},imageActions:{marginLeft:-10},deleteButton:{},grow:{flexGrow:1},degreesEdit:{marginLeft:20,width:"5em"}})})),Rn=function(e){var t=null===e||void 0===e?void 0:e.current;return null===t||void 0===t?void 0:t.cropper},Bn=function e(t,n,r,c,o,i){if("string"!==n.type||"image"!==n.format){if(!(i.includes(t)||"array"!==n.type&&"object"!==n.type))if("array"===n.type&&Array.isArray(t)&&"object"===typeof n.items){var u;if(Array.isArray(n.items)){var s=n.items.filter(F.b);if(1!==s.length)return;u=s[0]}else u=n.items;i.push(t);for(var l=0;l<t.length;l++)try{c.push(l),o.push(l.toString()),e(t[l],u,r,c,o,i)}finally{c.pop(),o.pop()}}else if("object"===n.type&&(Object(F.b)(t)||!Object(D.isPresent)(t))){if(t){i.push(t);for(var d=0,b=Object.entries(t);d<b.length;d++){var j,v,h=Object(f.a)(b[d],2),O=h[0],m=h[1],p=null!==(j=null===(v=n.properties)||void 0===v?void 0:v[O])&&void 0!==j?j:n.additionalProperties;if("object"===typeof p)try{var g;c.push(O),o.push(null!==(g=p.title)&&void 0!==g?g:O),e(m,p,r,c,o,i)}finally{c.pop(),o.pop()}}}if(n.properties)for(var x=0,y=Object.entries(n.properties);x<y.length;x++){var I=Object(f.a)(y[x],2),C=I[0],k=I[1];if("object"===typeof k&&(!t||!(C in t)))try{var P;c.push(C),o.push(null!==(P=k.title)&&void 0!==P?P:C),e(void 0,k,r,c,o,i)}finally{c.pop(),o.pop()}}}}else{var w=c.map((function(e){return e.toString()})).join(".");if(-1===r.findIndex((function(e){return e.id===w}))){var S=o.join(" -> ");r.push({id:w,path:Object(a.a)(c),title:S,value:t,originalValue:t})}}},Vn=function(e,t){var n=[];return Bn(e,t,n,[],[],[]),n},Fn=function(e,t){Object(D.isPresent)(t.value)&&!e&&(e={});for(var n=e,a=0;a<t.path.length-1;a++){var r=t.path[a],c=n[r];if(!n){if(!t.value)return e;n[r]=c={}}n=c}if(Object(D.isPresent)(n)){var o=t.path[t.path.length-1];Object(D.isPresent)(t.value)?n[o]=t.value:delete n[o]}return e},Hn=function(e){var t=e.open,n=e.pageIndex,r=e.onClose,c=e.outputImageFormat,i=Me(),u=i.findByPageIndex,s=i.getDisplayableDataUrl,l=Object(W.a)().t,d=En(),b=Object(o.useState)(180),v=Object(f.a)(b,2),O=v[0],m=v[1],p=Object(o.useRef)(null),g=Object(o.useState)(!1),x=Object(f.a)(g,2),y=x[0],I=x[1],C=function(){var e=Me(),t=e.documentSchemas,n=e.currentDocumentEditionState,r=e.setCurrentDocumentEditionState,c=Object(o.useState)([]),i=Object(f.a)(c,2),u=i[0],s=i[1];Object(B.a)(["documentSchema/".concat(null===n||void 0===n?void 0:n.document.schemaId),document],Object(R.a)(E.a.mark((function e(){var a,r,c,o,i;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=null===n||void 0===n?void 0:n.document.schemaId,r=null===t||void 0===t?void 0:t.find((function(e){return e.$id===a}))){e.next=4;break}return e.abrupt("return",void 0);case 4:return e.next=6,An(r);case 6:return c=e.sent,o=In()(c,{ignoreAdditionalProperties:!0}),i=Vn(null===n||void 0===n?void 0:n.document.data,o),s(i),e.abrupt("return",o);case 11:case"end":return e.stop()}}),e)}))),{revalidateOnFocus:!1});var l=Object(o.useCallback)((function(e,t){s((function(n){var r=Object(a.a)(n);return r[t]=Object(j.a)(Object(j.a)({},n[t]),{},{value:e}),r}))}),[s]),d=Object(o.useCallback)((function(e){s((function(t){var n,r=Object(a.a)(t);return null===(n=r[e])||void 0===n||delete n.value,r}))}),[s]),b=Object(o.useCallback)((function(){var e=u.filter((function(e){return e.originalValue!==e.value}));r((function(t){if(e.length>0&&t.document){var n=Object(J.a)(t.document.data,(function(t){var n,a=Object(N.a)(e);try{for(a.s();!(n=a.n()).done;){var r=n.value;if(0===r.path.length)return r.value;t=Fn(t,r)}}catch(c){a.e(c)}finally{a.f()}return t})),a=Object(j.a)(Object(j.a)({},t.document),{},{data:n});return Object(j.a)(Object(j.a)({},t),{},{document:a})}}))}),[u,r]);return{imageFields:u,setImageAt:l,deleteImageAt:d,applyImagesToDocument:b}}(),k=C.imageFields,P=C.setImageAt,w=C.deleteImageAt,S=C.applyImagesToDocument,M=Object(o.useMemo)((function(){return u(n)}),[u,n]),D=Object(o.useCallback)((function(){var e=Rn(p);e&&e.clear(),I(!1)}),[]),z=Object(o.useCallback)((function(){S(),null===r||void 0===r||r()}),[S,r]),L=Object(o.useCallback)((function(){null===r||void 0===r||r()}),[r]),A=Object(o.useCallback)((function(e,t){"backdropClick"!==t&&(null===r||void 0===r||r())}),[r]),T=Object(o.useCallback)((function(e){y&&"Escape"===e.key&&(e.preventDefault(),e.stopPropagation(),D())}),[y,D]),V=Object(o.useCallback)((function(e){var t=Rn(p);if(t){var n=function(e,t){if("image/tiff"===t){var n=e.getContext("2d").getImageData(0,0,e.width,e.height),a=new Uint8Array(n.data.buffer),r=Zt.a.encodeImage(a,n.width,n.height);return he(r,"image/tiff")}return e.toDataURL()}(t.getCroppedCanvas(),c);D(),P(n,e)}}),[D,c,P]);Object(o.useEffect)((function(){var e=void 0;return M&&setTimeout((function(){var t=p.current;if(t){var n=t.getContext("2d");n&&Tn(M.getImageData()).then((function(a){n.putImageData(a,0,0),(e=new Pn.a(t,{dragMode:"crop",initialAspectRatio:Number.NaN,guides:!1,crop:function(){var t,n=null===(t=e)||void 0===t?void 0:t.getCropBoxData();n&&!Object(Cn.a)(n)&&I(!0)},viewMode:1,autoCrop:!1})).clear()}))}}),0),function(){var t;null===(t=e)||void 0===t||t.destroy()}}),[M]);var F=Object(o.useCallback)((function(e){var t=parseInt(e.target.value);isNaN(t)||m(t)}),[]),H=Object(o.useCallback)((function(){var e=Rn(p);e&&!isNaN(O)&&e.rotate(O)}),[O]);return Object(h.jsxs)(Ye.a,{open:t,onClose:A,maxWidth:"lg",fullWidth:!0,classes:{paper:d.dialogPaper},onKeyDown:T,children:[Object(h.jsx)(et.a,{children:l("ExtractingImages")}),Object(h.jsxs)(Xe.a,{className:d.dialogContent,children:[Object(h.jsx)("div",{className:d.imagePane,children:!!M&&Object(h.jsx)("canvas",{ref:p,width:M.width,height:M.height,style:{visibility:"hidden"}})}),Object(h.jsx)("div",{className:d.listPane,children:Object(h.jsx)(pn.a,{children:k.map((function(e,t){return Object(h.jsx)(gn.a,{children:Object(h.jsxs)("div",{className:d.imageItem,children:[Object(h.jsx)(xn.a,{variant:"subtitle1",className:d.imageTitle,children:e.title}),e.value&&Object(h.jsx)("img",{src:s(e.value),alt:"",className:d.image}),!e.value&&Object(h.jsx)("img",{src:"".concat(Object(Jt.a)(),"images/image-placeholder.png"),alt:"placeholder",className:d.imagePlaceholder}),Object(h.jsxs)("div",{className:d.imageActions,children:[Object(h.jsx)(Le.a,{title:l("CaptureCurrentSelection"),children:Object(h.jsx)("span",{children:Object(h.jsx)(ze.a,{onClick:function(){return V(t)},disabled:!y,children:Object(h.jsx)(Kt,{})})})}),Object(h.jsx)(Le.a,{title:l("Delete"),children:Object(h.jsx)(ze.a,{onClick:function(){return w(t)},children:Object(h.jsx)(Ee.a,{})})})]})]})},t)}))})})]}),Object(h.jsxs)(Qe.a,{children:[Object(h.jsx)(nt.a,{type:"number",value:O,onChange:F,className:d.degreesEdit}),Object(h.jsx)(tt.a,{onClick:H,color:"primary",children:l("Rotate")}),Object(h.jsx)("div",{className:d.grow}),Object(h.jsx)(tt.a,{onClick:z,color:"primary",children:l("Accept")}),Object(h.jsx)(tt.a,{onClick:L,color:"primary",children:l("Cancel")})]})]})},Un=n(70),_n=n(2471),Wn=n(2500),Gn=n(2441),Jn=n(261),Kn=n.n(Jn),$n=n(620),Zn=n.n($n),qn=n(621),Yn=n.n(qn),Qn=n(262),Xn=n.n(Qn),ea=n(626),ta=n.n(ea),na=n(627),aa=n.n(na),ra=n(625),ca=n.n(ra),oa=n(624),ia=n.n(oa),ua=n(623),sa=n.n(ua),la=n(622),da=n.n(la),ba=n(340),ja=n.n(ba),fa=n(391),va=function(e){return Object(h.jsx)(Ct.a,Object(j.a)(Object(j.a)({viewBox:"0 0 1000 1000"},e),{},{children:Object(h.jsx)("path",{d:"M560.8 191.3v246.9h245V315.8L990 500 805.8 684.2V558.9h-245v246.9h123.4L500 990 315.8 805.8h122.5V558.9h-245v124.4L10 500l183.3-183.3v121.5h245V191.3H318.6L500 10l181.4 181.3H560.8z"})}))},ha=function(e){return Object(h.jsxs)(Ct.a,Object(j.a)(Object(j.a)({viewBox:"0 0 1000 1000"},e),{},{children:[Object(h.jsx)("path",{d:"M458.3 948.4c125.9 0 239.5-51.9 321-135.4l-37.5-40.2c-72.2 75-173.6 121.7-285.9 121.7-219.2 0-396.9-177.7-396.9-396.9S236.7 100.7 455.9 100.7c207.6 0 377.8 159.5 395.2 362.6h-96.3l117.6 196L990 463.2h-85C886.3 232.9 693.6 51.6 458.3 51.6 210.7 51.6 10 252.4 10 500c0 247.6 200.7 448.4 448.3 448.4z"}),Object(h.jsx)("path",{d:"M 402.3 395.8 c -17.6 -17.8 -41.8 -26.8 -72 -26.8 c -1.3 0 -2.7 0 -4.1 0.1 h -0.1 c -31.8 1.5 -56.7 11.1 -73.8 28.5 c -17.1 17.4 -26.8 42.9 -28.7 75.7 v 0.7 c 1.4 30.5 10 54.2 25.5 70.5 c 15.6 16.4 38.2 25.4 67.3 26.9 h 0.5 c 27.3 -0.8 49.5 -9.4 66.3 -25.6 c -1.9 25.7 -6.9 45.7 -15 59.6 c -9.5 16.3 -23.1 24.2 -41.7 24.2 H 325 c -22.4 0 -36.9 -12.4 -44.3 -37.8 c -0.9 -2.9 -3.5 -4.9 -6.5 -4.9 c -0.5 0 -1 0 -1.4 0.2 l -38.4 8.3 c -1.8 0.4 -3.4 1.5 -4.3 3 c -1 1.6 -1.3 3.5 -0.8 5.2 c 5.9 23 16.9 40.7 32.7 52.4 c 15.7 11.6 36.5 17.5 61.6 17.5 h 1.9 c 37.2 0 65.6 -13.6 84.4 -40.4 c 18.2 -26.1 27.5 -65.3 27.5 -116.5 c 0.3 -27.7 -2.5 -51.8 -8.2 -71.7 c -5.8 -20.5 -14.9 -37 -26.9 -49.1 z m -21 81.8 c -2.6 31.4 -20.1 46.8 -55 48.6 c -31.1 -1.8 -46.4 -19.3 -48.1 -55.2 c 1.7 -35.9 17.5 -53.5 49.6 -55.2 c 17.7 0.5 30.6 5.6 39.4 15.6 c 8.9 10 13.6 25.6 14.1 46.2 z M 647 409.2 c -17.9 -26.1 -44.8 -39.7 -79.9 -40.2 h -0.4 c -35 1.5 -61.9 15.4 -80.1 41.5 c -17.6 25.4 -27 62.8 -28 111.2 v 0.2 c 0.5 48.9 9.6 86.5 27.3 111.7 c 18.2 25.9 45.4 39.2 80.9 39.7 h 1.9 c 35 0 61.7 -13.2 79.4 -39.1 c 17.1 -25.1 25.8 -62.9 25.8 -112.3 v -0.1 c -0.4 -49.4 -9.5 -87.3 -26.9 -112.6 z m -30.5 114 c 0 36.5 -4.4 64.1 -13.1 81.9 c -8 16.4 -19.5 24.4 -35.1 24.4 h -2.8 c -15.6 0 -27.1 -8 -35.1 -24.4 c -8.7 -17.8 -13 -45.3 -13 -81.8 c 0 -36.9 4.4 -64.8 13.1 -82.9 c 8 -16.7 19.5 -24.8 35.1 -24.8 h 1.6 c 0.8 0 1.5 -0.1 2.3 -0.1 c 10.1 0 18.3 3.3 24.9 10 c 15.3 15.4 22.7 48.3 22.1 97.7 z M 647.5 257.5 c -28.4 0 -51.4 23 -51.4 51.5 c 0 28.4 23 51.4 51.4 51.4 s 51.5 -23 51.5 -51.4 c -0.1 -28.5 -23.1 -51.5 -51.5 -51.5 z m 0 73.4 c -12.2 0 -22 -9.9 -22 -22.1 c 0 -12.2 9.9 -22.1 22 -22.1 c 12.2 0 22.1 9.9 22.1 22.1 c -0.1 12.3 -10 22.1 -22.1 22.1 z"})]}))},Oa=function(e){return Object(h.jsxs)(Ct.a,Object(j.a)(Object(j.a)({viewBox:"0 0 1000 1000"},e),{},{children:[Object(h.jsx)("path",{d:"M541.7 948.4c-125.9 0-239.5-51.9-321-135.4l37.5-40.2c72.2 75 173.6 121.7 285.9 121.7 219.2 0 396.9-177.7 396.9-396.9S763.3 100.7 544.1 100.7c-207.6 0-377.8 159.5-395.2 362.6h96.3l-117.6 196L10 463.2h85C113.7 232.9 306.4 51.6 541.7 51.6 789.3 51.6 990 252.4 990 500c0 247.6-200.7 448.4-448.3 448.4z"}),Object(h.jsx)("path",{d:"M502.3 395.8c-17.6-17.8-41.8-26.8-72-26.8-1.3 0-2.7 0-4.1.1h-.1c-31.8 1.5-56.7 11.1-73.8 28.5-17.1 17.4-26.8 42.9-28.7 75.7v.7c1.4 30.5 10 54.2 25.5 70.5 15.6 16.4 38.2 25.4 67.3 26.9h.5c27.3-.8 49.5-9.4 66.3-25.6-1.9 25.7-6.9 45.7-15 59.6-9.5 16.3-23.1 24.2-41.7 24.2H425c-22.4 0-36.9-12.4-44.3-37.8-.9-2.9-3.5-4.9-6.5-4.9-.5 0-1 0-1.4.2l-38.4 8.3c-1.8.4-3.4 1.5-4.3 3-1 1.6-1.3 3.5-.8 5.2 5.9 23 16.9 40.7 32.7 52.4 15.7 11.6 36.5 17.5 61.6 17.5h1.9c37.2 0 65.6-13.6 84.4-40.4 18.2-26.1 27.5-65.3 27.5-116.5.3-27.7-2.5-51.8-8.2-71.7-5.8-20.5-14.9-37-26.9-49.1zm-21 81.8c-2.6 31.4-20.1 46.8-55 48.6-31.1-1.8-46.4-19.3-48.1-55.2 1.7-35.9 17.5-53.5 49.6-55.2 17.7.5 30.6 5.6 39.4 15.6 8.9 10 13.6 25.6 14.1 46.2zM747 409.2c-17.9-26.1-44.8-39.7-79.9-40.2h-.4c-35 1.5-61.9 15.4-80.1 41.5-17.6 25.4-27 62.8-28 111.2v.2c.5 48.9 9.6 86.5 27.3 111.7 18.2 25.9 45.4 39.2 80.9 39.7h1.9c35 0 61.7-13.2 79.4-39.1 17.1-25.1 25.8-62.9 25.8-112.3v-.1c-.4-49.4-9.5-87.3-26.9-112.6zm-30.5 114c0 36.5-4.4 64.1-13.1 81.9-8 16.4-19.5 24.4-35.1 24.4h-2.8c-15.6 0-27.1-8-35.1-24.4-8.7-17.8-13-45.3-13-81.8 0-36.9 4.4-64.8 13.1-82.9 8-16.7 19.5-24.8 35.1-24.8h1.6c.8 0 1.5-.1 2.3-.1 10.1 0 18.3 3.3 24.9 10 15.3 15.4 22.7 48.3 22.1 97.7zM747.5 257.5c-28.4 0-51.4 23-51.4 51.5 0 28.4 23 51.4 51.4 51.4s51.5-23 51.5-51.4c-.1-28.5-23.1-51.5-51.5-51.5zm0 73.4c-12.2 0-22-9.9-22-22.1 0-12.2 9.9-22.1 22-22.1 12.2 0 22.1 9.9 22.1 22.1-.1 12.3-10 22.1-22.1 22.1z"})]}))},ma=function(e){return Object(h.jsx)(Ct.a,Object(j.a)(Object(j.a)({viewBox:"0 0 100 100"},e),{},{children:Object(h.jsx)("switch",{children:Object(h.jsxs)("g",{children:[Object(h.jsx)("path",{d:"M5273.1 2400.1v-2c0-2.8-5-4-9.7-4s-9.7 1.3-9.7 4v2c0 1.8.7 3.6 2 4.9l5 4.9c.3.3.4.6.4 1v6.4c0 .4.2.7.6.8l2.9.9c.5.1 1-.2 1-.8v-7.2c0-.4.2-.7.4-1l5.1-5c1.3-1.3 2-3.1 2-4.9zm-9.7-.1c-4.8 0-7.4-1.3-7.5-1.8.1-.5 2.7-1.8 7.5-1.8s7.3 1.3 7.5 1.8c-.2.5-2.7 1.8-7.5 1.8z"}),Object(h.jsx)("path",{d:"M5268.4 2410.3c-.6 0-1 .4-1 1s.4 1 1 1h4.3c.6 0 1-.4 1-1s-.4-1-1-1h-4.3zM5272.7 2413.7h-4.3c-.6 0-1 .4-1 1s.4 1 1 1h4.3c.6 0 1-.4 1-1s-.4-1-1-1zM5272.7 2417h-4.3c-.6 0-1 .4-1 1s.4 1 1 1h4.3c.6 0 1-.4 1-1 0-.5-.4-1-1-1z"}),Object(h.jsx)("g",{children:Object(h.jsx)("path",{d:"M45.2 45.5H32.4v-5.2c0-.7-.4-1.3-1-1.5-.6-.3-1.3-.2-1.8.3l-10.7 9.7c-.4.3-.6.8-.6 1.2 0 .4.2.9.5 1.2l.1.1L29.6 61c.5.4 1.2.6 1.8.3.6-.3 1-.9 1-1.5v-5.2h12.8c.8 0 1.4-.6 1.4-1.4V47c0-.9-.7-1.5-1.4-1.5zM70.4 39.1c-.5-.4-1.2-.6-1.8-.3-.6.3-1 .9-1 1.5v5.2H54.8c-.8 0-1.4.6-1.4 1.4v6.2c0 .8.6 1.4 1.4 1.4h12.8v5.2c0 .5.2.9.5 1.2.1.1.3.3.5.3.6.3 1.3.2 1.8-.3l10.7-9.7c.4-.3.6-.8.6-1.2 0-.5-.2-.9-.6-1.2l-10.7-9.7zM10.9 28.7H4.2c-.9 0-1.7.8-1.7 1.7v39.2c0 .9.8 1.7 1.7 1.7h6.7c.9 0 1.7-.8 1.7-1.7V30.4c0-.9-.8-1.7-1.7-1.7zM95.8 28.7h-6.7c-.9 0-1.7.8-1.7 1.7v39.2c0 .9.8 1.7 1.7 1.7h6.7c.9 0 1.7-.8 1.7-1.7V30.4c0-.9-.8-1.7-1.7-1.7z"})})]})})}))},pa=Object(C.a)((function(e){return Object(k.a)({toolbar:{minHeight:"48px",paddingLeft:0,borderBottom:"solid 2px ".concat(e.palette.divider)},listContainer:{width:"100%",height:"calc(100% - 48px)"},cropper:{height:"100%",width:"100%"},cropperDisabled:{"& .cropper-crop-box":{display:"none"},"& .cropper-drag-box":{opacity:0}},imageItem:{width:"100%",position:"relative"},image:{maxWidth:"100%",marginTop:10,marginBottom:10},imagePlaceholder:{marginTop:10,height:50},imageActions:{marginLeft:-10},grow:{flexGrow:1},textField:{width:"4ch"},totalPages:{display:"inline-block",marginTop:6},fixHeight:{height:24},toolbarButtonContainer:{position:"relative"},ellipsis:{position:"absolute",fontSize:12,right:0,bottom:0,borderRadius:"50%",backgroundColor:e.palette.background.default,border:"solid 1px ".concat(e.palette.action.active)}})})),ga=Object(Un.a)((function(e){return{grouped:{margin:e.spacing(.5),border:"none","&:not(:first-child)":{borderRadius:e.shape.borderRadius},"&:first-child":{borderRadius:e.shape.borderRadius}}}}))(Wn.a),xa=function(e){var t=e.tooltip,n=e.onClick,a=e.showEllipsis,r=e.children,c=pa();return Object(h.jsx)(Le.a,{title:t,children:Object(h.jsxs)("div",{className:c.toolbarButtonContainer,children:[Object(h.jsx)(ze.a,{onClick:n,size:"small",children:r}),a&&Object(h.jsx)(ja.a,{className:c.ellipsis})]})})},ya=function(e){var t=Object(W.a)().t,n=Me(),a=n.canModify,r=n.rotateImage,c=n.rotateAllImages,i=pa(),u=Object(fa.a)({}),s=u.width,l=u.height,d=u.ref,b=Object(o.useRef)(null),j=function(){var e=Me(),t=e.currentDocument,n=e.currentDocumentLocation,a=e.setCurrentDocumentLocation,r=e.fileInfos,c=Object(o.useMemo)((function(){var e=[],n=[];if(t){var a,c=Object(N.a)(t.pages);try{for(c.s();!(a=c.n()).done;){var o=a.value,i=r[o.fileIndex];"loaded"===i.status&&(e.push(i.pages[o.filePageNumber]),n.push(i.pageStates[o.filePageNumber]))}}catch(d){c.e(d)}finally{c.f()}}else{var u,s=Object(N.a)(r);try{var l=function(){var t=u.value;"loaded"===t.status&&t.pageStates.forEach((function(a,r){Object(D.isPresent)(a.documentIndex)||(n.push(a),e.push(t.pages[r]))}))};for(s.s();!(u=s.n()).done;)l()}catch(d){s.e(d)}finally{s.f()}}return[e,n]}),[t,r]),i=Object(f.a)(c,2),u=i[0],s=i[1],l=Object(o.useMemo)((function(){var e=null===n||void 0===n?void 0:n.pageIndex;if(!Object(D.isPresent)(e))return[void 0,void 0];var t=u.findIndex((function(t){return t.pageIndex===e}));return[null===n||void 0===n?void 0:n.documentIndex,t>=0?t:void 0]}),[null===n||void 0===n?void 0:n.documentIndex,null===n||void 0===n?void 0:n.pageIndex,u]),d=Object(f.a)(l,2),b=d[0],j=d[1],v=Object(o.useCallback)((function(){a({documentIndex:b,pageIndex:u[0].pageIndex})}),[b,u,a]),h=Object(o.useCallback)((function(){Object(D.isPresent)(j)&&0!==j&&a({documentIndex:b,pageIndex:u[j-1].pageIndex})}),[b,j,u,a]),O=Object(o.useCallback)((function(){!Object(D.isPresent)(j)||j+1>=u.length||a({documentIndex:b,pageIndex:u[j+1].pageIndex})}),[b,j,u,a]),m=Object(o.useCallback)((function(){0!==u.length&&a({documentIndex:b,pageIndex:u[u.length-1].pageIndex})}),[b,u,a]),p=Object(o.useCallback)((function(e){isNaN(e)||e<=0||e>u.length||a({documentIndex:b,pageIndex:u[e-1].pageIndex})}),[b,u,a]);return{currentPage:Object(D.isPresent)(j)?u[j]:void 0,currentPageState:Object(D.isPresent)(j)?s[j]:void 0,currentPageNumber:Object(D.isPresent)(j)?j+1:void 0,totalPages:u.length,gotoFirst:v,gotoPrev:h,gotoNext:O,gotoLast:m,gotoPage:p}}(),v=j.currentPageNumber,O=j.currentPage,m=j.currentPageState,p=j.totalPages,g=j.gotoFirst,x=j.gotoLast,y=j.gotoNext,I=j.gotoPage,C=j.gotoPrev,k=Object(o.useState)(null!==v&&void 0!==v?v:null),P=Object(f.a)(k,2),w=P[0],S=P[1],M=en().setCurrentCropper,z=Object(o.useState)(),L=Object(f.a)(z,2),A=L[0],T=L[1],E=Object(o.useState)("crop"),R=Object(f.a)(E,2),B=R[0],V=R[1],F=Object(o.useState)(!1),H=Object(f.a)(F,2),U=H[0],_=H[1],G=Object(o.useState)(!1),J=Object(f.a)(G,2),K=J[0],$=J[1];Object(o.useEffect)((function(){var e=function(e){"Shift"===e.key&&(e.location===KeyboardEvent.DOM_KEY_LOCATION_LEFT?_(!0):e.location===KeyboardEvent.DOM_KEY_LOCATION_RIGHT&&$(!0))},t=function(e){"Shift"===e.key&&(e.location===KeyboardEvent.DOM_KEY_LOCATION_LEFT?_(!1):e.location===KeyboardEvent.DOM_KEY_LOCATION_RIGHT&&$(!1))};return document.addEventListener("keydown",e,{capture:!0}),document.addEventListener("keyup",t,{capture:!0}),function(){document.removeEventListener("keydown",e,{capture:!0}),document.removeEventListener("keyup",t,{capture:!0})}}),[]),Object(o.useEffect)((function(){S(null!==v&&void 0!==v?v:null)}),[v]);var Z=Object(o.useCallback)((function(){null===A||void 0===A||A.clear(),M(void 0)}),[A,M]);Object(o.useEffect)((function(){var e=void 0;return O&&setTimeout((function(){var t=b.current;if(t){var n=t.getContext("2d");n&&Tn(O.getImageData()).then((function(a){n.putImageData(a,0,0),(e=new Pn.a(t,{dragMode:"crop",initialAspectRatio:Number.NaN,guides:!1,crop:function(){var t,n=null===(t=e)||void 0===t?void 0:t.getCropBoxData();n&&!Object(Cn.a)(n)&&M(e)},viewMode:1,autoCrop:!1,ready:function(){T(e)}})).clear(),V("crop")}))}}),0),function(){var t;T(void 0),M(void 0),null===(t=e)||void 0===t||t.destroy()}}),[O,M]);var q=Object(o.useMemo)((function(){if(!Object(D.isPresent)(s)||!Object(D.isPresent)(l)||!Object(D.isPresent)(O))return[1,1,1];var e=s/O.width,t=l/O.height;return[Math.min(e,t),e,t]}),[s,l,O]),Y=Object(f.a)(q,3),Q=Y[0],X=Y[1],ee=Y[2];Object(o.useEffect)((function(){m&&(null===A||void 0===A||A.rotateTo(m.rotate))}),[A,m]);var te=Object(o.useCallback)((function(e){var t=0,n=0;"Escape"===e.key?(e.preventDefault(),e.stopPropagation(),Z()):"ArrowUp"===e.key?n=-1:"ArrowDown"===e.key?n=1:"ArrowLeft"===e.key?t=-1:"ArrowRight"===e.key&&(t=1),0===t&&0===n||null===A||void 0===A||A.move(t,n)}),[Z,A]),ne=Object(o.useCallback)((function(e){var t=e.target.value;if(Object(D.isPresent)(t)&&0!==t.length){var n=parseInt(t);isNaN(n)||S(n)}else S(null)}),[]),ae=Object(o.useCallback)((function(e){"Enter"===e.key&&(e.preventDefault(),Object(D.isPresent)(w)&&!isNaN(w)&&I(w))}),[I,w]),re=Object(o.useCallback)((function(e){e.currentTarget.focus()}),[]),ce=Object(o.useCallback)((function(e,t){t&&(null===A||void 0===A||A.setDragMode(t),V(t))}),[A]),oe=Object(o.useCallback)((function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t?c(e):O&&r(O.pageIndex,e)}),[O,c,r]),ie=Object(o.useCallback)((function(){if(A){A.zoomTo(Q);var e=Q===X?0:(s-O.width*Q)/2,t=Q===ee?0:(l-O.height*Q)/2;A.moveTo(e,t)}}),[A,O,ee,Q,X,l,s]),ue=Object(o.useCallback)((function(){if(A){A.zoomTo(X);var e=Q===ee?0:(l-O.height*Q)/2;A.moveTo(0,e)}}),[A,O,ee,Q,X,l]),se=Object(o.useCallback)((function(){null===A||void 0===A||A.zoom(-.1)}),[A]),le=Object(o.useCallback)((function(){null===A||void 0===A||A.zoom(.1)}),[A]);if(!O)return null;var de=U||K;return Object(h.jsxs)(h.Fragment,{children:[a&&Object(h.jsxs)(Ae.a,{className:i.toolbar,children:[Object(h.jsxs)("div",{children:[Object(h.jsx)(nt.a,{value:null!==w&&void 0!==w?w:"",onChange:ne,onKeyDown:ae,disabled:!Object(D.isPresent)(v),className:i.textField,inputProps:{style:{textAlign:"right"}}}),Object(h.jsxs)("span",{className:i.totalPages,children:["\xa0 / ",p," \xa0"]})]}),Object(h.jsx)(xa,{onClick:g,tooltip:t("GotoFirstPage"),children:Object(h.jsx)(Kn.a,{})}),Object(h.jsx)(xa,{onClick:C,tooltip:t("GotoPrevPage"),children:Object(h.jsx)(Zn.a,{})}),Object(h.jsx)(xa,{onClick:y,tooltip:t("GotoNextPage"),children:Object(h.jsx)(Yn.a,{})}),Object(h.jsx)(xa,{onClick:x,tooltip:t("GotoLastPage"),children:Object(h.jsx)(Xn.a,{})}),Object(h.jsx)(Gn.a,{orientation:"vertical",flexItem:!0}),Object(h.jsxs)(ga,{value:B,onChange:ce,size:"small",exclusive:!0,children:[Object(h.jsx)(_n.a,{value:"crop",children:Object(h.jsx)(Le.a,{title:t("Crop"),children:Object(h.jsx)("div",{className:i.fixHeight,children:Object(h.jsx)(Kt,{})})})}),Object(h.jsx)(_n.a,{value:"move",children:Object(h.jsx)(Le.a,{title:t("Move"),children:Object(h.jsx)("div",{className:i.fixHeight,children:Object(h.jsx)(va,{})})})})]}),Object(h.jsx)(Gn.a,{orientation:"vertical",flexItem:!0}),Object(h.jsx)(xa,{onClick:ie,tooltip:t("FitPage"),children:Object(h.jsx)(da.a,{})}),Object(h.jsx)(xa,{onClick:ue,tooltip:t("FitWidth"),children:Object(h.jsx)(ma,{})}),Object(h.jsx)(xa,{onClick:se,tooltip:t("ZoomOut"),children:Object(h.jsx)(sa.a,{})}),Object(h.jsx)(xa,{onClick:le,tooltip:t("ZoomIn"),children:Object(h.jsx)(ia.a,{})}),Object(h.jsx)(Gn.a,{orientation:"vertical",flexItem:!0}),Object(h.jsx)(xa,{onClick:function(e){return oe(-90,e.shiftKey)},tooltip:t(de?"RotateAll90Ccw":"Rotate90Ccw"),showEllipsis:de,children:Object(h.jsx)(Oa,{})}),Object(h.jsx)(xa,{onClick:function(e){return oe(90,e.shiftKey)},tooltip:t(de?"RotateAll90Cw":"Rotate90Cw"),showEllipsis:de,children:Object(h.jsx)(ha,{})}),Object(h.jsx)(xa,{onClick:function(e){return oe(180,e.shiftKey)},tooltip:t(de?"RotateAll180":"Rotate180"),showEllipsis:de,children:Object(h.jsx)(ca.a,{})}),Object(h.jsx)(xa,{onClick:function(e){return oe(-1,e.shiftKey)},tooltip:t(de?"RotateAll1Ccw":"Rotate1Ccw"),showEllipsis:de,children:Object(h.jsx)(ta.a,{})}),Object(h.jsx)(xa,{onClick:function(e){return oe(1,e.shiftKey)},tooltip:t(de?"RotateAll1Cw":"Rotate1Cw"),showEllipsis:de,children:Object(h.jsx)(aa.a,{})})]}),Object(h.jsx)("div",{ref:d,className:i.listContainer,onKeyDown:te,tabIndex:-1,onClick:re,children:Object(D.isPresent)(s)&&Object(D.isPresent)(l)&&!!O&&Object(h.jsx)("canvas",{ref:b,width:O.width,height:O.height,style:{visibility:"hidden"}})})]})},Ia=Object(C.a)((function(e){return Object(k.a)({content:{height:"75vh",minWidth:900,display:"flex",flexDirection:"row"},treePane:{flexGrow:1,overflow:"auto",width:function(e){return e.canModify?"25%":"40%"}},imageListPane:{flexGrow:1,width:"41%",overflowY:"auto",borderLeft:"2px solid ".concat(e.palette.divider),paddingLeft:10},editorPane:{width:function(e){return e.canModify?"33%":"59%"},flexGrow:1,overflow:"auto",borderLeft:"2px solid ".concat(e.palette.divider),paddingLeft:10}})})),Ca=function(e){var t=e.outputImageFormat,n=Object(W.a)().t,a=Me(),r=a.loadingImages,c=a.documentSchemas,i=a.canModify,u=Ia({canModify:i}),s=Object(o.useState)(),l=Object(f.a)(s,2),d=l[0],b=l[1],j=Object(o.useCallback)((function(){b(void 0)}),[]);return c?r?Object(h.jsx)(Ne.b,{children:n("LoadingImages")}):Object(h.jsxs)("div",{className:u.content,children:[Object(h.jsx)("div",{className:u.treePane,children:Object(h.jsx)(Ut,{})}),i&&Object(h.jsx)("div",{className:u.imageListPane,children:Object(h.jsx)(ya,{})}),Object(h.jsx)("div",{className:u.editorPane,children:Object(h.jsx)(mn,{})}),Object(D.isPresent)(d)&&Object(h.jsx)(Hn,{open:Object(D.isPresent)(d),pageIndex:d,onClose:j,outputImageFormat:t})]}):null},ka=function(e){var t,n=Object(d.useJsonForms)(),r=Object(l.mapStateToControlProps)({jsonforms:Object(j.a)({},n)},e),c=r.data,i=r.path,s=r.visible,b=r.uischema,f=null===c||void 0===c?void 0:c.documents,v=Object(o.useMemo)((function(){return f?function(e){if(!Array.isArray(e))return[];for(var t=e,n=0;n<t.length;n++){var r=t[n];if(!Object(D.isPresent)(r.data)||!r.action){var c,o,i=Object(j.a)(Object(j.a)({},r),{},{data:null!==(c=r.data)&&void 0!==c?c:{},action:null!==(o=r.action)&&void 0!==o?o:"send"});t===e&&(t=Object(a.a)(e)),t[n]=i}}return t}(f):[]}),[f]);if(Object(o.useEffect)((function(){var e;v===f||Object(G.a)(v,f)||(null===(e=n.dispatch)||void 0===e||e.call(n,Object(l.update)(Object(_.compose)(i,"documents"),(function(){return v}))))}),[n,f,v,i]),v!==f&&!Object(G.a)(v,f))return null;if("ImageBatchRecognition"!==b.type)return null;var O=b;return Object(h.jsx)(u.a,{xsUp:!s,children:Object(h.jsx)(dt.a,{children:Object(h.jsx)(Se,{basePath:i,batch:c,documentSchemasSource:O.documentSchemasSource,readonly:null!==(t=O.readonly)&&void 0!==t&&t,children:Object(h.jsx)(Xt,{outputImageFormat:O.outputImageFormat,children:Object(h.jsx)(Ca,{outputImageFormat:O.outputImageFormat})})})})})},Pa=Object(l.rankWith)(3,Object(l.uiTypeIs)("ImageBatchRecognition")),wa=n(4),Sa=n(6),Ma=n(10),Na=n(11),Da=n(235),za=n.n(Da),La=n(236),Aa=n.n(La),Ta=n(237),Ea=n.n(Ta),Ra=n(735),Ba=n(516),Va=n(2472),Fa=function(e){Object(Ma.a)(n,e);var t=Object(Na.a)(n);function n(){return Object(wa.a)(this,n),t.apply(this,arguments)}return Object(Sa.a)(n,[{key:"render",value:function(){var e=this.props,t=e.description,n=e.id,a=e.errors,r=e.label,c=e.uischema,o=e.visible,i=e.enabled,s=e.required,d=e.path,b=e.handleChange,j=e.data,f=e.config,v=r,O=0===a.length,m=on()({},f,c.options),p=!Object(l.isDescriptionHidden)(o,null!==t&&void 0!==t?t:"",this.state.isFocused,m.showUnfocusedDescription),g=Object(l.isPlainLabel)(r)?r:v;return Object(h.jsx)(u.a,{xsUp:!o,children:Object(h.jsx)(Ra.b,{id:n+"-input",label:Object(l.computeLabel)(g,null!==s&&void 0!==s&&s,m.hideRequiredAsterisk),error:!O,fullWidth:!m.trim,helperText:O?p?t:" ":a,InputLabelProps:{shrink:!0},value:j?Object(Ba.default)(j):null,onChange:function(e){return b(d,e&&!isNaN(e.valueOf())?Object(Va.a)(e,{representation:"date"}):"")},format:Ge.a.t("DATE_FORMAT"),clearable:!0,disabled:!i,autoFocus:m.focus,onFocus:this.onFocus,onBlur:this.onBlur,okLabel:Ge.a.t("OK"),cancelLabel:Ge.a.t("Cancel"),clearLabel:Ge.a.t("Clear"),leftArrowIcon:Object(h.jsx)(za.a,{}),rightArrowIcon:Object(h.jsx)(Aa.a,{}),keyboardIcon:Object(h.jsx)(Ea.a,{}),InputProps:{}})})}}]),n}(d.Control),Ha=Object(l.rankWith)(10,l.isDateControl),Ua=Object(d.withJsonFormsControlProps)(Fa),_a=n(381),Wa=n.n(_a),Ga=n(450),Ja=n.n(Ga),Ka=n(738),$a=function(e){Object(Ma.a)(n,e);var t=Object(Na.a)(n);function n(){return Object(wa.a)(this,n),t.apply(this,arguments)}return Object(Sa.a)(n,[{key:"render",value:function(){var e=this.props,t=e.id,n=e.description,a=e.errors,r=e.label,c=e.uischema,o=e.visible,i=e.enabled,s=e.required,d=e.path,b=e.handleChange,j=e.data,f=e.config,v=on()({},f,c.options),O=0===a.length;return Object(h.jsx)(u.a,{xsUp:!o,children:Object(h.jsx)(Ka.b,{id:t+"-input",label:Object(l.computeLabel)(Object(l.isPlainLabel)(r)?r:r.default,null!==s&&void 0!==s&&s,v.hideRequiredAsterisk),error:!O,fullWidth:!v.trim,onFocus:this.onFocus,onBlur:this.onBlur,helperText:O?n:a,InputLabelProps:{shrink:!0},value:j||null,onChange:function(e){return b(d,e&&!isNaN(e.valueOf())?e.toISOString():"")},format:Ge.a.t("DATETIME_FORMAT"),clearable:!0,disabled:!i,autoFocus:v.focus,okLabel:Ge.a.t("OK"),cancelLabel:Ge.a.t("Cancel"),clearLabel:Ge.a.t("Clear"),leftArrowIcon:Object(h.jsx)(za.a,{}),rightArrowIcon:Object(h.jsx)(Aa.a,{}),dateRangeIcon:Object(h.jsx)(Wa.a,{}),keyboardIcon:Object(h.jsx)(Ea.a,{}),timeIcon:Object(h.jsx)(Ja.a,{}),InputProps:{}})})}}]),n}(d.Control),Za=Object(l.rankWith)(10,l.isDateTimeControl),qa=Object(d.withJsonFormsControlProps)($a),Ya=n(2491),Qa=n(2435),Xa=["context","bindContext","uiSchemaLibrary","schema","onChange"],er=function(e){var t=e.context,n=e.bindContext,r=e.uiSchemaLibrary,c=e.schema,i=e.onChange,u=Object(M.a)(e,Xa),s=function(e){var t=Object(Ya.a)(Object(R.a)(E.a.mark((function t(){var n;return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=2;break}return t.abrupt("return",void 0);case 2:return t.next=4,An(e);case 4:return n=t.sent,t.abrupt("return",n);case 6:case"end":return t.stop()}}),t)}))),[e]);return{resolvedSchema:t.value,loading:t.loading,error:t.error}}(c),l=s.resolvedSchema,b=s.loading,v=s.error,O=Object(o.useState)(),m=Object(f.a)(O,2),g=m[0],x=m[1],y=Object(o.useState)([]),I=Object(f.a)(y,2),C=I[0],k=I[1],P=Object(o.useState)(),w=Object(f.a)(P,2),S=w[0],N=w[1],D=Object(o.useCallback)((function(e){x(e)}),[]),z=Object(o.useCallback)((function(e){k(e)}),[]);if(Object(o.useEffect)((function(){if(g||0!==C.length){var e=function(e,t){var n={data:void 0};return t.length>0||(null===e||void 0===e?void 0:e.errors)&&e.errors.length>0?(n.errors=n.errors?[].concat(Object(a.a)(n.errors),Object(a.a)(t)):t,n.errors=Object(Qa.a)([Object(Je.a)((function(e,t){var n,a;return e.dataPath<t.dataPath||e.dataPath===t.dataPath&&(null!==(n=e.message)&&void 0!==n?n:"")<(null!==(a=t.message)&&void 0!==a?a:"")}))],n.errors)):n.data=null===e||void 0===e?void 0:e.data,n}(g,C);N((function(t){return Object(G.a)(t,e)?t:e}))}}),[C,g]),Object(o.useEffect)((function(){S&&(null===i||void 0===i||i(S))}),[S,i]),b)return Object(h.jsx)(Ne.a,{});if(v)throw v;return Object(h.jsx)(p,{context:t,bindContext:n,uiSchemaLibrary:r,onErrorsChange:z,children:Object(h.jsx)(d.JsonForms,Object(j.a)({renderers:tr,cells:nr,schema:l,onChange:D},u))})},tr=[].concat(Object(a.a)(c.extendedMaterialRenderers),[{tester:I,renderer:y},{tester:S,renderer:w},{tester:A,renderer:L},{tester:U,renderer:H},{tester:Pa,renderer:ka},{tester:Ha,renderer:Ua},{tester:Za,renderer:qa}]),nr=r.materialCells},457:function(e,t){},575:function(e,t){},577:function(e,t){},578:function(e,t){},592:function(e,t){},593:function(e,t){},596:function(e,t){},597:function(e,t){},598:function(e,t){},599:function(e,t){},600:function(e,t){},602:function(e,t){},604:function(e,t){},605:function(e,t){},606:function(e,t){},607:function(e,t){},608:function(e,t){},619:function(e,t){}}]);
//# sourceMappingURL=14.d9547235.chunk.js.map