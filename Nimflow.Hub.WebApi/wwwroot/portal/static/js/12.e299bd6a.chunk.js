(this["webpackJsonpnimflow-portal"]=this["webpackJsonpnimflow-portal"]||[]).push([[12],{116:function(e,t,n){"use strict";n.d(t,"i",(function(){return u})),n.d(t,"h",(function(){return s})),n.d(t,"g",(function(){return l})),n.d(t,"d",(function(){return d})),n.d(t,"c",(function(){return f})),n.d(t,"f",(function(){return b})),n.d(t,"a",(function(){return O})),n.d(t,"b",(function(){return g})),n.d(t,"e",(function(){return y}));var a=n(15),r=n(2484),c=(n(2370),n(2438),n(247),n(81),["MilestoneReached","MilestoneCleared"]),i=["TaskCreated","TaskUpdated","TaskArchived","ResponseSent"],o=["ActionDispatched","ContextsRecalculationCompleted","ContextRecalculationError"].concat(i,c);["RequestProcessed"].concat(Object(a.a)(o),["CustomEvent"]);function u(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.settings;return!n&&t&&(e.settings=n={}),n}function s(e){var t,n=null===(t=u(e))||void 0===t?void 0:t.commandText;return Object(r.a)(n)?e.name:n}function l(e){var t,n=null===(t=u(e))||void 0===t?void 0:t.actionInProgressText;return n||e.name}var d={id:"string",typeName:"string",reference:"string",state:"record",dateCreated:"dateTime",dateModified:"dateTime",version:"string",contextTypeVersion:"number",milestones:"array",tags:"array",metrics:"array"},f={id:"string",contextId:"string",contextTypeName:"string",contextReference:"string",typeName:"string",title:"string",data:"record",labels:"array",dateCreated:"dateTime",dateUpdated:"dateTime",assignedTo:"string",status:"string",archived:"boolean",dueDate:"string",importance:"number",focused:"boolean"},b={event:"string",timestamp:"dateTime",requestTypeName:"string",contextTypeName:"string",sentBy:"string",reference:"string",subject:"string",contextIsNew:"boolean",action:"string",message:"string",dueDate:"dateTime",taskTypeName:"string",assignedTo:"string",importance:"number",responseTypeName:"string",oldImportance:"number",oldLabels:"array",oldDueDate:"dateTime",oldAssignedTo:"string",milestoneName:"string",value:"dateTime",tags:"array",metrics:"array"},j=function(e){var t=["string","number","boolean","dateTime"];return Object.keys(e).filter((function(n){return t.includes(e[n])})).sort()},v=function(e){return Object.keys(e).filter((function(t){return"array"===e[t]})).sort()},p=function(e){return Object.keys(e).filter((function(t){return"record"===e[t]})).sort()},O=j(d),m=v(d),h=p(d),g=([].concat(Object(a.a)(O),Object(a.a)(m),Object(a.a)(h)),j(f)),x=(v(f),p(f)),y=([].concat(Object(a.a)(g),Object(a.a)(x)),j(b)),k=v(b);[].concat(Object(a.a)(y),Object(a.a)(k))},121:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(2),r=n(33),c=n(427),i=n.n(c),o=n(265);i.a.registerHelper("translate",(function(e,t){var n={ns:o.b};return"object"===typeof t&&"hash"in t&&(n=Object(a.a)(Object(a.a)({},n),t.hash)),r.a.t(e,n)}));var u=function(e,t,n,a){return function(e,t){return i.a.compile(e,t)}(e,n)(t,a)}},137:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var a=n(4),r=n(6),c=n(10),i=n(11),o=n(3),u=n(918),s=n(2441),l=n(2442),d=n(2443),f=n(183),b=n.n(f),j=n(31),v=function(e){var t=e.error,n=e.stack;return Object(j.jsxs)(s.a,{children:[Object(j.jsx)(d.a,{expandIcon:Object(j.jsx)(b.a,{}),children:Object(j.jsx)(u.a,{variant:"h5",color:"error",children:t})}),Object(j.jsx)(l.a,{children:Object(j.jsx)("pre",{children:n})})]})},p=function(e){Object(c.a)(n,e);var t=Object(i.a)(n);function n(){var e;Object(a.a)(this,n);for(var r=arguments.length,c=new Array(r),i=0;i<r;i++)c[i]=arguments[i];return(e=t.call.apply(t,[this].concat(c))).state={hasError:!1},e}return Object(r.a)(n,[{key:"componentDidCatch",value:function(e,t){console.log({error:e,errorInfo:t}),this.setState({errorInfo:t})}},{key:"render",value:function(){var e,t,n=this.state,a=n.hasError,r=n.error,c=n.errorInfo;return a?Object(j.jsx)(v,{error:null!==(e=null===r||void 0===r?void 0:r.message)&&void 0!==e?e:"",stack:null!==(t=null===c||void 0===c?void 0:c.componentStack)&&void 0!==t?t:""}):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return{hasError:!0,error:e}}}]),n}(o.Component)},158:function(e,t,n){"use strict";n.d(t,"b",(function(){return b})),n.d(t,"a",(function(){return j}));var a=n(437),r=n.n(a),c=n(560),i=n.n(c),o=n(283),u=n.n(o),s=n(33),l=u.a;function d(e){n(323)("./".concat(e,"/index")).then((function(e){"function"===typeof(null===e||void 0===e?void 0:e.default)&&(l=e.default)})).catch((function(){var t=e.indexOf("-");t>0&&d(e.substring(0,t))}))}s.a.language&&d(s.a.language),s.a.on("languageChanged",(function(e){d(e)}));var f=new r.a({allErrors:!0,addUsedSchema:!1});i()(f),f.addKeyword({keyword:"markdownDescription",schemaType:"string",valid:!0});var b=function(e){var t;return f.validateSchema(e)?{type:"success"}:(f.errors&&l&&l(f.errors),{type:"failure",errors:null!==(t=f.errors)&&void 0!==t?t:[]})},j=function(e){return l&&l(e),e}},177:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(3),r=n(926),c=n(245),i=n(2482),o=n(146),u=n(272),s=n(352),l=n(31),d=function(){var e=Object(i.a)().t,t=Object(c.b)().enqueueSnackbar,n=Object(o.b)();return Object(a.useCallback)((function(a,c,i){var o,d,f=null!==(o=null===i||void 0===i?void 0:i.variant)&&void 0!==o?o:"error",b=null!==(d=null===i||void 0===i?void 0:i.dialogTitle)&&void 0!==d?d:e("Error");if(Object(s.b)(c)&&"string"===typeof a){var j,v=!1===(null===(j=window.navigator)||void 0===j?void 0:j.onLine);a=e(v?"BrowserOfflineMessage":"NetworkErrorMessage",{message:a})}t(a,{variant:f,action:Object(l.jsx)(r.a,{onClick:function(){n({title:b,description:Object(l.jsx)(u.a,{error:c})})},children:e("ShowDetails")})})}),[n,t,e])}},178:function(e,t,n){"use strict";var a=n(73),r=n(76);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var c=r(n(3)),i=(0,a(n(77)).default)(c.createElement("path",{d:"M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"}),"Refresh");t.default=i},215:function(e,t,n){"use strict";n.d(t,"b",(function(){return f})),n.d(t,"d",(function(){return h})),n.d(t,"a",(function(){return m})),n.d(t,"c",(function(){return i}));var a=["second","minute","hour","day","week","month","year"],r=["\u79d2","\u5206\u949f","\u5c0f\u65f6","\u5929","\u5468","\u4e2a\u6708","\u5e74"],c={},i=function(e,t){c[e]=t},o=function(e){return c[e]||c.en_US},u=[60,60,24,7,365/7/12,12];function s(e){return e instanceof Date?e:!isNaN(e)||/^\d+$/.test(e)?new Date(parseInt(e)):(e=(e||"").trim().replace(/\.\d+/,"").replace(/-/,"/").replace(/-/,"/").replace(/(\d)T(\d)/,"$1 $2").replace(/Z/," UTC").replace(/([+-]\d\d):?(\d\d)/," $1$2"),new Date(e))}function l(e,t){for(var n=e<0?1:0,a=e=Math.abs(e),r=0;e>=u[r]&&r<u.length;r++)e/=u[r];return(e=Math.floor(e))>(0===(r*=2)?9:1)&&(r+=1),t(e,r,a)[n].replace("%s",e.toString())}function d(e,t){return(+(t?s(t):new Date)-+s(e))/1e3}var f=function(e,t,n){return l(d(e,n&&n.relativeDate),o(t))},b="timeago-id";function j(e){return parseInt(e.getAttribute(b))}var v={},p=function(e){clearTimeout(e),delete v[e]};function O(e,t,n,a){p(j(e));var r=a.relativeDate,c=a.minInterval,i=d(t,r);e.innerText=l(i,n);var o=setTimeout((function(){O(e,t,n,a)}),Math.min(1e3*Math.max(function(e){for(var t=1,n=0,a=Math.abs(e);e>=u[n]&&n<u.length;n++)e/=u[n],t*=u[n];return a=(a%=t)?t-a:t,Math.ceil(a)}(i),c||1),2147483647));v[o]=0,function(e,t){e.setAttribute(b,t)}(e,o)}function m(e){e?p(j(e)):Object.keys(v).forEach(p)}function h(e,t,n){var a=e.length?e:[e];return a.forEach((function(e){O(e,function(e){return e.getAttribute("datetime")}(e),o(t),n||{})})),a}i("en_US",(function(e,t){if(0===t)return["just now","right now"];var n=a[Math.floor(t/2)];return e>1&&(n+="s"),[e+" "+n+" ago","in "+e+" "+n]})),i("zh_CN",(function(e,t){if(0===t)return["\u521a\u521a","\u7247\u523b\u540e"];var n=r[~~(t/2)];return[e+" "+n+"\u524d",e+" "+n+"\u540e"]}))},229:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return u}));var a=n(2),r=n(81),c=n(2456),i=function(e,t){var n,i=null===(n=e.definitions)||void 0===n?void 0:n[t];if(!Object(r.isPresent)(i))throw new Error("Invalid definition ".concat(t));if("boolean"===typeof i)throw new Error("Invalid definition ".concat(t));var o=Object(c.a)(i);return delete o.definitions,e=Object(a.a)(Object(a.a)({},e),o)},o=function(e,t,n){if(e.jsonSchema){var a=JSON.parse(e.jsonSchema),r=e.tasks.find((function(e){return e.name===t})),c=null===r||void 0===r?void 0:r.validResponses.find((function(e){return e.name===n})),o=null===c||void 0===c?void 0:c.payloadSchemaDefinitionName;if(o)return i(a,o)}},u=function(e,t){if(e.jsonSchema){var n=JSON.parse(e.jsonSchema),a=e.actions.find((function(e){return e.name===t})),r=null===a||void 0===a?void 0:a.payloadSchemaDefinitionName;if(r)return i(n,r)}}},243:function(e,t,n){"use strict";n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return h}));var a=n(215);function r(e,t,n,a,r){var c=r%10,i=a;return 1===r?i=e:1===c&&r>20?i=t:c>1&&c<5&&(r>20||r<10)&&(i=n),i}var c=r.bind(null,"\u0441\u0435\u043a\u0443\u043d\u0434\u0443","%s \u0441\u0435\u043a\u0443\u043d\u0434\u0443","%s \u0441\u0435\u043a\u0443\u043d\u0434\u044b","%s \u0441\u0435\u043a\u0443\u043d\u0434"),i=r.bind(null,"\u043c\u0438\u043d\u0443\u0442\u0443","%s \u043c\u0438\u043d\u0443\u0442\u0443","%s \u043c\u0438\u043d\u0443\u0442\u044b","%s \u043c\u0438\u043d\u0443\u0442"),o=r.bind(null,"\u0447\u0430\u0441","%s \u0447\u0430\u0441","%s \u0447\u0430\u0441\u0430","%s \u0447\u0430\u0441\u043e\u0432"),u=r.bind(null,"\u0434\u0435\u043d\u044c","%s \u0434\u0435\u043d\u044c","%s \u0434\u043d\u044f","%s \u0434\u043d\u0435\u0439"),s=r.bind(null,"\u043d\u0435\u0434\u0435\u043b\u044e","%s \u043d\u0435\u0434\u0435\u043b\u044e","%s \u043d\u0435\u0434\u0435\u043b\u0438","%s \u043d\u0435\u0434\u0435\u043b\u044c"),l=r.bind(null,"\u043c\u0435\u0441\u044f\u0446","%s \u043c\u0435\u0441\u044f\u0446","%s \u043c\u0435\u0441\u044f\u0446\u0430","%s \u043c\u0435\u0441\u044f\u0446\u0435\u0432"),d=r.bind(null,"\u0433\u043e\u0434","%s \u0433\u043e\u0434","%s \u0433\u043e\u0434\u0430","%s \u043b\u0435\u0442"),f=n(33),b="en_US",j=["en_US","zh_CN"],v=function(e,t){Object(a.c)(e,t),j.push(e)};function p(e){if(j.includes(e))b=e;else{var t=e.indexOf("_");t>0?p(e.substring(0,t)):b="en_US"}}function O(e){"en"===e&&(e="en_US"),p(e=e.replace("-","_"))}v("de",(function(e,t){return[["gerade eben","vor einer Weile"],["vor %s Sekunden","in %s Sekunden"],["vor 1 Minute","in 1 Minute"],["vor %s Minuten","in %s Minuten"],["vor 1 Stunde","in 1 Stunde"],["vor %s Stunden","in %s Stunden"],["vor 1 Tag","in 1 Tag"],["vor %s Tagen","in %s Tagen"],["vor 1 Woche","in 1 Woche"],["vor %s Wochen","in %s Wochen"],["vor 1 Monat","in 1 Monat"],["vor %s Monaten","in %s Monaten"],["vor 1 Jahr","in 1 Jahr"],["vor %s Jahren","in %s Jahren"]][t]})),v("es",(function(e,t){return[["justo ahora","en un rato"],["hace %s segundos","en %s segundos"],["hace 1 minuto","en 1 minuto"],["hace %s minutos","en %s minutos"],["hace 1 hora","en 1 hora"],["hace %s horas","en %s horas"],["hace 1 d\xeda","en 1 d\xeda"],["hace %s d\xedas","en %s d\xedas"],["hace 1 semana","en 1 semana"],["hace %s semanas","en %s semanas"],["hace 1 mes","en 1 mes"],["hace %s meses","en %s meses"],["hace 1 a\xf1o","en 1 a\xf1o"],["hace %s a\xf1os","en %s a\xf1os"]][t]})),v("fr",(function(e,t){return[["\xe0 l'instant","dans un instant"],["il y a %s secondes","dans %s secondes"],["il y a 1 minute","dans 1 minute"],["il y a %s minutes","dans %s minutes"],["il y a 1 heure","dans 1 heure"],["il y a %s heures","dans %s heures"],["il y a 1 jour","dans 1 jour"],["il y a %s jours","dans %s jours"],["il y a 1 semaine","dans 1 semaine"],["il y a %s semaines","dans %s semaines"],["il y a 1 mois","dans 1 mois"],["il y a %s mois","dans %s mois"],["il y a 1 an","dans 1 an"],["il y a %s ans","dans %s ans"]][t]})),v("it",(function(e,t){return[["poco fa","fra poco"],["%s secondi fa","fra %s secondi"],["un minuto fa","fra un minuto"],["%s minuti fa","fra %s minuti"],["un'ora fa","fra un'ora"],["%s ore fa","fra %s ore"],["un giorno fa","fra un giorno"],["%s giorni fa","fra %s giorni"],["una settimana fa","fra una settimana"],["%s settimane fa","fra %s settimane"],["un mese fa","fra un mese"],["%s mesi fa","fra %s mesi"],["un anno fa","fra un anno"],["%s anni fa","fra %s anni"]][t]})),v("pt_BR",(function(e,t){return[["agora mesmo","agora"],["h\xe1 %s segundos","em %s segundos"],["h\xe1 um minuto","em um minuto"],["h\xe1 %s minutos","em %s minutos"],["h\xe1 uma hora","em uma hora"],["h\xe1 %s horas","em %s horas"],["h\xe1 um dia","em um dia"],["h\xe1 %s dias","em %s dias"],["h\xe1 uma semana","em uma semana"],["h\xe1 %s semanas","em %s semanas"],["h\xe1 um m\xeas","em um m\xeas"],["h\xe1 %s meses","em %s meses"],["h\xe1 um ano","em um ano"],["h\xe1 %s anos","em %s anos"]][t]})),v("ru",(function(e,t){switch(t){case 0:return["\u0442\u043e\u043b\u044c\u043a\u043e \u0447\u0442\u043e","\u0447\u0435\u0440\u0435\u0437 \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u0441\u0435\u043a\u0443\u043d\u0434"];case 1:return[c(e)+" \u043d\u0430\u0437\u0430\u0434","\u0447\u0435\u0440\u0435\u0437 "+c(e)];case 2:case 3:return[i(e)+" \u043d\u0430\u0437\u0430\u0434","\u0447\u0435\u0440\u0435\u0437 "+i(e)];case 4:case 5:return[o(e)+" \u043d\u0430\u0437\u0430\u0434","\u0447\u0435\u0440\u0435\u0437 "+o(e)];case 6:return["\u0432\u0447\u0435\u0440\u0430","\u0437\u0430\u0432\u0442\u0440\u0430"];case 7:return[u(e)+" \u043d\u0430\u0437\u0430\u0434","\u0447\u0435\u0440\u0435\u0437 "+u(e)];case 8:case 9:return[s(e)+" \u043d\u0430\u0437\u0430\u0434","\u0447\u0435\u0440\u0435\u0437 "+s(e)];case 10:case 11:return[l(e)+" \u043d\u0430\u0437\u0430\u0434","\u0447\u0435\u0440\u0435\u0437 "+l(e)];case 12:case 13:return[d(e)+" \u043d\u0430\u0437\u0430\u0434","\u0447\u0435\u0440\u0435\u0437 "+d(e)];default:return["",""]}})),f.a.language&&O(f.a.language),f.a.on("languageChanged",(function(e){O(e)}));var m=function(e,t){return Object(a.b)(e,b,t)},h=function(e,t){return Object(a.d)(e,b,t)}},2437:function(e,t,n){"use strict";n.r(t),n.d(t,"TasksViewer",(function(){return l}));var a=n(3),r=n(476),c=n(117),i=n(31),o=[5,10,20,100],u=[{field:"title"},{field:"typeName"},{field:"contextTypeName",hidden:!0},{field:"contextReference"},{field:"dueDate"},{field:"status",hidden:!0},{field:"dateCreated"},{field:"focused",hidden:!0}],s={currentPage:0,pageSize:10},l=function(){var e=Object(c.c)().authenticatedUser,t=Object(a.useMemo)((function(){var t={archived:{type:"boolean",value:!1},assignedTo:{type:"textMatch",value:"*"}},n=null===e||void 0===e?void 0:e.email;return n&&(t.assignedTo={type:"or",filters:[t.assignedTo,{type:"prefixTextMatch",prefix:n}]}),t}),[e]);return Object(i.jsx)(r.a,{columns:u,initialState:s,pageSizeOptions:o,allowResponseCreation:!0,allowFocusing:!0,enforcedFilter:t})};t.default=l},314:function(e,t,n){"use strict";n(0);var a=n(18),r=n(1),c=n(2),i=n(3),o=n(134),u=n(251),s=n.n(u),l=n(922),d=n(983),f=n(1292),b=n(925),j=n(982),v=n(206),p=n.n(v),O=n(319),m=n.n(O),h=n(370),g=n.n(h),x=n(421),y=n.n(x),k=n(422),C=n.n(k),w=n(274),I=n.n(w),S=n(154),T=n.n(S),P=n(257),R=n.n(P),M=n(316),N=n.n(M),D=n(317),A=n.n(D),E=n(318),z=n.n(E),L=n(320),F=n.n(L),U=n(315),B=n.n(U),W=n(416),_=n.n(W),V=n(321),$=n.n(V),H=n(33),G=n(2475),J=n(31),q=["forwardedRef"],Z={Add:Object(i.forwardRef)((function(e,t){return Object(J.jsx)(p.a,Object(c.a)(Object(c.a)({},e),{},{ref:t}))})),Check:Object(i.forwardRef)((function(e,t){return Object(J.jsx)(g.a,Object(c.a)(Object(c.a)({},e),{},{ref:t}))})),Clear:Object(i.forwardRef)((function(e,t){return Object(J.jsx)(I.a,Object(c.a)(Object(c.a)({},e),{},{ref:t}))})),Delete:Object(i.forwardRef)((function(e,t){return Object(J.jsx)(T.a,Object(c.a)(Object(c.a)({},e),{},{ref:t}))})),DetailPanel:Object(i.forwardRef)((function(e,t){return Object(J.jsx)(C.a,Object(c.a)(Object(c.a)({},e),{},{ref:t}))})),Edit:Object(i.forwardRef)((function(e,t){return Object(J.jsx)(R.a,Object(c.a)(Object(c.a)({},e),{},{ref:t}))})),Export:Object(i.forwardRef)((function(e,t){return Object(J.jsx)(B.a,Object(c.a)(Object(c.a)({},e),{},{ref:t}))})),Filter:Object(i.forwardRef)((function(e,t){return Object(J.jsx)(N.a,Object(c.a)(Object(c.a)({},e),{},{ref:t}))})),FirstPage:Object(i.forwardRef)((function(e,t){return Object(J.jsx)(A.a,Object(c.a)(Object(c.a)({},e),{},{ref:t}))})),LastPage:Object(i.forwardRef)((function(e,t){return Object(J.jsx)(z.a,Object(c.a)(Object(c.a)({},e),{},{ref:t}))})),NextPage:Object(i.forwardRef)((function(e,t){return Object(J.jsx)(C.a,Object(c.a)(Object(c.a)({},e),{},{ref:t}))})),PreviousPage:Object(i.forwardRef)((function(e,t){return Object(J.jsx)(y.a,Object(c.a)(Object(c.a)({},e),{},{ref:t}))})),ResetSearch:Object(i.forwardRef)((function(e,t){return Object(J.jsx)(I.a,Object(c.a)(Object(c.a)({},e),{},{ref:t}))})),Search:Object(i.forwardRef)((function(e,t){return Object(J.jsx)(_.a,Object(c.a)(Object(c.a)({},e),{},{ref:t}))})),SortArrow:Object(i.forwardRef)((function(e,t){return Object(J.jsx)(m.a,Object(c.a)(Object(c.a)({},e),{},{ref:t}))})),ThirdStateCheck:Object(i.forwardRef)((function(e,t){return Object(J.jsx)(F.a,Object(c.a)(Object(c.a)({},e),{},{ref:t}))})),ViewColumn:Object(i.forwardRef)((function(e,t){return Object(J.jsx)($.a,Object(c.a)(Object(c.a)({},e),{},{ref:t}))}))},Y=function e(t,n){for(var a={},c=0,i=Object.entries(t);c<i.length;c++){var o=Object(r.a)(i[c],2),u=o[0],s=o[1];"object"===typeof s?(n.push(u),a[u]=e(s,n),n.pop()):a[u]=H.a.t("".concat(n.join("."),".").concat(u))}return a}({body:{emptyDataSourceMessage:"",filterRow:{filterTooltip:""},editRow:{saveTooltip:"",cancelTooltip:"",deleteText:""},addTooltip:"",deleteTooltip:"",editTooltip:""},header:{actions:""},grouping:{groupedBy:"",placeholder:""},pagination:{firstTooltip:"",firstAriaLabel:"",previousTooltip:"",previousAriaLabel:"",nextTooltip:"",nextAriaLabel:"",labelDisplayedRows:"",labelRowsPerPage:"",lastTooltip:"",lastAriaLabel:"",labelRowsSelect:""},toolbar:{addRemoveColumns:"",nRowsSelected:function(e){return""},showColumnsTitle:"",showColumnsAriaLabel:"",exportTitle:"",exportAriaLabel:"",searchTooltip:"",searchPlaceholder:""}},["MaterialTable"]),K={padding:0,width:24,marginLeft:24},Q=function(e){var t=e.forwardedRef,n=Object(a.a)(e,q);return Object(J.jsxs)(l.a,{error:Boolean(n.error),ref:t,component:"fieldset",children:[Object(J.jsx)(d.a,{children:Object(J.jsx)(j.a,{label:"",control:Object(J.jsx)(f.a,Object(c.a)(Object(c.a)({},n),{},{value:String(n.value),checked:Boolean(n.value),onChange:function(e){return n.onChange(e.target.checked)},style:K,color:"default",inputProps:{"aria-label":n.columnDef.title}}))})}),Object(J.jsx)(b.a,{children:n.helperText})]})},X=function(e){return"boolean"===e.columnDef.type?Object(J.jsx)(Q,Object(c.a)({},e)):Object(J.jsx)(u.MTableEditField,Object(c.a)({},e))},ee={EditField:function(e){return Object(J.jsx)(X,Object(c.a)({},e))}};t.a=function(e){var t=Object(o.a)(),n=Object(i.useMemo)((function(){return e.icons?Object(c.a)(Object(c.a)({},Z),e.icons):Z}),[e.icons]),a=Object(i.useMemo)((function(){return e.localization?Object(c.a)(Object(c.a)({},Y),e.localization):Y}),[e.localization]),r=Object(i.useMemo)((function(){var n=function(e){return{actionsCellStyle:{color:e.palette.text.secondary},actionsColumnIndex:-1,padding:"dense"}}(t);return e.options&&(n=Object(G.a)(n,e.options)),n}),[t,e.options]),u=Object(i.useMemo)((function(){return e.components?Object(c.a)(Object(c.a)({},ee),e.components):ee}),[e.components]);return Object(J.jsx)(s.a,Object(c.a)(Object(c.a)({},e),{},{icons:n,options:r,components:u,localization:a}))}},315:function(e,t,n){"use strict";var a=n(73),r=n(76);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var c=r(n(3)),i=(0,a(n(77)).default)(c.createElement("path",{d:"M19 12v7H5v-7H3v7c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2v-7h-2zm-6 .67l2.59-2.58L17 11.5l-5 5-5-5 1.41-1.41L11 12.67V3h2z"}),"SaveAlt");t.default=i},316:function(e,t,n){"use strict";var a=n(73),r=n(76);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var c=r(n(3)),i=(0,a(n(77)).default)(c.createElement("path",{d:"M10 18h4v-2h-4v2zM3 6v2h18V6H3zm3 7h12v-2H6v2z"}),"FilterList");t.default=i},317:function(e,t,n){"use strict";var a=n(73),r=n(76);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var c=r(n(3)),i=(0,a(n(77)).default)(c.createElement("path",{d:"M18.41 16.59L13.82 12l4.59-4.59L17 6l-6 6 6 6zM6 6h2v12H6z"}),"FirstPage");t.default=i},318:function(e,t,n){"use strict";var a=n(73),r=n(76);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var c=r(n(3)),i=(0,a(n(77)).default)(c.createElement("path",{d:"M5.59 7.41L10.18 12l-4.59 4.59L7 18l6-6-6-6zM16 6h2v12h-2z"}),"LastPage");t.default=i},320:function(e,t,n){"use strict";var a=n(73),r=n(76);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var c=r(n(3)),i=(0,a(n(77)).default)(c.createElement("path",{d:"M19 13H5v-2h14v2z"}),"Remove");t.default=i},321:function(e,t,n){"use strict";var a=n(73),r=n(76);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var c=r(n(3)),i=(0,a(n(77)).default)(c.createElement("path",{d:"M10 18h5V5h-5v13zm-6 0h5V5H4v13zM16 5v13h5V5h-5z"}),"ViewColumn");t.default=i},323:function(e,t,n){var a={"./ar/index":[628,22],"./ca/index":[629,23],"./cs/index":[630,24],"./de/index":[631,25],"./en/index":[283],"./es/index":[632,26],"./fr/index":[633,27],"./hu/index":[634,28],"./id/index":[635,29],"./it/index":[636,30],"./ja/index":[637,31],"./ko/index":[638,32],"./nb/index":[639,33],"./nl/index":[640,34],"./pl/index":[641,35],"./pt-BR/index":[642,36],"./ru/index":[643,37],"./sk/index":[644,38],"./sv/index":[645,39],"./th/index":[646,40],"./zh-TW/index":[648,41],"./zh/index":[647,42]};function r(e){if(!n.o(a,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=a[e],r=t[0];return Promise.all(t.slice(1).map(n.e)).then((function(){return n.t(r,7)}))}r.keys=function(){return Object.keys(a)},r.id=323,e.exports=r},335:function(e){e.exports=JSON.parse('{"$schema":"http://json-schema.org/draft-07/schema#","$id":"http://nimflow.com/schemas/recognized-image-batch.schema.json","type":"object","title":"Recognized image batch schema","allOf":[{"$ref":"#/definitions/RecognizedImageBatch"}],"definitions":{"RecognizedImageBatch":{"type":"object","properties":{"fileUrls":{"type":"array","items":{"type":"string"}},"documents":{"type":"array","items":{"$ref":"#/definitions/Document"}}},"required":["fileUrls"]},"Document":{"type":"object","properties":{"schemaId":{"type":"string"},"pages":{"type":"array","items":{"$ref":"#/definitions/PageImageLocation"}},"action":{"type":"string","enum":["saveAsDraft","send","dontSend"]},"data":true},"required":["schemaId","action"]},"PageImageLocation":{"type":"object","properties":{"fileIndex":{"type":"integer"},"filePageNumber":{"type":"integer"}},"required":["fileIndex","filePageNumber"]}}}')},336:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(3),r=n(215),c=n(243),i=n(31),o=function(e){var t=e.datetime,n=e.live,o=e.opts,u=Object(a.useRef)(null);return Object(a.useEffect)((function(){var e,a=u.current;if(a)return!1!==n&&(a.setAttribute("datetime",""+((e=t)instanceof Date?e.getTime():e)),Object(c.b)(a,o)),function(){return Object(r.a)(a)}}),[t,n,o]),Object(i.jsx)("time",{ref:u,children:Object(c.a)(t,o)})}},342:function(e,t,n){"use strict";n.d(t,"a",(function(){return ka})),n.d(t,"c",(function(){return Ca})),n.d(t,"b",(function(){return wa}));var a=n(15),r=n(185),c=n(3),i=n.n(c),o=n(1294),u=n(293),s=n(74),l=n(72),d=n(19),f=n(2),b=n(1),j=n(2434),v=n(31),p=function(){throw new Error("You forgot to wrap your component in <JsonFormsContextProvider>.")},O=Object(c.createContext)({context:{},bindContext:!0,uiSchemaLibrary:{},registerValidationProvider:p,unregisterValidationProvider:p,validationProviderUpdated:p}),m=function(e){var t=e.context,n=e.bindContext,a=e.uiSchemaLibrary,r=e.children,i=e.onErrorsChange,o=Object(c.useState)({}),u=Object(b.a)(o,2),s=u[0],l=u[1];Object(c.useEffect)((function(){var e=Object.values(s).flatMap((function(e){return e}));null===i||void 0===i||i(e)}),[s,i]);var p=Object(c.useCallback)((function(e){l((function(t){return Object(f.a)(Object(f.a)({},t),{},Object(d.a)({},e,[]))}))}),[]),m=Object(c.useCallback)((function(e){l((function(t){return Object(j.a)([e],t)}))}),[]),h=Object(c.useCallback)((function(e,t){l((function(n){return e in n?Object(f.a)(Object(f.a)({},n),{},Object(d.a)({},e,t)):n}))}),[]);return Object(v.jsx)(O.Provider,{value:{context:null!==t&&void 0!==t?t:{},bindContext:null===n||void 0===n||n,uiSchemaLibrary:null!==a&&void 0!==a?a:{},registerValidationProvider:p,unregisterValidationProvider:m,validationProviderUpdated:h},children:r})},h=function(){return Object(c.useContext)(O)},g=n(121),x=Object(l.withJsonFormsLayoutProps)((function(e){var t=e.uischema,n=e.visible,a=e.data,r=e.path,i=h(),s=i.bindContext,l=i.context,d=Object(c.useMemo)((function(){var e=t;if(e||"text"in e){var n={data:a,path:r};return s&&Object.assign(n,l),Object(g.a)(e.text,n)}}),[t,a,r,s,l]);return d?Object(v.jsx)(o.a,{xsUp:!n,children:Object(v.jsx)("div",{children:Object(v.jsx)(u.a,{children:d})})}):null})),y=Object(s.rankWith)(3,Object(s.uiTypeIs)("Markdown")),k=n(903),C=n(900),w=Object(k.a)((function(e){return Object(C.a)({viewer:{width:"100%",minHeight:"800px"}})})),I=Object(l.withJsonFormsLayoutProps)((function(e){var t=w(),n=e.uischema,a=e.visible,r=e.data,i=e.path,u=h(),s=u.bindContext,l=u.context,d=Object(c.useMemo)((function(){var e=n;if(e||"url"in e){var t={data:r,path:i};return s&&Object.assign(t,l),Object(g.a)(e.url,t)}}),[n,r,i,s,l]);return d?Object(v.jsx)(o.a,{xsUp:!a||!d,children:Object(v.jsx)("object",{data:d,type:"application/pdf",className:t.viewer,children:Object(v.jsx)("embed",{src:d,type:"application/pdf"})})}):null})),S=Object(s.rankWith)(3,Object(s.uiTypeIs)("Pdf")),T=n(18),P=n(0),R=n(81),M=["uischema","schema","path","renderers"],N=Object(l.withJsonFormsLayoutProps)((function(e){var t=e.uischema,n=e.schema,a=e.path,r=e.renderers,i=Object(T.a)(e,M),o=Object(l.useJsonForms)().core,u=h().uiSchemaLibrary,d="Use"===t.type?t:void 0,b=d?u[d.name]:void 0,j=d?s.Resolve.schema(n,d.scope):void 0,p=Object(c.useMemo)((function(){if(r&&b&&j)return function(e,t){var n,a=-1,r=void 0,c=Object(P.a)(e);try{for(c.s();!(n=c.n()).done;){var i=n.value,o=t(i);o>a&&(a=o,r=i)}}catch(u){c.e(u)}finally{c.f()}return r}(r,(function(e){return e.tester(b,j)}))}),[b,r,j]);if(!b||!d||!j)return null;var O=Object(s.composeWithUi)(d,a),m=s.Resolve.data(null===o||void 0===o?void 0:o.data,O);if(Object(R.isPresent)(p)&&-1!==p.tester(b,j)){var g=p.renderer;return Object(v.jsx)(g,Object(f.a)({uischema:b,schema:j,path:O,data:m,renderers:r},i))}return Object(v.jsx)(l.UnknownRenderer,{type:"renderer"})})),D=Object(s.rankWith)(3,Object(s.uiTypeIs)("Use")),A=n(5),E=n.n(A),z=n(32),L=n(97),F=n(222),U=n(197),B=Object(l.withJsonFormsControlProps)((function(e){var t=e.uischema.options.optionsSource,n=t.moduleName,a=t.functionName,i=Object(F.a)().call,o=Object(L.a)("function/".concat(n,"/").concat(a),Object(z.a)(E.a.mark((function e(){var t,r,c,o,u,s,l,d,f;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],e.next=3,i(n,a);case 3:if(r=e.sent,Array.isArray(r)){c=Object(P.a)(r);try{for(c.s();!(o=c.n()).done;)u=o.value,s=void 0,l=void 0,Object(U.a)(u)?(s=u.value,"string"===typeof u.label&&(l=u.label)):s=u,Object(R.isPresent)(s)&&(f={label:null!==(d=l)&&void 0!==d?d:"string"===typeof s?s:JSON.stringify(s),value:s},t.push(f))}catch(b){c.e(b)}finally{c.f()}}return e.abrupt("return",t);case 6:case"end":return e.stop()}}),e)}))),{fallbackData:[],revalidateOnMount:!0,revalidateOnFocus:!1}).data,u=Object(c.useMemo)((function(){return Object(f.a)(Object(f.a)({},e),{},{options:o})}),[e,o]);return Object(v.jsx)(r.MaterialInputControl,Object(f.a)(Object(f.a)({},u),{},{input:r.MuiSelect}))})),W=Object(s.rankWith)(3,Object(s.and)(s.isControl,(function(e){var t,n=null===(t=e.options)||void 0===t?void 0:t.optionsSource;return!!n&&!!n.moduleName&&!!n.functionName}))),_=n(230),V=n(2482),$=n(1291),H=n(67),G=n(2426),J=n(940),q=n(918),Z=n(2429),Y=n(2444),K=n(456),Q=n.n(K),X=n(2457),ee=n(386),te=n(667),ne=n(36),ae=n(2474),re=n(2458),ce=n(589),ie=n.n(ce),oe=n(288),ue=n.n(oe),se=n(220),le=n.n(se),de=n(665),fe=n(608),be=n.n(fe),je=n(96),ve=n(164),pe=["image/png","image/jpeg","image/webp"],Oe=function(e){return new Promise((function(t,n){var a=new Image;a.crossOrigin="anonymous",a.addEventListener("load",(function(){return t(a)})),a.addEventListener("error",(function(e){return n(e)})),a.src=e}))},me=function(){var e=Object(z.a)(E.a.mark((function e(t,n){var a,r,c;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=new Blob([t.content],{type:t.mimeType}),r=URL.createObjectURL(a),e.prev=2,e.next=5,Oe(r);case 5:c=e.sent,t.pages.push({getImageData:function(){var e=document.createElement("canvas"),t=e.getContext("2d");return e.width=c.naturalWidth,e.height=c.naturalHeight,t.drawImage(c,0,0),t.getImageData(0,0,c.naturalWidth,c.naturalHeight)},width:c.naturalWidth,height:c.naturalHeight,fileIndex:n,filePageNumber:0,pageIndex:0});case 7:return e.prev=7,URL.revokeObjectURL(r),e.finish(7);case 10:case"end":return e.stop()}}),e,null,[[2,,7,10]])})));return function(t,n){return e.apply(this,arguments)}}(),he=function(){var e=Object(z.a)(E.a.mark((function e(t,n){var a,r,c,i;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a=new ue.a({buffer:t.content}),r=function(e,r){a.setDirectory(e);var c={getImageData:function(){a.setDirectory(e);var t=a.readRGBAImage();return new ImageData(new Uint8ClampedArray(t),a.width(),a.height())},width:a.width(),height:a.height(),fileIndex:n,filePageNumber:e,pageIndex:0};t.pages.push(c)},c=0,i=a.countDirectory();c<i;++c)r(c);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),ge=function(){var e=Object(z.a)(E.a.mark((function e(t,n){var a,r,c,i,o,u;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=new Uint8Array(t.content),e.next=3,de.a.getDocument(a).promise;case 3:for(r=e.sent,c=[],i=new Array(r.numPages),o=function(e){c.push(r.getPage(e+1).then(function(){var t=Object(z.a)(E.a.mark((function t(a){var r,c;return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=2*window.devicePixelRatio,c=a.getViewport({scale:r}),i[e]={getImageData:function(){var e=Object(z.a)(E.a.mark((function e(){var t,n;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=document.createElement("canvas")).style.width="".concat(c.width/r,"px"),t.style.height="".concat(c.height/r,"px"),t.height=c.height,t.width=c.width,n=t.getContext("2d"),e.next=8,a.render({canvasContext:n,viewport:c}).promise;case 8:return e.abrupt("return",n.getImageData(0,0,t.width,t.height));case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),width:c.width,height:c.height,fileIndex:n,filePageNumber:e,pageIndex:0};case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()))},u=0;u<r.numPages;u++)o(u);return e.next=10,Promise.all(c);case 10:t.pages=i;case 11:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),xe=function(){var e=Object(z.a)(E.a.mark((function e(t,n,a){var r,c,i,o,u,s;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=t.lastIndexOf("/"),i=c>=0?t.substring(c+1):t,o={url:t,status:"loaded",name:i,mimeType:a.headers["content-type"],content:a.data,pages:[],pageStartIndex:0},u=null===(r=a.headers)||void 0===r?void 0:r["content-disposition"],(s=u?/filename="?([^"]*?)"?(;|$)/g.exec(u):void 0)&&s.length>1&&(o.name=s[1]),o.mimeType&&!pe.includes(o.mimeType)){e.next=11;break}return e.next=9,me(o,n);case 9:e.next=19;break;case 11:if("image/tiff"!==o.mimeType){e.next=16;break}return e.next=14,he(o,n);case 14:e.next=19;break;case 16:if("application/pdf"!==o.mimeType){e.next=19;break}return e.next=19,ge(o,n);case 19:return e.abrupt("return",o);case 20:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),ye=function(e,t){return Object(ne.a)(e,(function(e){null===t||void 0===t||t.forEach((function(t,n){t.pages.forEach((function(t,a){var r=e[t.fileIndex];if("loaded"===(null===r||void 0===r?void 0:r.status)){var c=r.pages[t.filePageNumber];c.documentIndex=n,c.documentOrder=a}}))}));var n,a=0,r=Object(P.a)(e);try{for(r.s();!(n=r.n()).done;){var c=n.value;if("loaded"===c.status){c.pageStartIndex=a;var i,o=Object(P.a)(c.pages);try{for(o.s();!(i=o.n()).done;){i.value.pageIndex=a++}}catch(u){o.e(u)}finally{o.f()}}}}catch(u){r.e(u)}finally{r.f()}}))},ke=n(158),Ce=Symbol("marker"),we=Object(s.createAjv)({allErrors:!0,addUsedSchema:!1,useDefaults:!0});we.addFormat("image",(function(){return!0})),we.addKeyword("patternMask",{type:"string",valid:!0,errors:!1});var Ie=function(e,t){var n=function(e){for(var t="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=new Uint8Array(e),r=a.byteLength,c=r%3,i=r-c,o=0;o<i;o+=3){var u=a[o]<<16|a[o+1]<<8|a[o+2],s=(258048&u)>>12,l=(4032&u)>>6,d=63&u;t+=n[(16515072&u)>>18]+n[s]+n[l]+n[d]}if(1===c){var f=a[i],b=(3&f)<<4;t+=n[(252&f)>>2]+n[b]+"=="}else if(2===c){var j=a[i]<<8|a[i+1],v=(1008&j)>>4,p=(15&j)<<2;t+=n[(64512&j)>>10]+n[v]+n[p]+"="}return t}(e);return"data:".concat(t,";base64,").concat(n)};var Se=function(){throw new Error("You forgot to wrap your component in <BatchProcessorContextProvider>.")},Te={fileInfos:[],documentInfos:[],loadingImages:!1,setCurrentDocumentLocation:Se,updateCurrentDocument:Se,updateBatch:Se,movePage:Se,findByPageIndex:Se,deleteDocument:Se,addDocument:Se,updateDocument:Se,getDocument:Se,setCurrentDocumentEditionState:Se,canModify:!0,getDisplayableDataUrl:Se},Pe=Object(c.createContext)(Te),Re=function(e,t){var n,a=Object(P.a)(t);try{for(a.s();!(n=a.n()).done;){var r,c=n.value,i="loaded"===c.status?c.pages:[],o=Object(P.a)(i);try{for(o.s();!(r=o.n()).done;){var u=r.value;if(u.pageIndex===e)return u}}catch(s){o.e(s)}finally{o.f()}}}catch(s){a.e(s)}finally{a.f()}},Me=function(e){return ie()(e).map((function(e){return e-1}))},Ne=function(e,t,n){var a=e;return a&&(a+=","),a+=t.toString(),t!==n&&(a+="-".concat(n)),a},De=function(e){if(0===e.length)return"";for(var t=e.map((function(e){return e+1})),n=t[0],a=n,r="",c=1;c<t.length;c++){var i=t[c];i===a+1&&a>=n||i===a-1&&a<=n?a=i:(r=Ne(r,n,a),n=a=i)}return r=Ne(r,n,a)},Ae=function(e,t){var n=new Array(e.length);return t.forEach((function(t,a){"loaded"===t.status&&t.pages.forEach((function(t,r){var c=e.indexOf(t.pageIndex);c>=0&&(n[c]={fileIndex:a,filePageNumber:r})}))})),n},Ee=function(e,t){return t&&!we.validate(t,e.data)&&we.errors?Object(ke.a)(we.errors.map((function(e){return Object(f.a)(Object(f.a)({},e),{},{instancePath:e.dataPath})}))):[]},ze=function(e){var t=e.basePath,n=e.batch,r=e.documentSchemasSource,i=e.readonly,o=e.children,u=!i,j=Object(c.useState)(n),p=Object(b.a)(j,1)[0],O=function(e){var t=e.moduleName,n=e.functionName,a=Object(F.a)().call,r=Object(L.a)("function/".concat(t,"/").concat(n),Object(z.a)(E.a.mark((function e(){var r,c,i,o,u;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=[],e.next=3,a(t,n);case 3:if(c=e.sent,Array.isArray(c)){i=Object(P.a)(c);try{for(i.s();!(o=i.n()).done;)u=o.value,"success"===Object(ke.b)(u).type&&r.push(u)}catch(s){i.e(s)}finally{i.f()}}return e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)}))),{revalidateOnFocus:!1}),i=r.data,o=r.isValidating,u=r.error;return{documentSchemas:Object(c.useMemo)((function(){return null!==i&&void 0!==i?i:[]}),[i]),loading:o,error:u}}(r).documentSchemas,m=Object(l.useJsonForms)().dispatch,g=function(e,t){var n=Object(ve.c)().hubBaseUrl,a=Object(je.c)().getConfiguredAxiosInstance,r=Object(c.useState)((function(){return e.fileUrls.map((function(e){var t=be()(e);return t.is("relative")&&n&&(t=be.a.joinPaths("BlobStorage",t).absoluteTo(n)),{url:t.valueOf(),status:"loading",name:t.filename()}}))})),i=Object(b.a)(r,2),o=i[0],u=i[1],s=Object(c.useState)(t&&e.fileUrls.length>0),l=Object(b.a)(s,2),d=l[0],f=l[1];return Object(c.useEffect)((function(){if(t){var r=le.a.CancelToken.source(),c=le.a.create({responseType:"arraybuffer",cancelToken:r.token}),i=a({responseType:"arraybuffer",cancelToken:r.token});return e.fileUrls.map((function(t,a){var r=be()(t),o=c;return r.is("relative")&&n&&(r=be.a.joinPaths("BlobStorage",r),o=i),t=r.valueOf(),o.get(t).then((function(n){return xe(t,a,n).then((function(t){u((function(n){var r=Object(ne.a)(n,(function(e){e[a]=t}));return r.every((function(e){return"loading"!==e.status}))&&(r=ye(r,e.documents),f(!1)),r}))}))})).catch((function(n){u((function(r){var c=Object(ne.a)(r,(function(e){e[a]=function(e,t){var n=e.lastIndexOf("/"),a=n>=0?e.substring(n+1):e,r={url:e,status:"failed",name:a,error:t.message};return t.response&&(r.error="Code: ".concat(t.response.status,"\nData: ").concat(t.response.data)),r}(t,n)}));return c.every((function(e){return"loading"!==e.status}))&&(c=ye(c,e.documents),f(!1)),c}))}))})),function(){r.cancel(),f(!1)}}u((function(e){return e.map((function(e){return{name:e.name,status:"loaded",url:e.url,content:new ArrayBuffer(0),pages:[],pageStartIndex:0}}))}))}),[t,a,n,e.documents,e.fileUrls]),{loadingFileInfos:d,fileInfos:o,setFileInfos:u}}(p,u),x=g.fileInfos,y=g.loadingFileInfos,k=g.setFileInfos,C=Object(c.useState)({documentIndex:p.documents.length>0?0:void 0}),w=Object(b.a)(C,2),I=w[0],S=w[1],T=Object(c.useState)([]),M=Object(b.a)(T,2),N=M[0],D=M[1],A=function(e){var t=h(),n=t.registerValidationProvider,a=t.unregisterValidationProvider,r=t.validationProviderUpdated,i=Object(c.useState)(),o=Object(b.a)(i,2),u=o[0],s=o[1];Object(c.useEffect)((function(){return n(e),function(){return a(e)}}),[e,n,a]),Object(c.useEffect)((function(){var t=(null!==u&&void 0!==u?u:[]).map((function(t){var n="".concat(e,".").concat(t.dataPath);return Object(f.a)(Object(f.a)({},t),{},{dataPath:n,instancePath:n})}));r(e,t)}),[u,e,r]);var l=Object(c.useCallback)((function(e){s((function(t){return Object($.a)(t,e)?t:e}))}),[]);return Object(c.useMemo)((function(){return{updateErrors:l}}),[l])}(t).updateErrors,U=Object(c.useMemo)((function(){return n.documents.map((function(e,t){var n;return{schemaId:e.schemaId,action:e.action,errors:null!==(n=N[t])&&void 0!==n?n:[]}}))}),[n.documents,N]);Object(c.useEffect)((function(){if(O&&0!==p.documents.length){var e=p.documents.map((function(e){var t=O.find((function(t){return t.$id===e.schemaId}));return Ee(e,t)}));D((function(t){return e.map((function(e,n){return t[n]?t[n]:e}))}))}}),[p,O]);var B=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Object(c.useRef)(e),r=n.current;if(e!==r)if(r.length!==e.length)n.current=e;else if(t)for(var i=Object(a.a)(e),o=0;o<r.length;o++){var u=i.indexOf(r[o]);if(-1===u){n.current=e;break}i[u]=Ce}else for(var s=0;s<r.length;s++)if(r[s]!==e[s]){n.current=e;break}return n.current}(n.documents.reduce((function(e,t,n){return"send"===t.action&&e.push(n),e}),[]),!0);Object(c.useEffect)((function(){var e=B.flatMap((function(e){var t,n;return null!==(t=null===(n=N[e])||void 0===n?void 0:n.map((function(t){var n="documents[".concat(e,"].data.").concat(t.instancePath);return Object(f.a)(Object(f.a)({},t),{},{instancePath:n,dataPath:n})})))&&void 0!==t?t:[]}));u&&A(e)}),[u,N,B,A]);var W=Object(c.useCallback)((function(e,n){var a="function"===typeof n?n:function(){return n};null===m||void 0===m||m(Object(s.update)(Object(_.compose)(t,e),a))}),[m]),V=Object(c.useMemo)((function(){return Object(R.isPresent)(I.documentIndex)?n.documents[I.documentIndex]:void 0}),[n.documents,I.documentIndex]),H=Object(c.useCallback)((function(e){var t=null!==e&&void 0!==e?e:{};S((function(e){return e.documentIndex!==t.documentIndex||e.pageIndex!==t.pageIndex?t:e}))}),[]),G=Object(c.useCallback)((function(e){var t=null===I||void 0===I?void 0:I.documentIndex;Object(R.isPresent)(t)&&W("documents[".concat(t,"]"),e)}),[null===I||void 0===I?void 0:I.documentIndex,W]),J=Object(R.isPresent)(I.documentIndex)?N[I.documentIndex]:void 0,q=Object(c.useMemo)((function(){if(V&&J)return{document:V,errors:J}}),[V,J]),Z=Object(c.useCallback)((function(e){var t=I.documentIndex;D((function(n){var a,r=V?{document:V,errors:n[t]}:void 0,c="function"===typeof e?e(r):e,i=Object($.a)(null===c||void 0===c?void 0:c.errors,null===r||void 0===r?void 0:r.errors),o=Object($.a)(null===c||void 0===c?void 0:c.document,null===r||void 0===r?void 0:r.document);if(i&&o)return n;var u=null===c||void 0===c?void 0:c.document;return u&&!o&&G(u),Object(ae.a)(t,null!==(a=null===c||void 0===c?void 0:c.errors)&&void 0!==a?a:[],n)}))}),[V,I.documentIndex,G]),Y=Object(c.useCallback)((function(e,t){var a=Object(ne.a)({fileInfos:x,docs:n.documents},(function(n){var a=Re(e,n.fileInfos);if(a){var r,c=[],i=[],o=a.documentIndex===(null===t||void 0===t?void 0:t.documentIndex),u=Object(P.a)(n.fileInfos);try{for(u.s();!(r=u.n()).done;){var s=r.value;if("loaded"===s.status){var l,d=Object(P.a)(s.pages);try{for(d.s();!(l=d.n()).done;){var f=l.value;Object(R.isPresent)(a.documentIndex)&&f.documentIndex===a.documentIndex&&c.push(f),Object(R.isPresent)(t)&&f.documentIndex===t.documentIndex&&!o&&i.push(f)}}catch(g){d.e(g)}finally{d.f()}}}}catch(g){u.e(g)}finally{u.f()}c.sort(Object(X.a)((function(e,t){return e.documentOrder<t.documentOrder}))),i.sort(Object(X.a)((function(e,t){return e.documentOrder<t.documentOrder})));var b=a.documentIndex;if(Object(R.isPresent)(b)){var j=n.docs[b];c.splice(a.documentOrder,1),o?c.splice(t.documentOrder,0,a):(a.documentIndex=void 0,a.documentOrder=void 0);for(var v=0;v<c.length;v++)c[v].documentOrder=v;j&&(j.pages=c.map((function(e){return{fileIndex:e.fileIndex,filePageNumber:e.filePageNumber}})))}if(Object(R.isPresent)(t)&&!o){var p=t.documentIndex,O=t.documentOrder,m=n.docs[p];i.splice(O,0,a),a.documentIndex=p,a.documentOrder=O;for(var h=0;h<i.length;h++)i[h].documentOrder=h;m&&(m.pages=i.map((function(e){return{fileIndex:e.fileIndex,filePageNumber:e.filePageNumber}})))}}}));k(a.fileInfos),W("documents",a.docs)}),[n.documents,x,k,W]),K=Object(c.useCallback)((function(e){return Re(e,x)}),[x]),Q=Object(c.useCallback)((function(e){if(Object(R.isPresent)(n.documents[e])){var t=Object(a.a)(n.documents);t.splice(e,1),setTimeout((function(){return W("documents",t)}),0),D((function(t){return Object(re.a)(e,1,t)})),k((function(t){return Object(ne.a)(t,(function(t){var n,a=Object(P.a)(t);try{for(a.s();!(n=a.n()).done;){var r=n.value;if("loaded"===r.status){var c,i=Object(P.a)(r.pages);try{for(i.s();!(c=i.n()).done;){var o=c.value;o.documentIndex===e&&(o.documentIndex=void 0,o.documentOrder=void 0)}}catch(u){i.e(u)}finally{i.f()}}}}catch(u){a.e(u)}finally{a.f()}}))})),S((function(t){return t.documentIndex===e?{}:t}))}}),[n.documents,k,W]),ee=Object(c.useCallback)((function(e){var t=n.documents.length,r=[].concat(Object(a.a)(n.documents),[e]);return W("documents",r),D((function(e){return[].concat(Object(a.a)(e),[[]])})),e.pages.length>0&&k((function(n){return Object(ne.a)(n,(function(n){e.pages.forEach((function(e,a){var r=n[e.fileIndex];if("loaded"===(null===r||void 0===r?void 0:r.status)){var c=r.pages[e.filePageNumber];c&&(c.documentIndex=t,c.documentOrder=a)}}))}))})),t}),[n.documents,k,W]),te=Object(c.useCallback)((function(e,t){var r=Object(a.a)(n.documents),c=r[e].schemaId,i=r[e].pages;r[e]=t,W("documents",r);var o=t.pages;if(i!==o&&k((function(t){return Object(ne.a)(t,(function(t){var n,a=Object(P.a)(i.filter(R.isPresent));try{for(a.s();!(n=a.n()).done;){var r=n.value,c=t[r.fileIndex];if("loaded"===c.status){var u=c.pages[r.filePageNumber];u.documentIndex=void 0,u.documentOrder=void 0}}}catch(b){a.e(b)}finally{a.f()}for(var s=0;s<o.length;s++){var l=o[s];if(l){var d=t[l.fileIndex];if("loaded"===d.status){var f=d.pages[l.filePageNumber];f.documentIndex=e,f.documentOrder=s}}}}))})),c!==t.schemaId){var u=null===O||void 0===O?void 0:O.find((function(e){return e.$id===t.schemaId})),s=Ee(t,u);D((function(t){return Object(ae.a)(e,s,t)}))}return e}),[n.documents,O,k,W]),ce=Object(c.useCallback)((function(e){return n.documents[e]}),[n.documents]),ie=Object(c.useState)({}),oe=Object(b.a)(ie,2),se=oe[0],de=oe[1],fe=Object(c.useCallback)((function(e){var t=se[e];if(!t){var n=e.indexOf(",");if(!e.startsWith("data:")||-1===n)return e;if("image/tiff"===e.substring(5,n).split(";")[0]){var a=function(e){for(var t=atob(e.split(",")[1]),n=new ArrayBuffer(t.length),a=new Uint8Array(n),r=0;r<t.length;r++)a[r]=t.charCodeAt(r);return n}(e),r=new ue.a({buffer:a});t=r.toDataURL()}else t=e;de((function(n){return Object(f.a)(Object(f.a)({},n),{},Object(d.a)({},e,t))}))}return t}),[se]),pe=Object(c.useMemo)((function(){return{fileInfos:x,documentSchemas:O,loadingImages:y,documentInfos:U,currentDocumentLocation:I,setCurrentDocumentLocation:H,currentDocument:V,updateCurrentDocument:G,updateBatch:W,movePage:Y,findByPageIndex:K,deleteDocument:Q,addDocument:ee,updateDocument:te,getDocument:ce,currentDocumentEditionState:q,setCurrentDocumentEditionState:Z,canModify:u,getDisplayableDataUrl:fe}}),[ee,u,V,q,I,Q,U,O,x,fe,ce,K,Z,H,y,Y,W,G,te]);return Object(v.jsx)(Pe.Provider,{value:pe,children:o})},Le=function(){return Object(c.useContext)(Pe)},Fe=n(107),Ue=n(2401),Be=function(e){return Object(v.jsx)(Ue.a,Object(f.a)(Object(f.a)({viewBox:"0 0 512 512"},e),{},{children:Object(v.jsx)("path",{d:"M9.5 1.4C2.3 4.6 0 9.7 0 22.6V32h32V0h-9.7c-5.9.1-11 .6-12.8 1.4zM62 16v16h29V0H62v16zM121 16v16h29V0h-29v16zM180 16v16h29V0h-29v16zM239 16v16h29V0h-29v16zM298 16v16h29V0h-29v16zM357 16v16h29V0h-29v16zM416 15.9V32h32.2l-.4-10.9c-.2-9.2-.6-11.4-2.4-13.7-4.4-6-6.7-6.9-18.5-7.2L416-.2v16.1zM0 76.5V91h32V62H0v14.5zM416 76.5V91h32V62h-32v14.5zM0 135.5V150h32v-29H0v14.5zM416 135.5V150h32v-29h-32v14.5zM0 194.5V209h32v-29H0v14.5zM416 194.5V209h32v-29h-32v14.5zM297.5 225.4c-4.1 1.8-8.3 6.9-9 10.9-.3 1.8-.4 62.2-.3 134.4.3 130.7.3 131.2 2.4 133.9 4.9 6.7 13 9.1 19.5 6 1.9-.9 20.5-15.3 41.4-32.1l38-30.4 54.8-.1c59.9 0 58.9.1 64-5.9 3-3.7 4.2-8.5 3.2-13.9-.6-3.3-11.6-14.6-99.3-102.6-57.7-57.7-100-99.4-101.9-100.2-4-1.7-8.9-1.7-12.8 0zM417.7 416l-39.4.5-3.9 3c-2.1 1.6-15 11.8-28.6 22.7-13.6 10.9-25 19.8-25.3 19.8-.3 0-.5-41.3-.5-91.7v-91.8l68.5 68.5 68.5 68.5-39.3.5zM0 253.5V268h32v-29H0v14.5zM416 253.5V268h32v-29h-32v14.5zM0 312.5V327h32v-29H0v14.5zM0 371.5V386h32v-29H0v14.5zM.2 426.9c.3 11.8 1.2 14.1 7.2 18.5 2.3 1.8 4.5 2.2 13.7 2.4l10.9.4V416H-.2l.4 10.9zM62 432v16h29v-32H62v16zM121 432v16h29v-32h-29v16zM180 432v16h29v-32h-29v16z"})}))},We=function(e){return function(e){return"object"===typeof e&&"then"in e}(e)?e:Promise.resolve(e)},_e=n(609),Ve=n.n(_e),$e=Object(k.a)((function(e){return Object(C.a)({listContainer:{width:"100%",height:"100%"},imageItem:{width:"100%",display:"flex",justifyContent:"center",position:"relative"},imageContainer:{width:"100%"},image:{padding:3,borderRadius:e.shape.borderRadius,boxShadow:e.shadows[4]},divider:{marginTop:20,marginBottom:10},name:{textAlign:"center",marginTop:e.spacing(2)},extractIcon:{position:"absolute",bottom:e.spacing(4),right:e.spacing(2)}})})),He=function(e){var t=e.page,n=e.onImageExtractionRequested,a=e.listWidth,r=e.readonly,i=$e(),o=Object(V.a)().t,u=Object(c.useRef)(null),s=Object(c.useState)(),l=Object(b.a)(s,2),d=l[0],f=l[1],j=a-40,p=Object(c.useMemo)((function(){return j*t.height/t.width}),[t.height,t.width,j]),O=Object(c.useState)(),m=Object(b.a)(O,2),h=m[0],g=m[1],x=Object(c.useState)(),y=Object(b.a)(x,2),k=y[0],C=y[1],w=Object(c.useState)(!1),I=Object(b.a)(w,2),S=I[0],T=I[1];Object(c.useEffect)((function(){return function(){g(void 0),C(void 0)}}),[]),Object(c.useEffect)((function(){We(t.getImageData()).then((function(e){g(e)}))}),[t]),Object(c.useEffect)((function(){if(h){var e=function(e,t,n){var a=document.createElement("canvas");a.width=e.width,a.height=e.height;var r=a.getContext("2d");r.imageSmoothingEnabled=!1,r.putImageData(e,0,0);var c=document.createElement("canvas");c.width=t,c.height=n;var i=c.getContext("2d");return i.imageSmoothingEnabled=!1,i.drawImage(a,0,0,e.width,e.height,0,0,c.width,c.height),i.getImageData(0,0,t,n)}(h,j,p);C(e)}else C(void 0)}),[p,h,j]),Object(c.useEffect)((function(){var e=u.current;if(e){var n=e.getContext("2d"),a=null!==d&&void 0!==d?d:{x:0,y:0},r=a.x,c=a.y;if(d||S||!k||n.putImageData(k,0,0),S&&h){var i=r*t.width/e.width,o=c*t.height/e.height;n.putImageData(h,r-i,c-o)}else k&&n.putImageData(k,0,0)}}),[h,d,t.height,t.width,k,S]);var P=Object(c.useCallback)((function(){}),[]),M=Object(c.useCallback)((function(){}),[]),N=Object(c.useCallback)((function(e){var t=u.current;if(t&&(null===e||void 0===e?void 0:e.altKey)){var n=t.getBoundingClientRect(),a=n.left,r=n.top;f({x:e.pageX-a,y:e.pageY-r})}}),[]),D=Object(c.useCallback)((function(e){(null===e||void 0===e?void 0:e.altKey)&&T(!0)}),[T]),A=Object(c.useCallback)((function(){T(!1)}),[T]),E=Object(c.useCallback)((function(){T(!1)}),[T]);return Object(v.jsx)(G.a,{className:Object(H.default)(i.imageItem,"page-index-".concat(t.pageIndex)),children:Object(v.jsxs)("div",{className:i.imageContainer,children:[Object(v.jsx)(Ve.a,{upHandler:A,downHandler:E,children:Object(v.jsx)("canvas",{tabIndex:0,onKeyDown:D,ref:u,width:j,height:p,className:i.image,onMouseOver:P,onMouseOut:M,onMouseMove:N})}),Object(v.jsx)(q.a,{className:i.name,children:t.name}),Object(v.jsx)(Z.a,{variant:"fullWidth",className:i.divider}),Object(R.isPresent)(t.documentIndex)&&!r&&Object(v.jsx)(J.a,{title:o("ExtractImages"),children:Object(v.jsx)(Y.a,{className:i.extractIcon,color:"secondary",size:"small",onClick:function(){return null===n||void 0===n?void 0:n(t.pageIndex)},children:Object(v.jsx)(Be,{})})})]})})},Ge=i.a.memo((function(e){var t=e.filteredPages,n=e.width,a=e.height,r=e.onImageExtractionRequested,i=e.readonly,o=$e(),u=Object(c.useCallback)((function(e){if(!Object(R.isPresent)(n))return 0;var a=t[e];return"loaded"!==a.status?100:(n-40)*a.height/a.width+100}),[t,n]);return Object(v.jsx)(te.a,{height:a,itemCount:t.length,itemSize:u,width:n,children:function(e){var a=e.index,c=e.style,u=t[a];return"loaded"!==u.status?Object(v.jsxs)(G.a,{className:o.imageItem,style:c,children:["loading"===u.status&&Object(v.jsx)(Fe.a,{}),"failed"===u.status&&Object(v.jsx)(Q.a,{color:"error"}),Object(v.jsx)(q.a,{style:{textAlign:"center"},children:u.name})]},a):Object(v.jsx)("div",{style:c,children:Object(v.jsx)(He,{page:u,onImageExtractionRequested:r,listWidth:n,readonly:i})},u.pageIndex)}})})),Je=function(e){var t=e.onImageExtractionRequested,n=Le(),a=n.fileInfos,r=n.currentDocumentLocation,i=n.currentDocument,o=$e(),u=Object(ee.a)({}),s=u.width,l=u.height,d=u.ref,f=Object(c.useMemo)((function(){var e=a.flatMap((function(e){return"loaded"!==e.status?[{finfo:e}]:e.pages.map((function(t,n){return{finfo:e,pinfo:t,pinfoOrder:n}}))}));return e.map((function(e){var t=e.finfo,n=e.pinfo,a=e.pinfoOrder;if("loaded"!==t.status)return{status:t.status,name:t.name};var r="".concat(n.pageIndex+1," - ").concat(t.name);return t.pages.length>1&&(r+=" / ".concat(a+1)),{status:t.status,name:r,getImageData:n.getImageData,width:n.width,height:n.height,fileInfoIndex:n.fileIndex,filePageNumber:n.filePageNumber,pageIndex:n.pageIndex,documentIndex:n.documentIndex,documentOrder:n.documentOrder}}))}),[a]),b=Object(c.useMemo)((function(){if(!r)return f;var e=r.pageIndex;if(Object(R.isPresent)(e))return f.filter((function(t){return"loaded"===t.status&&t.pageIndex===e}));var t=r.documentIndex,n=f.filter((function(e){return"loaded"===e.status&&e.documentIndex===t}));return Object(R.isPresent)(t)?n.sort(Object(X.a)((function(e,t){return e.documentOrder<t.documentOrder}))):n.sort(Object(X.a)((function(e,t){return e.pageIndex<t.pageIndex}))),n}),[f,r]);return Object(v.jsx)("div",{ref:d,className:o.listContainer,children:Object(R.isPresent)(s)&&Object(R.isPresent)(l)&&Object(v.jsx)(Ge,{filteredPages:b,width:s,height:l,onImageExtractionRequested:t,readonly:"dontSend"===(null===i||void 0===i?void 0:i.action)})})},qe=n(917),Ze=n(961),Ye=n(154),Ke=n.n(Ye),Qe=n(206),Xe=n.n(Qe),et=n(257),tt=n.n(et),nt=n(613),at=n.n(nt),rt=n(614),ct=n.n(rt),it=n(33),ot=n(664),ut=n(458),st=n.n(ut),lt=n(146),dt=n(2406),ft=n(2422),bt=n(2412),jt=n(2411),vt=n(926),pt=n(920),Ot=n(951),mt=n(2404),ht=n(1912),gt=n(2459),xt=n(190),yt=n(666),kt=["saveAsDraft","send","dontSend"];Object.freeze(kt);var Ct,wt=n(137),It=function e(t){var n={};if(t)for(var a=function(){var a=c[r];Array.isArray(t[a])?t[a].forEach((function(t,r){var c=n[a];Object(R.isPresent)(c)||(n[a]=c=[]),c[r]=e(t)})):"object"===typeof t[a]&&null!==t[a]?n[a]=e(t[a]):n[a]=!0},r=0,c=Object.keys(t);r<c.length;r++)a();return n},St=["name","debounce","onChange","onBlur","helperText","error","disabled","controlValueAdapter"],Tt=function(e){var t=e.name,n=e.debounce,a=e.onChange,r=e.onBlur,i=e.helperText,o=(e.error,e.disabled),u=e.controlValueAdapter,s=Object(T.a)(e,St),l=Object(xt.d)().isSubmitting,d=Object(xt.c)({name:t}),j=Object(b.a)(d,3),p=j[0],O=j[1],m=j[2],h=O.error,g=O.touched&&!!h,x=Object(c.useState)(p.value),y=Object(b.a)(x,2),k=y[0],C=y[1],w=Object(c.useState)(),I=Object(b.a)(w,2),S=I[0],P=I[1];Object(c.useEffect)((function(){C(p.value)}),[p.value]);var M=Object(c.useCallback)((function(e){var t=e.target.value;m.setValue(u?u(t):t),null===a||void 0===a||a(e)}),[u,m,a]),N=Object(c.useCallback)((function(e){C((function(t){var n=e.target.value;return n||t})),Object(R.isPresent)(n)?(e.persist(),S&&clearTimeout(S),P(setTimeout((function(){return M(e)}),n))):M(e)}),[M,n,S]),D=Object(c.useCallback)((function(e){p.onBlur(e),null===r||void 0===r||r(e)}),[p,r]);return Object(v.jsx)(v.Fragment,{children:Object(v.jsx)(pt.a,Object(f.a)(Object(f.a)({},p),{},{value:null!==k&&void 0!==k?k:"",onChange:N,onBlur:D,error:g,helperText:g?h:i,disabled:null!==o&&void 0!==o?o:l},s))})},Pt=n(2488),Rt=["name","controlValueAdapter","onChange","onBlur","renderInput","multiple","loading","disabled"],Mt=function(e){var t,n=e.name,a=e.controlValueAdapter,r=e.onChange,i=e.onBlur,o=e.renderInput,u=e.multiple,s=e.loading,l=e.disabled,d=Object(T.a)(e,Rt),j=Object(xt.d)(),p=j.isSubmitting,O=j.setFieldTouched,m=Object(xt.c)({name:n}),h=Object(b.a)(m,3),g=h[0],x=h[1],y=h[2],k=x.error,C=x.touched&&!!k,w=Object(c.useCallback)((function(e,t,n,c){var i=a?a(t):t;y.setValue(null!==i&&void 0!==i?i:void 0),null===r||void 0===r||r(e,t,n,c)}),[a,y,r]),I=Object(c.useCallback)((function(e){O(g.name),g.onBlur(e),null===i||void 0===i||i(e)}),[g,i,O]),S=Object(c.useCallback)((function(e){return o?o(Object(f.a)(Object(f.a)({},e),{},{error:C,helperText:C?k:void 0})):null}),[k,o,C]);return Object(v.jsx)(v.Fragment,{children:Object(v.jsx)(Pt.a,Object(f.a)(Object(f.a)({},g),{},{value:null!==(t=g.value)&&void 0!==t?t:null,onChange:w,onBlur:I,renderInput:S,disabled:null!==l&&void 0!==l?l:p,loading:s||p,multiple:u},d))})},Nt=Object(k.a)((function(e){return Object(C.a)({dialogPaper:{},dialogContent:{}})})),Dt=function(e){var t=Object(V.a)().t,n=Le().documentSchemas,a=Object(c.useMemo)((function(){var e={};if(n){var t,a=Object(P.a)(n);try{for(a.s();!(t=a.n()).done;){var r,c=t.value;c.$id&&(e[c.$id]={label:null!==(r=c.title)&&void 0!==r?r:c.$id,description:c.description})}}catch(i){a.e(i)}finally{a.f()}}return e}),[n]),r=Object(c.useMemo)((function(){var e=Object.keys(a);return Object(ht.a)((function(e){return a[e].label}),e)}),[a]);return Object(v.jsxs)(mt.a,{container:!0,spacing:3,children:[Object(v.jsx)(mt.a,{item:!0,xs:12,children:Object(v.jsx)(Mt,{name:"schemaId",options:r,getOptionLabel:function(e){var t;return null===(t=a[e])||void 0===t?void 0:t.label},renderInput:function(e){return Object(v.jsx)(pt.a,Object(f.a)(Object(f.a)({},e),{},{label:t("Schema"),InputLabelProps:{required:!0},required:!0,autoFocus:!0}))},fullWidth:!0})}),Object(v.jsx)(mt.a,{item:!0,xs:12,children:Object(v.jsx)(Tt,{name:"pages",label:t("Pages"),fullWidth:!0})}),Object(v.jsx)(mt.a,{item:!0,xs:12,children:Object(v.jsx)(Tt,{select:!0,name:"action",label:t("Action"),fullWidth:!0,children:kt.map((function(e){return Object(v.jsx)(Ot.a,{value:e,children:t("RecognizedDocumentAction.".concat(e))},e)}))})})]})},At="(\\d+(\\s*-\\s*\\d+)?)",Et="^\\s*".concat(At,"(\\s*,\\s*").concat(At,")*\\s*$"),zt=new RegExp(Et),Lt=function(e){var t=e.open,n=e.document,r=e.availablePageIndices,i=e.onChange,o=e.onClose,u=Object(V.a)().t,s=Nt(),l=Le(),d=l.documentSchemas,f=l.fileInfos,b=Object(c.useMemo)((function(){var e,t=n?function(e,t){return e.map((function(e){var n=t[e.fileIndex];return"loaded"===n.status?n.pages[e.filePageNumber].pageIndex:-1}))}(n.pages,f):r;return{schemaId:null===n||void 0===n?void 0:n.schemaId,pages:De(t),action:null!==(e=null===n||void 0===n?void 0:n.action)&&void 0!==e?e:"send"}}),[r,n,f]),j=Object(c.useRef)(),p=Object(c.useMemo)((function(){return function(e,t){return yt.a().shape({schemaId:yt.b().required().test({test:function(e){return!e||!("string"!==typeof e||!t.find((function(t){return t.$id===e})))||this.createError({path:this.path,message:it.a.t("UnknownDocumentSchema",{schemaId:e})})}}),pages:yt.b().test({test:function(t){if(!t)return!0;if("string"!==typeof t||!zt.test(t))return this.createError({path:this.path,message:it.a.t("InvalidPageRange",{range:t})});var n=Me(t),a=Object(gt.a)(n,e);return!(a.length>0)||(a.sort(),this.createError({path:this.path,message:it.a.t("PagesAlreadyUsedInOtherDocuments",{pages:a.map((function(e){return e+1})).join(", ")})}))}}),action:yt.b().required().oneOf(Object(a.a)(kt))})}(r,null!==d&&void 0!==d?d:[])}),[r,d]),O=Object(c.useCallback)((function(){var e=j.current;e&&function(e){e.validateForm().then((function(t){Object.keys(t).length>0?e.setTouched(It(t)):e.handleSubmit()}))}(e)}),[]),m=Object(c.useCallback)(function(){var e=Object(z.a)(E.a.mark((function e(t,a){var r,c;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{r={schemaId:t.schemaId,pages:[],data:null===n||void 0===n?void 0:n.data,action:t.action},t.pages&&(c=Me(t.pages),r.pages=Ae(c,f)),null===i||void 0===i||i(r),null===o||void 0===o||o()}finally{a.setSubmitting(!1)}case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),[null===n||void 0===n?void 0:n.data,f,i,o]),h=Object(c.useCallback)((function(){null===o||void 0===o||o()}),[o]),g=Object(c.useCallback)(function(){var e=Object(z.a)(E.a.mark((function e(t,n){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"backdropClick"!==n&&(null===o||void 0===o||o());case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),[o]);return Object(v.jsxs)(dt.a,{open:t,onClose:g,maxWidth:"sm",fullWidth:!0,classes:{paper:s.dialogPaper},children:[Object(v.jsx)(jt.a,{children:u(n?"EditingDocument":"AddingDocument")}),Object(v.jsx)(bt.a,{className:s.dialogContent,children:Object(v.jsx)(wt.a,{children:Object(v.jsx)(xt.b,{innerRef:function(e){return j.current=e},initialValues:b,onSubmit:m,validationSchema:p,validateOnChange:!0,validateOnBlur:!0,children:Object(v.jsx)(xt.a,{autoComplete:"off",children:Object(v.jsx)(Dt,{availablePageIndices:r})})})})}),Object(v.jsxs)(ft.a,{children:[Object(v.jsx)(vt.a,{onClick:O,color:"primary",children:u("Accept")}),Object(v.jsx)(vt.a,{onClick:h,color:"primary",children:u("Cancel")})]})]})},Ft=function(e){return Object(v.jsxs)(Ue.a,Object(f.a)(Object(f.a)({viewBox:"0 0 1000 1000"},e),{},{children:[Object(v.jsx)("path",{d:"M808.3 950h-725C42.9 950 10 917.1 10 876.7V171.6c0-40.4 32.9-73.3 73.3-73.3h502.1c18.6 0 33.6 15.1 33.6 33.6 0 18.6-15.1 33.6-33.6 33.6H83.3c-3.4 0-6.1 2.7-6.1 6.1v705.1c0 3.4 2.7 6.1 6.1 6.1h724.9c3.4 0 6.1-2.7 6.1-6.1V492c0-18.6 15-33.6 33.6-33.6s33.6 15.1 33.6 33.6v384.7c.1 40.4-32.8 73.3-73.2 73.3z"}),Object(v.jsx)("path",{d:"M307.3 781.2c-16.1 0-31.1-8.1-40.1-21.7-8.9-13.5-10.5-30.4-4.1-45.3l83.4-196.8 431-431C801 62.9 832.3 50 865.5 50s64.5 13 88 36.5c48.5 48.6 48.5 127.5 0 176.1l-431 431-196.3 83.8c-6 2.5-12.4 3.8-18.9 3.8zm96-225.5-59.8 141.1 140.8-60.1L906 215c22.3-22.3 22.3-58.7 0-81-10.8-10.8-25.2-16.8-40.5-16.8s-29.7 6-40.5 16.8L403.3 555.7z"}),Object(v.jsx)("path",{d:"M398.4 502.3 530 633.8l-47.5 47.5-131.6-131.5 47.5-47.5zM800.2 100.5 931.8 232l-47.5 47.5L752.7 148l47.5-47.5z"})]}))},Ut=Object(k.a)((function(e){return Object(C.a)({toolbar:{minHeight:"48px",paddingLeft:0,borderBottom:"solid 2px ".concat(e.palette.divider)},tree:{"& .rst__collapseButton":{backgroundColor:"dark"===e.palette.type?e.palette.background.paper:void 0,backgroundImage:"dark"===e.palette.type?"url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCI+PGNpcmNsZSBjeD0iOSIgY3k9IjkiIHI9IjgiIGZpbGw9Im5vbmUiLz48ZyBzdHJva2U9IiNGRkYiIHN0cm9rZS13aWR0aD0iMS45IiA+PHBhdGggZD0iTTQuNSA5aDkiLz48L2c+Cjwvc3ZnPg==)":void 0},"& .rst__expandButton":{backgroundColor:"dark"===e.palette.type?e.palette.background.paper:void 0,backgroundImage:"dark"===e.palette.type?"url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCI+PGNpcmNsZSBjeD0iOSIgY3k9IjkiIHI9IjgiIGZpbGw9Im5vbmUiLz48ZyBzdHJva2U9IiNGRkYiIHN0cm9rZS13aWR0aD0iMS45IiA+PHBhdGggZD0iTTQuNSA5aDkiLz48cGF0aCBkPSJNOSA0LjV2OSIvPjwvZz4KPC9zdmc+)":void 0},"& .rst__collapseButton:focus, & .rst__expandButton:focus":{boxShadow:"dark"===e.palette.type?"0 0 0 1px #000":void 0,outline:"initial"}},node:{"& .rst__rowContents":{cursor:"pointer",backgroundColor:e.palette.background.default},"& .rst__moveHandle":{backgroundColor:"dark"===e.palette.type?e.palette.background.paper:void 0}},selectedNode:{"& .rst__rowContents":{backgroundColor:e.palette.action.selected}},actionIcon:{marginLeft:5,verticalAlign:"bottom"},sendActionIcon:{marginLeft:5,color:st.a[500],verticalAlign:"bottom"},documentWithErrors:{textDecoration:"underline wavy ".concat(e.palette.error.main)}})})),Bt=function(e){return Object(R.isPresent)(e.documentIndex)&&!Object(R.isPresent)(e.pageIndex)},Wt=function(e){return!Object(R.isPresent)(e.documentIndex)&&!Object(R.isPresent)(e.pageIndex)},_t=function(e){return Object(R.isPresent)(e.pageIndex)},Vt=function(e){var t=e.node;return _t(t)?"p-".concat(t.pageIndex):Bt(t)?"d-".concat(t.documentIndex):"o"},$t=function(e){return!_t(e)},Ht=function(e){return _t(e.node)},Gt=function(e){var t=e.node,n=e.nextParent,a=t;return!!n&&(!!Object(R.isPresent)(a.documentIndex)||!Wt(n))},Jt=function(){var e=Le(),t=e.documentSchemas,n=e.fileInfos,r=e.documentInfos,i=e.canModify,o=Object(c.useState)([]),u=Object(b.a)(o,2),s=u[0],l=u[1];return Object(c.useEffect)((function(){l((function(e){var c=i?function(e,t,n){var r,c=[],i=[],o=Object(P.a)(e);try{for(o.s();!(r=o.n()).done;){var u=r.value;"loaded"===u.status&&u.pages.forEach((function(e){var t=it.a.t("PageN",{index:e.pageIndex+1}),n=e.documentIndex,a={title:t,pageIndex:e.pageIndex,documentIndex:n};if(Object(R.isPresent)(n)&&Object(R.isPresent)(e.documentOrder)){var r=i[n];r||(i[n]=r=[]),r[e.documentOrder]=a}else c.push(a)}))}}catch(s){o.e(s)}finally{o.f()}return[].concat(Object(a.a)(i.map((function(e,a){var r=it.a.t("DocumentN",{index:a+1}),c=t[a].schemaId;if(c){var i=null===n||void 0===n?void 0:n.find((function(e){return e.$id===c}));if(i){var o=i.title;if(!o){var u=c.lastIndexOf("/");(o=c.substring(u+1)).toLocaleLowerCase().endsWith(".json")&&(o=o.substring(0,o.length-5))}r="".concat(a+1," - ").concat(o)}}return{documentIndex:a,title:r,action:t[a].action,errors:t[a].errors,children:null!==e&&void 0!==e?e:[]}}))),[{title:it.a.t("OrphanPages"),children:c}])}(n,r,t):function(e,t){return e.map((function(n,a){var r=it.a.t("DocumentN",{index:a+1}),c=e[a].schemaId;if(c){var i=null===t||void 0===t?void 0:t.find((function(e){return e.$id===c}));if(i){var o=i.title;if(!o){var u=c.lastIndexOf("/");(o=c.substring(u+1)).toLocaleLowerCase().endsWith(".json")&&(o=o.substring(0,o.length-5))}r="".concat(a+1," - ").concat(o)}}return{documentIndex:a,title:r,action:e[a].action,errors:e[a].errors,children:[]}}))}(r,t);if(e.length>0){for(var o=0;o<Math.min(c.length,e.length-1);o++)c[o].expanded=e[o].expanded;c[c.length-1].expanded=e[e.length-1].expanded}return c}))}),[i,r,t,n]),{treeData:s,setTreeData:l}},qt=function(e){var t=e.node,n=Object(V.a)().t,a=Ut(),r="send"===t.action?Object(v.jsx)(at.a,{className:a.sendActionIcon}):"dontSend"===t.action?Object(v.jsx)(ct.a,{className:a.actionIcon,color:"error"}):Object(v.jsx)(Ft,{className:a.actionIcon});return Object(v.jsx)(J.a,{title:n("RecognizedDocumentAction.".concat(t.action)),children:Object(v.jsx)("span",{children:r})})},Zt=function(e){var t=e.node,n=e.canModify,a=Ut(),r="send"===t.action&&t.errors.length>0&&n?a.documentWithErrors:void 0;return Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)("span",{className:r,children:t.title}),Object(v.jsx)(qt,{node:t})]})},Yt=function(e){var t=e.description,n=e.onClick,a=e.icon;return Object(v.jsx)(J.a,{title:t,children:Object(v.jsx)(qe.a,{size:"small",onClick:n,children:a})})},Kt=function(e){var t=e.node,n=e.unusedPageIndices,r=Object(V.a)().t,i=Object(c.useState)(),o=Object(b.a)(i,2),u=o[0],s=o[1],l=Le(),d=l.updateDocument,f=l.getDocument,j=l.fileInfos,p=Object(c.useMemo)((function(){var e=n;if(Object(R.isPresent)(u)){var t=f(u).pages.map((function(e){var t=j[e.fileIndex];if("loaded"===t.status)return t.pages[e.filePageNumber].pageIndex})).filter(R.isPresent);t.push.apply(t,Object(a.a)(e)),e=t.sort()}return e}),[u,j,f,n]),O=Object(c.useCallback)((function(e,t){s(t)}),[]),m=Object(c.useCallback)((function(e){f(u).schemaId!==e.schemaId&&(e.data={}),d(u,e)}),[u,f,d]);return Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(Yt,{description:r("Edit"),icon:Object(v.jsx)(tt.a,{}),onClick:function(e){return O(e,t.documentIndex)}}),Object(R.isPresent)(u)&&Object(v.jsx)(Lt,{open:Object(R.isPresent)(u),document:f(u),availablePageIndices:p,onChange:m,onClose:function(){return s(void 0)}})]})},Qt=function(e){var t=e.node,n=Object(V.a)().t,a=Object(lt.c)(),r=Le().deleteDocument,i=Object(c.useCallback)(function(){var e=Object(z.a)(E.a.mark((function e(t,c,i){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.stopPropagation(),e.next=3,a({description:n("ConfirmDeleteBatchDocument",{name:i})});case 3:if(e.sent){e.next=6;break}return e.abrupt("return");case 6:r(c);case 7:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),[a,r,n]);return Object(v.jsx)(Yt,{description:n("Delete"),icon:Object(v.jsx)(Ke.a,{}),onClick:function(e){return i(e,t.documentIndex,t.title)}})},Xt=function(e){var t=e.unusedPageIndices,n=Object(V.a)().t,a=Object(c.useState)(!1),r=Object(b.a)(a,2),i=r[0],o=r[1],u=Le(),s=u.setCurrentDocumentLocation,l=u.addDocument,d=Object(c.useCallback)((function(){o(!0)}),[]),f=Object(c.useCallback)((function(e){e.data={};var t=l(e);s({documentIndex:t})}),[l,s]);return Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(J.a,{title:n("AddDocument"),children:Object(v.jsx)(qe.a,{onClick:d,children:Object(v.jsx)(Xe.a,{})})}),i&&Object(v.jsx)(Lt,{open:i,availablePageIndices:t,onChange:f,onClose:function(){return o(!1)}})]})},en=function(e){var t=Ut(),n=Le(),a=n.fileInfos,r=n.loadingImages,i=n.movePage,o=n.currentDocumentLocation,u=n.setCurrentDocumentLocation,s=n.canModify,l=Jt(),f=l.treeData,b=l.setTreeData,j=Object(c.useMemo)((function(){return a.flatMap((function(e){return"loaded"!==e.status?[]:e.pages.filter((function(e){return!Object(R.isPresent)(e.documentOrder)})).map((function(e){return e.pageIndex}))}))}),[a]),p=Object(c.useCallback)((function(e){!function(e){var t=e[e.length-1],n=t.children;Wt(t)&&Array.isArray(n)&&n.sort(Object(X.a)((function(e,t){return e.pageIndex<t.pageIndex})))}(e),b(e)}),[b]),O=Object(c.useCallback)((function(e){var t=e.node,n=e.nextParentNode,a=e.prevTreeIndex,r=e.nextTreeIndex;if(n&&a!==r){var c=t,o=n;if(!Wt(o)||Object(R.isPresent)(c.documentIndex))if(Bt(o)){var u=o.documentIndex,s=o.children.findIndex((function(e){return e.pageIndex===c.pageIndex}));i(c.pageIndex,{documentIndex:u,documentOrder:s})}else Wt(o)&&i(c.pageIndex)}}),[i]),m=Object(c.useCallback)((function(e,t){var n,a,r=e.target;if(!0!==(null===(n=r.classList)||void 0===n?void 0:n.contains("rst__collapseButton"))&&!0!==(null===(a=r.classList)||void 0===a?void 0:a.contains("rst__expandButton"))){var c=t;u({documentIndex:c.documentIndex,pageIndex:c.pageIndex})}}),[u]),h=Object(c.useCallback)((function(e){var n=e.node,a=o&&n.documentIndex===o.documentIndex&&n.pageIndex===o.pageIndex,r={onClick:function(t){return m(t,e.node)},className:Object(H.default)(t.node,Object(d.a)({},t.selectedNode,a))};if(Bt(n)){if(s){var c=Object(v.jsx)(Kt,{node:n,unusedPageIndices:j}),i=Object(v.jsx)(Qt,{node:n});r.buttons=[c,i]}r.title=function(){return Object(v.jsx)(Zt,{node:n,canModify:s})}}return r}),[s,t.node,t.selectedNode,o,m,j]);return r?null:Object(v.jsxs)(v.Fragment,{children:[s&&Object(v.jsx)(Ze.a,{className:t.toolbar,children:Object(v.jsx)(Xt,{unusedPageIndices:j})}),Object(v.jsx)(ot.a,{treeData:f,onChange:p,onMoveNode:O,getNodeKey:Vt,canDrag:Ht,canDrop:Gt,canNodeHaveChildren:$t,isVirtualized:!1,generateNodeProps:h,className:t.tree})]})},tn=n(922),nn=n(2416),an=n(925),rn=n(331),cn=n(38),on=Object(k.a)((function(e){return Object(C.a)({image:{marginTop:e.spacing(2),width:"max-content",maxWidth:"100%"},imagePlaceholder:{marginTop:e.spacing(6),height:50}})})),un=Object(l.withJsonFormsControlProps)((function(e){var t=e.uischema,n=e.config,a=e.id,r=e.data,c=e.visible,i=e.errors,u=e.label,l=e.required,d=e.description,f=on(),b=0===i.length,j=Object(rn.merge)({},n,t.options),p=!Object(s.isDescriptionHidden)(c,null!==d&&void 0!==d?d:"",!1,j.showUnfocusedDescription),O=Le().getDisplayableDataUrl,m=p?d:b?null:i,h=p&&!b?i:null;return Object(v.jsx)(o.a,{xsUp:!c,children:Object(v.jsxs)(tn.a,{fullWidth:!j.trim,id:a,children:[Object(v.jsx)(nn.a,{htmlFor:a+"-input",error:!b,shrink:"string"===typeof r,children:Object(s.computeLabel)(Object(s.isPlainLabel)(u)?u:u.default,!!l,j.hideRequiredAsterisk)}),Object(v.jsxs)("div",{children:["string"===typeof r&&Object(v.jsx)("img",{src:O(r),alt:"",className:f.image}),"string"!==typeof r&&Object(v.jsx)("img",{src:"".concat(Object(cn.a)(),"images/image-placeholder.png"),alt:"placeholder",className:f.imagePlaceholder})]}),Object(v.jsx)(an.a,{error:!b&&!p,children:m}),Object(v.jsx)(an.a,{error:!b,children:h})]})})})),sn=Object(s.rankWith)(4,Object(s.and)(s.isControl,(function(e,t){var n=s.Resolve.schema(t,e.scope);return n&&"string"===n.type&&"image"===n.format}))),ln=n(668),dn=n(99),fn=n.n(dn),bn=n(134),jn=n(921),vn=n(939),pn=n(446),On=n.n(pn),mn=(Ct=jn.a,Object(ln.a)((function(e){return Object(v.jsx)(Ct,Object(f.a)({},e))}))),hn=i.a.memo((function(e){var t,n,a,r,i=Object(c.useState)(!1),o=Object(b.a)(i,2),u=o[0],s=o[1],l=e.data,d=e.config,f=e.className,j=e.id,p=e.enabled,O=e.uischema,m=e.isValid,h=e.path,g=e.handleChange,x=e.schema,y=e.muiInputProps,k=x.maxLength,C=fn()({},d,O.options);r=C.restrict?{maxLength:k}:{};var w=Object(c.useMemo)((function(){return x.patternMask}),[x]);r=fn()(r,y),C.trim&&void 0!==k&&(r.size=k);var I=Object(bn.a)(),S=(null===(t=I.jsonforms)||void 0===t||null===(n=t.input)||void 0===n||null===(a=n.delete)||void 0===a?void 0:a.background)||I.palette.background.default,T=Object(c.useCallback)((function(e){g(h,e)}),[g,h]);return Object(v.jsx)(mn,{mask:w,onAccept:T,type:"text",className:f,id:j,value:l,disabled:!p,autoFocus:C.focus,multiline:C.multi,fullWidth:!C.trim||void 0===k,inputProps:r,error:!m,onPointerEnter:function(){return s(!0)},onPointerLeave:function(){return s(!1)},endAdornment:Object(v.jsx)(vn.a,{position:"end",style:{display:u&&p&&void 0!==l?"flex":"none",position:"absolute",right:0},children:Object(v.jsx)(qe.a,{"aria-label":"Clear input field",onClick:function(){return g(h,void 0)},children:Object(v.jsx)(On.a,{style:{background:S,borderRadius:"50%"}})})})})}),l.areEqual),gn=Object(l.withJsonFormsControlProps)((function(e){return Object(v.jsx)(r.MaterialInputControl,Object(f.a)(Object(f.a)({},e),{},{input:hn}))})),xn=Object(s.rankWith)(4,Object(s.and)(s.isControl,(function(e,t){var n=s.Resolve.schema(t,e.scope);return n&&"string"===n.type&&"string"===typeof n.patternMask}))),yn=Object(k.a)((function(e){return Object(C.a)({content:{display:"grid",gridTemplateColumns:"auto",gridTemplateRows:"auto",rowGap:"5px",height:"100%",overflowY:"hidden"},editorPane:{gridRow:"1 / 2",gridColumn:"1 / 2",overflow:"auto"},listPane:{gridRow:"2 / 3",gridColumn:"1 / 2",overflow:"auto",borderTop:"solid 2px ".concat(e.palette.divider),paddingTop:10},listPaneHeader:{display:"flex",flexDirection:"row",placeItems:"center"},list:{display:"flex",flexDirection:"row",padding:0},listItem:{width:"inherit",marginTop:10,marginLeft:10,marginRight:10,border:"solid 2px ".concat(e.palette.divider),height:125},imageItem:{},image:{maxWidth:300,maxHeight:100},grow:{flexGrow:1}})})),kn=function(e){var t,n=Le(),r=n.documentSchemas,i=n.currentDocumentEditionState,o=n.setCurrentDocumentEditionState,u=n.canModify,s=yn(),d=Object(c.useRef)(null===i||void 0===i?void 0:i.document.data),b=Object(c.useRef)(!1);Object(c.useMemo)((function(){d.current=null===i||void 0===i?void 0:i.document.data}),[null===i||void 0===i?void 0:i.document.data]);var j=Object(c.useMemo)((function(){return[].concat(Object(a.a)(Ca),[{tester:sn,renderer:un},{tester:xn,renderer:gn}])}),[]),p=Object(c.useCallback)((function(e){b.current=!!e.errors&&e.errors.length>0;var t=b.current?Object(ke.a)(e.errors.map((function(e){return Object(f.a)(Object(f.a)({},e),{},{instancePath:e.dataPath})}))):void 0;b.current||d.current===e.data||(d.current=e.data,b.current=!1),o((function(n){var a,r;return Object($.a)(e.data,null===n||void 0===n?void 0:n.document)&&Object($.a)(t,null===n||void 0===n?void 0:n.errors)?n:{document:Object(f.a)(Object(f.a)({},n.document),{},{data:null!==(a=e.data)&&void 0!==a?a:null===n||void 0===n||null===(r=n.document)||void 0===r?void 0:r.data}),errors:t}}))}),[o]);if(!(null===i||void 0===i?void 0:i.document))return null;var O=null===r||void 0===r?void 0:r.find((function(e){return e.$id===(null===i||void 0===i?void 0:i.document.schemaId)}));return Object(v.jsx)("div",{className:s.content,children:Object(v.jsx)("div",{className:s.editorPane,children:Object(v.jsx)(l.JsonForms,{data:null!==(t=null===i||void 0===i?void 0:i.document.data)&&void 0!==t?t:{},schema:O,onChange:p,renderers:j,cells:wa,ajv:we,readonly:!u||"dontSend"===(null===i||void 0===i?void 0:i.document.action)})})})},Cn=n(2421),wn=n(615),In=n.n(wn),Sn=n(2484),Tn=n(616),Pn=n.n(Tn),Rn=n(617),Mn=n.n(Rn),Nn=n(2477),Dn=n(618),An=n.n(Dn),En=n(1962),zn=[n(335)],Ln=Object(En.a)((function(e){return e[0]}),Object(Nn.a)((function(e){return e.$id}),zn)),Fn={resolve:{nimflow:{order:1,canRead:function(e){return!!Ln[e.url]},read:function(e){return Object(j.a)(["$id"],Ln[e.url])}}}},Un=function(e){return An.a.dereference(e,Fn)},Bn=Object(k.a)((function(e){return Object(C.a)({dialogPaper:{height:"90vh"},dialogContent:{display:"grid",gridTemplateColumns:"auto ".concat(400,"px"),gridTemplateRows:"auto",rowGap:"5px",height:"100%",overflowY:"hidden"},imagePane:{gridRow:"1 / 2",gridColumn:"1 / 2",overflow:"auto"},listPane:{gridRow:"1 / 2",gridColumn:"2 / 3",overflow:"auto",borderLeft:"solid 2px ".concat(e.palette.divider),paddingLeft:10},cropper:{height:"100%",width:"100%"},cropperDisabled:{"& .cropper-crop-box":{display:"none"},"& .cropper-drag-box":{opacity:0}},imageItem:{width:"100%",position:"relative"},imageTitle:{textDecoration:"underline"},image:{maxWidth:"100%",marginTop:10,marginBottom:10},imagePlaceholder:{marginTop:10,height:50},imageActions:{marginLeft:-10},deleteButton:{},grow:{flexGrow:1},degreesEdit:{marginLeft:20,width:"5em"}})})),Wn=function(e){var t=null===e||void 0===e?void 0:e.current;return null===t||void 0===t?void 0:t.cropper},_n=function e(t,n,r,c,i,o){if("string"!==n.type||"image"!==n.format){if(!(o.includes(t)||"array"!==n.type&&"object"!==n.type))if("array"===n.type&&Array.isArray(t)&&"object"===typeof n.items){var u;if(Array.isArray(n.items)){var s=n.items.filter(U.b);if(1!==s.length)return;u=s[0]}else u=n.items;o.push(t);for(var l=0;l<t.length;l++)try{c.push(l),i.push(l.toString()),e(t[l],u,r,c,i,o)}finally{c.pop(),i.pop()}}else if("object"===n.type&&(Object(U.b)(t)||!Object(R.isPresent)(t))){if(t){o.push(t);for(var d=0,f=Object.entries(t);d<f.length;d++){var j,v,p=Object(b.a)(f[d],2),O=p[0],m=p[1],h=null!==(j=null===(v=n.properties)||void 0===v?void 0:v[O])&&void 0!==j?j:n.additionalProperties;if("object"===typeof h)try{var g;c.push(O),i.push(null!==(g=h.title)&&void 0!==g?g:O),e(m,h,r,c,i,o)}finally{c.pop(),i.pop()}}}if(n.properties)for(var x=0,y=Object.entries(n.properties);x<y.length;x++){var k=Object(b.a)(y[x],2),C=k[0],w=k[1];if("object"===typeof w&&(!t||!(C in t)))try{var I;c.push(C),i.push(null!==(I=w.title)&&void 0!==I?I:C),e(void 0,w,r,c,i,o)}finally{c.pop(),i.pop()}}}}else{var S=c.map((function(e){return e.toString()})).join(".");if(-1===r.findIndex((function(e){return e.id===S}))){var T=i.join(" -> ");r.push({id:S,path:Object(a.a)(c),title:T,value:t,originalValue:t})}}},Vn=function(e,t){var n=[];return _n(e,t,n,[],[],[]),n},$n=function(e,t){Object(R.isPresent)(t.value)&&!e&&(e={});for(var n=e,a=0;a<t.path.length-1;a++){var r=t.path[a],c=n[r];if(!n){if(!t.value)return e;n[r]=c={}}n=c}if(Object(R.isPresent)(n)){var i=t.path[t.path.length-1];Object(R.isPresent)(t.value)?n[i]=t.value:delete n[i]}return e},Hn=function(e){var t=e.open,n=e.pageIndex,r=e.onClose,i=e.outputImageFormat,o=Le(),u=o.findByPageIndex,s=o.getDisplayableDataUrl,l=Object(V.a)().t,d=Bn(),j=Object(c.useState)(180),p=Object(b.a)(j,2),O=p[0],m=p[1],h=Object(c.useRef)(null),g=Object(c.useState)(!1),x=Object(b.a)(g,2),y=x[0],k=x[1],C=function(){var e=Le(),t=e.documentSchemas,n=e.currentDocumentEditionState,r=e.setCurrentDocumentEditionState,i=Object(c.useState)([]),o=Object(b.a)(i,2),u=o[0],s=o[1];Object(L.a)(["documentSchema/".concat(null===n||void 0===n?void 0:n.document.schemaId),document],Object(z.a)(E.a.mark((function e(){var a,r,c,i,o;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=null===n||void 0===n?void 0:n.document.schemaId,r=null===t||void 0===t?void 0:t.find((function(e){return e.$id===a}))){e.next=4;break}return e.abrupt("return",void 0);case 4:return e.next=6,Un(r);case 6:return c=e.sent,i=In()(c,{ignoreAdditionalProperties:!0}),o=Vn(null===n||void 0===n?void 0:n.document.data,i),s(o),e.abrupt("return",i);case 11:case"end":return e.stop()}}),e)}))),{revalidateOnFocus:!1});var l=Object(c.useCallback)((function(e,t){s((function(n){var r=Object(a.a)(n);return r[t]=Object(f.a)(Object(f.a)({},n[t]),{},{value:e}),r}))}),[s]),d=Object(c.useCallback)((function(e){s((function(t){var n,r=Object(a.a)(t);return null===(n=r[e])||void 0===n||delete n.value,r}))}),[s]),j=Object(c.useCallback)((function(){var e=u.filter((function(e){return e.originalValue!==e.value}));r((function(t){if(e.length>0&&t.document){var n=Object(ne.a)(t.document.data,(function(t){var n,a=Object(P.a)(e);try{for(a.s();!(n=a.n()).done;){var r=n.value;if(0===r.path.length)return r.value;t=$n(t,r)}}catch(c){a.e(c)}finally{a.f()}return t})),a=Object(f.a)(Object(f.a)({},t.document),{},{data:n});return Object(f.a)(Object(f.a)({},t),{},{document:a})}}))}),[u,r]);return{imageFields:u,setImageAt:l,deleteImageAt:d,applyImagesToDocument:j}}(),w=C.imageFields,I=C.setImageAt,S=C.deleteImageAt,T=C.applyImagesToDocument,R=Object(c.useMemo)((function(){return u(n)}),[u,n]),M=Object(c.useCallback)((function(){var e=Wn(h);e&&e.clear(),k(!1)}),[]),N=Object(c.useCallback)((function(){T(),null===r||void 0===r||r()}),[T,r]),D=Object(c.useCallback)((function(){null===r||void 0===r||r()}),[r]),A=Object(c.useCallback)((function(e,t){"backdropClick"!==t&&(null===r||void 0===r||r())}),[r]),F=Object(c.useCallback)((function(e){y&&"Escape"===e.key&&(e.preventDefault(),e.stopPropagation(),M())}),[y,M]),U=Object(c.useCallback)((function(e){var t=Wn(h);if(t){var n=function(e,t){if("image/tiff"===t){var n=e.getContext("2d").getImageData(0,0,e.width,e.height),a=new Uint8Array(n.data.buffer),r=Mn.a.encodeImage(a,n.width,n.height);return Ie(r,"image/tiff")}return e.toDataURL()}(t.getCroppedCanvas(),i);M(),I(n,e)}}),[M,i,I]);Object(c.useEffect)((function(){var e=void 0;return R&&setTimeout((function(){var t=h.current;if(t){var n=t.getContext("2d");n&&We(R.getImageData()).then((function(a){n.putImageData(a,0,0),(e=new Pn.a(t,{dragMode:"crop",initialAspectRatio:Number.NaN,guides:!1,crop:function(){var t,n=null===(t=e)||void 0===t?void 0:t.getCropBoxData();n&&!Object(Sn.a)(n)&&k(!0)},viewMode:1,autoCrop:!1})).clear()}))}}),0),function(){var t;null===(t=e)||void 0===t||t.destroy()}}),[R]);var B=Object(c.useCallback)((function(e){var t=parseInt(e.target.value);isNaN(t)||m(t)}),[]),W=Object(c.useCallback)((function(){var e=Wn(h);e&&!isNaN(O)&&e.rotate(O)}),[O]);return Object(v.jsxs)(dt.a,{open:t,onClose:A,maxWidth:"lg",fullWidth:!0,classes:{paper:d.dialogPaper},onKeyDown:F,children:[Object(v.jsx)(jt.a,{children:l("ExtractingImages")}),Object(v.jsxs)(bt.a,{className:d.dialogContent,children:[Object(v.jsx)("div",{className:d.imagePane,children:!!R&&Object(v.jsx)("canvas",{ref:h,width:R.width,height:R.height,style:{visibility:"hidden"}})}),Object(v.jsx)("div",{className:d.listPane,children:Object(v.jsx)(Cn.a,{children:w.map((function(e,t){return Object(v.jsx)(G.a,{children:Object(v.jsxs)("div",{className:d.imageItem,children:[Object(v.jsx)(q.a,{variant:"subtitle1",className:d.imageTitle,children:e.title}),e.value&&Object(v.jsx)("img",{src:s(e.value),alt:"",className:d.image}),!e.value&&Object(v.jsx)("img",{src:"".concat(Object(cn.a)(),"images/image-placeholder.png"),alt:"placeholder",className:d.imagePlaceholder}),Object(v.jsxs)("div",{className:d.imageActions,children:[Object(v.jsx)(J.a,{title:l("CaptureCurrentSelection"),children:Object(v.jsx)("span",{children:Object(v.jsx)(qe.a,{onClick:function(){return U(t)},disabled:!y,children:Object(v.jsx)(Be,{})})})}),Object(v.jsx)(J.a,{title:l("Delete"),children:Object(v.jsx)(qe.a,{onClick:function(){return S(t)},children:Object(v.jsx)(Ke.a,{})})})]})]})},t)}))})})]}),Object(v.jsxs)(ft.a,{children:[Object(v.jsx)(pt.a,{type:"number",value:O,onChange:B,className:d.degreesEdit}),Object(v.jsx)(vt.a,{onClick:W,color:"primary",children:l("Rotate")}),Object(v.jsx)("div",{className:d.grow}),Object(v.jsx)(vt.a,{onClick:N,color:"primary",children:l("Accept")}),Object(v.jsx)(vt.a,{onClick:D,color:"primary",children:l("Cancel")})]})]})},Gn=Object(k.a)((function(e){return Object(C.a)({content:{height:"75vh",minWidth:900,display:"flex",flexDirection:"row"},treePane:{flexGrow:1,overflow:"auto",width:function(e){return e.canModify?"25%":"40%"}},imageListPane:{flexGrow:1,width:"41%",overflowY:"auto",borderLeft:"2px solid ".concat(e.palette.divider),paddingLeft:10},editorPane:{width:function(e){return e.canModify?"33%":"59%"},flexGrow:1,overflow:"auto",borderLeft:"2px solid ".concat(e.palette.divider),paddingLeft:10}})})),Jn=function(e){var t=e.outputImageFormat,n=Object(V.a)().t,a=Le(),r=a.loadingImages,i=a.documentSchemas,o=a.canModify,u=Gn({canModify:o}),s=Object(c.useState)(),l=Object(b.a)(s,2),d=l[0],f=l[1],j=Object(c.useCallback)((function(e){f(e)}),[]),p=Object(c.useCallback)((function(){f(void 0)}),[]);return i?r?Object(v.jsx)(Fe.b,{children:n("LoadingImages")}):Object(v.jsxs)("div",{className:u.content,children:[Object(v.jsx)("div",{className:u.treePane,children:Object(v.jsx)(en,{})}),o&&Object(v.jsx)("div",{className:u.imageListPane,children:Object(v.jsx)(Je,{onImageExtractionRequested:j})}),Object(v.jsx)("div",{className:u.editorPane,children:Object(v.jsx)(kn,{})}),Object(R.isPresent)(d)&&Object(v.jsx)(Hn,{open:Object(R.isPresent)(d),pageIndex:d,onClose:p,outputImageFormat:t})]}):null},qn=function(e){var t,n=Object(l.useJsonForms)(),r=Object(s.mapStateToControlProps)({jsonforms:Object(f.a)({},n)},e),i=r.data,u=r.path,d=r.visible,b=r.uischema,j=null===i||void 0===i?void 0:i.documents,p=Object(c.useMemo)((function(){return j?function(e){if(!Array.isArray(e))return[];for(var t=e,n=0;n<t.length;n++){var r=t[n];if(!Object(R.isPresent)(r.data)||!r.action){var c,i,o=Object(f.a)(Object(f.a)({},r),{},{data:null!==(c=r.data)&&void 0!==c?c:{},action:null!==(i=r.action)&&void 0!==i?i:"send"});t===e&&(t=Object(a.a)(e)),t[n]=o}}return t}(j):[]}),[j]);if(Object(c.useEffect)((function(){var e;p===j||Object($.a)(p,j)||(null===(e=n.dispatch)||void 0===e||e.call(n,Object(s.update)(Object(_.compose)(u,"documents"),(function(){return p}))))}),[n,j,p,u]),p!==j&&!Object($.a)(p,j))return null;if("ImageBatchRecognition"!==b.type)return null;var O=b;return Object(v.jsx)(o.a,{xsUp:!d,children:Object(v.jsx)(wt.a,{children:Object(v.jsx)(ze,{basePath:u,batch:i,documentSchemasSource:O.documentSchemasSource,readonly:null!==(t=O.readonly)&&void 0!==t&&t,children:Object(v.jsx)(Jn,{outputImageFormat:O.outputImageFormat})})})})},Zn=Object(s.rankWith)(3,Object(s.uiTypeIs)("ImageBatchRecognition")),Yn=n(4),Kn=n(6),Qn=n(10),Xn=n(11),ea=n(232),ta=n.n(ea),na=n(233),aa=n.n(na),ra=n(234),ca=n.n(ra),ia=n(727),oa=n(515),ua=n(2460),sa=function(e){Object(Qn.a)(n,e);var t=Object(Xn.a)(n);function n(){return Object(Yn.a)(this,n),t.apply(this,arguments)}return Object(Kn.a)(n,[{key:"render",value:function(){var e=this.props,t=e.description,n=e.id,a=e.errors,r=e.label,c=e.uischema,i=e.visible,u=e.enabled,l=e.required,d=e.path,f=e.handleChange,b=e.data,j=e.config,p=r,O=0===a.length,m=fn()({},j,c.options),h=!Object(s.isDescriptionHidden)(i,null!==t&&void 0!==t?t:"",this.state.isFocused,m.showUnfocusedDescription),g=Object(s.isPlainLabel)(r)?r:p;return Object(v.jsx)(o.a,{xsUp:!i,children:Object(v.jsx)(ia.b,{id:n+"-input",label:Object(s.computeLabel)(g,null!==l&&void 0!==l&&l,m.hideRequiredAsterisk),error:!O,fullWidth:!m.trim,helperText:O?h?t:" ":a,InputLabelProps:{shrink:!0},value:b?Object(oa.default)(b):null,onChange:function(e){return f(d,e&&!isNaN(e.valueOf())?Object(ua.a)(e,{representation:"date"}):"")},format:it.a.t("DATE_FORMAT"),clearable:!0,disabled:!u,autoFocus:m.focus,onFocus:this.onFocus,onBlur:this.onBlur,okLabel:it.a.t("OK"),cancelLabel:it.a.t("Cancel"),clearLabel:it.a.t("Clear"),leftArrowIcon:Object(v.jsx)(ta.a,{}),rightArrowIcon:Object(v.jsx)(aa.a,{}),keyboardIcon:Object(v.jsx)(ca.a,{}),InputProps:{}})})}}]),n}(l.Control),la=Object(s.rankWith)(10,s.isDateControl),da=Object(l.withJsonFormsControlProps)(sa),fa=n(378),ba=n.n(fa),ja=n(447),va=n.n(ja),pa=n(730),Oa=function(e){Object(Qn.a)(n,e);var t=Object(Xn.a)(n);function n(){return Object(Yn.a)(this,n),t.apply(this,arguments)}return Object(Kn.a)(n,[{key:"render",value:function(){var e=this.props,t=e.id,n=e.description,a=e.errors,r=e.label,c=e.uischema,i=e.visible,u=e.enabled,l=e.required,d=e.path,f=e.handleChange,b=e.data,j=e.config,p=fn()({},j,c.options),O=0===a.length;return Object(v.jsx)(o.a,{xsUp:!i,children:Object(v.jsx)(pa.b,{id:t+"-input",label:Object(s.computeLabel)(Object(s.isPlainLabel)(r)?r:r.default,null!==l&&void 0!==l&&l,p.hideRequiredAsterisk),error:!O,fullWidth:!p.trim,onFocus:this.onFocus,onBlur:this.onBlur,helperText:O?n:a,InputLabelProps:{shrink:!0},value:b||null,onChange:function(e){return f(d,e&&!isNaN(e.valueOf())?e.toISOString():"")},format:it.a.t("DATETIME_FORMAT"),clearable:!0,disabled:!u,autoFocus:p.focus,okLabel:it.a.t("OK"),cancelLabel:it.a.t("Cancel"),clearLabel:it.a.t("Clear"),leftArrowIcon:Object(v.jsx)(ta.a,{}),rightArrowIcon:Object(v.jsx)(aa.a,{}),dateRangeIcon:Object(v.jsx)(ba.a,{}),keyboardIcon:Object(v.jsx)(ca.a,{}),timeIcon:Object(v.jsx)(va.a,{}),InputProps:{}})})}}]),n}(l.Control),ma=Object(s.rankWith)(10,s.isDateTimeControl),ha=Object(l.withJsonFormsControlProps)(Oa),ga=n(2479),xa=n(2423),ya=["context","bindContext","uiSchemaLibrary","schema","onChange"],ka=function(e){var t=e.context,n=e.bindContext,r=e.uiSchemaLibrary,i=e.schema,o=e.onChange,u=Object(T.a)(e,ya),s=function(e){var t=Object(ga.a)(Object(z.a)(E.a.mark((function t(){var n;return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=2;break}return t.abrupt("return",void 0);case 2:return t.next=4,Un(e);case 4:return n=t.sent,t.abrupt("return",n);case 6:case"end":return t.stop()}}),t)}))),[e]);return{resolvedSchema:t.value,loading:t.loading,error:t.error}}(i),d=s.resolvedSchema,j=s.loading,p=s.error,O=Object(c.useState)(),h=Object(b.a)(O,2),g=h[0],x=h[1],y=Object(c.useState)([]),k=Object(b.a)(y,2),C=k[0],w=k[1],I=Object(c.useState)(),S=Object(b.a)(I,2),P=S[0],R=S[1],M=Object(c.useCallback)((function(e){x(e)}),[]),N=Object(c.useCallback)((function(e){w(e)}),[]);if(Object(c.useEffect)((function(){if(g||0!==C.length){var e=function(e,t){var n={data:void 0};return t.length>0||(null===e||void 0===e?void 0:e.errors)&&e.errors.length>0?(n.errors=n.errors?[].concat(Object(a.a)(n.errors),Object(a.a)(t)):t,n.errors=Object(xa.a)([Object(X.a)((function(e,t){var n,a;return e.dataPath<t.dataPath||e.dataPath===t.dataPath&&(null!==(n=e.message)&&void 0!==n?n:"")<(null!==(a=t.message)&&void 0!==a?a:"")}))],n.errors)):n.data=null===e||void 0===e?void 0:e.data,n}(g,C);R((function(t){return Object($.a)(t,e)?t:e}))}}),[C,g]),Object(c.useEffect)((function(){P&&(null===o||void 0===o||o(P))}),[P,o]),j)return Object(v.jsx)(Fe.a,{});if(p)throw p;return Object(v.jsx)(m,{context:t,bindContext:n,uiSchemaLibrary:r,onErrorsChange:N,children:Object(v.jsx)(l.JsonForms,Object(f.a)({renderers:Ca,cells:wa,schema:d,onChange:M},u))})},Ca=[].concat(Object(a.a)(r.materialRenderers),[{tester:y,renderer:x},{tester:S,renderer:I},{tester:D,renderer:N},{tester:W,renderer:B},{tester:Zn,renderer:qn},{tester:la,renderer:da},{tester:ma,renderer:ha}]),wa=r.materialCells},389:function(e,t,n){"use strict";n.d(t,"a",(function(){return I}));var a=n(5),r=n.n(a),c=n(32),i=n(1),o=n(2443),u=n(183),s=n.n(u),l=n(2441),d=n(2484),f=n(3),b=n.n(f),j=n(2482),v=n(918),p=n(2442),O=n(336),m=n(2426),h=n(2427),g=n(96),x=n(117),y=n(221),k=n(390),C=n(515),w=n(31),I=function(e){var t=e.taskId,n=e.activityName,a=e.otherUsers,u=e.warning,I=Object(j.a)().t,S=Object(f.useState)([]),T=Object(i.a)(S,2),P=T[0],R=T[1],M=Object(g.c)().tasks_GetUserTaskLastKnownActivityRecords,N=Object(x.c)().authenticatedUser,D=Object(y.c)().isFeatureSupported,A=Object(f.useCallback)(Object(c.a)(r.a.mark((function e(){var c;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(D(y.a.UserTasksActivityTracking)){e.next=2;break}return e.abrupt("return",[]);case 2:return e.prev=2,e.next=5,M({taskId:t});case 5:return c=e.sent,e.abrupt("return",c.filter((function(e){return(!n||e.activityName===n)&&(!a||e.userId!==(null===N||void 0===N?void 0:N.sub)&&e.email!==(null===N||void 0===N?void 0:N.email))&&Object(k.a)(new Date,Object(C.default)(e.timestamp))<=60})));case 9:return e.prev=9,e.t0=e.catch(2),console.error("Error trying to record user task activity."),e.abrupt("return",[]);case 13:case"end":return e.stop()}}),e,null,[[2,9]])}))),[D,M,t,n,a,null===N||void 0===N?void 0:N.sub,null===N||void 0===N?void 0:N.email]);return Object(f.useEffect)((function(){Object(c.a)(r.a.mark((function e(){var n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t||R([]),e.next=3,A();case 3:n=e.sent,R(n);case 5:case"end":return e.stop()}}),e)})))()}),[t,R,A]),P&&!Object(d.a)(P)&&Object(w.jsxs)(l.a,{defaultExpanded:!0,children:[Object(w.jsx)(o.a,{expandIcon:Object(w.jsx)(s.a,{}),children:Object(w.jsx)(v.a,{variant:"h5",color:u?"error":"inherit",children:u?"".concat(I("Warning"),": ").concat(I("AnotherUserCouldBeWorkingOnTheSameTask")):I("RecentUserTaskActivityRecords")})}),Object(w.jsx)(p.a,{children:P.map((function(e){var t;return Object(w.jsx)(b.a.Fragment,{children:Object(w.jsx)(m.a,{children:Object(w.jsx)(h.a,{primary:null!==(t=e.email)&&void 0!==t?t:e.userId,secondary:Object(w.jsx)(O.a,{datetime:e.timestamp})})})},e.id)}))})]})||null}},390:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(423),r=n(80);function c(e,t){Object(r.a)(2,arguments);var n=Object(a.a)(e,t)/6e4;return n>0?Math.floor(n):Math.ceil(n)}},454:function(e,t){},460:function(e,t,n){"use strict";var a=n(73),r=n(76);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var c=r(n(3)),i=(0,a(n(77)).default)(c.createElement("path",{d:"M19 3h-4.18C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm0 4c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm6 12H6v-1.4c0-2 4-3.1 6-3.1s6 1.1 6 3.1V19z"}),"AssignmentInd");t.default=i},461:function(e,t,n){"use strict";var a=n(73),r=n(76);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var c=r(n(3)),i=(0,a(n(77)).default)(c.createElement("path",{d:"M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"}),"Visibility");t.default=i},462:function(e,t,n){"use strict";var a=n(73),r=n(76);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var c=r(n(3)),i=(0,a(n(77)).default)(c.createElement("path",{d:"M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7zM2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3 2 4.27zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2zm4.31-.78l3.15 3.15.02-.16c0-1.66-1.34-3-3-3l-.17.01z"}),"VisibilityOff");t.default=i},463:function(e,t,n){"use strict";var a=n(73),r=n(76);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var c=r(n(3)),i=(0,a(n(77)).default)(c.createElement("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"}),"Info");t.default=i},464:function(e,t,n){"use strict";var a=n(73),r=n(76);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var c=r(n(3)),i=(0,a(n(77)).default)(c.createElement("path",{d:"M6 10c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm12 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm-6 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"}),"MoreHoriz");t.default=i},465:function(e,t,n){"use strict";var a=n(73),r=n(76);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var c=r(n(3)),i=(0,a(n(77)).default)(c.createElement("path",{d:"M19 7v4H5.83l3.58-3.59L8 6l-6 6 6 6 1.41-1.41L5.83 13H21V7z"}),"KeyboardReturn");t.default=i},476:function(e,t,n){"use strict";n.d(t,"a",(function(){return nn}));var a=n(2),r=n(5),c=n.n(r),i=n(32),o=n(1),u=n(18),s=n(3),l=n.n(s),d=n(903),f=n(900),b=n(917),j=n(940),v=n(178),p=n.n(v),O=n(2482),m=n(0),h=n(15),g=n(19),x=n(97),y=n(35),k=n(2370),C=n(1291),w=n(81),I=n(96),S=n(116),T=n(121),P=n(199),R=n(117),M=n(31),N=function(){throw new Error("You forgot to wrap your component in <TasksViewTaskServiceProvider>.")},D={task:{},addResponse:N,refreshTasks:N,taskBlocked:!1},A=Object(s.createContext)(D),E=Object(y.c)({key:"taskBlockedState",default:!1}),z=(A.Consumer,n(420)),L=n(250),F=n(221),U=function(){throw new Error("You forgot to wrap your component in <TasksViewServiceProvider>.")},B=Object.freeze({data:[],page:0,totalCount:0,activityRecords:[]}),W=Object.freeze({}),_={data:B,contextTypes:W,currentState:{currentPage:0,pageSize:0},updateTask:U,refreshTasks:U,addResponse:U,setCurrentState:U,canCreateReponses:U,canReassignUsers:U,canCreateResponsesTo:U,getColumnCandidates:U,taskResponseStarted:U,taskResponseClosed:U},V=Object(s.createContext)(_),$=function e(t,n){switch(t.type){case"or":case"and":return Object(g.a)({},"$".concat(t.type),t.filters.map((function(t){return e(t,n)})));case"boolean":case"textMatch":case"selection":return Object(w.isPresent)(t.value)?{$eq:["$".concat(n),t.value]}:{$in:[{$type:"$".concat(n)},["missing","null"]]};case"prefixTextMatch":return{$regexMatch:{input:"$".concat(n),regex:"^".concat(t.prefix,".*")}};case"dateRange":var a=[];return Object(w.isPresent)(t.from)&&a.push(Object(g.a)({},t.includeFrom?"$gte":"$gt",["$".concat(n),{$dateFromString:{dateString:t.from}}])),Object(w.isPresent)(t.to)&&a.push({$lt:["$".concat(n),{$dateFromString:{dateString:t.includeTo?(c=new Date(t.to),new Date(c.getFullYear(),c.getMonth(),c.getDate(),24)).toISOString():t.to}}]}),a;case"numberRange":var r=[];return Object(w.isPresent)(t.from)&&r.push(Object(g.a)({},t.includeFrom?"$gte":"$gt",["$".concat(n),t.from])),Object(w.isPresent)(t.to)&&r.push(Object(g.a)({},t.includeTo?"$lte":"$lt",["$".concat(n),t.to])),r;default:return}var c},H=function(e){for(var t=[],n=0,a=Object.entries(e);n<a.length;n++){var r=Object(o.a)(a[n],2),c=r[0],i=r[1];if(i){var u=$(i,c);Array.isArray(u)?t.push.apply(t,Object(h.a)(u)):t.push(u)}}return{$match:{$expr:1===t.length?t[0]:{$and:t}}}},G=function(e,t){var n=[{$set:{id:"$_id"}},{$unset:"_id"}];t&&n.push(H(t)),e.filters&&Object.keys(e.filters).length>0&&n.push(H(e.filters)),e.sortInfo&&n.push({$sort:Object(g.a)({},e.sortInfo.column,"desc"===e.sortInfo.direction?-1:1)});var a=[];return e.currentPage>0&&a.push({$skip:e.currentPage*e.pageSize}),a.push({$limit:e.pageSize}),n.push({$facet:{data:a,totalCount:[{$count:"count"}]}}),n.push({$project:{data:1,totalCount:{$arrayElemAt:[{$map:{input:"$totalCount",as:"cnt",in:"$$cnt.count"}},0]}}}),n},J=function(e){var t=e.initialState,n=e.enforcedFilter,r=Object(I.c)(),u=r.tasks_Aggregate,l=r.tasks_Update,d=r.tasks_AddResponse,f=r.contextTypes_FindOne,b=r.tasks_RecordActivity,j=r.tasks_GetUserTaskLastKnownActivityRecords,v=Object(R.c)().authenticatedUser,p=Object(s.useRef)([]),O=Object(s.useState)(t),h=Object(o.a)(O,2),g=h[0],S=h[1],T=Object(s.useRef)(B),P=Object(s.useRef)(W),N=Object(z.a)().can,D=Object(s.useState)(0),A=Object(o.a)(D,2),U=A[0],_=A[1],$=Object(F.c)().isFeatureSupported,J=Object(x.a)(["/Tasks/Search",g],Object(i.a)(c.a.mark((function e(){var t,a,r,i,o,s,l,d,b,v,p,O,h,x;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=G(g,n),e.next=3,u({stages:t});case 3:if(a=e.sent,r=a[0],i=r.data,o=r.totalCount,!$(F.a.UserTasksActivityTracking)){e.next=11;break}return e.next=8,j({});case 8:e.t0=e.sent,e.next=12;break;case 11:e.t0=[];case 12:return s=e.t0,l={data:i,page:g.currentPage,totalCount:o,activityRecords:s},d=Object(k.a)(i.map((function(e){return e.contextTypeName}))),e.next=17,Promise.allSettled(d.map((function(e){return f({name:e})})));case 17:b=e.sent,v={},p=Object(m.a)(b);try{for(p.s();!(O=p.n()).done;)"fulfilled"===(h=O.value).status&&(x=h.value)&&(v[x.name]=x)}catch(c){p.e(c)}finally{p.f()}return T.current=l,P.current=v,e.abrupt("return",{data:l,contextTypes:v});case 24:case"end":return e.stop()}}),e)}))),{revalidateOnFocus:!1}),q=J.data,Z=(q=void 0===q?{}:q).data,Y=q.contextTypes,K=J.mutate,Q=Object(s.useCallback)(Object(i.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,K();case 2:return t=e.sent,S((function(e){return Object(a.a)({},e)})),e.abrupt("return",t);case 5:case"end":return e.stop()}}),e)}))),[K]),X=Object(s.useCallback)(function(){var e=Object(i.a)(c.a.mark((function e(t,n){var r,i,u,s,d,f,b,j,v,O,m;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=function(e){for(var t=0,a=Object.entries(n);t<a.length;t++){var r=Object(o.a)(a[t],2),c=r[0],i=r[1];if(!Object(C.a)(e[c],i))return!0}return!1},i=!1,K((function(e){if(e){var c=e.data.data.map((function(e){return e.id!==t.id?e:(i=r(e),Object(a.a)(Object(a.a)({},e),n))}));return i?Object(a.a)(Object(a.a)({},e),{},{data:Object(a.a)(Object(a.a)({},e.data),{},{data:c})}):e}}),!1),i){e.next=5;break}return e.abrupt("return");case 5:for(u={},s={},d=0,f=Object.entries(n);d<f.length;d++)b=Object(o.a)(f[d],2),j=b[0],v=b[1],(Object(w.isPresent)(v)?u:s)[j]=null!==v&&void 0!==v?v:"";O=[],Object.keys(u).length>0&&O.push({$set:u}),Object.keys(s).length>0&&O.push({$unset:s}),m=l({id:t.id,update:O,returnTask:!0}),p.current.push(m),m.finally((function(){var e=p.current.indexOf(m);e>=-1&&p.current.splice(e,1)})).then((function(e){e.task&&!r(e.task)||K(),_((function(e){return e+1}))})).catch((function(){return K()}));case 14:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),[K,l]),ee=Object(y.d)((function(e){var t=e.set;return function(){var e=Object(i.a)(c.a.mark((function e(n,a,r,i){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(E(n.id),!0),e.prev=1,e.next=4,d({contextId:n.contextId,contextTypeName:n.contextTypeName,taskTypeName:n.typeName,responseTypeName:a.name,payload:r,startedOn:null===i||void 0===i?void 0:i.toISOString(),sentOn:(new Date).toISOString(),sentBy:null===v||void 0===v?void 0:v.name});case 4:return e.next=6,Q();case 6:return e.prev=6,t(E(n.id),!1),e.finish(6);case 9:case"end":return e.stop()}}),e,null,[[1,,6,9]])})));return function(t,n,a,r){return e.apply(this,arguments)}}()}),[Q,d,null===v||void 0===v?void 0:v.name]),te=Object(s.useCallback)((function(){return N([L.b.sendTaskResponses])}),[N]),ne=Object(s.useCallback)((function(){return N([L.b.manageTasks,L.b.readUsers])}),[N]),ae=Object(s.useCallback)((function(e){return te()&&(e.assignedTo===(null===v||void 0===v?void 0:v.name)||e.assignedTo===(null===v||void 0===v?void 0:v.email)||"*"===e.assignedTo)}),[te,v]),re=Object(s.useCallback)(function(){var e=Object(i.a)(c.a.mark((function e(t,a){var r,i,o,s;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.filterCandidates,!Array.isArray(r)){e.next=3;break}return e.abrupt("return",r);case 3:return i=[],o=!!a&&Object.keys(a).length>0,(n||o)&&(i.push({$set:{name:"$_id"}},{$unset:"_id"}),n&&i.push(H(n)),o&&i.push(H(a))),i.push({$group:{_id:"$"+t.field,value:{$sum:1}}},{$set:{name:"$_id"}},{$unset:"_id"},{$sort:{name:1}}),e.next=9,u({stages:i});case 9:return s=e.sent,U.toString(),e.abrupt("return",s);case 12:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),[n,U,u]),ce=Object(s.useCallback)(function(){var e=Object(i.a)(c.a.mark((function e(t,n){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if($(F.a.UserTasksActivityTracking)){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,b({taskId:t.id,activityName:"UserStartedNewTaskResponse",responseTypeName:n.name});case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(2),console.error("Error trying to record user task activity.");case 10:case"end":return e.stop()}}),e,null,[[2,7]])})));return function(t,n){return e.apply(this,arguments)}}(),[$,b]),ie=Object(s.useCallback)(function(){var e=Object(i.a)(c.a.mark((function e(t,n){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if($(F.a.UserTasksActivityTracking)){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,b({taskId:t.id,activityName:"UserClosedTaskResponse",responseTypeName:n.name});case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(2),console.error("Error trying to record user task activity.");case 10:case"end":return e.stop()}}),e,null,[[2,7]])})));return function(t,n){return e.apply(this,arguments)}}(),[$,b]),oe=Object(s.useMemo)((function(){return{data:null!==Z&&void 0!==Z?Z:T.current,contextTypes:null!==Y&&void 0!==Y?Y:P.current,updateTask:X,refreshTasks:Q,addResponse:ee,currentState:g,setCurrentState:S,canCreateReponses:te,canReassignUsers:ne,canCreateResponsesTo:ae,getColumnCandidates:re,taskResponseStarted:ce,taskResponseClosed:ie}}),[ee,te,ae,ne,Y,g,Z,re,Q,X,ce,ie]);return Object(M.jsx)(V.Provider,{value:oe,children:e.children})},q=(V.Consumer,function(){return Object(s.useContext)(V)}),Z=n(251),Y=n(704),K=n(951),Q=n(2427),X=n(2433),ee=n(461),te=n.n(ee),ne=n(462),ae=n.n(ne),re=n(465),ce=n.n(re),ie=n(464),oe=n.n(ie),ue=n(463),se=n.n(ue),le=n(33),de=n(34),fe=Object(de.a)((function(e,t){var n,a=Number(t),r=0;if(a<0||isNaN(a))throw new RangeError("n must be a non-negative number");for(n=new Array(a);r<a;)n[r]=e(r),r+=1;return n})),be=n(275),je=function(e){var t=new Date(e);return t.getFullYear()<=1?"":Intl.DateTimeFormat(void 0,{dateStyle:"short",timeStyle:"short"}).format(t)},ve=n(314),pe=n(146),Oe=n(2456),me=n(508),he=n(198),ge=Object(he.a)(Object(me.a)("slice",(function(e,t,n){return Array.prototype.slice.call(n,e,t)})))(0,-1),xe=n(2483),ye=function(){throw new Error("You forgot to wrap your component in <TasksViewGroupServiceProvider>.")},ke={representativeTask:{},tasks:[],addResponse:ye,updateAssignedTo:ye},Ce=Object(s.createContext)(ke),we=function(){var e=Object(i.a)(c.a.mark((function e(t,n,a){var r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.jsInitialPayloadBuilder){e.next=2;break}return e.abrupt("return",void 0);case 2:return e.next=4,a({contextId:t.contextId,contextTypeName:t.contextTypeName,responseTypeName:n.name,taskTypeName:t.typeName});case 4:if(!(r=e.sent).defined){e.next=7;break}return e.abrupt("return",r.payload);case 7:return e.abrupt("return",void 0);case 8:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),Ie=function e(t,n,a,r){var c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];if(!c.includes(n))if(c.push(n),t===n)r.push(a);else if("object"===typeof n&&null!==n&&"object"===typeof t&&null!==t)for(var i=0,o=Object.keys(n);i<o.length;i++){var u=o[i];e(t[u],n[u],[].concat(Object(h.a)(a),[u]),r,c)}},Se=function(e,t,n){var a,r=Object(Oe.a)(e),c=Object(m.a)(n);try{for(c.s();!(a=c.n()).done;){var i,o,u=a.value,s=t,l=r,d=Object(m.a)(ge(u));try{for(d.s();!(o=d.n()).done;){var f,b=o.value;l=r[b],s=null===(f=s)||void 0===f?void 0:f[b]}}catch(j){d.e(j)}finally{d.f()}l[Object(xe.a)(u)]=null===(i=s)||void 0===i?void 0:i[Object(xe.a)(u)]}}catch(j){c.e(j)}finally{c.f()}return r},Te=function(e){var t=e.tasks,n=e.children,a=Object(I.c)(),r=a.tasks_AddResponse,u=a.tasks_BuildInitialResponsePayload,l=a.tasks_UpdateMany,d=Object(R.c)().authenticatedUser,f=q().refreshTasks,b=Object(s.useMemo)((function(){if(0===t.length)throw new Error("tasks.length === 0");return t[0]}),[t]),j=function(e){var t=Object(I.c)().contextTypes_FindOne,n=Object(x.a)("/ContextType/".concat(e),Object(i.a)(c.a.mark((function n(){var a;return c.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t({name:e});case 2:return a=n.sent,n.abrupt("return",a);case 4:case"end":return n.stop()}}),n)}))),{revalidateOnFocus:!1}),a=n.data,r=n.isValidating,o=n.mutate,u=n.error;return Object(s.useMemo)((function(){return{contextType:a,isValidating:r,error:u,mutate:o}}),[a,r,o,u])}(b.contextTypeName).contextType,v=Object(s.useMemo)((function(){var e,t=null===j||void 0===j?void 0:j.tasks.find((function(e){return e.name===b.typeName})),n=[];if(t){var a,r=null===(a=Object(S.i)(t))||void 0===a?void 0:a.taskDetailsTemplate;r&&(e=Object(T.a)(r,{task:b})),t.validResponses&&(n=t.validResponses)}return[n,e]}),[j,b]),p=Object(o.a)(v,2),O=p[0],h=p[1],g=Object(y.d)((function(e){var n=e.set;return function(){var e=Object(i.a)(c.a.mark((function e(a,o){var s,l,j,v,p,O,h,g;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l=function(){return(l=Object(i.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,we(t,a,u);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)},s=function(e){return l.apply(this,arguments)},e.next=4,s(b);case 4:j=e.sent,Ie(o,j,[],v=[]),p=[],O=Object(m.a)(t),e.prev=9,g=c.a.mark((function e(){var t,i,u;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t=h.value)!==b&&0!==v.length){e.next=5;break}e.t0=o,e.next=12;break;case 5:return e.t1=Se,e.t2=o,e.next=9,s(t);case 9:e.t3=e.sent,e.t4=v,e.t0=(0,e.t1)(e.t2,e.t3,e.t4);case 12:i=e.t0,n(E(t.id),!0),u=r({contextId:t.contextId,contextTypeName:t.contextTypeName,taskTypeName:t.typeName,responseTypeName:a.name,payload:i,sentBy:null===d||void 0===d?void 0:d.name}).catch((function(e){throw n(E(t.id),!1),e})),p.push(u);case 16:case"end":return e.stop()}}),e)})),O.s();case 12:if((h=O.n()).done){e.next=16;break}return e.delegateYield(g(),"t0",14);case 14:e.next=12;break;case 16:e.next=21;break;case 18:e.prev=18,e.t1=e.catch(9),O.e(e.t1);case 21:return e.prev=21,O.f(),e.finish(21);case 24:return e.next=26,Promise.allSettled(p);case 26:f();case 27:case"end":return e.stop()}}),e,null,[[9,18,21,24]])})));return function(t,n){return e.apply(this,arguments)}}()}),[b,u,f,t,r,d]),k=Object(s.useCallback)(function(){var e=Object(i.a)(c.a.mark((function e(n){var a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=[],n?a.push({$set:{assignedTo:n}}):a.push({$unset:{assignedTo:""}}),e.next=4,l({filter:{_id:{$in:t.map((function(e){return e.id}))}},update:a,returnTasks:!1});case 4:f();case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[f,t,l]),C={representativeTask:b,tasks:t,contextType:j,responses:O,taskDetails:h,addResponse:g,updateAssignedTo:k};return Object(M.jsx)(Ce.Provider,{value:C,children:n})},Pe=Ce.Consumer,Re=n(1305),Me=n(516),Ne=n.n(Me),De=["response","title","icon"],Ae=function(e){var t=e.response,n=e.title,r=e.icon,c=Object(u.a)(e,De);return Object(M.jsx)(Re.a,Object(a.a)({icon:null!==r&&void 0!==r?r:Object(M.jsx)(Ne.a,{}),label:null!==n&&void 0!==n?n:Object(S.h)(t)},c))},Ee=n(480),ze=Object(d.a)((function(e){return Object(f.a)({responses:{textAlign:"center",marginBottom:10,marginLeft:10},response:{marginRight:5}})})),Le=function(e){var t=e.taskGroupService,n=e.onResponsesAdded,a=ze(),r=t.representativeTask,u=t.tasks,l=t.responses,d=t.contextType,f=t.addResponse,b=Object(s.useContext)(A).refreshTasks,j=Object(s.useState)(),v=Object(o.a)(j,2),p=v[0],O=v[1],m=Object(s.useCallback)((function(e){O(e)}),[]),h=Object(s.useCallback)(function(){var e=Object(i.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(O(void 0),!t){e.next=4;break}return e.next=4,b();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[b]),g=Object(s.useCallback)(function(){var e=Object(i.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f(p,t);case 2:null===n||void 0===n||n();case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[f,n,p]);return l&&d?Object(M.jsxs)("div",{className:a.responses,children:[null===l||void 0===l?void 0:l.map((function(e,t){return Object(M.jsx)(Ae,{response:e,onClick:function(){return m(e)},className:a.response,variant:"outlined"},t)})),!!p&&Object(M.jsx)(Ee.TasksViewResponseEditorModal,{task:r,contextType:d,responseType:p,open:!!p,taskGroupSize:u.length,onAddResponse:g,onClose:h})]}):null},Fe=function(e){var t=e.data,n=e.onResponsesAdded;return Object(M.jsx)(Te,{tasks:t,children:Object(M.jsx)(Pe,{children:function(e){return Object(M.jsx)(Le,{taskGroupService:e,onResponsesAdded:n})}})})},Ue=n(177),Be=n(926),We=n(2406),_e=n(2422),Ve=n(2412),$e=n(2411),He=n(2404),Ge=n(2416),Je=n(460),qe=n.n(Je),Ze=n(1300),Ye=n(2488),Ke=n(920),Qe=["value","onChange","onBlur","users","digitalWorkers","renderInput","freeSolo"],Xe="13rem",et=Object(d.a)((function(e){return Object(f.a)({small:{width:e.spacing(3),height:e.spacing(3)},view:{width:Xe,borderRadius:e.shape.borderRadius,padding:e.spacing(1),overflowX:"hidden","&:hover":{borderWidth:1,borderStyle:"solid",borderColor:e.palette.divider}},textFieldRoot:{width:Xe,"& .MuiInput-root":{fontFamily:"inherit",fontSize:"inherit",fontWeight:"inherit"}},container:{position:"relative","&:hover .clear-button":{visibility:"visible"}},clearButton:{position:"absolute",left:-40,top:0,visibility:"hidden"}})}));function tt(e){if(e)switch(e.type){case"any-user":return"*";case"digital-worker":return"dw:".concat(e.digitalWorker.id);case"user":return e.user.email;case"unknown":return e.id}}var nt=function(e){var t;switch(null===e||void 0===e?void 0:e.type){case"any-user":return le.a.t("AnyUser");case"digital-worker":return e.digitalWorker.name;case"user":return null!==(t=e.user.fullName)&&void 0!==t?t:e.user.email;case"unknown":return e.id}return""},at=function(e){var t,n,a=e.taskAssignment,r=e.onClick,c=et();return Object(M.jsxs)(He.a,{container:!0,spacing:1,alignItems:"center",onClick:r,wrap:"nowrap",children:["user"===a.type&&Object(M.jsx)(He.a,{item:!0,children:Object(M.jsx)(j.a,{title:null!==(t=a.user.email)&&void 0!==t?t:"",children:Object(M.jsx)(Ze.a,{alt:a.user.fullName,src:null===(n=a.user.props)||void 0===n?void 0:n.Picture,className:c.small})})}),Object(M.jsx)(He.a,{item:!0,xs:!0,children:nt(a)})]})},rt=l.a.forwardRef((function(e,t){var n=e.value,r=e.onChange,c=(e.onBlur,e.users),i=e.digitalWorkers,o=e.renderInput,l=e.freeSolo,d=Object(u.a)(e,Qe),f=et(),b=Object(s.useMemo)((function(){var e=[];if(c){var t=c.filter((function(e){return e.id&&e.email})).map((function(e){return{type:"user",user:e}}));e.push.apply(e,Object(h.a)(t))}if(i){var n=i.filter((function(e){return e.id})).map((function(e){return{type:"digital-worker",digitalWorker:e}}));e.push.apply(e,Object(h.a)(n))}return e.unshift({type:"any-user"}),e}),[c,i]),j=Object(s.useMemo)((function(){return b.find((function(e){switch(e.type){case"any-user":return"any-user"===(null===n||void 0===n?void 0:n.type);case"digital-worker":return"digital-worker"===(null===n||void 0===n?void 0:n.type)&&e.digitalWorker.id===n.digitalWorker.id;case"user":return"user"===(null===n||void 0===n?void 0:n.type)&&e.user.id===n.user.id}return!1}))}),[b,n]),v=Object(s.useCallback)((function(e){e.preventDefault();var t=e.target;setTimeout((function(){return t.setSelectionRange(0,t.value.length)}),0)}),[]);return Object(M.jsx)(Ye.a,Object(a.a)({ref:t,freeSolo:null===l||void 0===l||l,blurOnSelect:!0,options:null!==b&&void 0!==b?b:[],value:j,onChange:function(e,t,n){var a;"object"===typeof t&&"select-option"===n&&(null===r||void 0===r||r(null!==(a=t)&&void 0!==a?a:void 0))},getOptionLabel:function(e){var t;return null!==(t=nt(e))&&void 0!==t?t:""},filterOptions:function(e,t){var n,a=(n=t.inputValue,n.normalize("NFD").replace(/[\u0300-\u036f]/g,"")).toLowerCase();return a?e.filter((function(e){return function(e,t){switch(e.type){case"any-user":return"*"===t;case"digital-worker":var n=e.digitalWorker.name;return n&&n.includes(t);case"user":var a=e.user.fullName,r=e.user.email;return a&&a.includes(t)||r&&r.includes(t)}return!1}(e,a)})):e},renderInput:null!==o&&void 0!==o?o:function(e){return Object(M.jsx)(Ke.a,Object(a.a)(Object(a.a)({},e),{},{autoFocus:!0,margin:"dense",onFocus:v,classes:{root:f.textFieldRoot}}))},renderOption:function(e){return Object(M.jsx)(at,{taskAssignment:e})}},d))})),ct=["data","users","digitalWorkers","onAssignmentChange"],it=Object(d.a)((function(e){return Object(f.a)({grow:{flexGrow:1},assignmentEditorContainer:{justifyContent:"center"}})})),ot=function(e){var t=e.taskGroupService,n=e.users,a=e.digitalWorkers,r=e.open,u=e.onClose,l=e.onChange,d=it(),f=Object(O.a)().t,b=t.updateAssignedTo,j=Object(s.useState)(),v=Object(o.a)(j,2),p=v[0],m=v[1],h=Object(Ue.a)(),g=Object(s.useCallback)((function(e){m(e)}),[]),x=Object(s.useCallback)(Object(i.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b(tt(p));case 3:e.next=9;break;case 5:return e.prev=5,e.t0=e.catch(0),h(f("CouldNotAssignUser"),e.t0),e.abrupt("return");case 9:null===l||void 0===l||l(tt(p)),u();case 11:case"end":return e.stop()}}),e,null,[[0,5]])}))),[l,u,h,p,f,b]),y=Object(s.useCallback)(Object(i.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b(void 0);case 3:e.next=9;break;case 5:return e.prev=5,e.t0=e.catch(0),h(f("CouldNotClearAssignments"),e.t0),e.abrupt("return");case 9:null===l||void 0===l||l(void 0),u();case 11:case"end":return e.stop()}}),e,null,[[0,5]])}))),[l,u,h,f,b]),k=Object(s.useCallback)((function(e,t){"backdropClick"!==t&&(null===u||void 0===u||u())}),[u]);return Object(M.jsxs)(We.a,{open:r,onClose:k,maxWidth:"sm",fullWidth:!0,children:[Object(M.jsx)($e.a,{children:f("AssigningUser")}),Object(M.jsx)(Ve.a,{className:d.assignmentEditorContainer,children:Object(M.jsxs)(He.a,{container:!0,justifyContent:"center",alignItems:"center",spacing:2,children:[Object(M.jsx)(He.a,{item:!0,children:Object(M.jsx)(Ge.a,{children:f("User")})}),Object(M.jsx)(He.a,{item:!0,xs:6,children:Object(M.jsx)(rt,{users:n,digitalWorkers:a,value:p,onChange:g})})]})}),Object(M.jsxs)(_e.a,{children:[Object(M.jsx)(Be.a,{onClick:y,color:"primary",children:f("ClearAssignments")}),Object(M.jsx)("div",{className:d.grow}),Object(M.jsx)(Be.a,{onClick:x,color:"primary",disabled:!p,children:f("Accept")}),Object(M.jsx)(Be.a,{onClick:u,color:"primary",children:f("Cancel")})]})]})},ut=function(e){var t=e.data,n=e.users,r=e.digitalWorkers,c=e.onAssignmentChange,i=Object(u.a)(e,ct),l=Object(O.a)().t,d=Object(s.useState)(!1),f=Object(o.a)(d,2),b=f[0],j=f[1],v=Object(s.useCallback)((function(){j(!0)}),[]),p=Object(s.useCallback)((function(){j(!1)}),[]),m=Object(s.useCallback)((function(e){null===c||void 0===c||c(e)}),[c]);return Object(M.jsx)(Te,{tasks:t,children:Object(M.jsx)(Pe,{children:function(e){return Object(M.jsxs)(M.Fragment,{children:[Object(M.jsx)(Re.a,Object(a.a)({icon:Object(M.jsx)(qe.a,{}),label:l("AssignUser"),clickable:!0,onClick:v,variant:"outlined"},i)),b&&Object(M.jsx)(ot,{taskGroupService:e,users:n,digitalWorkers:r,open:b,onClose:p,onChange:m})]})}})})},st=n(2402),lt=n(274),dt=n.n(lt),ft=["value","onChange","users","digitalWorkers"],bt=Object(d.a)((function(e){return Object(f.a)({view:{width:"13rem",borderRadius:e.shape.borderRadius,padding:e.spacing(1),overflowX:"hidden",borderWidth:1,borderStyle:"solid",borderColor:"transparent","&:hover":{borderColor:e.palette.divider}},container:{position:"relative","&:hover .clear-button":{visibility:"visible"}},clearButton:{position:"absolute",left:-40,top:0,visibility:"hidden"}})})),jt=function(e){var t=e.value,n=e.onChange,r=e.users,l=e.digitalWorkers,d=Object(u.a)(e,ft),f=Object(O.a)().t,j=bt(),v=Object(pe.c)(),p=Object(s.useState)(!1),m=Object(o.a)(p,2),h=m[0],g=m[1],x=Object(s.useMemo)((function(){return t?function(e,t,n){if("*"===e)return{type:"any-user"};if(e.startsWith("dw:")){var a=e.substring(3),r=null===n||void 0===n?void 0:n.find((function(e){return e.id===a}));if(r)return{type:"digital-worker",digitalWorker:r}}else{var c=null===t||void 0===t?void 0:t.find((function(t){return t.id===e||t.email===e}));if(c)return{type:"user",user:c}}return e?{type:"unknown",id:e}:void 0}(t,r,l):void 0}),[t,r,l]),y=Object(s.useCallback)((function(){g(!0)}),[g]),k=Object(s.useCallback)((function(){g(!1)}),[g]),C=Object(s.useCallback)((function(e){"Escape"===e.key&&g(!1)}),[g]),w=Object(s.useCallback)((function(e){g(!1),null===n||void 0===n||n(e?tt(e):void 0)}),[n]),I=Object(s.useCallback)(Object(i.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return g(!1),t=nt(x),e.next=4,v({description:f("ConfirmClearAssignment",{name:t})});case 4:e.sent&&(null===n||void 0===n||n(void 0));case 6:case"end":return e.stop()}}),e)}))),[n,x,v,f]);return h?Object(M.jsx)(st.a,{onClickAway:k,children:Object(M.jsx)(rt,Object(a.a)({value:x,onChange:w,users:r,digitalWorkers:l,onKeyUp:C,disableClearable:!0},d))}):Object(M.jsxs)("div",{className:j.container,children:[Object(M.jsx)("div",{className:j.view,children:Object(M.jsx)(at,{taskAssignment:null!==x&&void 0!==x?x:{type:"unknown",id:null!==t&&void 0!==t?t:"\xa0"},onClick:y})}),!!t&&Object(M.jsx)(b.a,{onClick:I,className:"".concat(j.clearButton," clear-button"),children:Object(M.jsx)(dt.a,{})})]})},vt=n(67),pt=n(984),Ot=["family","className"],mt=function(e){switch(e){case"Outlined":return"material-icons-outlined";case"Rounded":return"material-icons-round";case"Sharp":return"material-icons-sharp";case"Two tone":return"material-icons-two-tone";default:return}},ht=function(e){var t=e.family,n=e.className,r=Object(u.a)(e,Ot);return Object(M.jsx)(pt.a,Object(a.a)({className:Object(vt.default)(mt(t),n)},r))},gt=n(265),xt=n(107),yt=n(390),kt=n(515),Ct=n(243),wt={padding:"dense",showSelectAllCheckbox:!1,search:!1},It=function(e){var t,n={currentPage:e.page,pageSize:e.pageSize};if(e.filters&&e.filters.length>0){n.filters={};var a,r=Object(m.a)(e.filters);try{for(r.s();!(a=r.n()).done;){var c=a.value;n.filters[c.column.field]=null===c||void 0===c?void 0:c.value}}catch(i){r.e(i)}finally{r.f()}}return(null===(t=e.orderBy)||void 0===t?void 0:t.field)&&(n.sortInfo={column:e.orderBy.field,direction:e.orderDirection}),n},St=function(e){return function(t,n){Array.isArray(n)&&(n=n[0]),e(n)}},Tt=function(){return Object(M.jsx)(te.a,{})},Pt=function(){return Object(M.jsx)(ae.a,{})},Rt=Object(s.lazy)((function(){return n.e(21).then(n.bind(null,2464))})),Mt=l.a.memo((function(e){var t=e.columns,n=e.pageSizeOptions,r=e.initialState,u=e.allowResponseCreation,l=e.allowTaskReassignment,d=e.allowFocusing,f=e.onResponseRequested,b=q(),j=b.data,v=b.contextTypes,g=b.canCreateResponsesTo,y=b.currentState,k=b.setCurrentState,w=b.refreshTasks,N=b.updateTask,D=Object(O.a)().t,A=Object(Ue.a)(),E=Object(s.useRef)(),z=Object(s.useState)(),F=Object(o.a)(z,2),U=F[0],W=F[1],_=Object(s.useRef)(),V=Object(s.useRef)(),$=Object(s.useRef)(),H=Object(s.useRef)(),G=Object(s.useCallback)((function(e){W(e),_.current=e}),[]),J=Object(pe.c)(),ee=function(e){var t=Object(I.c)().users_GetUsersWithPermission,n=Object(P.a)(t,L.b.readTasks,e),a=Object(x.a)(n,Object(i.a)(c.a.mark((function n(){var a;return c.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e){n.next=2;break}return n.abrupt("return",[]);case 2:return n.next=4,t({action:L.b.readTasks,pageSize:100,pageNumber:0});case 4:return a=n.sent,n.abrupt("return",a);case 6:case"end":return n.stop()}}),n)})))),r=a.data,o=a.isValidating,u=a.mutate,l=a.error;return Object(s.useMemo)((function(){return{users:null!==r&&void 0!==r?r:[],isValidating:o,error:l,mutate:u}}),[r,o,u,l])}(l).users,te=function(e){var t=Object(I.c)().digitalWorkers_SearchData,n=Object(P.a)(t,e),a=Object(x.a)(n,Object(i.a)(c.a.mark((function n(){var a;return c.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e){n.next=2;break}return n.abrupt("return",[]);case 2:return n.next=4,t({active:!0});case 4:return a=n.sent,n.abrupt("return",a);case 6:case"end":return n.stop()}}),n)})))),r=a.data,o=a.isValidating,u=a.mutate,l=a.error;return Object(s.useMemo)((function(){return{digitalWorkers:null!==r&&void 0!==r?r:[],isValidating:o,error:l,mutate:u}}),[r,o,u,l])}(l).digitalWorkers,ne=Object(s.useState)(),ae=Object(o.a)(ne,2),re=ae[0],ie=ae[1],ue=function(){var e=Object(be.usePopupState)({variant:"popover",popupId:"actionMenu"}),t=Object(s.useState)(),n=Object(o.a)(t,2),a=n[0],r=n[1],c=Object(s.useState)(),i=Object(o.a)(c,2),u=i[0],l=i[1],d=Object(s.useCallback)((function(t,n,a){for(var c=t.target;c&&!(c instanceof HTMLElement);)c=c.parentNode;if(c){var i=a.tasks.find((function(e){return e.name===n.typeName}));(null===i||void 0===i?void 0:i.validResponses)&&l(i.validResponses),r(n),setTimeout((function(){e.open(c)}),0)}}),[e]),f=Object(s.useCallback)((function(){e.close(),r(void 0),l(void 0)}),[e]);return{popupState:e,openMenu:d,closeMenu:f,currentTask:a,responseTypes:u}}(),de=ue.popupState,Oe=ue.openMenu,me=ue.closeMenu,he=ue.currentTask,ge=ue.responseTypes,xe=Object(R.c)().authenticatedUser,ye=Object(s.useCallback)(function(){var e=Object(i.a)(c.a.mark((function e(t,n){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,N(t,{assignedTo:n});case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),A(D("TaskAssignmentFailed"),e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t,n){return e.apply(this,arguments)}}(),[A,D,N]),ke=Object(s.useCallback)(function(){var e=Object(i.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,N(t,{focused:!t.focused});case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),A(D("TaskAssignmentFailed"),e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t){return e.apply(this,arguments)}}(),[A,D,N]),Ce=Object(s.useMemo)((function(){return t.map((function(e){var t,n,a,c={field:e.field,title:null!==(t=e.title)&&void 0!==t?t:D(e.field.toUpperCase()[0]+e.field.substring(1)),sorting:"focused"!==e.field&&(null===(n=e.allowSorting)||void 0===n||n),hidden:e.hidden};return"dueDate"===e.field&&(c.render=function(e){return e.dueDate?je(e.dueDate):""}),"dateCreated"===e.field&&(c.render=function(e){return e.dateCreated?je(e.dateCreated):""}),"assignedTo"===e.field&&l&&(c.render=function(e){return Object(M.jsx)(jt,{value:e.assignedTo,users:ee,digitalWorkers:te,onChange:function(t){return ye(e,t)}})}),"typeName"===e.field&&(c.render=function(e){return D(e.typeName,{ns:gt.b})}),"contextTypeName"===e.field&&(c.render=function(e){return D(e.contextTypeName,{ns:gt.b})}),(null===r||void 0===r||null===(a=r.sortInfo)||void 0===a?void 0:a.column)===e.field&&(c.defaultSort=r.sortInfo.direction),c}))}),[l,t,te,ye,r.sortInfo,D,ee]);Object(s.useEffect)((function(){Object(C.a)(H.current,y.filters)||(H.current=y.filters,t.forEach((function(e,t){var n,a;null===(n=E.current)||void 0===n||n.onFilterChange(t,null===(a=y.filters)||void 0===a?void 0:a[e.field])})))}),[t,y.filters]),Object(s.useEffect)((function(){var e;(V.current=j,$.current)?$.current(j):null===(e=E.current)||void 0===e||e.onQueryChange()}),[j]);var we=Object(s.useCallback)((function(e,t){if(0===e.length)G(void 0),_.current=void 0;else{var n={taskTypeName:e[0].typeName,contextTypeName:e[0].contextTypeName,selectedTasks:e};G(n)}}),[G]),Ie=Object(s.useCallback)((function(){G(void 0)}),[G]),Se=Object(s.useCallback)((function(e,t){G(void 0)}),[G]),Te=Object(s.useCallback)((function(e){}),[]),Pe=Object(s.useCallback)((function(e){ie(e)}),[]),Re=Object(s.useCallback)((function(e){if(me(),he){var t=v[he.contextTypeName];null===f||void 0===f||f(t,he,e)}}),[me,v,he,f]),Me=Object(s.useMemo)((function(){var e={onChange:function(e,t){var n=E.current,a=null===n||void 0===n?void 0:n.dataManager;a&&(0===a.selectedCount&&u?J({title:null,description:le.a.t("SelectAtLeastOneRowToDetermineType"),cancellationButtonProps:{style:{display:"none"}}}):(a.changeAllSelected(t),n.setState(a.getRenderState(),(function(){return n.onSelectionChange()}))))}};return Object(a.a)(Object(a.a)({},wt),{},{selectionProps:function(e){if(!u)return{};var t=_.current,n=!!t&&(t.taskTypeName!==e.typeName||t.contextTypeName!==e.contextTypeName)||!g(e);return e.tableData.disabled=n,{disabled:n}},headerSelectionProps:e,selection:u||l,showSelectAllCheckbox:u||l,pageSizeOptions:n,pageSize:y.pageSize,initialPage:r.currentPage})}),[u,l,n,y.pageSize,r.currentPage,g,J]),Ne=Object(s.useMemo)((function(){var e,t=[(e=function(){return w()},{icon:p.a,tooltip:le.a.t("RefreshData"),isFreeAction:!0,onClick:e})];return d&&t.push({action:function(e){return function(e,t){return{icon:e.focused?Pt:Tt,tooltip:le.a.t(e.focused?"Unfocus":"Focus"),onClick:St(t)}}(e,(function(){return ke(e)}))},position:"row"}),u&&(t.push({action:function(e){return function(e,t,n,a,r){var c,i,o=null===t||void 0===t?void 0:t.tasks.find((function(t){return t.name===e.typeName})),u=o?null===(c=Object(S.i)(o))||void 0===c?void 0:c.taskDetailsTemplate:void 0,s=void 0,l=null!==(i=null===n||void 0===n?void 0:n.filter((function(t){return t.taskId===e.id&&"UserStartedNewTaskResponse"===t.activityName&&t.userId!==(null===a||void 0===a?void 0:a.sub)&&t.email!==(null===a||void 0===a?void 0:a.email)&&Object(yt.a)(new Date,Object(kt.default)(t.timestamp))<=60})))&&void 0!==i?i:[];return u?s=Object(T.a)(u.trimStart().split("\n")[0],{task:e,activityRecords:l}):l.length>0&&(s=l.map((function(e){return"".concat(e.email,": ").concat(Object(Ct.a)(e.timestamp))})).join("; ")),{icon:function(){return Object(M.jsx)(se.a,{color:0===l.length?"action":"error"})},tooltip:s,onClick:St(r),disabled:!s}}(e,v[e.contextTypeName],j.activityRecords,xe,(function(){Pe(e)}))},position:"row"}),t.push.apply(t,Object(h.a)(fe((function(e){return{action:function(t){var n=v[t.contextTypeName];return function(e,t,n,a){var r,c=null===t||void 0===t?void 0:t.tasks.find((function(t){return t.name===e.typeName})),i=null===c||void 0===c?void 0:c.validResponses.filter((function(e){var t;return!!(null===(t=Object(S.i)(e))||void 0===t?void 0:t.icon)}))[n],o=i?null===(r=Object(S.i)(i))||void 0===r?void 0:r.icon:void 0;return{icon:function(){return Object(M.jsx)(ht,{family:null===o||void 0===o?void 0:o.family,children:null===o||void 0===o?void 0:o.name})},tooltip:i?Object(S.h)(i):"",onClick:St((function(e){return a(e,i)})),position:"row",hidden:!i}}(t,n,e,(function(e,t){null===f||void 0===f||f(n,e,t)}))},position:"row"}}),3))),t.push({action:function(e){return function(e,t,n){var a=null===t||void 0===t?void 0:t.tasks.find((function(t){return t.name===e.typeName})),r=!1,c=!1;if(a){var i,o=Object(m.a)(a.validResponses);try{for(o.s();!(i=o.n()).done;){var u,s=i.value;(null===(u=Object(S.i)(s))||void 0===u?void 0:u.icon)?r=!0:c=!0}}catch(l){o.e(l)}finally{o.f()}}return{icon:r?oe.a:ce.a,tooltip:le.a.t(r?"MoreResponses":"SendResponse"),onClick:function(e,a){return n(e,Array.isArray(a)?a[0]:a,t)},position:"row",hidden:!c}}(e,v[e.contextTypeName],(function(e,t,n){Oe(e,t,n)}))},position:"row"})),t}),[d,u,xe,v,j.activityRecords,ke,Pe,f,Oe,w]),De=Object(s.useMemo)((function(){return{Container:function(e){return Object(M.jsx)("div",Object(a.a)({},e))},Actions:function(e){return U&&Array.isArray(e.data)?Object(M.jsxs)(M.Fragment,{children:[l&&Object(M.jsx)(ut,Object(a.a)({onAssignmentChange:Ie,users:ee,digitalWorkers:te},e)),u&&Object(M.jsx)(Fe,Object(a.a)({onResponsesAdded:Ie},e))]}):Object(M.jsx)(Z.MTableActions,Object(a.a)({},e))},Toolbar:function(e){return U&&Array.isArray(e.data)?Object(M.jsx)(Z.MTableToolbar,Object(a.a)({},e)):Object(M.jsx)("div",{})}}}),[u,l,Ie,te,U,ee]),Ae=Object(s.useCallback)(function(){var e=Object(i.a)(c.a.mark((function e(t){var n,a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=!1,k((function(e){var n=It(t);return n.filters=e.filters,(a=!Object(C.a)(e,n))?n:e})),!a){e.next=4;break}return e.abrupt("return",new Promise((function(e,t){$.current=function(t){e(t),$.current=void 0}})));case 4:return e.abrupt("return",Promise.resolve(null!==(n=V.current)&&void 0!==n?n:B));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[k]),Ee=Object(s.useMemo)((function(){return!!ge&&ge.some((function(e){var t;return!!(null===(t=Object(S.i)(e))||void 0===t?void 0:t.icon)}))}),[ge]);return Object(M.jsxs)(M.Fragment,{children:[Object(M.jsx)(ve.a,{tableRef:E,columns:Ce,data:Ae,options:Me,title:" ",components:De,actions:Ne,onSelectionChange:we,onPageChange:Se,onRowsPerPageChange:Te}),Object(M.jsx)(Y.a,Object(a.a)(Object(a.a)({},Object(be.bindMenu)(de)),{},{children:null===ge||void 0===ge?void 0:ge.map((function(e){var t,n,a=null===(t=Object(S.i)(e))||void 0===t?void 0:t.icon;return Object(M.jsxs)(K.a,{onClick:function(){return Re(e)},children:[Ee&&Object(M.jsx)(X.a,{children:Object(M.jsx)(ht,{fontSize:"small",family:null===a||void 0===a?void 0:a.family,children:null===a||void 0===a?void 0:a.name})}),Object(M.jsx)(Q.a,{primary:null!==(n=Object(S.h)(e))&&void 0!==n?n:""})]},e.name)}))})),!!re&&Object(M.jsx)(s.Suspense,{fallback:Object(M.jsx)(xt.a,{}),children:Object(M.jsx)(Rt,{open:!!re,task:re,contextType:v[re.contextTypeName],onClose:function(){return ie(void 0)}})})]})})),Nt=n(939),Dt=n(137),At=Object(d.a)((function(e){return Object(f.a)({size:{width:"7em"}})})),Et=n(2401),zt=function(e){return Object(M.jsx)(Et.a,Object(a.a)(Object(a.a)({viewBox:"0 0 247.46 247.46"},e),{},{children:Object(M.jsx)("path",{d:"M246.744,13.984c-1.238-2.626-3.881-4.301-6.784-4.301H7.5c-2.903,0-5.545,1.675-6.784,4.301\r c-1.238,2.626-0.85,5.73,0.997,7.97l89.361,108.384v99.94c0,2.595,1.341,5.005,3.545,6.373c1.208,0.749,2.579,1.127,3.955,1.127\r c1.137,0,2.278-0.259,3.33-0.78l50.208-24.885c2.551-1.264,4.165-3.863,4.169-6.71l0.098-75.062l89.366-108.388\r C247.593,19.714,247.982,16.609,246.744,13.984z M143.097,122.873c-1.105,1.34-1.711,3.023-1.713,4.761l-0.096,73.103\r l-35.213,17.453v-90.546c0-1.741-0.605-3.428-1.713-4.771L23.404,24.682h200.651L143.097,122.873z"})}))};function Lt(e,t,n){void 0===t&&(t=0),void 0===n&&(n=[]);var a=function(e,t){void 0===t&&(t=0);var n=Object(s.useRef)(!1),a=Object(s.useRef)(),r=Object(s.useRef)(e),c=Object(s.useCallback)((function(){return n.current}),[]),i=Object(s.useCallback)((function(){n.current=!1,a.current&&clearTimeout(a.current),a.current=setTimeout((function(){n.current=!0,r.current()}),t)}),[t]),o=Object(s.useCallback)((function(){n.current=null,a.current&&clearTimeout(a.current)}),[]);return Object(s.useEffect)((function(){r.current=e}),[e]),Object(s.useEffect)((function(){return i(),o}),[t]),[c,o,i]}(e,t),r=a[0],c=a[1],i=a[2];return Object(s.useEffect)(i,n),[r,c]}var Ft=function(e){var t=e.value,n=e.onChange,a=Object(s.useState)("textMatch"===(null===t||void 0===t?void 0:t.type)?t.value:void 0),r=Object(o.a)(a,2),c=r[0],i=r[1],u=Object(s.useRef)(!1),l=Object(s.useRef)();Object(s.useEffect)((function(){var e;l.current&&!u.current&&(null===t||void 0===t?void 0:t.value)!==c&&(i(null===t||void 0===t?void 0:t.value),l.current.value=null!==(e=null===t||void 0===t?void 0:t.value)&&void 0!==e?e:"")}),[c,t]),Lt((function(){u.current=!1,null===n||void 0===n||n(c?{type:"textMatch",value:c}:void 0)}),2e3,[c,n]);var d=Object(s.useCallback)((function(e){u.current=!0,i(e.target.value)}),[]);return Object(M.jsx)(Ke.a,{value:c,onChange:d,inputRef:l})},Ut=["value","onChange"],Bt=function(e){var t=e.value,n=e.onChange,r=Object(u.a)(e,Ut),c=Object(s.useMemo)((function(){if(t)return{type:"textMatch",value:t.prefix}}),[t]),i=Object(s.useCallback)((function(e){var t=void 0;e&&(t={type:"prefixTextMatch",prefix:e.value}),null===n||void 0===n||n(t)}),[n]);return Object(M.jsx)(Ft,Object(a.a)({value:c,onChange:i},r))},Wt=n(410),_t=function(e){switch(null===e||void 0===e?void 0:e.type){case"boolean":return le.a.t(e.value?"Yes":"No");case"textMatch":return e.value;case"selection":return null!==e.value?e.value:le.a.t("NullValueText");case"prefixTextMatch":return"".concat(e.prefix,"*");case"dateRange":var t="";return Object(w.isPresent)(e.from)?(t+=e.includeFrom?"[":"(",t+=Object(Wt.default)(Object(kt.default)(e.from),le.a.t("DATE_FORMAT"))):t+="(-\u221e",t+=", ",Object(w.isPresent)(e.to)?(t+=Object(Wt.default)(Object(kt.default)(e.to),le.a.t("DATE_FORMAT")),t+=e.includeTo?"]":")"):t+="\u221e)",t;case"numberRange":var n="";return Object(w.isPresent)(e.from)?(n+=e.includeFrom?"[":"(",n+=e.from):n+="(-\u221e",n+=", ",Object(w.isPresent)(e.to)?(n+=e.to,n+=e.includeTo?"]":")"):n+="\u221e)",n;default:return"??"}},Vt=function(e){var t=e.field,n=e.title,r=e.value,c=e.onClearFilter,i=e.size,o=e.variant,l=Object(u.a)(e,["field","title","value","onClearFilter","size","variant"]),d=Object(s.useCallback)((function(){null===c||void 0===c||c(t)}),[t,c]);return Object(M.jsx)(Re.a,Object(a.a)({onDelete:d,label:"".concat(n,": ").concat(_t(r)),size:null!==i&&void 0!==i?i:"small",variant:null!==o&&void 0!==o?o:"outlined"},l))},$t=Object(s.lazy)((function(){return Promise.all([n.e(15),n.e(19)]).then(n.bind(null,2486))})),Ht=Object(s.lazy)((function(){return Promise.all([n.e(4),n.e(20)]).then(n.bind(null,2465))})),Gt={width:20,height:20},Jt=Object(d.a)((function(e){return Object(f.a)({filter:{marginRight:20},filterIconContainer:{position:"relative"},filteringActiveIcon:{position:"absolute",fontSize:12,right:-5,top:-20},filterAppliedIcon:Object(a.a)({fontSize:"1rem",verticalAlign:"text-bottom"},Gt),clearIconContainer:{position:"relative"},clearButton:{position:"absolute",right:-35},appliedFilterMarker:Object(a.a)({display:"inline-block"},Gt),appliedFilterMarkerClearButton:Object(a.a)({padding:0},Gt),chip:{marginRight:5}})})),qt={contextReference:Bt,title:Bt,assignedTo:Ht,dueDate:$t,contextTypeName:Ht,typeName:Ht,focused:function(e){var t=e.value,n=e.onChange,a=Object(O.a)().t,r=At(),c="boolean"===(null===t||void 0===t?void 0:t.type)?!0===t.value?1:0:void 0,i=Object(s.useCallback)((function(e){var t=e.target.value;null===n||void 0===n||n(1===t?{type:"boolean",value:!0}:0===t?{type:"boolean",value:!1}:void 0)}),[n]);return Object(M.jsxs)(Ke.a,{select:!0,value:c,onChange:i,className:r.size,children:[Object(M.jsx)(K.a,{value:void 0,children:"\xa0"}),Object(M.jsx)(K.a,{value:1,children:a("Yes")}),Object(M.jsx)(K.a,{value:0,children:a("No")})]})},status:Ht,dateCreated:$t},Zt=function(e){var t,n;return null!==(t=null!==(n=e.title)&&void 0!==n?n:le.a.t(e.field.toUpperCase()[0]+e.field.substring(1)))&&void 0!==t?t:""},Yt=function(e){var t,n=e.columns,r=Jt(),u=q(),l=u.currentState,d=u.setCurrentState,f=u.getColumnCandidates,b=Object(s.useState)(n[0]),j=Object(o.a)(b,2),v=j[0],p=j[1],O=Object(s.useCallback)((function(e){var t;p(null!==(t=n.find((function(t){return t.field===e.target.value})))&&void 0!==t?t:n[0])}),[n]),m=Object(s.useCallback)((function(e,t){d((function(n){var r=n.filters;Object(w.isPresent)(t)?r=Object(a.a)(Object(a.a)({},r),{},Object(g.a)({},e,t)):Object(w.isPresent)(r)&&delete r[e];var c=Object(a.a)(Object(a.a)({},n),{},{filters:r});return Object(w.isPresent)(r)&&0===Object.keys(r).length&&delete c.filters,c}))}),[d]),h=Object(s.useCallback)((function(e){m(v.field,e)}),[m,v.field]),x=Object(s.useCallback)((function(e){m(e,void 0),v.field}),[m,v]),y=Object(s.useRef)({}),k=Object(s.useMemo)((function(){var e,t=Object(a.a)({},null!==(e=l.filters)&&void 0!==e?e:{});return delete t[v.field],Object(C.a)(y.current,t)||(y.current=t),y.current}),[l.filters,v.field]),I=Object(s.useCallback)(Object(i.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(v){e.next=2;break}return e.abrupt("return",[]);case 2:return e.next=4,f(v,k);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)}))),[f,v,k]),S=qt[v.field],T=null!==(t=l.filters)&&void 0!==t?t:{},P=T[v.field],R=Object(s.useMemo)((function(){return{startAdornment:Object(M.jsx)(Nt.a,{position:"start",className:r.filterIconContainer,children:Object(M.jsx)(zt,{fontSize:"small"})})}}),[r]);return Object(M.jsxs)(He.a,{container:!0,spacing:3,alignItems:"flex-start",children:[Object(M.jsx)(He.a,{item:!0,xs:12,children:n.filter((function(e){return e.field in T})).map((function(e){return Object(M.jsx)(Vt,{title:Zt(e),field:e.field,value:T[e.field],onClearFilter:x,className:r.chip},e.field)}))}),Object(M.jsx)(He.a,{item:!0,xs:2,children:Object(M.jsx)(Ke.a,{select:!0,value:v.field,onChange:O,fullWidth:!0,InputProps:R,className:r.filter,children:n.map((function(e){return Object(M.jsx)(K.a,{value:e.field,children:Zt(e)},e.field)}))})}),Object(M.jsx)(He.a,{item:!0,xs:10,children:Object(M.jsx)(Dt.a,{children:Object(M.jsx)(s.Suspense,{fallback:Object(M.jsx)(xt.a,{}),children:!!S&&Object(M.jsx)(S,{column:v,value:P,onChange:h,getCandidates:I})})})})]})},Kt=["onStateChanged","allowResponseCreation","allowTaskReassignment"],Qt=["initialState","pageSizeOptions","allowResponseCreation","allowTaskReassignment","allowFocusing","enforcedFilter"],Xt=Object(d.a)((function(e){return Object(f.a)({root:{position:"relative"},refreshButton:{position:"absolute",right:10,top:10}})})),en=Object(s.lazy)((function(){return Promise.resolve().then(n.bind(null,480))})),tn=function(e){var t=e.onStateChanged,n=e.allowResponseCreation,r=e.allowTaskReassignment,l=Object(u.a)(e,Kt),d=Object(O.a)().t,f=Xt(),v=q(),m=v.addResponse,h=v.refreshTasks,g=v.currentState,x=v.canCreateReponses,y=v.canReassignUsers,k=v.taskResponseStarted,C=v.taskResponseClosed,w=Object(s.useState)(),I=Object(o.a)(w,2),S=I[0],T=I[1];Object(s.useEffect)((function(){null===t||void 0===t||t(g)}),[g,t]);var P=Object(s.useCallback)(function(){var e=Object(i.a)(c.a.mark((function e(t,n,a){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return T({contextType:t,task:n,responseType:a}),e.next=3,k(n,a);case 3:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),[k]),R=Object(s.useCallback)(function(){var e=Object(i.a)(c.a.mark((function e(t,n){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(S){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,m(S.task,S.responseType,t,n);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),[m,S]),N=Object(s.useCallback)(function(){var e=Object(i.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(null===S||void 0===S?void 0:S.task)){e.next=3;break}return e.next=3,C(S.task,S.responseType);case 3:if(T(void 0),!t){e.next=7;break}return e.next=7,h();case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[h,null===S||void 0===S?void 0:S.responseType,null===S||void 0===S?void 0:S.task,C]),D=Object(s.useMemo)((function(){return n&&x()}),[x,n]),A=Object(s.useMemo)((function(){return r&&y()}),[y,r]);return Object(M.jsxs)(M.Fragment,{children:[Object(M.jsx)("div",{className:f.root,children:Object(M.jsx)(j.a,{title:d("RefreshData"),children:Object(M.jsx)(b.a,{className:f.refreshButton,onClick:h,children:Object(M.jsx)(p.a,{})})})}),Object(M.jsx)(Yt,Object(a.a)({},l)),Object(M.jsx)("div",{style:{height:10}}),Object(M.jsx)(Mt,Object(a.a)({allowResponseCreation:D,allowTaskReassignment:A,onResponseRequested:P},l)),!!S&&Object(M.jsx)(s.Suspense,{fallback:null,children:Object(M.jsx)(en,{task:S.task,contextType:S.contextType,responseType:S.responseType,open:!!S,onAddResponse:R,onClose:N})})]})},nn=function(e){var t=e.initialState,n=e.pageSizeOptions,r=e.allowResponseCreation,c=void 0!==r&&r,i=e.allowTaskReassignment,o=void 0!==i&&i,l=e.allowFocusing,d=void 0!==l&&l,f=e.enforcedFilter,b=Object(u.a)(e,Qt),j=Object(s.useMemo)((function(){var e=n;return e&&0!==e.length||(e=[5,10,20,100]),e}),[n]),v=Object(s.useMemo)((function(){return Object(a.a)({currentPage:0,pageSize:j[0]},t)}),[t,j]);return Object(M.jsx)(J,{initialState:v,enforcedFilter:f,children:Object(M.jsx)(tn,Object(a.a)({pageSizeOptions:j,initialState:v,allowResponseCreation:c,allowTaskReassignment:o,allowFocusing:d},b))})}},480:function(e,t,n){"use strict";n.r(t),n.d(t,"TasksViewResponseEditorModal",(function(){return W}));var a=n(2),r=n(5),c=n.n(r),i=n(32),o=n(1),u=n(3),s=n(903),l=n(900),d=n(2406),f=n(2422),b=n(2412),j=n(2411),v=n(918),p=n(926),O=n(2482),m=n(2456),h=n(245),g=n(2479),x=n(96),y=n(158),k=n(229),C=n(116),w=n(107),I=n(342),S=n(177),T=n(74),P=n(4),R=n(6),M=n(191),N=n(16),D=n(10),A=n(11),E=n(0),z=function(e){Object(D.a)(n,e);var t=Object(A.a)(n);function n(){var e;Object(P.a)(this,n);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).columnCount=0,e}return Object(R.a)(n,[{key:"visit",value:function(e){return this.columnCount=1,Object(M.a)(Object(N.a)(n.prototype),"visit",this).call(this,e)}},{key:"processLayoutElements",value:function(e){var t=this;this.columnCount=e.elements.reduce((function(e,n){return t.visit(n),Math.max(e,t.columnCount)}),0)}},{key:"visitHorizontalLayout",value:function(e){var t=this;return this.columnCount=e.elements.reduce((function(e,n){return t.visit(n),e+t.columnCount}),0),e}},{key:"visitImageBatchRecognitionElement",value:function(e){return this.columnCount=!0===e.readonly?2:10,e}}]),n}(function(){function e(t){Object(P.a)(this,e),this.schemaLibrary=t}return Object(R.a)(e,[{key:"visit",value:function(e){if(e)switch(e.type){case"VerticalLayout":return this.visitVerticalLayout(e);case"HorizontalLayout":return this.visitHorizontalLayout(e);case"Group":return this.visitGroupLayout(e);case"Label":return this.visitLabelElement(e);case"Control":return this.visitControlElement(e);case"Category":return this.visitCategory(e);case"Categorization":return this.visitCategorization(e);case"ListWithDetails":return this.visitListWithDetails(e);case"Markdown":return this.visitMarkdownElement(e);case"Pdf":return this.visitPdfElement(e);case"Use":return this.visitUseElement(e);case"ImageBatchRecognition":return this.visitImageBatchRecognitionElement(e)}}},{key:"processDetailElement",value:function(e){var t,n=null===(t=e.options)||void 0===t?void 0:t.detail;"object"===typeof n&&n&&"string"===typeof n.type&&this.visit(n)}},{key:"processLayoutElements",value:function(e){var t,n=Object(E.a)(e.elements);try{for(n.s();!(t=n.n()).done;){var a=t.value;this.visit(a)}}catch(r){n.e(r)}finally{n.f()}}},{key:"visitVerticalLayout",value:function(e){return this.processLayoutElements(e),e}},{key:"visitHorizontalLayout",value:function(e){return this.processLayoutElements(e),e}},{key:"visitGroupLayout",value:function(e){return this.processLayoutElements(e),e}},{key:"visitLabelElement",value:function(e){return e}},{key:"visitControlElement",value:function(e){return this.processDetailElement(e),e}},{key:"visitCategory",value:function(e){return e}},{key:"visitCategorization",value:function(e){return this.processLayoutElements(e),e}},{key:"visitListWithDetails",value:function(e){return e}},{key:"visitMarkdownElement",value:function(e){return e}},{key:"visitPdfElement",value:function(e){return e}},{key:"visitUseElement",value:function(e){var t,n=null===(t=this.schemaLibrary)||void 0===t?void 0:t[e.name];return n&&this.visit(n),e}},{key:"visitImageBatchRecognitionElement",value:function(e){return e}}]),e}()),L=function(e,t){var n,a=null===(n=Object(C.i)(t))||void 0===n?void 0:n.uiSchemaCommon,r=a?JSON.parse(a):void 0,c=e?function(e,t){var n=new z(t);return n.visit(e),n.columnCount}(e,r):1;return c>=3?"xl":2===c?"lg":"md"},F=n(389),U=n(31),B=Object(s.a)((function(e){return Object(l.a)({dialogPaper:{maxHeight:"90vh",minHeight:"60vh"},dialogContent:{},grow:{flexGrow:1},content:{padding:"8px 24px","&:first-child":{paddingTop:20}}})}));var W=function(e){var t=e.task,n=e.contextType,r=e.responseType,s=e.open,l=e.taskGroupSize,P=void 0===l?1:l,R=e.onAddResponse,M=e.onClose,N=B(),D=Object(O.a)().t,A=Object(h.b)().enqueueSnackbar,E=Object(S.a)(),z=Object(x.c)().tasks_BuildInitialResponsePayload,W=Object(u.useState)(),_=Object(o.a)(W,2),V=_[0],$=_[1],H=Object(u.useState)(),G=Object(o.a)(H,2),J=G[0],q=G[1],Z=Object(u.useRef)(),Y=Object(g.a)(Object(i.a)(c.a.mark((function e(){var n,a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n={},!(null===r||void 0===r?void 0:r.jsInitialPayloadBuilder)){e.next=14;break}return e.prev=2,e.next=5,z({contextId:t.contextId,contextTypeName:t.contextTypeName,responseTypeName:r.name,taskTypeName:t.typeName});case 5:(a=e.sent).defined&&(n=a.payload),e.next=14;break;case 9:return e.prev=9,e.t0=e.catch(2),X(D("ServerErrorInitializingResponsePayload"),e.t0),M(!0),e.abrupt("return");case 14:$(n);case 15:case"end":return e.stop()}}),e,null,[[2,9]])}))),[]),K=Y.loading,Q=Y.error,X=Object(u.useCallback)((function(e,t){!function(e){var t;if(null==(null===e||void 0===e?void 0:e.response))return!1;var n=null===(t=JSON.parse(null===e||void 0===e?void 0:e.response))||void 0===t?void 0:t.detail;return"string"===typeof n&&n.startsWith("Active")}(t)?E(e,t):A(D("TaskIsNoLongerActive"),{variant:"warning",action:Object(U.jsx)(p.a,{onClick:function(){M(!0)},children:D("Refresh")})})}),[A,D,M,E]),ee=Object(u.useCallback)(Object(i.a)(c.a.mark((function e(){var n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&!(Z.current&&Z.current.length>0)){e.next=2;break}return e.abrupt("return");case 2:n="".concat(t.title,": ").concat(Object(C.h)(r)),R(V,J).catch((function(e){X(D("ErrorSendingResponse",{description:n}),e)})),M(!1);case 5:case"end":return e.stop()}}),e)}))),[t,r,R,V,M,X,J,D]),te=Object(u.useCallback)((function(e){e.errors&&e.errors.length>0?Object(y.a)(e.errors.map((function(e){return Object(a.a)(Object(a.a)({},e),{},{instancePath:e.dataPath})}))):$(e.data),Z.current=Object(m.a)(e.errors)}),[$]),ne=Object(u.useMemo)((function(){if(t&&n)return Object(k.b)(n,t.typeName,r.name)}),[t,n,r]),ae=Object(u.useMemo)((function(){var e;if(t&&n){var a=r?null===(e=Object(C.i)(r))||void 0===e?void 0:e.uiSchema:void 0;return a?JSON.parse(a):void 0}}),[t,n,r]),re=Object(u.useMemo)((function(){if(t&&V)return{task:t,payload:V}}),[t,V]);Object(u.useEffect)((function(){K||q(new Date)}),[K]);var ce=Object(u.useMemo)((function(){return r?function(e,t,n){var a,r=e.tasks.find((function(e){return e.name===t})),c=null===r||void 0===r?void 0:r.validResponses.find((function(e){return e.name===n})),i=c?null===(a=Object(C.i)(c))||void 0===a?void 0:a.uiSchema:void 0,o=i?JSON.parse(i):void 0;if(!o&&c){var u=Object(k.b)(e,t,n);u&&(o=Object(T.generateDefaultUISchema)(u))}return L(o,e)}(n,t.typeName,r.name):"md"}),[n,r,t.typeName]),ie=Object(u.useCallback)((function(e,t){"backdropClick"!==t&&M(!1)}),[M]),oe=Object(u.useMemo)((function(){var e,t=null===(e=Object(C.i)(n))||void 0===e?void 0:e.uiSchemaCommon;if(t)return JSON.parse(t)}),[n]);return K?Object(U.jsx)(w.a,{}):Q||!V?null:Object(U.jsxs)(d.a,{open:s,onClose:ie,maxWidth:ce,fullWidth:!0,classes:{paper:N.dialogPaper},children:[Object(U.jsxs)(j.a,{disableTypography:!0,children:[Object(U.jsxs)(v.a,{component:"h2",variant:"h6",children:[null===t||void 0===t?void 0:t.title," ",P>1?D("AndNOtherResponses",{othersCount:P-1}):""]}),Object(U.jsx)(v.a,{variant:"subtitle1",children:Object(C.g)(r)})]}),Object(U.jsxs)(b.a,{className:N.dialogContent,children:[K&&Object(U.jsx)(w.a,{}),!!t&&!K&&!Q&&Object(U.jsxs)(U.Fragment,{children:[Object(U.jsx)(F.a,{taskId:null===t||void 0===t?void 0:t.id,otherUsers:!0,warning:!0,activityName:"UserStartedNewTaskResponse"}),Object(U.jsx)(I.a,{schema:ne,uischema:ae,data:V,onChange:te,context:re,uiSchemaLibrary:oe})]})]}),Object(U.jsxs)(f.a,{children:[!!t&&Object(U.jsx)(p.a,{onClick:ee,disabled:K||!!Q,color:"primary",children:D("Accept")}),Object(U.jsx)(p.a,{onClick:function(){return M(!1)},color:"primary",children:D("Cancel")})]})]})};t.default=W},574:function(e,t){},576:function(e,t){},577:function(e,t){},590:function(e,t){},591:function(e,t){},594:function(e,t){},595:function(e,t){},596:function(e,t){},597:function(e,t){},598:function(e,t){},600:function(e,t){},602:function(e,t){},603:function(e,t){},604:function(e,t){},605:function(e,t){},606:function(e,t){},620:function(e,t){}}]);
//# sourceMappingURL=12.e299bd6a.chunk.js.map