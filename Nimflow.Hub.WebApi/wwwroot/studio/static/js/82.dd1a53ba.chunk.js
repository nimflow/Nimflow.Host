(this["webpackJsonpnimflow-studio"]=this["webpackJsonpnimflow-studio"]||[]).push([[82],{2291:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var a=n(518),o=n(25),i=n(5),c=n(2617),r=n(2986),s=n(2418),l=n(2417),u=n(2936),d=n(2306),g=n(2442),f=n(3002),b=n(2987),j=n(38),p=n(1258),O=n(1543),h=n(128),v=Object(r.a)((function(e){return Object(c.a)({smallAvatar:{width:25,height:25,border:function(t){return t.displayStandalone?void 0:"2px solid ".concat(e.palette.primary.main)},color:function(t){return t.displayStandalone?e.palette.text.primary:e.palette.text.secondary},backgroundColor:function(t){return t.displayStandalone?e.palette.background.default:e.palette.background.paper}},tagging:{width:16,height:16}})})),m=function(e){var t=e.value,n=e.onChange,c=e.children,r=e.displayEmptyTagging,m=v(e),y=Object(p.usePopupState)({variant:"popover",popupId:"taggingMenu"}),x=Object(i.useCallback)((function(e){y.close(),null===n||void 0===n||n(e)}),[n,y]);return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsxs)(l.a,Object(o.a)(Object(o.a)({},Object(p.bindTrigger)(y)),{},{size:"small",children:[(Object(j.isPresent)(t)||r)&&Object(h.jsx)(b.a,{overlap:"circular",anchorOrigin:{vertical:"bottom",horizontal:"right"},badgeContent:Object(h.jsx)(f.a,{className:m.smallAvatar,children:Object(h.jsx)(O.a,{taggingType:t,className:m.tagging})}),children:c}),!Object(j.isPresent)(t)&&c]})),Object(h.jsx)(d.a,Object(o.a)(Object(o.a)({},Object(p.bindMenu)(y)),{},{children:[void 0].concat(Object(a.a)(O.d)).map((function(e,t){return Object(h.jsxs)(g.a,{onClick:function(){return x(e)},children:[Object(h.jsx)(u.a,{children:Object(h.jsx)(O.a,{taggingType:e,fontSize:"small"})}),Object(h.jsx)(s.a,{variant:"inherit",children:Object(O.b)(e)})]},t)}))}))]})}},2981:function(e,t,n){"use strict";n.r(t),n.d(t,"ContextTypeDiagram",(function(){return Ct}));var a,o=n(464),i=n(25),c=n(135),r=n(134),s=n(137),l=n(138),u=n(485),d=n(518),g=n(49),f=n(484),b=n.n(f),j=n(5),p=n.n(j),O=n(480),h=n(1318),v=n.n(h),m=n(627),y=n(2438),x=n(884),k=n.n(x),C=n(3033),I=n(905),N=n(2852),P=n(150),S=n(14),w=n(3006),M=n(38),L=n(2617),T=n(2986),D=n(1966),R=n(643),A=n.n(R),E=n(2317),z=n.n(E),F=n(575),X=n.n(F),Y=n(785),B=n.n(Y),H=n(2838),W=n.n(H),Z=n(2911),V=n(2225),q=n(2226),J=n(2227),U=n(2934),_=n(564),G=n(463),K=n(1851),Q=Object(P.b)({key:"hoveredContextTypeNodeModelIdState",default:void 0}),$=Object(P.b)({key:"selectedLinkIds",default:[]}),ee=Object(P.b)({key:"selectedNodeIdsState",default:[]}),te=Object(P.b)({key:"focusedNodeIdsState",default:[]}),ne=n(128),ae=["port","onPortHovering","className"],oe=Object(T.a)((function(e){return Object(L.a)({portBody:{width:function(e){var t;return null!==(t=e.portSize)&&void 0!==t?t:K.b},height:function(e){var t;return null!==(t=e.portSize)&&void 0!==t?t:K.b},background:"rgba(128, 128, 128, 1)",opacity:.3},port:{width:"100%",height:"100%"}})})),ie=function(e){var t=e.port,n=e.onPortHovering,a=e.className,o=Object(_.a)(e,ae),c=oe(e),r=Object(P.i)($),s=Object(j.useCallback)((function(e){null===n||void 0===n||n(t,e),r((function(n){if(!e)return[];var a=Object.keys(t.links);return n.length===a.length&&a.every((function(e){return n.includes(e)}))?n:a}))}),[n,t,r]);return Object(ne.jsx)("div",{className:Object(G.default)(c.portBody,a),onMouseEnter:function(){return s(!0)},onMouseLeave:function(){return s(!1)},children:Object(ne.jsx)(h.PortWidget,Object(i.a)({className:c.port,port:t},o))})},ce=Object(T.a)((function(e){return Object(L.a)({root:{position:"relative",marginTop:20,marginBottom:20,cursor:"pointer",opacity:function(e){return e.unfocused?.2:1}},cardContainer:{position:"relative"},card:{backgroundColor:function(t){return t.selected?e.palette.action.selected:e.palette.background.paper}},inPort:{top:20,left:-K.b,position:"absolute"},outPort:{top:20,right:-K.b,position:"absolute"},headerRoot:{padding:"".concat(e.spacing(1)," ").concat(e.spacing(2))},contentRoot:{padding:"".concat(e.spacing(1)," ").concat(e.spacing(1))},actions:{display:"table",position:"absolute",paddingBottom:10,zIndex:100,width:"100%",textAlign:"right"},action:{marginTop:5,marginRight:10,color:e.palette.text.secondary,backgroundColor:e.palette.background.paper,"&:hover":{backgroundColor:Object(Z.e)(e.palette.background.paper,.15)}}})})),re=function(e){var t,n=e.node,a=e.engine,i=e.onPortHovering,c=e.onPanelHovering,r=e.title,s=e.titleTypographyProps,l=e.subheader,u=e.subheaderTypographyProps,d=e.avatar,g=e.actions,f=e.children,b=Object(P.f)(Q),p=Object(o.a)(b,2),O=p[0],h=p[1],v=Object(P.h)(te),m=Object(P.i)($),x=O===n.getID(),k=v.includes(n.getID()),I=ce({selected:null!==(t=e.selected)&&void 0!==t&&t,unfocused:v.length>0&&!k}),N=Object(j.useCallback)((function(){null===c||void 0===c||c(!0),h(n.getID()),m((function(e){var t=Object(S.I)(Object.values(n.getPorts()).flatMap((function(e){return Object.keys(e.links)})));return e.length===t.length&&t.every((function(t){return e.includes(t)}))?e:t}))}),[c,h,n,m]),w=Object(j.useCallback)((function(){null===c||void 0===c||c(!1);var e=n.getID();h((function(t){return t===e?void 0:t})),m((function(e){return e.length>0?[]:e}))}),[c,n,h,m]),M=Object(j.useCallback)((function(){n.dispatchCommand({type:"focusNode"})}),[n]);return Object(ne.jsxs)("div",{className:I.root,children:[Object(ne.jsxs)("div",{onMouseEnter:N,onMouseLeave:w,className:I.cardContainer,children:[Object(ne.jsxs)(V.a,{className:I.card,elevation:2,onDoubleClick:M,children:[Object(ne.jsx)(q.a,{title:null!==r&&void 0!==r?r:n.title,titleTypographyProps:s,subheader:l,subheaderTypographyProps:u,avatar:d,classes:{root:I.headerRoot}}),!!f&&Object(ne.jsxs)(ne.Fragment,{children:[Object(ne.jsx)(U.a,{}),Object(ne.jsx)(J.a,{classes:{root:I.contentRoot},children:f})]})]}),!!g&&x&&Object(ne.jsx)("div",{className:I.actions,children:g.map((function(e,t){var n=Object(ne.jsx)(C.a,{onClick:function(t){return e.onClick(t)},size:"small",className:I.action,children:e.icon},t);return e.tooltip&&(n=Object(ne.jsx)(y.a,{title:e.tooltip,children:n},t)),n}))})]}),n.inPort&&Object(ne.jsx)(ie,{port:n.inPort,engine:a,onPortHovering:i,className:I.inPort}),n.outPort&&Object(ne.jsx)(ie,{port:n.outPort,engine:a,onPortHovering:i,className:I.outPort})]})},se=n(3002),le=["className"],ue=Object(T.a)((function(e){return Object(L.a)({avatar:{color:"light"===e.palette.mode?e.palette.background.default:"#fff",backgroundColor:e.palette.primary.main,width:e.spacing(4),height:e.spacing(4)}})})),de=function(e){var t=e.className,n=Object(_.a)(e,le),a=ue();return Object(ne.jsx)(se.a,Object(i.a)({className:Object(G.default)(a.avatar,t)},n))},ge=Object(T.a)((function(e){return Object(L.a)({responsePort:{top:"calc(50% - ".concat(4,"px)"),right:-8,position:"absolute"},response:{position:"relative",marginBottom:5},responseChipRoot:{width:"100%",backgroundColor:e.palette.background.paper},responseChipLabel:{width:"100%"}})})),fe=function(e){return Object(ne.jsxs)(ne.Fragment,{children:[Object(ne.jsx)(A.a,Object(i.a)({"data-action-type":"edit"},e)),Object(ne.jsx)(z.a,Object(i.a)({"data-action-type":"delete"},e))]})},be=function(e){var t,n=e.engine,a=e.node,o=ge(e),i=Object(j.useMemo)((function(){return[{icon:Object(ne.jsx)(A.a,{}),onClick:function(){a.dispatchCommand({type:"edit"})}},{icon:Object(ne.jsx)(X.a,{}),onClick:function(){a.dispatchCommand({type:"delete"})}}]}),[a]),c=Object(j.useCallback)((function(e,t){for(var n=e.target;n&&"svg"!==n.tagName;)n=n.parentNode;if(n){var o=n.getAttribute("data-action-type");o&&("edit"===o?a.dispatchCommand({type:"editResponse",responseName:t.name}):"delete"===o&&a.dispatchCommand({type:"deleteResponse",responseName:t.name}))}}),[a]);return Object(ne.jsx)(re,{engine:n,node:a,avatar:Object(ne.jsx)(de,{children:Object(ne.jsx)(B.a,{})}),actions:i,selected:a.isSelected(),children:null===(t=a.instance.validResponses)||void 0===t?void 0:t.map((function(e){var t=a.getResponsePort(e);return Object(ne.jsxs)("div",{className:o.response,children:[Object(ne.jsx)(D.a,{icon:Object(ne.jsx)(W.a,{}),label:null===e||void 0===e?void 0:e.name,onDelete:function(t){return c(t,e)},deleteIcon:Object(ne.jsx)(fe,{}),variant:"outlined",classes:{root:o.responseChipRoot,label:o.responseChipLabel}}),t&&Object(ne.jsx)(ie,{port:t,engine:n,portSize:8,className:o.responsePort})]},e.name)}))})},je=n(1941),pe=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(){return Object(r.a)(this,n),t.call(this,"taskType")}return Object(c.a)(n,[{key:"generateModel",value:function(e){var t,n=null!==(t=e.instanceId)&&void 0!==t?t:"",a=Object(i.a)({},e);return delete a.instanceId,new je.a(a,n)}},{key:"generateReactWidget",value:function(e){return Object(ne.jsx)(be,{engine:this.engine,node:e.model})}}]),n}(m.AbstractReactFactory),Oe=n(1940),he=n(2417),ve=n(1853),me=n.n(ve),ye=n(2987),xe=n(2013),ke=n.n(xe),Ce=Object(T.a)((function(e){return Object(L.a)({smallAvatar:{width:25,height:25,border:"2px solid ".concat(e.palette.primary.main),color:e.palette.text.secondary,backgroundColor:e.palette.background.paper},initialAction:{width:16,height:16}})})),Ie=function(e){var t=e.isInitialAction,n=e.onClick,a=e.children,o=Ce();return Object(ne.jsxs)(he.a,{onClick:n,size:"small",children:[t&&Object(ne.jsx)(ye.a,{overlap:"circular",anchorOrigin:{vertical:"bottom",horizontal:"right"},badgeContent:Object(ne.jsx)(se.a,{className:o.smallAvatar,children:Object(ne.jsx)(ke.a,{className:o.initialAction})}),children:a}),!t&&a]})},Ne=function(e){var t=e.engine,n=e.node,a=Object(j.useCallback)((function(){n.dispatchCommand({type:"toggleInitialAction"})}),[n]),o=Object(j.useMemo)((function(){return[{icon:Object(ne.jsx)(A.a,{}),onClick:function(){n.dispatchCommand({type:"edit"})}},{icon:Object(ne.jsx)(X.a,{}),onClick:function(){n.dispatchCommand({type:"delete"})}}]}),[n]);return Object(ne.jsx)(re,{engine:t,node:n,avatar:Object(ne.jsx)(Ie,{isInitialAction:n.isInitialAction,onClick:a,children:Object(ne.jsx)(de,{children:Object(ne.jsx)(me.a,{})})}),actions:o,selected:n.isSelected()})},Pe=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(){return Object(r.a)(this,n),t.call(this,"actionType")}return Object(c.a)(n,[{key:"generateModel",value:function(e){var t,n,a=null!==(t=e.isInitialAction)&&void 0!==t&&t,o=null!==(n=e.instanceId)&&void 0!==n?n:"",c=Object(i.a)({},e);return delete c.isInitialAction,delete c.instanceId,new Oe.a(c,o,a)}},{key:"generateReactWidget",value:function(e){return Object(ne.jsx)(Ne,{engine:this.engine,node:e.model})}}]),n}(m.AbstractReactFactory),Se=n(1980),we=n(1264),Me=n(1981),Le=n(2011),Te=n.n(Le),De=n(2291),Re=function(e){var t=e.engine,n=e.node,a=Object(j.useCallback)((function(e){n.dispatchCommand({type:"setTagging",tagging:e})}),[n]);return Object(ne.jsx)(re,{engine:t,node:n,avatar:Object(ne.jsx)(De.a,{value:n.taggingType,onChange:a,children:Object(ne.jsx)(de,{children:Object(ne.jsx)(Te.a,{})})}),selected:n.isSelected()})},Ae=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(){return Object(r.a)(this,n),t.call(this,"state")}return Object(c.a)(n,[{key:"generateModel",value:function(e){var t,n=e.milestoneType,a=null!==(t=e.instanceId)&&void 0!==t?t:"",o=Object(i.a)({},e);return delete o.milestoneType,delete o.instanceId,new Me.a(o,a,n)}},{key:"generateReactWidget",value:function(e){return Object(ne.jsx)(Re,{engine:this.engine,node:e.model})}}]),n}(m.AbstractReactFactory),Ee=n(1942),ze=n(1854),Fe=n.n(ze),Xe=function(e){var t=e.engine,n=e.node,a=Object(j.useCallback)((function(e){n.dispatchCommand({type:"setTagging",tagging:e})}),[n]),o=Object(j.useMemo)((function(){return[{icon:Object(ne.jsx)(A.a,{}),onClick:function(){n.dispatchCommand({type:"edit"})}},{icon:Object(ne.jsx)(X.a,{}),onClick:function(){n.dispatchCommand({type:"delete"})}}]}),[n]);return Object(ne.jsx)(re,{engine:t,node:n,avatar:Object(ne.jsx)(De.a,{value:n.taggingType,onChange:a,children:Object(ne.jsx)(de,{children:Object(ne.jsx)(Fe.a,{})})}),actions:o,selected:n.isSelected()})},Ye=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(){return Object(r.a)(this,n),t.call(this,"selector")}return Object(c.a)(n,[{key:"generateModel",value:function(e){var t,n=e.milestoneType,a=null!==(t=e.instanceId)&&void 0!==t?t:"",o=Object(i.a)({},e);return delete o.milestoneType,delete o.instanceId,new Ee.a(o,a,n)}},{key:"generateReactWidget",value:function(e){return Object(ne.jsx)(Xe,{engine:this.engine,node:e.model})}}]),n}(m.AbstractReactFactory),Be=n(1852),He=function(e){var t=e.path,n=e.link,o=e.forwardRef,c=e.factory,r=e.onSelection,s=e.extras,l=e.linkStatus,u=e.isOutgoing,d=l===a.selected||n.isSelected(),g=d?u?n.getSelectedOutgoingColor():n.getOptions().selectedColor:n.getOptions().color,f=p.a.cloneElement(c.generateLinkSegment(n,d,t),{ref:o,strokeOpacity:l===a.selected?.8:a.unfocused?.1:.3,stroke:g}),b=p.a.cloneElement(f,Object(i.a)(Object(i.a)({strokeLinecap:"round",onMouseLeave:function(){r(!1)},onMouseEnter:function(){r(!0)}},s),{},{ref:null,"data-linkid":n.getID(),strokeOpacity:l===a.selected?.1:0,strokeWidth:20,fill:"none"}));return Object(ne.jsxs)("g",{children:[f,b]})};!function(e){e[e.normal=0]="normal",e[e.selected=1]="selected",e[e.unfocused=2]="unfocused"}(a||(a={}));var We=function(e){var t=e.linkId,n=e.point,o=e.previousPoint,i=e.color,c=e.selectedColor,r=e.linkStatus,s=n.x,l=n.y,u=o.x,d=o.y,g=90+180*Math.atan2(l-d,s-u)/Math.PI;return Object(ne.jsx)("g",{className:"arrow",transform:"translate(".concat(s,", ").concat(l,")"),children:Object(ne.jsx)("g",{style:{transform:"rotate(".concat(g,"deg)")},children:Object(ne.jsx)("g",{transform:"translate(0, -5)",children:Object(ne.jsx)("polygon",{points:"0,5 4,15 -4,15",fill:r===a.selected?c:i,opacity:r===a.selected?.8:a.unfocused?.1:.3,"data-linkid":t})})})})},Ze=function(e){return"".concat(e.x," ").concat(e.y)},Ve=function(e){return"M ".concat(Ze(e)," ")},qe=function(e){return"L ".concat(Ze(e)," ")},Je=function(e,t,n){return"C ".concat(Ze(e),", ").concat(Ze(t),", ").concat(Ze(n)," ")},Ue=function(e,t,n){var a=t.x-e.x,o=t.y-e.y,i=Math.sqrt(a*a+o*o);return _e(e,t,Math.min(1,n/i))},_e=function(e,t,n){return{x:e.x+(t.x-e.x)*n,y:e.y+(t.y-e.y)*n}},Ge=function(e){var t,n,i,c=e.link,r=e.diagramEngine,s=Object(j.useState)(!1),l=Object(o.a)(s,2),u=l[0],d=l[1],g=Object(P.h)(Q),f=Object(P.h)($),b=Object(P.h)(ee),O=Object(P.h)(te),h=Object(j.useRef)([]),v=b.includes(null===(t=c.getSourcePort())||void 0===t?void 0:t.getNode().getID()),m=b.includes(null===(n=c.getTargetPort())||void 0===n?void 0:n.getNode().getID()),y=u||f.includes(c.getID())||v||m?a.selected:O.length>0?a.unfocused:a.normal,x=v||(null===(i=c.getSourcePort())||void 0===i?void 0:i.getNode().getID())===g;Object(j.useEffect)((function(){return h.current&&c.setRenderedPaths(h.current.map((function(e){return e.current})).filter(M.isPresent)),function(){return c.setRenderedPaths([])}}));var k=Object(j.useCallback)((function(e){d(e)}),[]),C=c.getPoints();if(C.length<=1)return c.setRenderedPaths([]),Object(ne.jsx)("g",{});var I=c.getID(),N=c.getOptions(),S=C.map((function(e){return{x:e.getX(),y:e.getY()}})),w=S.length-1,L=S[w];S[w]=function(e,t,n){var a=t.x,o=t.y,i=e.x,c=e.y,r=i-a,s=c-o;if(Math.abs(s)<1e-4)return{x:i-n*Math.sign(r),y:c};if(Math.abs(r)<1e-4)return{x:i,y:c-n*Math.sign(s)};var l=Math.sqrt(r*r+s*s)-n,u=Math.atan2(s,r);return{x:a+l*Math.cos(u),y:o+l*Math.sin(u)}}(S[w],S[w-1],8);var T=function(e){for(var t=[],n=e.length-1,a=e[0],o="",i=1;i<n;i++){o=Ve(a);var c,r,s=e[i],l=e[i+1];c=Ue(s,a,5),r=Ue(s,l,5),o+=qe(c);var u=_e(c,s,.5),d=_e(s,r,.5);o+=Je(u,d,r),a=r,t.push(o)}return o=Ve(a),o+=qe(e[n]),t.push(o),t}(S);return h.current=T.map((function(){return p.a.createRef()})),Object(ne.jsxs)("g",{"data-default-link-test":N.testName,children:[T.map((function(e,t){return Object(ne.jsx)(He,{path:e,diagramEngine:r,factory:r.getFactoryForLink(c),link:c,linkStatus:y,isOutgoing:x,forwardRef:h.current[t],onSelection:k,extras:{"data-linkid":I}},"link-".concat(t))})),Object(ne.jsx)(We,{linkId:I,point:L,previousPoint:S[w-1],selectedColor:x?N.selectedOutgoingColor:N.selectedColor,color:N.color,linkStatus:y},"link-arrowhead")]})},Ke=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(){return Object(r.a)(this,n),t.call(this,"contextTypeLink")}return Object(c.a)(n,[{key:"generateModel",value:function(){return new Be.a}},{key:"generateReactWidget",value:function(e){return Object(ne.jsx)(Ge,{link:e.model,diagramEngine:this.engine})}}]),n}(h.DefaultLinkFactory),Qe=n(912),$e=n(2839),et=n.n($e),tt=(n(690),function(e){if(e){for(var t={},n=0,a=Object.entries(e);n<a.length;n++){var i=Object(o.a)(a[n],2),c=i[0],r=i[1];switch("org.eclipse.".concat(c)){case"org.eclipse.elk.contentAlignment":case"org.eclipse.elk.nodeSize.constraints":case"org.eclipse.elk.nodeSize.options":case"org.eclipse.elk.portLabels.placement":case"org.eclipse.elk.layered.wrapping.cutting.cuts":case"org.eclipse.elk.layered.wrapping.validify.forbiddenIndices":case"org.eclipse.elk.nodeLabels.placement":if(Array.isArray(r)){t[c]=r.map((function(e){return""+e})).join(" ");break}t[c]=r;break;default:t[c]=r}}return t}}),nt=function(e){return e instanceof we.a},at=function(e,t){return new Qe.PointModel({link:t,position:new I.Point(e.x,e.y)})},ot=function(){function e(t){Object(r.a)(this,e),this.options=void 0,this.options=t}return Object(c.a)(e,[{key:"redistribute",value:function(){var e=Object(u.a)(b.a.mark((function e(t){var n,a,o,i,c,r,s,l,u,d,f,j,p,O,h,v,m,y=this;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return b={algorithms:[this.options.algorithm],defaultLayoutOptions:tt(this.options.layoutOptions)},n=new et.a(b),a={},o=Object(S.C)((function(e){return e.instanceId}),t.getNodes().filter(nt)).map((function(e){var t,n,a=null===(t=(n=y.options).nodeLayoutOptions)||void 0===t?void 0:t.call(n,e);return{id:e.getID(),width:e.width,height:e.height,layoutOptions:tt(a),ports:Object.values(e.getPorts()).map((function(t){return{id:t.getID(),height:t.height,width:t.width,x:t.getX()-e.getX(),y:t.getY()-e.getY()}}))}})),i=Object(S.C)((function(e){return e instanceof Be.a?e.getInstanceId():"edge"}),t.getLinks().filter((function(e){return e.getSourcePort()&&e.getTargetPort()}))).map((function(e){var t,n;a[e.getID()]=!0;var o=null===(t=(n=y.options).linkLayoutOptions)||void 0===t?void 0:t.call(n,e);return{id:e.getID(),sources:[e.getSourcePort().getID()],targets:[e.getTargetPort().getID()],sections:[],layoutOptions:tt(o)}})),e.next=6,n.layout({id:"root",children:o,edges:i});case 6:c=e.sent,r=Object(g.a)(c.children);try{for(r.s();!(s=r.n()).done;)l=s.value,t.getNode(l.id).setPosition(l.x,l.y)}catch(x){r.e(x)}finally{r.f()}if(this.options.includeLinks&&c.edges){u=Object(g.a)(c.edges);try{for(u.s();!(d=u.n()).done;){if(f=d.value,j=t.getLink(f.id),p=f.sections[0],O=[at(p.startPoint,j)],p.bendPoints){h=Object(g.a)(p.bendPoints);try{for(h.s();!(v=h.n()).done;)m=v.value,O.push(at(m,j))}catch(x){h.e(x)}finally{h.f()}}j.setPoints(O.concat(at(p.endPoint,j)))}}catch(x){u.e(x)}finally{u.f()}}case 10:case"end":return e.stop()}var b}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();var it=n(2918),ct=n(1306),rt=n(2421),st=n(992),lt=n.n(st),ut=n(2534),dt=["nodes","onNodeSelected"],gt=Object(T.a)((function(e){return Object(L.a)({root:{position:"relative"},editorContainer:{position:"absolute",top:5,right:e.spacing(7),backgroundColor:e.palette.background.paper},button:{color:e.palette.text.secondary,backgroundColor:e.palette.background.paper,"&:hover":{backgroundColor:Object(Z.e)(e.palette.background.paper,.15)}}})})),ft=function(e,t){return t.filter((function(t){return t instanceof e}))},bt=n(162),jt=function(e){var t,n={},a=Object(g.a)(e.getNodes());try{for(a.s();!(t=a.n()).done;){var o=t.value,i=1;o instanceof Oe.a?i=0:(o instanceof Me.a||o instanceof Ee.a)&&"final"===o.taggingType?i=1e4:o instanceof Me.a?i=2:o instanceof Ee.a?i=3:o instanceof je.a&&(i=4),n[o.getID()]=i}}catch(h){a.e(h)}finally{a.f()}for(var c=Object(S.r)((function(e){return e.map((function(e){return e.getSourcePort().getNode()}))}),Object(S.j)((function(e){return e.getTargetPort().getNode().getID()}),e.getLinks().filter((function(e){return n[e.getSourcePort().getNode().getID()]<1e4})))),r=function(e){var t,n=Object(S.r)((function(e){return e.map((function(e){return e.getTargetPort().getNode()}))}),Object(S.j)((function(e){return e.getSourcePort().getNode().getID()}),e.getLinks())),a=[],o=[],i=function(e){var t=a.indexOf(e);return-1===t&&(t=a.length,a.push(e),o.push([])),t},c=Object(g.a)(ft(je.a,e.getNodes()));try{var r=function(){var e=t.value,a=i(e);Object(bt.a)(e,{getNeighbors:function(t){var a;return t instanceof je.a&&t!==e?[]:null!==(a=n[t.getID()])&&void 0!==a?a:[]},enterVertex:function(e){var t=e.currentVertex;t instanceof je.a&&o[a].push(i(t))}})};for(c.s();!(t=c.n()).done;)r()}catch(h){c.e(h)}finally{c.f()}for(var s=Object(bt.c)(o),l=s.components,u=s.adjacencyList,f=[],b=Object(S.c)(u),j=!0;j;){j=!1;for(var p=[],O=[],v=0;v<b.length;v++){var m=b[v];m&&0===m.length&&(O.push(v),b[v]=void 0,p.push.apply(p,Object(d.a)(l[v].map((function(e){return a[e]})))))}var y,x=Object(g.a)(b.filter(M.isPresent));try{for(x.s();!(y=x.n()).done;){var k,C=y.value,I=Object(g.a)(O);try{for(I.s();!(k=I.n()).done;){var N=k.value,P=C.indexOf(N);P>-1&&C.splice(P,1)}}catch(h){I.e(h)}finally{I.f()}}}catch(h){x.e(h)}finally{x.f()}p.length>0&&(f.unshift(p),j=!0)}return f}(e),s=0;s<r.length;s++){var l,u=Object(g.a)(r[s]);try{for(u.s();!(l=u.n()).done;){var f=l.value;n[f.getID()]=10*s+4}}catch(h){u.e(h)}finally{u.f()}}var b=function(t){var a,o=0,i=Object(g.a)(ft(Me.a,e.getNodes()).filter((function(e){return n[e.getID()]===t+2})));try{for(i.s();!(a=i.n()).done;){var r=a.value,s=c[r.getID()];s&&s.some((function(e){return n[e.getID()]>t+2}))&&(n[r.getID()]=t+12,o++)}}catch(h){i.e(h)}finally{i.f()}for(var l=!0;l;){l=!1;var u,d=Object(g.a)(ft(Ee.a,e.getNodes()).filter((function(e){return n[e.getID()]===t+3})));try{for(d.s();!(u=d.n()).done;){var f=u.value,b=c[f.getID()];b&&b.some((function(e){return n[e.getID()]>t+3}))&&(n[f.getID()]=t+13,l=!0,o++)}}catch(h){d.e(h)}finally{d.f()}}return o},j=0,p=Number.MAX_VALUE,O=0;do{j=p,p=b(O),O+=10}while(p>0&&p<j);return n},pt=function(){var e=Object(u.a)(b.a.mark((function e(t){var n,a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={},a=new ot({algorithm:"layered",layoutOptions:{"elk.alignment":"LEFT","elk.partitioning.activate":!0,"elk.layered.feedbackEdges":!0,"elk.portConstraints":"FIXED_POS","elk.separateConnectedComponents":!1,"elk.interactiveLayout":!0,"elk.layered.spacing.nodeNodeBetweenLayers":60,"elk.spacing.edgeEdge":20,"elk.spacing.edgeNode":20,"elk.spacing.nodeNode":20,"elk.layered.spacing.edgeEdgeBetweenLayers":20,"elk.layered.spacing.edgeNodeBetweenLayers":20,"elk.edgeRouting":"ORTHOGONAL","elk.layered.layering.strategy":"INTERACTIVE"},nodeLayoutOptions:function(e){var a;0===Object.keys(n).length&&(n=jt(t));var o={"elk.partitioning.partition":null!==(a=n[e.getID()])&&void 0!==a?a:1};return delete n[e.getID()],o},includeLinks:!0}),e.next=4,a.redistribute(t);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ot=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(){var e;return Object(r.a)(this,n),(e=t.call(this)).childStates=[],e}return Object(c.a)(n)}(h.DefaultDiagramState),ht=function(e,t){var n=e.getModel(),a={x:0,y:0,zoom:0},o=Object(i.a)({offsetX:[n.getOffsetX(),n.getOffsetX()],offsetY:[n.getOffsetY(),n.getOffsetY()],zoomLevel:[n.getZoomLevel(),n.getZoomLevel()]},t);N.a.fromTo(a,{x:o.offsetX[0],y:o.offsetY[0],zoom:o.zoomLevel[0]},{x:o.offsetX[1],y:o.offsetY[1],zoom:o.zoomLevel[1],duration:.5,ease:"power2",onUpdate:function(){n.setZoomLevel(a.zoom),n.setOffset(a.x,a.y),e.repaintCanvas()}})},vt=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:20,a=e.getTopLeft(),o=t.getTopLeft(),i=e.getBottomRight(),c=t.getBottomRight(),r=new I.Point(Math.min(a.x,o.x)-n,Math.min(a.y,o.y)-n),s=new I.Point(Math.max(i.x,c.x)+n,Math.max(i.y,c.y)+n),l=s.x-r.x,u=s.y-r.y;return new I.Rectangle(r,l,u)},mt=Object(O.a)("div")({height:"100%",width:"100%"}),yt=Object(O.a)(m.CanvasWidget)({height:"100%",minHeight:"250px"}),xt=Object(O.a)(C.a)((function(e){var t=e.theme;return{position:"absolute",bottom:t.spacing(2),left:t.spacing(2),color:t.palette.text.secondary,backgroundColor:t.palette.background.default}})),kt=Object(O.a)((function(e){var t=e.nodes,n=e.onNodeSelected,a=Object(_.a)(e,dt),c=Object(w.a)().t,r=gt(),s=Object(j.useState)(!1),l=Object(o.a)(s,2),u=l[0],d=l[1],g=Object(j.useMemo)((function(){return Object(S.C)((function(e){return"".concat(c(e.getType()),":").concat(e.title)}),t)}),[t,c]),f=Object(j.useCallback)((function(){d(!0)}),[]),b=Object(j.useCallback)((function(){d(!1)}),[]),p=Object(j.useCallback)((function(e,t){t&&(null===n||void 0===n||n(t),d(!1))}),[n]);return Object(ne.jsx)(it.a,{mouseEvent:"onMouseDown",touchEvent:"onTouchStart",onClickAway:b,children:Object(ne.jsx)("div",Object(i.a)(Object(i.a)({},a),{},{children:Object(ne.jsxs)("div",{className:r.root,children:[Object(ne.jsx)(C.a,{className:r.button,onClick:f,size:"medium",children:Object(ne.jsx)(lt.a,{})}),Object(ne.jsx)("div",{className:r.editorContainer,children:Object(ne.jsx)(ut.Transition,{items:u,from:{width:0,opacity:0},enter:{width:300,opacity:1},leave:{width:0,opacity:0},reverse:u,children:function(e,t){return t&&Object(ne.jsx)(ut.animated.div,{style:e,children:Object(ne.jsx)(ct.a,{options:g,getOptionLabel:function(e){return e.title},size:"small",groupBy:function(e){return c(e.getType())},onChange:p,renderInput:function(e){return Object(ne.jsx)(rt.a,Object(i.a)(Object(i.a)({},e),{},{autoFocus:!0,variant:"outlined"}))}})})}})})]})}))})}))((function(e){var t=e.theme;return{position:"absolute",top:t.spacing(2),right:t.spacing(2)}})),Ct=function(e){var t=e.actionTypes,n=e.taskTypes,a=e.selectors,i=e.taggings,c=e.initialActions,r=e.statesIncluded,s=e.visibleElementTypes,l=e.onNodeSelectionChanged,u=e.onNodeHighlighted,g=e.onActionTypeCommandInvoked,f=e.onStateCommandInvoked,b=e.onSelectorCommandInvoked,p=e.onTaskTypeCommandInvoked,O=e.onResponseTypeCommandInvoked,m=e.onSelectionChanged,x=e.onPinStatusesChanged,C=Object(w.a)().t,N=Object(j.useRef)(null),M=Object(P.i)(ee),L=Object(P.i)(te),T=Object(j.useMemo)((function(){return new Se.a({locked:!0})}),[]),D=Object(j.useMemo)((function(){var e=function(){var e=v()(),t=e.getNodeFactories();return t.registerFactory(new Pe),t.registerFactory(new pe),t.registerFactory(new Ae),t.registerFactory(new Ye),e.getLinkFactories().registerFactory(new Ke),e.getStateMachine().pushState(new Ot),e}();return e.setModel(T),e}),[T]);Object(j.useEffect)((function(){L([])}),[L]);var R=Object(j.useCallback)((function(){var e;e=function(e){setTimeout((function(){var e=N.current;pt(T).finally((function(){e&&(e.style.visibility="visible"),D.repaintCanvas()}))}),e?100:0)},"hidden"===document.visibilityState?document.addEventListener("visibilitychange",(function t(n){"visible"===document.visibilityState&&(document.removeEventListener("visibilitychange",t),e(!0))})):e(!1)}),[D,T]);Object(j.useEffect)((function(){var e=N.current;if(e){var o=T.pinStatuses,l=T.updateData(t,n,a,i,c,r,s);o!==T.pinStatuses&&(null===x||void 0===x||x(T.pinStatuses)),l&&(e.style.visibility="hidden"),D.repaintCanvas(!0).then((function(){R()}))}}),[t,D,c,i,T,a,n,R,s,r,x]),Object(j.useEffect)((function(){var e={nodeSelectionChanged:function(e){null===l||void 0===l||l(e.node,e.isSelected);var t=T.getSelectedEntities().filter((function(e){return e instanceof h.NodeModel}));null===m||void 0===m||m(t),M(t.map((function(e){return e.getID()}))),e.isSelected||L([])},contextTypeNodeCommandInvoked:function(e){var t=e.command,n=e.node;if("focusNode"===t.type){var a=function(e){var t=Object(S.I)(Object.values(e.getPorts()).flatMap((function(e){return Object.values(e.getLinks())})));return[Object(S.I)(t.flatMap((function(t){var n=t.getSourcePort().getNode(),a=t.getTargetPort().getNode();return n===e?a:n}))),t]}(n),i=Object(o.a)(a,2),c=i[0];!function(e,t,n,a){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:20,i=a.getModel(),c=a.getCanvas(),r=a.getBoundingNodesRect([e].concat(Object(d.a)(t))),s=I.Polygon.boundingBoxFromPoints(n.flatMap((function(e){return e.getPoints()})).map((function(e){return e.getPosition()}))),l=vt(r,s,o),u=c.getBoundingClientRect(),g={x:u.left,y:u.top},f={x:g.x+i.getOffsetX(),y:g.y+i.getOffsetY()},b=c.clientWidth/l.getWidth(),j=c.clientHeight/l.getHeight(),p=Math.min(b<j?b:j,1),O=l.getTopLeft(),h={x:f.x+O.x*p,y:f.y+O.y*p},v=i.getOffsetX()+g.x-h.x,m=i.getOffsetY()+g.y-h.y;ht(a,{offsetX:[i.getOffsetX(),v],offsetY:[i.getOffsetY(),m],zoomLevel:[i.getZoomLevel(),100*p]})}(n,c,i[1],D),c.unshift(n),L(c.map((function(e){return e.getID()}))),null===u||void 0===u||u(n)}if(n instanceof Oe.a)null===g||void 0===g||g(n.instance,t);else if(n instanceof Me.a)null===f||void 0===f||f(n.instance,t);else if(n instanceof Ee.a)null===b||void 0===b||b(n.instance,t);else if(n instanceof je.a)if(Object(we.b)(t)){var r=n.instance.validResponses.find((function(e){return e.name===t.responseName}));r&&(null===O||void 0===O||O(r,n.instance,t))}else null===p||void 0===p||p(n.instance,t)}},t=T.registerListener(e);return function(){T.deregisterListener(t)}}),[D,T,g,u,l,O,m,b,f,p,L,M]);var A=Object(j.useState)(),E=Object(o.a)(A,2)[1],z=Object(j.useCallback)((function(e){var t=D.getMouseElement(e);t&&E(t)}),[D]),F=Object(j.useCallback)((function(e){!function(e,t){var n=t.getModel();n.clearSelection(),e.setSelected(!0);var a=t.getCanvas().getBoundingClientRect(),o=a.width,i=a.height,c=-n.getOffsetX(),r=-n.getOffsetX()+o,s=-n.getOffsetY(),l=-n.getOffsetY()+i,u=n.getZoomLevel()/100,d=e.getPosition(),g=d.x,f=d.y;f*=u;var b=(g*=u)+e.width*u,j=f+e.height*u,p=n.getOffsetX(),O=n.getOffsetY();b>r?p=-b-40+o:g<c&&(p=40-g),j>l?O=-j-40+i:f<s&&(O=40-f),n.getOffsetX()===p&&n.getOffsetY()===O||ht(t,{offsetX:[n.getOffsetX(),p],offsetY:[n.getOffsetY(),O]})}(e,D)}),[D]);return Object(ne.jsxs)(ne.Fragment,{children:[Object(ne.jsx)(mt,{ref:N,onMouseOver:z,children:Object(ne.jsx)(yt,{engine:D})}),Object(ne.jsx)(kt,{nodes:D.getModel().getNodes(),onNodeSelected:F}),Object(ne.jsx)(y.a,{title:C("PerformLayout"),children:Object(ne.jsx)(xt,{onClick:R,size:"small",children:Object(ne.jsx)(k.a,{fontSize:"small"})})})]})};t.default=Ct}}]);
//# sourceMappingURL=82.dd1a53ba.chunk.js.map