(this["webpackJsonpnimflow-studio"]=this["webpackJsonpnimflow-studio"]||[]).push([[64],{2054:function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var a=n(14),o=n(3),i=n(9),c=n(2278),r=n(2272),s=n(2289),l=n(2288),u=n(3352),d=n(2094),g=n(2313),f=n(1545),b=n(1501),j=n(49),p=n(797),O=n(1214),v=n(129),h=Object(c.a)((function(e){return Object(r.a)({smallAvatar:{width:25,height:25,border:function(t){return t.displayStandalone?void 0:"2px solid ".concat(e.palette.primary.main)},color:function(t){return t.displayStandalone?e.palette.text.primary:e.palette.text.secondary},backgroundColor:function(t){return t.displayStandalone?e.palette.background.default:e.palette.background.paper}},tagging:{width:16,height:16}})})),y=function(e){var t=e.value,n=e.onChange,c=e.children,r=e.displayEmptyTagging,y=h(e),m=Object(p.usePopupState)({variant:"popover",popupId:"taggingMenu"}),x=Object(i.useCallback)((function(e){m.close(),null===n||void 0===n||n(e)}),[n,m]);return Object(v.jsxs)(v.Fragment,{children:[Object(v.jsxs)(l.a,Object(o.a)(Object(o.a)({},Object(p.bindTrigger)(m)),{},{size:"small",children:[(Object(j.isPresent)(t)||r)&&Object(v.jsx)(b.a,{overlap:"circular",anchorOrigin:{vertical:"bottom",horizontal:"right"},badgeContent:Object(v.jsx)(f.a,{className:y.smallAvatar,children:Object(v.jsx)(O.a,{taggingType:t,className:y.tagging})}),children:c}),!Object(j.isPresent)(t)&&c]})),Object(v.jsx)(d.a,Object(o.a)(Object(o.a)({},Object(p.bindMenu)(m)),{},{children:[void 0].concat(Object(a.a)(O.d)).map((function(e,t){return Object(v.jsxs)(g.a,{onClick:function(){return x(e)},children:[Object(v.jsx)(u.a,{children:Object(v.jsx)(O.a,{taggingType:e,fontSize:"small"})}),Object(v.jsx)(s.a,{variant:"inherit",children:Object(O.b)(e)})]},t)}))}))]})}},3268:function(e,t,n){"use strict";n.r(t),n.d(t,"ContextTypeDiagram",(function(){return Nt}));var a,o=n(1),i=n(3),c=n(2),r=n(16),s=n(17),l=n(4),u=n.n(l),d=n(21),g=n(14),f=n(0),b=n(9),j=n.n(b),p=n(2278),O=n(2272),v=n(1448),h=n.n(v),y=n(679),m=n(2307),x=n(685),k=n.n(x),C=n(779),N=n(1079),I=n(3283),P=n(137),S=n(428),w=n(430),M=n(427),T=n(244),L=n(3412),D=n(49),R=n(8),A=n(683),E=n(519),z=n.n(E),F=n(2107),X=n.n(F),Y=n(496),B=n.n(Y),H=n(697),W=n.n(H),Z=n(3260),V=n.n(Z),q=n(572),J=n(2635),U=n(2637),_=n(2636),G=n(3348),K=n(70),Q=n(457),$=n(1998),ee=Object(P.b)({key:"hoveredContextTypeNodeModelIdState",default:void 0}),te=Object(P.b)({key:"selectedLinkIds",default:[]}),ne=Object(P.b)({key:"selectedNodeIdsState",default:[]}),ae=Object(P.b)({key:"focusedNodeIdsState",default:[]}),oe=n(129),ie=["port","onPortHovering","className"],ce=Object(p.a)((function(e){return Object(O.a)({portBody:{width:function(e){var t;return null!==(t=e.portSize)&&void 0!==t?t:$.b},height:function(e){var t;return null!==(t=e.portSize)&&void 0!==t?t:$.b},background:"rgba(128, 128, 128, 1)",opacity:.3},port:{width:"100%",height:"100%"}})})),re=function(e){var t=e.port,n=e.onPortHovering,a=e.className,o=Object(K.a)(e,ie),c=ce(e),r=Object(P.i)(te),s=Object(b.useCallback)((function(e){null===n||void 0===n||n(t,e),r((function(n){if(!e)return[];var a=Object.keys(t.links);return n.length===a.length&&a.every((function(e){return n.includes(e)}))?n:a}))}),[n,t,r]);return Object(oe.jsx)("div",{className:Object(Q.default)(c.portBody,a),onMouseEnter:function(){return s(!0)},onMouseLeave:function(){return s(!1)},children:Object(oe.jsx)(v.PortWidget,Object(i.a)({className:c.port,port:t},o))})},se=Object(p.a)((function(e){return Object(O.a)({root:{position:"relative",marginTop:20,marginBottom:20,cursor:"pointer",opacity:function(e){return e.unfocused?.2:1}},cardContainer:{position:"relative"},card:{backgroundColor:function(t){return t.selected?e.palette.action.selected:e.palette.background.paper}},inPort:{top:20,left:-$.b,position:"absolute"},outPort:{top:20,right:-$.b,position:"absolute"},headerRoot:{padding:"".concat(e.spacing(1),"px ").concat(e.spacing(2),"px")},contentRoot:{padding:"".concat(e.spacing(1),"px ").concat(e.spacing(1),"px")},actions:{display:"table",position:"absolute",paddingBottom:10,zIndex:100,width:"100%",textAlign:"right"},action:{marginTop:5,marginRight:10,color:e.palette.text.secondary,backgroundColor:e.palette.background.paper,"&:hover":{backgroundColor:Object(q.d)(e.palette.background.paper,.15)}}})})),le=function(e){var t,n=e.node,a=e.engine,i=e.onPortHovering,c=e.onPanelHovering,r=e.title,s=e.titleTypographyProps,l=e.subheader,u=e.subheaderTypographyProps,d=e.avatar,g=e.actions,f=e.children,j=Object(P.f)(ee),p=Object(o.a)(j,2),O=p[0],v=p[1],h=Object(P.h)(ae),y=Object(P.i)(te),x=O===n.getID(),k=h.includes(n.getID()),N=se({selected:null!==(t=e.selected)&&void 0!==t&&t,unfocused:h.length>0&&!k}),I=Object(b.useCallback)((function(){null===c||void 0===c||c(!0),v(n.getID()),y((function(e){var t=Object(T.a)(Object.values(n.getPorts()).flatMap((function(e){return Object.keys(e.links)})));return e.length===t.length&&t.every((function(t){return e.includes(t)}))?e:t}))}),[c,v,n,y]),S=Object(b.useCallback)((function(){null===c||void 0===c||c(!1);var e=n.getID();v((function(t){return t===e?void 0:t})),y((function(e){return e.length>0?[]:e}))}),[c,n,v,y]),w=Object(b.useCallback)((function(){n.dispatchCommand({type:"focusNode"})}),[n]);return Object(oe.jsxs)("div",{className:N.root,children:[Object(oe.jsxs)("div",{onMouseEnter:I,onMouseLeave:S,className:N.cardContainer,children:[Object(oe.jsxs)(J.a,{className:N.card,elevation:2,onDoubleClick:w,children:[Object(oe.jsx)(U.a,{title:null!==r&&void 0!==r?r:n.title,titleTypographyProps:s,subheader:l,subheaderTypographyProps:u,avatar:d,classes:{root:N.headerRoot}}),!!f&&Object(oe.jsxs)(oe.Fragment,{children:[Object(oe.jsx)(G.a,{}),Object(oe.jsx)(_.a,{classes:{root:N.contentRoot},children:f})]})]}),!!g&&x&&Object(oe.jsx)("div",{className:N.actions,children:g.map((function(e,t){var n=Object(oe.jsx)(C.a,{onClick:function(t){return e.onClick(t)},size:"small",className:N.action,children:e.icon},t);return e.tooltip&&(n=Object(oe.jsx)(m.a,{title:e.tooltip,children:n},t)),n}))})]}),n.inPort&&Object(oe.jsx)(re,{port:n.inPort,engine:a,onPortHovering:i,className:N.inPort}),n.outPort&&Object(oe.jsx)(re,{port:n.outPort,engine:a,onPortHovering:i,className:N.outPort})]})},ue=n(1545),de=["className"],ge=Object(p.a)((function(e){return Object(O.a)({avatar:{color:"light"===e.palette.type?e.palette.background.default:"#fff",backgroundColor:e.palette.primary.main,width:e.spacing(4),height:e.spacing(4)}})})),fe=function(e){var t=e.className,n=Object(K.a)(e,de),a=ge();return Object(oe.jsx)(ue.a,Object(i.a)({className:Object(Q.default)(a.avatar,t)},n))},be=Object(p.a)((function(e){return Object(O.a)({responsePort:{top:"calc(50% - ".concat(4,"px)"),right:-8,position:"absolute"},response:{position:"relative",marginBottom:5},responseChipRoot:{width:"100%",backgroundColor:e.palette.background.paper},responseChipLabel:{width:"100%"}})})),je=function(e){return Object(oe.jsxs)(oe.Fragment,{children:[Object(oe.jsx)(z.a,Object(i.a)({"data-action-type":"edit"},e)),Object(oe.jsx)(X.a,Object(i.a)({"data-action-type":"delete"},e))]})},pe=function(e){var t,n=e.engine,a=e.node,o=be(e),i=Object(b.useMemo)((function(){return[{icon:Object(oe.jsx)(z.a,{}),onClick:function(){a.dispatchCommand({type:"edit"})}},{icon:Object(oe.jsx)(B.a,{}),onClick:function(){a.dispatchCommand({type:"delete"})}}]}),[a]),c=Object(b.useCallback)((function(e,t){for(var n=e.target;n&&"svg"!==n.tagName;)n=n.parentNode;if(n){var o=n.getAttribute("data-action-type");o&&("edit"===o?a.dispatchCommand({type:"editResponse",responseName:t.name}):"delete"===o&&a.dispatchCommand({type:"deleteResponse",responseName:t.name}))}}),[a]);return Object(oe.jsx)(le,{engine:n,node:a,avatar:Object(oe.jsx)(fe,{children:Object(oe.jsx)(W.a,{})}),actions:i,selected:a.isSelected(),children:null===(t=a.instance.validResponses)||void 0===t?void 0:t.map((function(e){var t=a.getResponsePort(e);return Object(oe.jsxs)("div",{className:o.response,children:[Object(oe.jsx)(A.a,{icon:Object(oe.jsx)(V.a,{}),label:null===e||void 0===e?void 0:e.name,onDelete:function(t){return c(t,e)},deleteIcon:Object(oe.jsx)(je,{}),variant:"outlined",classes:{root:o.responseChipRoot,label:o.responseChipLabel}}),t&&Object(oe.jsx)(re,{port:t,engine:n,portSize:8,className:o.responsePort})]},e.name)}))})},Oe=n(2011),ve=function(e){Object(r.a)(n,e);var t=Object(s.a)(n);function n(){return Object(c.a)(this,n),t.call(this,"taskType")}return Object(R.a)(n,[{key:"generateModel",value:function(e){var t,n=null!==(t=e.instanceId)&&void 0!==t?t:"",a=Object(i.a)({},e);return delete a.instanceId,new Oe.a(a,n)}},{key:"generateReactWidget",value:function(e){return Object(oe.jsx)(pe,{engine:this.engine,node:e.model})}}]),n}(y.AbstractReactFactory),he=n(2010),ye=n(2288),me=n(2141),xe=n.n(me),ke=n(1501),Ce=n(3261),Ne=n.n(Ce),Ie=Object(p.a)((function(e){return Object(O.a)({smallAvatar:{width:25,height:25,border:"2px solid ".concat(e.palette.primary.main),color:e.palette.text.secondary,backgroundColor:e.palette.background.paper},initialAction:{width:16,height:16}})})),Pe=function(e){var t=e.isInitialAction,n=e.onClick,a=e.children,o=Ie();return Object(oe.jsxs)(ye.a,{onClick:n,size:"small",children:[t&&Object(oe.jsx)(ke.a,{overlap:"circular",anchorOrigin:{vertical:"bottom",horizontal:"right"},badgeContent:Object(oe.jsx)(ue.a,{className:o.smallAvatar,children:Object(oe.jsx)(Ne.a,{className:o.initialAction})}),children:a}),!t&&a]})},Se=function(e){var t=e.engine,n=e.node,a=Object(b.useCallback)((function(){n.dispatchCommand({type:"toggleInitialAction"})}),[n]),o=Object(b.useMemo)((function(){return[{icon:Object(oe.jsx)(z.a,{}),onClick:function(){n.dispatchCommand({type:"edit"})}},{icon:Object(oe.jsx)(B.a,{}),onClick:function(){n.dispatchCommand({type:"delete"})}}]}),[n]);return Object(oe.jsx)(le,{engine:t,node:n,avatar:Object(oe.jsx)(Pe,{isInitialAction:n.isInitialAction,onClick:a,children:Object(oe.jsx)(fe,{children:Object(oe.jsx)(xe.a,{})})}),actions:o,selected:n.isSelected()})},we=function(e){Object(r.a)(n,e);var t=Object(s.a)(n);function n(){return Object(c.a)(this,n),t.call(this,"actionType")}return Object(R.a)(n,[{key:"generateModel",value:function(e){var t,n,a=null!==(t=e.isInitialAction)&&void 0!==t&&t,o=null!==(n=e.instanceId)&&void 0!==n?n:"",c=Object(i.a)({},e);return delete c.isInitialAction,delete c.instanceId,new he.a(c,o,a)}},{key:"generateReactWidget",value:function(e){return Object(oe.jsx)(Se,{engine:this.engine,node:e.model})}}]),n}(y.AbstractReactFactory),Me=n(2123),Te=n(1259),Le=n(2140),De=n(2403),Re=n.n(De),Ae=n(2054),Ee=function(e){var t=e.engine,n=e.node,a=Object(b.useCallback)((function(e){n.dispatchCommand({type:"setTagging",tagging:e})}),[n]);return Object(oe.jsx)(le,{engine:t,node:n,avatar:Object(oe.jsx)(Ae.a,{value:n.taggingType,onChange:a,children:Object(oe.jsx)(fe,{children:Object(oe.jsx)(Re.a,{})})}),selected:n.isSelected()})},ze=function(e){Object(r.a)(n,e);var t=Object(s.a)(n);function n(){return Object(c.a)(this,n),t.call(this,"state")}return Object(R.a)(n,[{key:"generateModel",value:function(e){var t,n=e.milestoneType,a=null!==(t=e.instanceId)&&void 0!==t?t:"",o=Object(i.a)({},e);return delete o.milestoneType,delete o.instanceId,new Le.a(o,a,n)}},{key:"generateReactWidget",value:function(e){return Object(oe.jsx)(Ee,{engine:this.engine,node:e.model})}}]),n}(y.AbstractReactFactory),Fe=n(2012),Xe=n(2142),Ye=n.n(Xe),Be=function(e){var t=e.engine,n=e.node,a=Object(b.useCallback)((function(e){n.dispatchCommand({type:"setTagging",tagging:e})}),[n]),o=Object(b.useMemo)((function(){return[{icon:Object(oe.jsx)(z.a,{}),onClick:function(){n.dispatchCommand({type:"edit"})}},{icon:Object(oe.jsx)(B.a,{}),onClick:function(){n.dispatchCommand({type:"delete"})}}]}),[n]);return Object(oe.jsx)(le,{engine:t,node:n,avatar:Object(oe.jsx)(Ae.a,{value:n.taggingType,onChange:a,children:Object(oe.jsx)(fe,{children:Object(oe.jsx)(Ye.a,{})})}),actions:o,selected:n.isSelected()})},He=function(e){Object(r.a)(n,e);var t=Object(s.a)(n);function n(){return Object(c.a)(this,n),t.call(this,"selector")}return Object(R.a)(n,[{key:"generateModel",value:function(e){var t,n=e.milestoneType,a=null!==(t=e.instanceId)&&void 0!==t?t:"",o=Object(i.a)({},e);return delete o.milestoneType,delete o.instanceId,new Fe.a(o,a,n)}},{key:"generateReactWidget",value:function(e){return Object(oe.jsx)(Be,{engine:this.engine,node:e.model})}}]),n}(y.AbstractReactFactory),We=n(2009),Ze=function(e){var t=e.path,n=e.link,o=e.forwardRef,c=e.factory,r=e.onSelection,s=e.extras,l=e.linkStatus,u=e.isOutgoing,d=l===a.selected||n.isSelected(),g=d?u?n.getSelectedOutgoingColor():n.getOptions().selectedColor:n.getOptions().color,f=j.a.cloneElement(c.generateLinkSegment(n,d,t),{ref:o,strokeOpacity:l===a.selected?.8:a.unfocused?.1:.3,stroke:g}),b=j.a.cloneElement(f,Object(i.a)(Object(i.a)({strokeLinecap:"round",onMouseLeave:function(){r(!1)},onMouseEnter:function(){r(!0)}},s),{},{ref:null,"data-linkid":n.getID(),strokeOpacity:l===a.selected?.1:0,strokeWidth:20,fill:"none"}));return Object(oe.jsxs)("g",{children:[f,b]})};!function(e){e[e.normal=0]="normal",e[e.selected=1]="selected",e[e.unfocused=2]="unfocused"}(a||(a={}));var Ve=function(e){var t=e.linkId,n=e.point,o=e.previousPoint,i=e.color,c=e.selectedColor,r=e.linkStatus,s=n.x,l=n.y,u=o.x,d=o.y,g=90+180*Math.atan2(l-d,s-u)/Math.PI;return Object(oe.jsx)("g",{className:"arrow",transform:"translate(".concat(s,", ").concat(l,")"),children:Object(oe.jsx)("g",{style:{transform:"rotate(".concat(g,"deg)")},children:Object(oe.jsx)("g",{transform:"translate(0, -5)",children:Object(oe.jsx)("polygon",{points:"0,5 4,15 -4,15",fill:r===a.selected?c:i,opacity:r===a.selected?.8:a.unfocused?.1:.3,"data-linkid":t})})})})},qe=function(e){return"".concat(e.x," ").concat(e.y)},Je=function(e){return"M ".concat(qe(e)," ")},Ue=function(e){return"L ".concat(qe(e)," ")},_e=function(e,t,n){return"C ".concat(qe(e),", ").concat(qe(t),", ").concat(qe(n)," ")},Ge=function(e,t,n){var a=t.x-e.x,o=t.y-e.y,i=Math.sqrt(a*a+o*o);return Ke(e,t,Math.min(1,n/i))},Ke=function(e,t,n){return{x:e.x+(t.x-e.x)*n,y:e.y+(t.y-e.y)*n}},Qe=function(e){var t,n,i,c=e.link,r=e.diagramEngine,s=Object(b.useState)(!1),l=Object(o.a)(s,2),u=l[0],d=l[1],g=Object(P.h)(ee),f=Object(P.h)(te),p=Object(P.h)(ne),O=Object(P.h)(ae),v=Object(b.useRef)([]),h=p.includes(null===(t=c.getSourcePort())||void 0===t?void 0:t.getNode().getID()),y=p.includes(null===(n=c.getTargetPort())||void 0===n?void 0:n.getNode().getID()),m=u||f.includes(c.getID())||h||y?a.selected:O.length>0?a.unfocused:a.normal,x=h||(null===(i=c.getSourcePort())||void 0===i?void 0:i.getNode().getID())===g;Object(b.useEffect)((function(){return v.current&&c.setRenderedPaths(v.current.map((function(e){return e.current})).filter(D.isPresent)),function(){return c.setRenderedPaths([])}}));var k=Object(b.useCallback)((function(e){d(e)}),[]),C=c.getPoints();if(C.length<=1)return c.setRenderedPaths([]),Object(oe.jsx)("g",{});var N=c.getID(),I=c.getOptions(),S=C.map((function(e){return{x:e.getX(),y:e.getY()}})),w=S.length-1,M=S[w];S[w]=function(e,t,n){var a=t.x,o=t.y,i=e.x,c=e.y,r=i-a,s=c-o;if(Math.abs(s)<1e-4)return{x:i-n*Math.sign(r),y:c};if(Math.abs(r)<1e-4)return{x:i,y:c-n*Math.sign(s)};var l=Math.sqrt(r*r+s*s)-n,u=Math.atan2(s,r);return{x:a+l*Math.cos(u),y:o+l*Math.sin(u)}}(S[w],S[w-1],8);var T=function(e){for(var t=[],n=e.length-1,a=e[0],o="",i=1;i<n;i++){o=Je(a);var c,r,s=e[i],l=e[i+1];c=Ge(s,a,5),r=Ge(s,l,5),o+=Ue(c);var u=Ke(c,s,.5),d=Ke(s,r,.5);o+=_e(u,d,r),a=r,t.push(o)}return o=Je(a),o+=Ue(e[n]),t.push(o),t}(S);return v.current=T.map((function(){return j.a.createRef()})),Object(oe.jsxs)("g",{"data-default-link-test":I.testName,children:[T.map((function(e,t){return Object(oe.jsx)(Ze,{path:e,diagramEngine:r,factory:r.getFactoryForLink(c),link:c,linkStatus:m,isOutgoing:x,forwardRef:v.current[t],onSelection:k,extras:{"data-linkid":N}},"link-".concat(t))})),Object(oe.jsx)(Ve,{linkId:N,point:M,previousPoint:S[w-1],selectedColor:x?I.selectedOutgoingColor:I.selectedColor,color:I.color,linkStatus:m},"link-arrowhead")]})},$e=function(e){Object(r.a)(n,e);var t=Object(s.a)(n);function n(){return Object(c.a)(this,n),t.call(this,"contextTypeLink")}return Object(R.a)(n,[{key:"generateModel",value:function(){return new We.a}},{key:"generateReactWidget",value:function(e){return Object(oe.jsx)(Qe,{link:e.model,diagramEngine:this.engine})}}]),n}(v.DefaultLinkFactory),et=n(1095),tt=n(3262),nt=n.n(tt),at=n(1227),ot=(n(663),function(e){if(e){for(var t={},n=0,a=Object.entries(e);n<a.length;n++){var i=Object(o.a)(a[n],2),c=i[0],r=i[1];switch("org.eclipse.".concat(c)){case"org.eclipse.elk.contentAlignment":case"org.eclipse.elk.nodeSize.constraints":case"org.eclipse.elk.nodeSize.options":case"org.eclipse.elk.portLabels.placement":case"org.eclipse.elk.layered.wrapping.cutting.cuts":case"org.eclipse.elk.layered.wrapping.validify.forbiddenIndices":case"org.eclipse.elk.nodeLabels.placement":if(Array.isArray(r)){t[c]=r.map((function(e){return""+e})).join(" ");break}t[c]=r;break;default:t[c]=r}}return t}}),it=function(e){return e instanceof Te.a},ct=function(e,t){return new et.PointModel({link:t,position:new N.Point(e.x,e.y)})},rt=function(){function e(t){Object(c.a)(this,e),this.options=void 0,this.options=t}return Object(R.a)(e,[{key:"redistribute",value:function(){var e=Object(d.a)(u.a.mark((function e(t){var n,a,o,i,c,r,s,l,d,g,b,j,p,O,v,h,y,m=this;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u={algorithms:[this.options.algorithm],defaultLayoutOptions:ot(this.options.layoutOptions)},n=new nt.a(u),a={},o=Object(at.a)((function(e){return e.instanceId}),t.getNodes().filter(it)).map((function(e){var t,n,a=null===(t=(n=m.options).nodeLayoutOptions)||void 0===t?void 0:t.call(n,e);return{id:e.getID(),width:e.width,height:e.height,layoutOptions:ot(a),ports:Object.values(e.getPorts()).map((function(t){return{id:t.getID(),height:t.height,width:t.width,x:t.getX()-e.getX(),y:t.getY()-e.getY()}}))}})),i=Object(at.a)((function(e){return e instanceof We.a?e.getInstanceId():"edge"}),t.getLinks().filter((function(e){return e.getSourcePort()&&e.getTargetPort()}))).map((function(e){var t,n;a[e.getID()]=!0;var o=null===(t=(n=m.options).linkLayoutOptions)||void 0===t?void 0:t.call(n,e);return{id:e.getID(),sources:[e.getSourcePort().getID()],targets:[e.getTargetPort().getID()],sections:[],layoutOptions:ot(o)}})),e.next=6,n.layout({id:"root",children:o,edges:i});case 6:c=e.sent,r=Object(f.a)(c.children);try{for(r.s();!(s=r.n()).done;)l=s.value,t.getNode(l.id).setPosition(l.x,l.y)}catch(x){r.e(x)}finally{r.f()}if(this.options.includeLinks&&c.edges){d=Object(f.a)(c.edges);try{for(d.s();!(g=d.n()).done;){if(b=g.value,j=t.getLink(b.id),p=b.sections[0],O=[ct(p.startPoint,j)],p.bendPoints){v=Object(f.a)(p.bendPoints);try{for(v.s();!(h=v.n()).done;)y=h.value,O.push(ct(y,j))}catch(x){v.e(x)}finally{v.f()}}j.setPoints(O.concat(ct(p.endPoint,j)))}}catch(x){d.e(x)}finally{d.f()}}case 10:case"end":return e.stop()}var u}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();var st=n(3319),lt=n(845),ut=n(2293),dt=n(705),gt=n.n(dt),ft=n(2208),bt=["nodes","onNodeSelected"],jt=Object(p.a)((function(e){return Object(O.a)({root:{position:"relative"},editorContainer:{position:"absolute",top:5,right:e.spacing(7),backgroundColor:e.palette.background.paper},button:{color:e.palette.text.secondary,backgroundColor:e.palette.background.paper,"&:hover":{backgroundColor:Object(q.d)(e.palette.background.paper,.15)}}})})),pt=function(e){var t=e.nodes,n=e.onNodeSelected,a=Object(K.a)(e,bt),c=Object(L.a)().t,r=jt(),s=Object(b.useState)(!1),l=Object(o.a)(s,2),u=l[0],d=l[1],g=Object(b.useMemo)((function(){return Object(at.a)((function(e){return"".concat(c(e.getType()),":").concat(e.title)}),t)}),[t,c]),f=Object(b.useCallback)((function(){d(!0)}),[]),j=Object(b.useCallback)((function(){d(!1)}),[]),p=Object(b.useCallback)((function(e,t){t&&(null===n||void 0===n||n(t),d(!1))}),[n]);return Object(oe.jsx)(st.a,{mouseEvent:"onMouseDown",touchEvent:"onTouchStart",onClickAway:j,children:Object(oe.jsx)("div",Object(i.a)(Object(i.a)({},a),{},{children:Object(oe.jsxs)("div",{className:r.root,children:[Object(oe.jsx)(C.a,{className:r.button,onClick:f,size:"medium",children:Object(oe.jsx)(gt.a,{})}),Object(oe.jsx)("div",{className:r.editorContainer,children:Object(oe.jsx)(ft.Transition,{items:u,from:{width:0,opacity:0},enter:{width:300,opacity:1},leave:{width:0,opacity:0},reverse:u,children:function(e,t){return t&&Object(oe.jsx)(ft.animated.div,{style:e,children:Object(oe.jsx)(lt.a,{options:g,getOptionLabel:function(e){return e.title},size:"small",groupBy:function(e){return c(e.getType())},onChange:p,renderInput:function(e){return Object(oe.jsx)(ut.a,Object(i.a)(Object(i.a)({},e),{},{autoFocus:!0,variant:"outlined"}))}})})}})})]})}))})},Ot=function(e,t){return t.filter((function(t){return t instanceof e}))},vt=n(155),ht=Object(p.a)((function(e){return Object(O.a)({canvas:{height:"100%",minHeight:"250px"},actionTypeNode:{color:e.palette.primary.main},taskTypeNode:{color:"rgb(0,177,235)"},canvasContainer:{height:"100%",width:"100%"},search:{position:"absolute",top:e.spacing(2),right:e.spacing(2)},layout:{position:"absolute",bottom:e.spacing(2),left:e.spacing(2),color:e.palette.text.secondary,backgroundColor:e.palette.background.default}})})),yt=function(e){var t,n={},a=Object(f.a)(e.getNodes());try{for(a.s();!(t=a.n()).done;){var o=t.value,i=1;o instanceof he.a?i=0:(o instanceof Le.a||o instanceof Fe.a)&&"final"===o.taggingType?i=1e4:o instanceof Le.a?i=2:o instanceof Fe.a?i=3:o instanceof Oe.a&&(i=4),n[o.getID()]=i}}catch(v){a.e(v)}finally{a.f()}for(var c=Object(S.a)((function(e){return e.map((function(e){return e.getSourcePort().getNode()}))}),Object(w.a)((function(e){return e.getTargetPort().getNode().getID()}),e.getLinks().filter((function(e){return n[e.getSourcePort().getNode().getID()]<1e4})))),r=function(e){var t,n=Object(S.a)((function(e){return e.map((function(e){return e.getTargetPort().getNode()}))}),Object(w.a)((function(e){return e.getSourcePort().getNode().getID()}),e.getLinks())),a=[],o=[],i=function(e){var t=a.indexOf(e);return-1===t&&(t=a.length,a.push(e),o.push([])),t},c=Object(f.a)(Ot(Oe.a,e.getNodes()));try{var r=function(){var e=t.value,a=i(e);Object(vt.a)(e,{getNeighbors:function(t){var a;return t instanceof Oe.a&&t!==e?[]:null!==(a=n[t.getID()])&&void 0!==a?a:[]},enterVertex:function(e){var t=e.currentVertex;t instanceof Oe.a&&o[a].push(i(t))}})};for(c.s();!(t=c.n()).done;)r()}catch(v){c.e(v)}finally{c.f()}for(var s=Object(vt.c)(o),l=s.components,u=s.adjacencyList,d=[],b=Object(M.a)(u),j=!0;j;){j=!1;for(var p=[],O=[],h=0;h<b.length;h++){var y=b[h];y&&0===y.length&&(O.push(h),b[h]=void 0,p.push.apply(p,Object(g.a)(l[h].map((function(e){return a[e]})))))}var m,x=Object(f.a)(b.filter(D.isPresent));try{for(x.s();!(m=x.n()).done;){var k,C=m.value,N=Object(f.a)(O);try{for(N.s();!(k=N.n()).done;){var I=k.value,P=C.indexOf(I);P>-1&&C.splice(P,1)}}catch(v){N.e(v)}finally{N.f()}}}catch(v){x.e(v)}finally{x.f()}p.length>0&&(d.unshift(p),j=!0)}return d}(e),s=0;s<r.length;s++){var l,u=Object(f.a)(r[s]);try{for(u.s();!(l=u.n()).done;){var d=l.value;n[d.getID()]=10*s+4}}catch(v){u.e(v)}finally{u.f()}}var b=function(t){var a,o=0,i=Object(f.a)(Ot(Le.a,e.getNodes()).filter((function(e){return n[e.getID()]===t+2})));try{for(i.s();!(a=i.n()).done;){var r=a.value,s=c[r.getID()];s&&s.some((function(e){return n[e.getID()]>t+2}))&&(n[r.getID()]=t+12,o++)}}catch(v){i.e(v)}finally{i.f()}for(var l=!0;l;){l=!1;var u,d=Object(f.a)(Ot(Fe.a,e.getNodes()).filter((function(e){return n[e.getID()]===t+3})));try{for(d.s();!(u=d.n()).done;){var g=u.value,b=c[g.getID()];b&&b.some((function(e){return n[e.getID()]>t+3}))&&(n[g.getID()]=t+13,l=!0,o++)}}catch(v){d.e(v)}finally{d.f()}}return o},j=0,p=Number.MAX_VALUE,O=0;do{j=p,p=b(O),O+=10}while(p>0&&p<j);return n},mt=function(){var e=Object(d.a)(u.a.mark((function e(t){var n,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={},a=new rt({algorithm:"layered",layoutOptions:{"elk.alignment":"LEFT","elk.partitioning.activate":!0,"elk.layered.feedbackEdges":!0,"elk.portConstraints":"FIXED_POS","elk.separateConnectedComponents":!1,"elk.interactiveLayout":!0,"elk.layered.spacing.nodeNodeBetweenLayers":60,"elk.spacing.edgeEdge":20,"elk.spacing.edgeNode":20,"elk.spacing.nodeNode":20,"elk.layered.spacing.edgeEdgeBetweenLayers":20,"elk.layered.spacing.edgeNodeBetweenLayers":20,"elk.edgeRouting":"ORTHOGONAL","elk.layered.layering.strategy":"INTERACTIVE"},nodeLayoutOptions:function(e){var a;0===Object.keys(n).length&&(n=yt(t));var o={"elk.partitioning.partition":null!==(a=n[e.getID()])&&void 0!==a?a:1};return delete n[e.getID()],o},includeLinks:!0}),e.next=4,a.redistribute(t);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),xt=function(e){Object(r.a)(n,e);var t=Object(s.a)(n);function n(){var e;return Object(c.a)(this,n),(e=t.call(this)).childStates=[],e}return n}(v.DefaultDiagramState),kt=function(e,t){var n=e.getModel(),a={x:0,y:0,zoom:0},o=Object(i.a)({offsetX:[n.getOffsetX(),n.getOffsetX()],offsetY:[n.getOffsetY(),n.getOffsetY()],zoomLevel:[n.getZoomLevel(),n.getZoomLevel()]},t);I.a.fromTo(a,{x:o.offsetX[0],y:o.offsetY[0],zoom:o.zoomLevel[0]},{x:o.offsetX[1],y:o.offsetY[1],zoom:o.zoomLevel[1],duration:.5,ease:"power2",onUpdate:function(){n.setZoomLevel(a.zoom),n.setOffset(a.x,a.y),e.repaintCanvas()}})},Ct=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:20,a=e.getTopLeft(),o=t.getTopLeft(),i=e.getBottomRight(),c=t.getBottomRight(),r=new N.Point(Math.min(a.x,o.x)-n,Math.min(a.y,o.y)-n),s=new N.Point(Math.max(i.x,c.x)+n,Math.max(i.y,c.y)+n),l=s.x-r.x,u=s.y-r.y;return new N.Rectangle(r,l,u)},Nt=function(e){var t=e.actionTypes,n=e.taskTypes,a=e.selectors,i=e.taggings,c=e.initialActions,r=e.statesIncluded,s=e.visibleElementTypes,l=e.onNodeSelectionChanged,u=e.onNodeHighlighted,d=e.onActionTypeCommandInvoked,f=e.onStateCommandInvoked,j=e.onSelectorCommandInvoked,p=e.onTaskTypeCommandInvoked,O=e.onResponseTypeCommandInvoked,x=e.onSelectionChanged,I=e.onPinStatusesChanged,S=ht(),w=Object(L.a)().t,M=Object(b.useRef)(null),D=Object(P.i)(ne),R=Object(P.i)(ae),A=Object(b.useMemo)((function(){return new Me.a({locked:!0})}),[]),E=Object(b.useMemo)((function(){var e=function(){var e=h()(),t=e.getNodeFactories();return t.registerFactory(new we),t.registerFactory(new ve),t.registerFactory(new ze),t.registerFactory(new He),e.getLinkFactories().registerFactory(new $e),e.getStateMachine().pushState(new xt),e}();return e.setModel(A),e}),[A]);Object(b.useEffect)((function(){R([])}),[R]);var z=Object(b.useCallback)((function(){var e;e=function(e){setTimeout((function(){var e=M.current;mt(A).finally((function(){e&&(e.style.visibility="visible"),E.repaintCanvas()}))}),e?100:0)},"hidden"===document.visibilityState?document.addEventListener("visibilitychange",(function t(n){"visible"===document.visibilityState&&(document.removeEventListener("visibilitychange",t),e(!0))})):e(!1)}),[E,A]);Object(b.useEffect)((function(){var e=M.current;if(e){var o=A.pinStatuses,l=A.updateData(t,n,a,i,c,r,s);o!==A.pinStatuses&&(null===I||void 0===I||I(A.pinStatuses)),l&&(e.style.visibility="hidden"),E.repaintCanvas(),z()}}),[t,E,c,i,A,a,n,z,s,r,I]),Object(b.useEffect)((function(){var e={nodeSelectionChanged:function(e){null===l||void 0===l||l(e.node,e.isSelected);var t=A.getSelectedEntities().filter((function(e){return e instanceof v.NodeModel}));null===x||void 0===x||x(t),D(t.map((function(e){return e.getID()}))),e.isSelected||R([])},contextTypeNodeCommandInvoked:function(e){var t=e.command,n=e.node;if("focusNode"===t.type){var a=function(e){var t=Object(T.a)(Object.values(e.getPorts()).flatMap((function(e){return Object.values(e.getLinks())})));return[Object(T.a)(t.flatMap((function(t){var n=t.getSourcePort().getNode(),a=t.getTargetPort().getNode();return n===e?a:n}))),t]}(n),i=Object(o.a)(a,2),c=i[0];!function(e,t,n,a){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:20,i=a.getModel(),c=a.getCanvas(),r=a.getBoundingNodesRect([e].concat(Object(g.a)(t))),s=N.Polygon.boundingBoxFromPoints(n.flatMap((function(e){return e.getPoints()})).map((function(e){return e.getPosition()}))),l=Ct(r,s,o),u=c.getBoundingClientRect(),d={x:u.left,y:u.top},f={x:d.x+i.getOffsetX(),y:d.y+i.getOffsetY()},b=c.clientWidth/l.getWidth(),j=c.clientHeight/l.getHeight(),p=Math.min(b<j?b:j,1),O=l.getTopLeft(),v={x:f.x+O.x*p,y:f.y+O.y*p},h=i.getOffsetX()+d.x-v.x,y=i.getOffsetY()+d.y-v.y;kt(a,{offsetX:[i.getOffsetX(),h],offsetY:[i.getOffsetY(),y],zoomLevel:[i.getZoomLevel(),100*p]})}(n,c,i[1],E),c.unshift(n),R(c.map((function(e){return e.getID()}))),null===u||void 0===u||u(n)}if(n instanceof he.a)null===d||void 0===d||d(n.instance,t);else if(n instanceof Le.a)null===f||void 0===f||f(n.instance,t);else if(n instanceof Fe.a)null===j||void 0===j||j(n.instance,t);else if(n instanceof Oe.a)if(Object(Te.b)(t)){var r=n.instance.validResponses.find((function(e){return e.name===t.responseName}));r&&(null===O||void 0===O||O(r,n.instance,t))}else null===p||void 0===p||p(n.instance,t)}},t=A.registerListener(e);return function(){A.deregisterListener(t)}}),[E,A,d,u,l,O,x,j,f,p,R,D]);var F=Object(b.useState)(),X=Object(o.a)(F,2)[1],Y=Object(b.useCallback)((function(e){var t=E.getMouseElement(e);t&&X(t)}),[E]),B=Object(b.useCallback)((function(e){!function(e,t){var n=t.getModel();n.clearSelection(),e.setSelected(!0);var a=t.getCanvas().getBoundingClientRect(),o=a.width,i=a.height,c=-n.getOffsetX(),r=-n.getOffsetX()+o,s=-n.getOffsetY(),l=-n.getOffsetY()+i,u=n.getZoomLevel()/100,d=e.getPosition(),g=d.x,f=d.y;f*=u;var b=(g*=u)+e.width*u,j=f+e.height*u,p=n.getOffsetX(),O=n.getOffsetY();b>r?p=-b-40+o:g<c&&(p=40-g),j>l?O=-j-40+i:f<s&&(O=40-f),n.getOffsetX()===p&&n.getOffsetY()===O||kt(t,{offsetX:[n.getOffsetX(),p],offsetY:[n.getOffsetY(),O]})}(e,E)}),[E]);return Object(oe.jsxs)(oe.Fragment,{children:[Object(oe.jsx)("div",{ref:M,className:S.canvasContainer,onMouseOver:Y,children:Object(oe.jsx)(y.CanvasWidget,{engine:E,className:S.canvas})}),Object(oe.jsx)(pt,{nodes:E.getModel().getNodes(),className:S.search,onNodeSelected:B}),Object(oe.jsx)(m.a,{title:w("PerformLayout"),children:Object(oe.jsx)(C.a,{className:S.layout,onClick:z,size:"small",children:Object(oe.jsx)(k.a,{fontSize:"small"})})})]})};t.default=Nt}}]);
//# sourceMappingURL=64.ae0fb8c0.chunk.js.map