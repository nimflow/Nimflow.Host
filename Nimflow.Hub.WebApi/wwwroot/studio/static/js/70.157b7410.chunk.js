(this["webpackJsonpnimflow-studio"]=this["webpackJsonpnimflow-studio"]||[]).push([[70],{1181:function(e,n,t){"use strict";t.d(n,"a",(function(){return d}));var a=t(7),i=t(103),r=t(2305),c=t(2986),s=t(2618),o=t(128),l=["children","className"],u=Object(c.a)((function(e){return Object(s.a)({paper:{padding:e.spacing(2),color:e.palette.text.secondary}})})),d=function(e){var n=e.children,t=e.className,c=Object(i.a)(e,l),s=u();return Object(o.jsx)(r.a,Object(a.a)(Object(a.a)({className:"".concat(s.paper," ").concat(t),elevation:3},c),{},{children:n}))}},1246:function(e,n,t){"use strict";t.d(n,"a",(function(){return f}));var a=t(7),i=t(103),r=t(2618),c=t(2986),s=t(2459),o=t(1515),l=t(128),u=["title","actions"],d=Object(c.a)((function(e){return Object(r.a)({grow:{flexGrow:1},actionToolbarButtons:{display:"flex"}})})),f=function(e){var n=e.title,t=e.actions,r=Object(i.a)(e,u),c=d();return Object(l.jsxs)(s.a,Object(a.a)(Object(a.a)({variant:"dense"},r),{},{children:[n&&Object(l.jsx)(o.a,{children:n}),Object(l.jsx)("div",{className:c.grow}),t&&Object(l.jsx)("div",{className:c.actionToolbarButtons,children:t})]}))}},1515:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var a=t(7),i=t(103),r=t(2419),c=t(128),s=["children"],o=function(e){var n=e.children,t=Object(i.a)(e,s);return Object(c.jsx)(r.a,Object(a.a)(Object(a.a)({variant:"h5"},t),{},{children:n}))}},1857:function(e,n,t){"use strict";var a=t(474);Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=a(t(479)),r=t(128),c=(0,i.default)((0,r.jsx)("path",{d:"M19 3h-4.18C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm2 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"}),"Assignment");n.default=c},1990:function(e,n,t){"use strict";t.d(n,"a",(function(){return d}));var a=t(518),i=t(130),r=t(5),c=t.n(r),s=t(14),o=t(38),l=t(1582),u=function(e,n){var t,a=null!==(t=e.getValue())&&void 0!==t?t:[],i=null!==a&&void 0!==a?a:[],r=n(i);i!==r&&e.setValue(r,{shouldDirty:!0})},d=function(e){var n,t=e.control,d=e.name,f=(e.keyName,e.defaultValue),b=t.register,p=t.unregister,j=t.fieldsRef,v=t.setValue,O=t.updateFormState,m=t.readFormStateRef,h=t.fieldArrayNamesRef,x=t.shallowFieldsStateRef,y=t.defaultValuesRef,g=t.validateResolver,k=c.a.useMemo((function(){return{getValue:function(){var e,n=null===(e=j.current)||void 0===e?void 0:e[d];if(n)return n.ref.value},setValue:function(e,n){v(d,e,n),m.current.isValid&&g&&g(Object(i.a)({},d,e)),O()}}}),[j,v,d,m,g,O]),C=Object(r.useCallback)((function(){var e,n=!Object(l.d)(h.current,d);return Object(o.isPresent)(x.current[d])&&n?x.current[d]:null!==(e=null!==f&&void 0!==f?f:Object(l.b)(y.current,d))&&void 0!==e?e:[]}),[d,h,x,y,f]),T=null!==(n=k.getValue())&&void 0!==n?n:C(),R=Object(r.useCallback)((function(){if(b({name:d,type:"array-field"}),!k.getValue()){var e=C();k.setValue(e)}return O(),function(){return p(d)}}),[b,p,O,k,d,C]);return c.a.useEffect((function(){R()}),[R]),c.a.useEffect((function(){j.current[d]||R()})),{fields:T,swap:c.a.useCallback((function(e,n){u(k,(function(t){if(t.length<=1)return t;var a=t[e],i=t[n];return t.map((function(t,r){return r===e?i:r===n?a:t}))}))}),[k]),move:c.a.useCallback((function(e,n){u(k,(function(t){return t.length<=1?t:Object(s.v)(e,n,t)}))}),[k]),prepend:c.a.useCallback((function(e){u(k,(function(n){return Array.isArray(e)?Object(s.e)(e,n):Object(s.y)(e,n)}))}),[k]),append:c.a.useCallback((function(e){u(k,(function(n){return Array.isArray(e)?Object(s.e)(n,e):Object(s.a)(e,n)}))}),[k]),remove:c.a.useCallback((function(e){u(k,(function(n){if(0===n.length)return n;if(!Object(o.isDefined)(e))return[];if(n){for(var t=[],a=Array.isArray(e)?e:[e],i=0;i<n.length;i++)a.includes(i)||t.push(n[i]);return t}return n}))}),[k]),insert:c.a.useCallback((function(e,n){u(k,(function(t){return Array.isArray(n)?Object(s.n)(e,n,t):Object(s.m)(e,n,t)}))}),[k]),setAt:c.a.useCallback((function(e,n){u(k,(function(t){if(Array.isArray(n)){var i=Object(a.a)(t);return i.splice.apply(i,[e,n.length].concat(Object(a.a)(n))),i}return Object(s.K)(e,n,t)}))}),[k])}}},2837:function(e,n,t){"use strict";t.r(n),t.d(n,"TaskTypesEditor",(function(){return ee}));var a=t(518),i=t(25),r=t(49),c=t(485),s=t(464),o=t(484),l=t.n(o),u=t(5),d=t(2618),f=t(2986),b=t(2386),p=t(2440),j=t(1270),v=t(1271),O=t(1272),m=t(3029),h=t(2419),x=t(2418),y=t(596),g=t.n(y),k=t(738),C=t.n(k),T=t(2935),R=t(1967),S=t(1857),D=t.n(S),N=t(643),w=t.n(N),I=t(575),V=t.n(I),A=t(2439),z=t(3006),J=t(38),H=t(14),P=t(862),M=t(1990),B=t(1994),E=t(1181),F=t(1246),W=t(1303),$=t(529),_=t(576),G=t(1507),K=t(1544),q=t(128),L=Object(u.lazy)((function(){return Promise.all([t.e(0),t.e(7),t.e(9),t.e(14),t.e(20)]).then(t.bind(null,2846))})),Q=Object(u.lazy)((function(){return Promise.all([t.e(0),t.e(7),t.e(9),t.e(14),t.e(19)]).then(t.bind(null,2841))})),U=Object(f.a)((function(e){return Object(d.a)({root:{width:"100%",backgroundColor:e.palette.background.paper},item:{border:"2px solid ".concat(e.palette.common.task),borderRadius:2,paddingRight:96},divider:{height:5,background:"transparent"},inline:{display:"inline"},actionHeading:{fontSize:e.typography.pxToRem(15),fontWeight:e.typography.fontWeightRegular},summaryTextContainer:{width:"100%",height:"100%",display:"flex",alignItems:"center"},responses:{display:"flex",justifyContent:"center",flexWrap:"wrap","& > *":{margin:e.spacing(.5)}},textField:{width:"40ch"}})})),X=Object(b.a)({root:{backgroundColor:"transparent",boxShadow:"none","&:not(:last-child)":{borderBottom:0},"&:before":{display:"none"},"&$expanded":{border:"1px solid rgba(0, 0, 0, .125)",margin:"auto"}},expanded:{}})(j.a),Y=Object(b.a)({root:{marginBottom:-1,height:32,minHeight:32,papdding:0,"&$expanded":{borderBottom:"1px solid rgba(0, 0, 0, .125)",minHeight:56}},content:{margin:0,height:"100%",alignItems:"center","&$expanded":{margin:0}},expandIcon:{paddingRight:"16px"},expanded:{}})(v.a),Z=Object(b.a)((function(e){return{root:{padding:e.spacing(2),flexDirection:"column"}}}))(O.a),ee=function(e){var n=e.onDialogVisibilityChanged,t=Object(z.a)().t,o=U(),d=Object(u.useState)(-1),f=Object(s.a)(d,2),b=f[0],j=f[1],v=Object(u.useState)(),O=Object(s.a)(v,2),y=O[0],k=O[1],S=Object(P.f)(),N=S.control,I=S.errors,ee=Object(M.a)({name:"tasks",control:N}),ne=ee.fields,te=ee.append,ae=ee.remove,ie=ee.setAt,re=ee.move,ce=Object($.c)(),se=Object(G.b)(),oe=se.getJsonSchemaDefinition,le=se.getJsonSchemaDefinitions,ue=se.setJsonSchemaDefinition,de=se.updateResponseJsonSchemaDefinition,fe=se.updateTaskJsonSchemaDefinitions,be=Object(K.e)().removeInvalidTaggings,pe=Object(u.useCallback)((function(){k({type:"taskType",taskType:{name:"",jsTaskDataSetters:{},validResponses:[]}}),null===n||void 0===n||n(!0),j(ne.length)}),[k,ne,n]),je=Object(u.useCallback)(function(){var e=Object(c.a)(l.a.mark((function e(n){var a,i,c,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ce({description:t("ConfirmDeleteTaskType",{name:ne[n].name})});case 2:if(e.sent){e.next=5;break}return e.abrupt("return");case 5:if((a=null===ne||void 0===ne?void 0:ne.flatMap((function(e){var n;return null!==(n=e.validResponses)&&void 0!==n?n:[]})).map((function(e){return e.payloadSchemaDefinitionName})).filter(J.isPresent))&&a.length>0){i=Object(r.a)(a);try{for(i.s();!(c=i.n()).done;)s=c.value,ue(s,void 0)}catch(o){i.e(o)}finally{i.f()}}ae(n),be(),b>n&&j(b-1);case 10:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),[ce,b,ae,be,ue,t,ne]),ve=Object(u.useMemo)((function(){var e,n=(null!==(e="taskType"===(null===y||void 0===y?void 0:y.type)?y.taskType.validResponses:void 0)&&void 0!==e?e:[]).map((function(e){return e.payloadSchemaDefinitionName})).filter(J.isPresent);return le(n)}),[y,le]),Oe=Object(u.useCallback)((function(e,n){if("taskType"===(null===y||void 0===y?void 0:y.type)){var t=y.index;if(Object(J.isDefined)(t)){var a,i,c=null===(a=ne[t].validResponses)||void 0===a?void 0:a.map((function(e){return e.payloadSchemaDefinitionName})).filter(J.isPresent),s=Object(r.a)(null!==c&&void 0!==c?c:[]);try{for(s.s();!(i=s.n()).done;){var o=i.value;o in n||(n[o]=void 0)}}catch(l){s.e(l)}finally{s.f()}ie(t,e),be()}else te(e);fe(e,n)}}),[te,y,be,ie,ne,fe]),me=Object(u.useCallback)((function(e,n){re(e,n),b===e?j(n):b>e&&b<n&&j(b-1)}),[re,b]),he=Object(u.useCallback)((function(e,n){j(n?e:-1)}),[]),xe=Object(u.useCallback)((function(e,t){k({type:"taskType",index:e,taskType:Object(H.c)(t)}),null===n||void 0===n||n(!0)}),[k,n]),ye=Object(u.useCallback)((function(e){var t=ne.findIndex((function(n){return n===e}));t<=-1||(k({type:"responseType",taskIndex:t,responseType:{name:"",validators:[],jsSetters:{}}}),null===n||void 0===n||n(!0),j(ne.length))}),[k,ne,n]),ge=Object(u.useCallback)((function(e,t){var a=ne.findIndex((function(n){return n===e}));if(!(a<=-1)&&e.validResponses){var i=e.validResponses.findIndex((function(e){return e===t}));i<=-1||(k({type:"responseType",taskIndex:a,responseIndex:i,responseType:Object(H.c)(t)}),null===n||void 0===n||n(!0))}}),[ne,n]),ke=Object(u.useCallback)(function(){var e=Object(c.a)(l.a.mark((function e(n,r){var c,s,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!((c=ne.findIndex((function(e){return e===n})))<=-1)){e.next=3;break}return e.abrupt("return");case 3:if(n.validResponses){e.next=5;break}return e.abrupt("return");case 5:if(!((s=n.validResponses.findIndex((function(e){return e===r})))<=-1)){e.next=8;break}return e.abrupt("return");case 8:return e.next=10,ce({description:t("ConfirmDeleteResponseType",{name:n.validResponses[s].name})});case 10:e.sent&&((o=r.payloadSchemaDefinitionName)&&ue(o,void 0),ie(c,Object(i.a)(Object(i.a)({},n),{},{validResponses:Object(a.a)(n.validResponses.filter((function(e){return e!==r})))})),be());case 12:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),[ne,ce,t,ie,be,ue]),Ce=Object(u.useMemo)((function(){if("responseType"===(null===y||void 0===y?void 0:y.type)){var e=y.responseType.payloadSchemaDefinitionName;if(e)return oe(e)}}),[y,oe]),Te=Object(u.useCallback)((function(e,n){if(y){var t=y,r=t.taskIndex,c=t.responseIndex,s=ne[r];if(de(e,s.name,n),Object(J.isDefined)(c)){if(!e.payloadSchemaDefinitionName){var o,l=null===(o=ne[r].validResponses)||void 0===o?void 0:o[c].payloadSchemaDefinitionName;l&&ue(l,void 0)}ie(r,Object(i.a)(Object(i.a)({},s),{},{validResponses:s.validResponses.map((function(n,t){return t===c?e:n}))})),be()}else{var u;ie(r,Object(i.a)(Object(i.a)({},s),{},{validResponses:[].concat(Object(a.a)(null!==(u=s.validResponses)&&void 0!==u?u:[]),[e])}))}}}),[y,be,ie,ue,ne,de]),Re=Object(u.useCallback)((function(){k(void 0),null===n||void 0===n||n(!1)}),[k,n]);return Object(q.jsxs)(E.a,{children:[Object(q.jsx)(F.a,{title:t("Tasks"),actions:Object(q.jsx)(A.a,{title:t("NewTaskType"),children:Object(q.jsx)(x.a,{onClick:pe,size:"large",children:Object(q.jsx)(g.a,{})})})}),Object(q.jsx)(B.a,{onItemReorder:me,className:o.root,children:ne.map((function(e,n){var a,i=null!==(a=e.validResponses)&&void 0!==a?a:[];return Object(q.jsxs)(B.b,{index:n,className:o.item,afterItem:Object(q.jsx)(T.a,{className:o.divider}),children:[Object(q.jsx)(p.a,{primary:Object(q.jsxs)(X,{expanded:b===n,onChange:function(e,t){return he(n,t)},children:[Object(q.jsx)(Y,{expandIcon:Object(q.jsx)(C.a,{}),children:Object(q.jsx)("div",{className:o.summaryTextContainer,children:Object(q.jsx)(h.a,{className:o.actionHeading,children:e.name})})}),Object(q.jsx)(Z,{children:i.length>0&&Object(q.jsxs)("div",{className:o.responses,children:[i.map((function(n,t){var a,i=null===(a=Object(_.A)(n))||void 0===a?void 0:a.commandText;return i||(i=n.name),Object(q.jsx)(R.a,{icon:Object(q.jsx)(D.a,{}),label:i,onClick:function(){return ge(e,n)},onDelete:function(){return ke(e,n)}},t)})),Object(q.jsx)(A.a,{title:t("NewResponseType"),children:Object(q.jsx)(x.a,{size:"small",onClick:function(){return ye(e)},children:Object(q.jsx)(g.a,{})})})]})})]})}),Object(q.jsxs)(m.a,{children:[Object(q.jsx)(A.a,{title:t("Edit"),children:Object(q.jsx)(x.a,{"aria-label":"edit",onClick:function(){return xe(n,e)},size:"large",children:Object(q.jsx)(w.a,{})})}),Object(q.jsx)(A.a,{title:t("Delete"),children:Object(q.jsx)(x.a,{edge:"end","aria-label":"delete",onClick:function(){return je(n)},size:"large",children:Object(q.jsx)(V.a,{})})})]})]},e.name)}))}),Object(q.jsx)(W.a,{errors:I,names:"tasks"}),"taskType"===(null===y||void 0===y?void 0:y.type)&&Object(q.jsx)(u.Suspense,{fallback:null,children:Object(q.jsx)(L,{open:Object(J.isDefined)(y),onClose:Re,defaultValue:y.taskType,definitionJsonSchemas:ve,onChange:Oe})}),"responseType"===(null===y||void 0===y?void 0:y.type)&&Object(q.jsx)(u.Suspense,{fallback:null,children:Object(q.jsx)(Q,{open:"responseType"===(null===y||void 0===y?void 0:y.type),onClose:Re,defaultValue:y.responseType,taskTypeName:ne[y.taskIndex].name,definitionJsonSchema:Ce,onChange:Te})})]})};n.default=ee}}]);
//# sourceMappingURL=70.157b7410.chunk.js.map