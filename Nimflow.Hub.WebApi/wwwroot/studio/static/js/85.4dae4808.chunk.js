(this["webpackJsonpnimflow-studio"]=this["webpackJsonpnimflow-studio"]||[]).push([[85],{1841:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var a=n(13),o=n(3),i=n(6),c=n(2322),r=n(2975),s=n(2038),l=n(2037),u=n(2926),d=n(1861),g=n(2062),f=n(2988),b=n(2977),j=n(35),p=n(819),O=n(1009),h=n(125),v=Object(r.a)((function(e){return Object(c.a)({smallAvatar:{width:25,height:25,border:function(t){return t.displayStandalone?void 0:"2px solid ".concat(e.palette.primary.main)},color:function(t){return t.displayStandalone?e.palette.text.primary:e.palette.text.secondary},backgroundColor:function(t){return t.displayStandalone?e.palette.background.default:e.palette.background.paper}},tagging:{width:16,height:16}})})),m=function(e){var t=e.value,n=e.onChange,c=e.children,r=e.displayEmptyTagging,m=v(e),y=Object(p.usePopupState)({variant:"popover",popupId:"taggingMenu"}),x=Object(i.useCallback)((function(e){y.close(),null===n||void 0===n||n(e)}),[n,y]);return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsxs)(l.a,Object(o.a)(Object(o.a)({},Object(p.bindTrigger)(y)),{},{size:"small",children:[(Object(j.isPresent)(t)||r)&&Object(h.jsx)(b.a,{overlap:"circular",anchorOrigin:{vertical:"bottom",horizontal:"right"},badgeContent:Object(h.jsx)(f.a,{className:m.smallAvatar,children:Object(h.jsx)(O.a,{taggingType:t,className:m.tagging})}),children:c}),!Object(j.isPresent)(t)&&c]})),Object(h.jsx)(d.a,Object(o.a)(Object(o.a)({},Object(p.bindMenu)(y)),{},{children:[void 0].concat(Object(a.a)(O.d)).map((function(e,t){return Object(h.jsxs)(g.a,{onClick:function(){return x(e)},children:[Object(h.jsx)(u.a,{children:Object(h.jsx)(O.a,{taggingType:e,fontSize:"small"})}),Object(h.jsx)(s.a,{variant:"inherit",children:Object(O.b)(e)})]},t)}))}))]})}},2813:function(e,t,n){"use strict";n.r(t),n.d(t,"ContextTypeDiagram",(function(){return Rt}));var a,o=n(445),i=n(101),c=n(637),r=n(636),s=n(741),l=n(742),u=n(507),d=n(518),g=n(137),f=n(502),b=n.n(f),j=n(6),p=n.n(j),O=n(439),h=n(985),v=n.n(h),m=n(719),y=n(2058),x=n(645),k=n.n(x),C=n(3019),I=n(1034),N=n(2829),P=n(139),S=n(14),w=n(2991),M=n(35),L=n(3),T=n(2),D=n(1),R=n(12),A=n(15),E=n(2322),z=n(2975),F=n(627),X=n(481),Y=n.n(X),B=n(1872),H=n.n(B),W=n(470),Z=n.n(W),V=n(662),q=n.n(V),J=n(2805),U=n.n(J),_=n(4),G=n(2897),K=n(1992),Q=n(1993),$=n(1994),ee=n(2924),te=n(99),ne=n(432),ae=n(1158),oe=Object(P.b)({key:"hoveredContextTypeNodeModelIdState",default:void 0}),ie=Object(P.b)({key:"selectedLinkIds",default:[]}),ce=Object(P.b)({key:"selectedNodeIdsState",default:[]}),re=Object(P.b)({key:"focusedNodeIdsState",default:[]}),se=n(125),le=["port","onPortHovering","className"],ue=Object(z.a)((function(e){return Object(E.a)({portBody:{width:function(e){var t;return null!==(t=e.portSize)&&void 0!==t?t:ae.b},height:function(e){var t;return null!==(t=e.portSize)&&void 0!==t?t:ae.b},background:"rgba(128, 128, 128, 1)",opacity:.3},port:{width:"100%",height:"100%"}})})),de=function(e){var t=e.port,n=e.onPortHovering,a=e.className,o=Object(te.a)(e,le),i=ue(e),c=Object(P.i)(ie),r=Object(j.useCallback)((function(e){null===n||void 0===n||n(t,e),c((function(n){if(!e)return[];var a=Object.keys(t.links);return n.length===a.length&&a.every((function(e){return n.includes(e)}))?n:a}))}),[n,t,c]);return Object(se.jsx)("div",{className:Object(ne.default)(i.portBody,a),onMouseEnter:function(){return r(!0)},onMouseLeave:function(){return r(!1)},children:Object(se.jsx)(h.PortWidget,Object(L.a)({className:i.port,port:t},o))})},ge=Object(z.a)((function(e){return Object(E.a)({root:{position:"relative",marginTop:20,marginBottom:20,cursor:"pointer",opacity:function(e){return e.unfocused?.2:1}},cardContainer:{position:"relative"},card:{backgroundColor:function(t){return t.selected?e.palette.action.selected:e.palette.background.paper}},inPort:{top:20,left:-ae.b,position:"absolute"},outPort:{top:20,right:-ae.b,position:"absolute"},headerRoot:{padding:"".concat(e.spacing(1)," ").concat(e.spacing(2))},contentRoot:{padding:"".concat(e.spacing(1)," ").concat(e.spacing(1))},actions:{display:"table",position:"absolute",paddingBottom:10,zIndex:100,width:"100%",textAlign:"right"},action:{marginTop:5,marginRight:10,color:e.palette.text.secondary,backgroundColor:e.palette.background.paper,"&:hover":{backgroundColor:Object(G.e)(e.palette.background.paper,.15)}}})})),fe=function(e){var t,n=e.node,a=e.engine,o=e.onPortHovering,i=e.onPanelHovering,c=e.title,r=e.titleTypographyProps,s=e.subheader,l=e.subheaderTypographyProps,u=e.avatar,d=e.actions,g=e.children,f=Object(P.f)(oe),b=Object(_.a)(f,2),p=b[0],O=b[1],h=Object(P.h)(re),v=Object(P.i)(ie),m=p===n.getID(),x=h.includes(n.getID()),k=ge({selected:null!==(t=e.selected)&&void 0!==t&&t,unfocused:h.length>0&&!x}),I=Object(j.useCallback)((function(){null===i||void 0===i||i(!0),O(n.getID()),v((function(e){var t=Object(S.I)(Object.values(n.getPorts()).flatMap((function(e){return Object.keys(e.links)})));return e.length===t.length&&t.every((function(t){return e.includes(t)}))?e:t}))}),[i,O,n,v]),N=Object(j.useCallback)((function(){null===i||void 0===i||i(!1);var e=n.getID();O((function(t){return t===e?void 0:t})),v((function(e){return e.length>0?[]:e}))}),[i,n,O,v]),w=Object(j.useCallback)((function(){n.dispatchCommand({type:"focusNode"})}),[n]);return Object(se.jsxs)("div",{className:k.root,children:[Object(se.jsxs)("div",{onMouseEnter:I,onMouseLeave:N,className:k.cardContainer,children:[Object(se.jsxs)(K.a,{className:k.card,elevation:2,onDoubleClick:w,children:[Object(se.jsx)(Q.a,{title:null!==c&&void 0!==c?c:n.title,titleTypographyProps:r,subheader:s,subheaderTypographyProps:l,avatar:u,classes:{root:k.headerRoot}}),!!g&&Object(se.jsxs)(se.Fragment,{children:[Object(se.jsx)(ee.a,{}),Object(se.jsx)($.a,{classes:{root:k.contentRoot},children:g})]})]}),!!d&&m&&Object(se.jsx)("div",{className:k.actions,children:d.map((function(e,t){var n=Object(se.jsx)(C.a,{onClick:function(t){return e.onClick(t)},size:"small",className:k.action,children:e.icon},t);return e.tooltip&&(n=Object(se.jsx)(y.a,{title:e.tooltip,children:n},t)),n}))})]}),n.inPort&&Object(se.jsx)(de,{port:n.inPort,engine:a,onPortHovering:o,className:k.inPort}),n.outPort&&Object(se.jsx)(de,{port:n.outPort,engine:a,onPortHovering:o,className:k.outPort})]})},be=n(2988),je=["className"],pe=Object(z.a)((function(e){return Object(E.a)({avatar:{color:"light"===e.palette.mode?e.palette.background.default:"#fff",backgroundColor:e.palette.primary.main,width:e.spacing(4),height:e.spacing(4)}})})),Oe=function(e){var t=e.className,n=Object(te.a)(e,je),a=pe();return Object(se.jsx)(be.a,Object(L.a)({className:Object(ne.default)(a.avatar,t)},n))},he=Object(z.a)((function(e){return Object(E.a)({responsePort:{top:"calc(50% - ".concat(4,"px)"),right:-8,position:"absolute"},response:{position:"relative",marginBottom:5},responseChipRoot:{width:"100%",backgroundColor:e.palette.background.paper},responseChipLabel:{width:"100%"}})})),ve=function(e){return Object(se.jsxs)(se.Fragment,{children:[Object(se.jsx)(Y.a,Object(L.a)({"data-action-type":"edit"},e)),Object(se.jsx)(H.a,Object(L.a)({"data-action-type":"delete"},e))]})},me=function(e){var t,n=e.engine,a=e.node,o=he(e),i=Object(j.useMemo)((function(){return[{icon:Object(se.jsx)(Y.a,{}),onClick:function(){a.dispatchCommand({type:"edit"})}},{icon:Object(se.jsx)(Z.a,{}),onClick:function(){a.dispatchCommand({type:"delete"})}}]}),[a]),c=Object(j.useCallback)((function(e,t){for(var n=e.target;n&&"svg"!==n.tagName;)n=n.parentNode;if(n){var o=n.getAttribute("data-action-type");o&&("edit"===o?a.dispatchCommand({type:"editResponse",responseName:t.name}):"delete"===o&&a.dispatchCommand({type:"deleteResponse",responseName:t.name}))}}),[a]);return Object(se.jsx)(fe,{engine:n,node:a,avatar:Object(se.jsx)(Oe,{children:Object(se.jsx)(q.a,{})}),actions:i,selected:a.isSelected(),children:null===(t=a.instance.validResponses)||void 0===t?void 0:t.map((function(e){var t=a.getResponsePort(e);return Object(se.jsxs)("div",{className:o.response,children:[Object(se.jsx)(F.a,{icon:Object(se.jsx)(U.a,{}),label:null===e||void 0===e?void 0:e.name,onDelete:function(t){return c(t,e)},deleteIcon:Object(se.jsx)(ve,{}),variant:"outlined",classes:{root:o.responseChipRoot,label:o.responseChipLabel}}),t&&Object(se.jsx)(de,{port:t,engine:n,portSize:8,className:o.responsePort})]},e.name)}))})},ye=n(1212),xe=function(e){Object(R.a)(n,e);var t=Object(A.a)(n);function n(){return Object(T.a)(this,n),t.call(this,"taskType")}return Object(D.a)(n,[{key:"generateModel",value:function(e){var t,n=null!==(t=e.instanceId)&&void 0!==t?t:"",a=Object(L.a)({},e);return delete a.instanceId,new ye.a(a,n)}},{key:"generateReactWidget",value:function(e){return Object(se.jsx)(me,{engine:this.engine,node:e.model})}}]),n}(m.AbstractReactFactory),ke=n(1211),Ce=n(2037),Ie=n(1493),Ne=n.n(Ie),Pe=n(2977),Se=n(2806),we=n.n(Se),Me=Object(z.a)((function(e){return Object(E.a)({smallAvatar:{width:25,height:25,border:"2px solid ".concat(e.palette.primary.main),color:e.palette.text.secondary,backgroundColor:e.palette.background.paper},initialAction:{width:16,height:16}})})),Le=function(e){var t=e.isInitialAction,n=e.onClick,a=e.children,o=Me();return Object(se.jsxs)(Ce.a,{onClick:n,size:"small",children:[t&&Object(se.jsx)(Pe.a,{overlap:"circular",anchorOrigin:{vertical:"bottom",horizontal:"right"},badgeContent:Object(se.jsx)(be.a,{className:o.smallAvatar,children:Object(se.jsx)(we.a,{className:o.initialAction})}),children:a}),!t&&a]})},Te=function(e){var t=e.engine,n=e.node,a=Object(j.useCallback)((function(){n.dispatchCommand({type:"toggleInitialAction"})}),[n]),o=Object(j.useMemo)((function(){return[{icon:Object(se.jsx)(Y.a,{}),onClick:function(){n.dispatchCommand({type:"edit"})}},{icon:Object(se.jsx)(Z.a,{}),onClick:function(){n.dispatchCommand({type:"delete"})}}]}),[n]);return Object(se.jsx)(fe,{engine:t,node:n,avatar:Object(se.jsx)(Le,{isInitialAction:n.isInitialAction,onClick:a,children:Object(se.jsx)(Oe,{children:Object(se.jsx)(Ne.a,{})})}),actions:o,selected:n.isSelected()})},De=function(e){Object(R.a)(n,e);var t=Object(A.a)(n);function n(){return Object(T.a)(this,n),t.call(this,"actionType")}return Object(D.a)(n,[{key:"generateModel",value:function(e){var t,n,a=null!==(t=e.isInitialAction)&&void 0!==t&&t,o=null!==(n=e.instanceId)&&void 0!==n?n:"",i=Object(L.a)({},e);return delete i.isInitialAction,delete i.instanceId,new ke.a(i,o,a)}},{key:"generateReactWidget",value:function(e){return Object(se.jsx)(Te,{engine:this.engine,node:e.model})}}]),n}(m.AbstractReactFactory),Re=n(1354),Ae=n(823),Ee=n(1371),ze=n(1798),Fe=n.n(ze),Xe=n(1841),Ye=function(e){var t=e.engine,n=e.node,a=Object(j.useCallback)((function(e){n.dispatchCommand({type:"setTagging",tagging:e})}),[n]);return Object(se.jsx)(fe,{engine:t,node:n,avatar:Object(se.jsx)(Xe.a,{value:n.taggingType,onChange:a,children:Object(se.jsx)(Oe,{children:Object(se.jsx)(Fe.a,{})})}),selected:n.isSelected()})},Be=function(e){Object(R.a)(n,e);var t=Object(A.a)(n);function n(){return Object(T.a)(this,n),t.call(this,"state")}return Object(D.a)(n,[{key:"generateModel",value:function(e){var t,n=e.milestoneType,a=null!==(t=e.instanceId)&&void 0!==t?t:"",o=Object(L.a)({},e);return delete o.milestoneType,delete o.instanceId,new Ee.a(o,a,n)}},{key:"generateReactWidget",value:function(e){return Object(se.jsx)(Ye,{engine:this.engine,node:e.model})}}]),n}(m.AbstractReactFactory),He=n(1213),We=n(1494),Ze=n.n(We),Ve=function(e){var t=e.engine,n=e.node,a=Object(j.useCallback)((function(e){n.dispatchCommand({type:"setTagging",tagging:e})}),[n]),o=Object(j.useMemo)((function(){return[{icon:Object(se.jsx)(Y.a,{}),onClick:function(){n.dispatchCommand({type:"edit"})}},{icon:Object(se.jsx)(Z.a,{}),onClick:function(){n.dispatchCommand({type:"delete"})}}]}),[n]);return Object(se.jsx)(fe,{engine:t,node:n,avatar:Object(se.jsx)(Xe.a,{value:n.taggingType,onChange:a,children:Object(se.jsx)(Oe,{children:Object(se.jsx)(Ze.a,{})})}),actions:o,selected:n.isSelected()})},qe=function(e){Object(R.a)(n,e);var t=Object(A.a)(n);function n(){return Object(T.a)(this,n),t.call(this,"selector")}return Object(D.a)(n,[{key:"generateModel",value:function(e){var t,n=e.milestoneType,a=null!==(t=e.instanceId)&&void 0!==t?t:"",o=Object(L.a)({},e);return delete o.milestoneType,delete o.instanceId,new He.a(o,a,n)}},{key:"generateReactWidget",value:function(e){return Object(se.jsx)(Ve,{engine:this.engine,node:e.model})}}]),n}(m.AbstractReactFactory),Je=n(1163),Ue=function(e){var t=e.path,n=e.link,o=e.forwardRef,i=e.factory,c=e.onSelection,r=e.extras,s=e.linkStatus,l=e.isOutgoing,u=s===a.selected||n.isSelected(),d=u?l?n.getSelectedOutgoingColor():n.getOptions().selectedColor:n.getOptions().color,g=p.a.cloneElement(i.generateLinkSegment(n,u,t),{ref:o,strokeOpacity:s===a.selected?.8:a.unfocused?.1:.3,stroke:d}),f=p.a.cloneElement(g,Object(L.a)(Object(L.a)({strokeLinecap:"round",onMouseLeave:function(){c(!1)},onMouseEnter:function(){c(!0)}},r),{},{ref:null,"data-linkid":n.getID(),strokeOpacity:s===a.selected?.1:0,strokeWidth:20,fill:"none"}));return Object(se.jsxs)("g",{children:[g,f]})};!function(e){e[e.normal=0]="normal",e[e.selected=1]="selected",e[e.unfocused=2]="unfocused"}(a||(a={}));var _e=function(e){var t=e.linkId,n=e.point,o=e.previousPoint,i=e.color,c=e.selectedColor,r=e.linkStatus,s=n.x,l=n.y,u=o.x,d=o.y,g=90+180*Math.atan2(l-d,s-u)/Math.PI;return Object(se.jsx)("g",{className:"arrow",transform:"translate(".concat(s,", ").concat(l,")"),children:Object(se.jsx)("g",{style:{transform:"rotate(".concat(g,"deg)")},children:Object(se.jsx)("g",{transform:"translate(0, -5)",children:Object(se.jsx)("polygon",{points:"0,5 4,15 -4,15",fill:r===a.selected?c:i,opacity:r===a.selected?.8:a.unfocused?.1:.3,"data-linkid":t})})})})},Ge=function(e){return"".concat(e.x," ").concat(e.y)},Ke=function(e){return"M ".concat(Ge(e)," ")},Qe=function(e){return"L ".concat(Ge(e)," ")},$e=function(e,t,n){return"C ".concat(Ge(e),", ").concat(Ge(t),", ").concat(Ge(n)," ")},et=function(e,t,n){var a=t.x-e.x,o=t.y-e.y,i=Math.sqrt(a*a+o*o);return tt(e,t,Math.min(1,n/i))},tt=function(e,t,n){return{x:e.x+(t.x-e.x)*n,y:e.y+(t.y-e.y)*n}},nt=function(e){var t,n,o,i=e.link,c=e.diagramEngine,r=Object(j.useState)(!1),s=Object(_.a)(r,2),l=s[0],u=s[1],d=Object(P.h)(oe),g=Object(P.h)(ie),f=Object(P.h)(ce),b=Object(P.h)(re),O=Object(j.useRef)([]),h=f.includes(null===(t=i.getSourcePort())||void 0===t?void 0:t.getNode().getID()),v=f.includes(null===(n=i.getTargetPort())||void 0===n?void 0:n.getNode().getID()),m=l||g.includes(i.getID())||h||v?a.selected:b.length>0?a.unfocused:a.normal,y=h||(null===(o=i.getSourcePort())||void 0===o?void 0:o.getNode().getID())===d;Object(j.useEffect)((function(){return O.current&&i.setRenderedPaths(O.current.map((function(e){return e.current})).filter(M.isPresent)),function(){return i.setRenderedPaths([])}}));var x=Object(j.useCallback)((function(e){u(e)}),[]),k=i.getPoints();if(k.length<=1)return i.setRenderedPaths([]),Object(se.jsx)("g",{});var C=i.getID(),I=i.getOptions(),N=k.map((function(e){return{x:e.getX(),y:e.getY()}})),S=N.length-1,w=N[S];N[S]=function(e,t,n){var a=t.x,o=t.y,i=e.x,c=e.y,r=i-a,s=c-o;if(Math.abs(s)<1e-4)return{x:i-n*Math.sign(r),y:c};if(Math.abs(r)<1e-4)return{x:i,y:c-n*Math.sign(s)};var l=Math.sqrt(r*r+s*s)-n,u=Math.atan2(s,r);return{x:a+l*Math.cos(u),y:o+l*Math.sin(u)}}(N[S],N[S-1],8);var L=function(e){for(var t=[],n=e.length-1,a=e[0],o="",i=1;i<n;i++){o=Ke(a);var c,r,s=e[i],l=e[i+1];c=et(s,a,5),r=et(s,l,5),o+=Qe(c);var u=tt(c,s,.5),d=tt(s,r,.5);o+=$e(u,d,r),a=r,t.push(o)}return o=Ke(a),o+=Qe(e[n]),t.push(o),t}(N);return O.current=L.map((function(){return p.a.createRef()})),Object(se.jsxs)("g",{"data-default-link-test":I.testName,children:[L.map((function(e,t){return Object(se.jsx)(Ue,{path:e,diagramEngine:c,factory:c.getFactoryForLink(i),link:i,linkStatus:m,isOutgoing:y,forwardRef:O.current[t],onSelection:x,extras:{"data-linkid":C}},"link-".concat(t))})),Object(se.jsx)(_e,{linkId:C,point:w,previousPoint:N[S-1],selectedColor:y?I.selectedOutgoingColor:I.selectedColor,color:I.color,linkStatus:m},"link-arrowhead")]})},at=function(e){Object(R.a)(n,e);var t=Object(A.a)(n);function n(){return Object(T.a)(this,n),t.call(this,"contextTypeLink")}return Object(D.a)(n,[{key:"generateModel",value:function(){return new Je.a}},{key:"generateReactWidget",value:function(e){return Object(se.jsx)(nt,{link:e.model,diagramEngine:this.engine})}}]),n}(h.DefaultLinkFactory),ot=n(0),it=n(19),ct=n(8),rt=n.n(ct),st=n(1061),lt=n(2807),ut=n.n(lt),dt=(n(549),function(e){if(e){for(var t={},n=0,a=Object.entries(e);n<a.length;n++){var o=Object(_.a)(a[n],2),i=o[0],c=o[1];switch("org.eclipse.".concat(i)){case"org.eclipse.elk.contentAlignment":case"org.eclipse.elk.nodeSize.constraints":case"org.eclipse.elk.nodeSize.options":case"org.eclipse.elk.portLabels.placement":case"org.eclipse.elk.layered.wrapping.cutting.cuts":case"org.eclipse.elk.layered.wrapping.validify.forbiddenIndices":case"org.eclipse.elk.nodeLabels.placement":if(Array.isArray(c)){t[i]=c.map((function(e){return""+e})).join(" ");break}t[i]=c;break;default:t[i]=c}}return t}}),gt=function(e){return e instanceof Ae.a},ft=function(e,t){return new st.PointModel({link:t,position:new I.Point(e.x,e.y)})},bt=function(){function e(t){Object(T.a)(this,e),this.options=void 0,this.options=t}return Object(D.a)(e,[{key:"redistribute",value:function(){var e=Object(it.a)(rt.a.mark((function e(t){var n,a,o,i,c,r,s,l,u,d,g,f,b,j,p,O,h,v=this;return rt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return m={algorithms:[this.options.algorithm],defaultLayoutOptions:dt(this.options.layoutOptions)},n=new ut.a(m),a={},o=Object(S.C)((function(e){return e.instanceId}),t.getNodes().filter(gt)).map((function(e){var t,n,a=null===(t=(n=v.options).nodeLayoutOptions)||void 0===t?void 0:t.call(n,e);return{id:e.getID(),width:e.width,height:e.height,layoutOptions:dt(a),ports:Object.values(e.getPorts()).map((function(t){return{id:t.getID(),height:t.height,width:t.width,x:t.getX()-e.getX(),y:t.getY()-e.getY()}}))}})),i=Object(S.C)((function(e){return e instanceof Je.a?e.getInstanceId():"edge"}),t.getLinks().filter((function(e){return e.getSourcePort()&&e.getTargetPort()}))).map((function(e){var t,n;a[e.getID()]=!0;var o=null===(t=(n=v.options).linkLayoutOptions)||void 0===t?void 0:t.call(n,e);return{id:e.getID(),sources:[e.getSourcePort().getID()],targets:[e.getTargetPort().getID()],sections:[],layoutOptions:dt(o)}})),e.next=6,n.layout({id:"root",children:o,edges:i});case 6:c=e.sent,r=Object(ot.a)(c.children);try{for(r.s();!(s=r.n()).done;)l=s.value,t.getNode(l.id).setPosition(l.x,l.y)}catch(y){r.e(y)}finally{r.f()}if(this.options.includeLinks&&c.edges){u=Object(ot.a)(c.edges);try{for(u.s();!(d=u.n()).done;){if(g=d.value,f=t.getLink(g.id),b=g.sections[0],j=[ft(b.startPoint,f)],b.bendPoints){p=Object(ot.a)(b.bendPoints);try{for(p.s();!(O=p.n()).done;)h=O.value,j.push(ft(h,f))}catch(y){p.e(y)}finally{p.f()}}f.setPoints(j.concat(ft(b.endPoint,f)))}}catch(y){u.e(y)}finally{u.f()}}case 10:case"end":return e.stop()}var m}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();var jt=n(2906),pt=n(867),Ot=n(2041),ht=n(660),vt=n.n(ht),mt=n(1970),yt=["nodes","onNodeSelected"],xt=Object(z.a)((function(e){return Object(E.a)({root:{position:"relative"},editorContainer:{position:"absolute",top:5,right:e.spacing(7),backgroundColor:e.palette.background.paper},button:{color:e.palette.text.secondary,backgroundColor:e.palette.background.paper,"&:hover":{backgroundColor:Object(G.e)(e.palette.background.paper,.15)}}})})),kt=function(e,t){return t.filter((function(t){return t instanceof e}))},Ct=n(147),It=function(e){var t,n={},a=Object(g.a)(e.getNodes());try{for(a.s();!(t=a.n()).done;){var o=t.value,i=1;o instanceof ke.a?i=0:(o instanceof Ee.a||o instanceof He.a)&&"final"===o.taggingType?i=1e4:o instanceof Ee.a?i=2:o instanceof He.a?i=3:o instanceof ye.a&&(i=4),n[o.getID()]=i}}catch(h){a.e(h)}finally{a.f()}for(var c=Object(S.r)((function(e){return e.map((function(e){return e.getSourcePort().getNode()}))}),Object(S.j)((function(e){return e.getTargetPort().getNode().getID()}),e.getLinks().filter((function(e){return n[e.getSourcePort().getNode().getID()]<1e4})))),r=function(e){var t,n=Object(S.r)((function(e){return e.map((function(e){return e.getTargetPort().getNode()}))}),Object(S.j)((function(e){return e.getSourcePort().getNode().getID()}),e.getLinks())),a=[],o=[],i=function(e){var t=a.indexOf(e);return-1===t&&(t=a.length,a.push(e),o.push([])),t},c=Object(g.a)(kt(ye.a,e.getNodes()));try{var r=function(){var e=t.value,a=i(e);Object(Ct.a)(e,{getNeighbors:function(t){var a;return t instanceof ye.a&&t!==e?[]:null!==(a=n[t.getID()])&&void 0!==a?a:[]},enterVertex:function(e){var t=e.currentVertex;t instanceof ye.a&&o[a].push(i(t))}})};for(c.s();!(t=c.n()).done;)r()}catch(h){c.e(h)}finally{c.f()}for(var s=Object(Ct.c)(o),l=s.components,u=s.adjacencyList,f=[],b=Object(S.c)(u),j=!0;j;){j=!1;for(var p=[],O=[],v=0;v<b.length;v++){var m=b[v];m&&0===m.length&&(O.push(v),b[v]=void 0,p.push.apply(p,Object(d.a)(l[v].map((function(e){return a[e]})))))}var y,x=Object(g.a)(b.filter(M.isPresent));try{for(x.s();!(y=x.n()).done;){var k,C=y.value,I=Object(g.a)(O);try{for(I.s();!(k=I.n()).done;){var N=k.value,P=C.indexOf(N);P>-1&&C.splice(P,1)}}catch(h){I.e(h)}finally{I.f()}}}catch(h){x.e(h)}finally{x.f()}p.length>0&&(f.unshift(p),j=!0)}return f}(e),s=0;s<r.length;s++){var l,u=Object(g.a)(r[s]);try{for(u.s();!(l=u.n()).done;){var f=l.value;n[f.getID()]=10*s+4}}catch(h){u.e(h)}finally{u.f()}}var b=function(t){var a,o=0,i=Object(g.a)(kt(Ee.a,e.getNodes()).filter((function(e){return n[e.getID()]===t+2})));try{for(i.s();!(a=i.n()).done;){var r=a.value,s=c[r.getID()];s&&s.some((function(e){return n[e.getID()]>t+2}))&&(n[r.getID()]=t+12,o++)}}catch(h){i.e(h)}finally{i.f()}for(var l=!0;l;){l=!1;var u,d=Object(g.a)(kt(He.a,e.getNodes()).filter((function(e){return n[e.getID()]===t+3})));try{for(d.s();!(u=d.n()).done;){var f=u.value,b=c[f.getID()];b&&b.some((function(e){return n[e.getID()]>t+3}))&&(n[f.getID()]=t+13,l=!0,o++)}}catch(h){d.e(h)}finally{d.f()}}return o},j=0,p=Number.MAX_VALUE,O=0;do{j=p,p=b(O),O+=10}while(p>0&&p<j);return n},Nt=function(){var e=Object(u.a)(b.a.mark((function e(t){var n,a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={},a=new bt({algorithm:"layered",layoutOptions:{"elk.alignment":"LEFT","elk.partitioning.activate":!0,"elk.layered.feedbackEdges":!0,"elk.portConstraints":"FIXED_POS","elk.separateConnectedComponents":!1,"elk.interactiveLayout":!0,"elk.layered.spacing.nodeNodeBetweenLayers":60,"elk.spacing.edgeEdge":20,"elk.spacing.edgeNode":20,"elk.spacing.nodeNode":20,"elk.layered.spacing.edgeEdgeBetweenLayers":20,"elk.layered.spacing.edgeNodeBetweenLayers":20,"elk.edgeRouting":"ORTHOGONAL","elk.layered.layering.strategy":"INTERACTIVE"},nodeLayoutOptions:function(e){var a;0===Object.keys(n).length&&(n=It(t));var o={"elk.partitioning.partition":null!==(a=n[e.getID()])&&void 0!==a?a:1};return delete n[e.getID()],o},includeLinks:!0}),e.next=4,a.redistribute(t);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Pt=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(){var e;return Object(r.a)(this,n),(e=t.call(this)).childStates=[],e}return Object(c.a)(n)}(h.DefaultDiagramState),St=function(e,t){var n=e.getModel(),a={x:0,y:0,zoom:0},o=Object(i.a)({offsetX:[n.getOffsetX(),n.getOffsetX()],offsetY:[n.getOffsetY(),n.getOffsetY()],zoomLevel:[n.getZoomLevel(),n.getZoomLevel()]},t);N.a.fromTo(a,{x:o.offsetX[0],y:o.offsetY[0],zoom:o.zoomLevel[0]},{x:o.offsetX[1],y:o.offsetY[1],zoom:o.zoomLevel[1],duration:.5,ease:"power2",onUpdate:function(){n.setZoomLevel(a.zoom),n.setOffset(a.x,a.y),e.repaintCanvas()}})},wt=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:20,a=e.getTopLeft(),o=t.getTopLeft(),i=e.getBottomRight(),c=t.getBottomRight(),r=new I.Point(Math.min(a.x,o.x)-n,Math.min(a.y,o.y)-n),s=new I.Point(Math.max(i.x,c.x)+n,Math.max(i.y,c.y)+n),l=s.x-r.x,u=s.y-r.y;return new I.Rectangle(r,l,u)},Mt=Object(O.a)("div")({height:"100%",width:"100%"}),Lt=Object(O.a)(m.CanvasWidget)({height:"100%",minHeight:"250px"}),Tt=Object(O.a)(C.a)((function(e){var t=e.theme;return{position:"absolute",bottom:t.spacing(2),left:t.spacing(2),color:t.palette.text.secondary,backgroundColor:t.palette.background.default}})),Dt=Object(O.a)((function(e){var t=e.nodes,n=e.onNodeSelected,a=Object(te.a)(e,yt),o=Object(w.a)().t,i=xt(),c=Object(j.useState)(!1),r=Object(_.a)(c,2),s=r[0],l=r[1],u=Object(j.useMemo)((function(){return Object(S.C)((function(e){return"".concat(o(e.getType()),":").concat(e.title)}),t)}),[t,o]),d=Object(j.useCallback)((function(){l(!0)}),[]),g=Object(j.useCallback)((function(){l(!1)}),[]),f=Object(j.useCallback)((function(e,t){t&&(null===n||void 0===n||n(t),l(!1))}),[n]);return Object(se.jsx)(jt.a,{mouseEvent:"onMouseDown",touchEvent:"onTouchStart",onClickAway:g,children:Object(se.jsx)("div",Object(L.a)(Object(L.a)({},a),{},{children:Object(se.jsxs)("div",{className:i.root,children:[Object(se.jsx)(C.a,{className:i.button,onClick:d,size:"medium",children:Object(se.jsx)(vt.a,{})}),Object(se.jsx)("div",{className:i.editorContainer,children:Object(se.jsx)(mt.Transition,{items:s,from:{width:0,opacity:0},enter:{width:300,opacity:1},leave:{width:0,opacity:0},reverse:s,children:function(e,t){return t&&Object(se.jsx)(mt.animated.div,{style:e,children:Object(se.jsx)(pt.a,{options:u,getOptionLabel:function(e){return e.title},size:"small",groupBy:function(e){return o(e.getType())},onChange:f,renderInput:function(e){return Object(se.jsx)(Ot.a,Object(L.a)(Object(L.a)({},e),{},{autoFocus:!0,variant:"outlined"}))}})})}})})]})}))})}))((function(e){var t=e.theme;return{position:"absolute",top:t.spacing(2),right:t.spacing(2)}})),Rt=function(e){var t=e.actionTypes,n=e.taskTypes,a=e.selectors,i=e.taggings,c=e.initialActions,r=e.statesIncluded,s=e.visibleElementTypes,l=e.onNodeSelectionChanged,u=e.onNodeHighlighted,g=e.onActionTypeCommandInvoked,f=e.onStateCommandInvoked,b=e.onSelectorCommandInvoked,p=e.onTaskTypeCommandInvoked,O=e.onResponseTypeCommandInvoked,m=e.onSelectionChanged,x=e.onPinStatusesChanged,C=Object(w.a)().t,N=Object(j.useRef)(null),M=Object(P.i)(ce),L=Object(P.i)(re),T=Object(j.useMemo)((function(){return new Re.a({locked:!0})}),[]),D=Object(j.useMemo)((function(){var e=function(){var e=v()(),t=e.getNodeFactories();return t.registerFactory(new De),t.registerFactory(new xe),t.registerFactory(new Be),t.registerFactory(new qe),e.getLinkFactories().registerFactory(new at),e.getStateMachine().pushState(new Pt),e}();return e.setModel(T),e}),[T]);Object(j.useEffect)((function(){L([])}),[L]);var R=Object(j.useCallback)((function(){var e;e=function(e){setTimeout((function(){var e=N.current;Nt(T).finally((function(){e&&(e.style.visibility="visible"),D.repaintCanvas()}))}),e?100:0)},"hidden"===document.visibilityState?document.addEventListener("visibilitychange",(function t(n){"visible"===document.visibilityState&&(document.removeEventListener("visibilitychange",t),e(!0))})):e(!1)}),[D,T]);Object(j.useEffect)((function(){var e=N.current;if(e){var o=T.pinStatuses,l=T.updateData(t,n,a,i,c,r,s);o!==T.pinStatuses&&(null===x||void 0===x||x(T.pinStatuses)),l&&(e.style.visibility="hidden"),D.repaintCanvas(!0).then((function(){R()}))}}),[t,D,c,i,T,a,n,R,s,r,x]),Object(j.useEffect)((function(){var e={nodeSelectionChanged:function(e){null===l||void 0===l||l(e.node,e.isSelected);var t=T.getSelectedEntities().filter((function(e){return e instanceof h.NodeModel}));null===m||void 0===m||m(t),M(t.map((function(e){return e.getID()}))),e.isSelected||L([])},contextTypeNodeCommandInvoked:function(e){var t=e.command,n=e.node;if("focusNode"===t.type){var a=function(e){var t=Object(S.I)(Object.values(e.getPorts()).flatMap((function(e){return Object.values(e.getLinks())})));return[Object(S.I)(t.flatMap((function(t){var n=t.getSourcePort().getNode(),a=t.getTargetPort().getNode();return n===e?a:n}))),t]}(n),i=Object(o.a)(a,2),c=i[0];!function(e,t,n,a){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:20,i=a.getModel(),c=a.getCanvas(),r=a.getBoundingNodesRect([e].concat(Object(d.a)(t))),s=I.Polygon.boundingBoxFromPoints(n.flatMap((function(e){return e.getPoints()})).map((function(e){return e.getPosition()}))),l=wt(r,s,o),u=c.getBoundingClientRect(),g={x:u.left,y:u.top},f={x:g.x+i.getOffsetX(),y:g.y+i.getOffsetY()},b=c.clientWidth/l.getWidth(),j=c.clientHeight/l.getHeight(),p=Math.min(b<j?b:j,1),O=l.getTopLeft(),h={x:f.x+O.x*p,y:f.y+O.y*p},v=i.getOffsetX()+g.x-h.x,m=i.getOffsetY()+g.y-h.y;St(a,{offsetX:[i.getOffsetX(),v],offsetY:[i.getOffsetY(),m],zoomLevel:[i.getZoomLevel(),100*p]})}(n,c,i[1],D),c.unshift(n),L(c.map((function(e){return e.getID()}))),null===u||void 0===u||u(n)}if(n instanceof ke.a)null===g||void 0===g||g(n.instance,t);else if(n instanceof Ee.a)null===f||void 0===f||f(n.instance,t);else if(n instanceof He.a)null===b||void 0===b||b(n.instance,t);else if(n instanceof ye.a)if(Object(Ae.b)(t)){var r=n.instance.validResponses.find((function(e){return e.name===t.responseName}));r&&(null===O||void 0===O||O(r,n.instance,t))}else null===p||void 0===p||p(n.instance,t)}},t=T.registerListener(e);return function(){T.deregisterListener(t)}}),[D,T,g,u,l,O,m,b,f,p,L,M]);var A=Object(j.useState)(),E=Object(o.a)(A,2)[1],z=Object(j.useCallback)((function(e){var t=D.getMouseElement(e);t&&E(t)}),[D]),F=Object(j.useCallback)((function(e){!function(e,t){var n=t.getModel();n.clearSelection(),e.setSelected(!0);var a=t.getCanvas().getBoundingClientRect(),o=a.width,i=a.height,c=-n.getOffsetX(),r=-n.getOffsetX()+o,s=-n.getOffsetY(),l=-n.getOffsetY()+i,u=n.getZoomLevel()/100,d=e.getPosition(),g=d.x,f=d.y;f*=u;var b=(g*=u)+e.width*u,j=f+e.height*u,p=n.getOffsetX(),O=n.getOffsetY();b>r?p=-b-40+o:g<c&&(p=40-g),j>l?O=-j-40+i:f<s&&(O=40-f),n.getOffsetX()===p&&n.getOffsetY()===O||St(t,{offsetX:[n.getOffsetX(),p],offsetY:[n.getOffsetY(),O]})}(e,D)}),[D]);return Object(se.jsxs)(se.Fragment,{children:[Object(se.jsx)(Mt,{ref:N,onMouseOver:z,children:Object(se.jsx)(Lt,{engine:D})}),Object(se.jsx)(Dt,{nodes:D.getModel().getNodes(),onNodeSelected:F}),Object(se.jsx)(y.a,{title:C("PerformLayout"),children:Object(se.jsx)(Tt,{onClick:R,size:"small",children:Object(se.jsx)(k.a,{fontSize:"small"})})})]})};t.default=Rt}}]);
//# sourceMappingURL=85.4dae4808.chunk.js.map