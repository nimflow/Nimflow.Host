(this["webpackJsonpnimflow-studio"]=this["webpackJsonpnimflow-studio"]||[]).push([[18],{1960:function(e,t,n){"use strict";n.r(t),n.d(t,"JsonSchemaEditorModal",(function(){return E}));var a=n(485),r=n(464),c=n(484),i=n.n(c),o=n(5),s=n(480),u=n(2986),l=n(2618),b=n(2923),j=n(3018),d=n(3017),O=n(2929),h=n(2550),f=n(3006),p=n(2425),m=n(9),x=n(132),v=n(907),g=n(1509),C=n(128),S=Object(u.a)((function(e){return Object(l.a)({dialogPaper:{height:"80vh"}})})),k=m.m().jsonSchema(),y=function(e){return Object(x.b)(k,e)},w=Object(s.a)(d.a,{shouldForwardProp:function(e){return"showErrors"!==e}})((function(e){return{display:"grid",gridTemplateColumns:"auto",gridTemplateRows:e.showErrors?"auto ".concat(100,"px"):"auto",rowGap:"5px",placeItems:"stretch",height:"100%",overflowY:"hidden"}})),J=Object(s.a)("div")({gridColumn:"1 / 2",gridRow:"1 / 2"}),V=Object(s.a)("div")({gridColumn:"1 / 2",gridRow:"2 / 3",overflowY:"auto"}),E=function(e){var t=e.open,n=e.defaultValue,c=e.onChange,s=e.onClose,u=e.title,l=e.extraJsonSchemas,d=e.validator,m=e.mainMetaSchema,x=Object(f.a)().t,k=Object(v.a)(),E=Object(o.useState)([]),N=Object(r.a)(E,2),M=N[0],T=N[1],A=S(),D=Object(o.useMemo)((function(){return n?n.includes("\n")?n:JSON.stringify(JSON.parse(n),void 0,2):'{\n    "type": "object",\n    "definitions": {\n\n    }\n}'}),[n]),P=Object(o.useState)(D),F=Object(r.a)(P,2),I=F[0],R=F[1],W=Object(o.useCallback)(Object(a.a)(i.a.mark((function e(){var t,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=null!==d&&void 0!==d?d:y,e.next=3,t(null!==I&&void 0!==I?I:"");case 3:(n=e.sent).length>0?T(n.map((function(e){return e.message}))):(null===c||void 0===c||c(I),s());case 5:case"end":return e.stop()}}),e)}))),[I,c,s,d]),L=Object(o.useCallback)(Object(a.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=D!==I,!e.t0){e.next=5;break}return e.next=4,k();case 4:e.t0=!e.sent;case 5:if(!e.t0){e.next=7;break}return e.abrupt("return");case 7:s();case 8:case"end":return e.stop()}}),e)}))),[I,D,k,s]),Y=Object(o.useCallback)(function(){var e=Object(a.a)(i.a.mark((function e(t,n){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=D!==I,!e.t0){e.next=5;break}return e.next=4,k();case 4:e.t0=!e.sent;case 5:if(!e.t0){e.next=7;break}return e.abrupt("return");case 7:"backdropClick"!==n&&(null===s||void 0===s||s());case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),[I,D,k,s]);return Object(C.jsxs)(b.a,{open:t,onClose:Y,maxWidth:"xl",fullWidth:!0,classes:{paper:A.dialogPaper},children:[Object(C.jsx)(O.a,{children:null!==u&&void 0!==u?u:x("EditingJsonSchema")}),Object(C.jsxs)(w,{showErrors:M.length>0,children:[Object(C.jsx)(J,{children:Object(C.jsx)(g.a,{value:I,onChange:R,extraJsonSchemas:l,mainMetaSchema:m})}),M.length>0&&Object(C.jsx)(V,{children:Object(C.jsx)(p.a,{component:"span",error:!0,children:M.map((function(e,t){return Object(C.jsx)("p",{children:e},t)}))})})]}),Object(C.jsxs)(j.a,{children:[Object(C.jsx)(h.a,{onClick:W,color:"primary",children:x("Accept")}),Object(C.jsx)(h.a,{onClick:L,color:"primary",children:x("Cancel")})]})]})};t.default=E},2848:function(e,t,n){"use strict";n.r(t),n.d(t,"ActionTypeEditorDialog",(function(){return de})),n.d(t,"useActionTypeEditorDialog",(function(){return Oe}));var a=n(485),r=n(25),c=n(130),i=n(464),o=n(484),s=n.n(o),u=n(5),l=n(2618),b=n(2986),j=n(2550),d=n(2923),O=n(3018),h=n(3017),f=n(2929),p=n(9),m=n(862),x=n(1506),v=n(17),g=n(3006),C=n(1608),S=n(924),k=n(2422),y=n(2999),w=n(2540),J=n(1996),V=n(2381),E=n(1507),N=n(132),M=n(1876),T=n(1303),A=n(908),D=n(128),P=Object(b.a)((function(e){return Object(l.a)({textField:{width:"40ch"}})})),F=S.a.key,I=S.a.value,R=[M.a.state,M.a.payload],W={Container:function(e){return Object(D.jsx)("div",Object(r.a)({},e))}},L=function(e){var t=e.path,n=e.defaultValue,a=Object(m.f)().errors,r=P(),o=Object(E.b)().jsCommon,s=Object(A.c)({voteIdPrefix:"ActionTypeSettersEditor"}),l=Object(u.useCallback)((function(e){return Object(N.b)(I,e,{context:Object(c.a)({},S.l,o)})}),[o]),b=Object(u.useMemo)((function(){return[{title:v.a.t("Key"),width:"20ch"},{title:v.a.t("Expression"),width:"40ch",editComponent:function(e){var t=e.value,n=e.onChange,a=e.errorMessage;return Object(D.jsx)(J.a,{defaultValue:t,onChange:n,className:r.textField,error:!!a,helperText:a,validator:l,freeVariables:R})}}]}),[r.textField,l]),j=Object(i.a)(b,2),d=j[0],O=j[1],h=Object(u.useCallback)((function(e){s(!e)}),[s]);return Object(D.jsxs)(D.Fragment,{children:[Object(D.jsx)(V.a,{path:t,defaultValue:n,keyColumn:d,keySchema:F,valueColumn:O,valueSchema:I,title:" ",components:W,onEditionStateChanged:h}),Object(D.jsx)(T.a,{errors:a,names:t})]})},Y=n(1980),B=n(1552),G=n(480),U=n(2425),q=n(14),K=n(907),z=n(1858),H=Object(b.a)((function(e){return Object(l.a)({dialogPaper:{height:"90vh"}})})),Q=Object(G.a)(h.a)({display:"grid",gridTemplateColumns:"auto",gridTemplateRows:"auto",rowGap:"5px",height:"100%",overflowY:"hidden"}),X=Object(G.a)("div")({gridColumn:"1 / 2",gridRow:"1 / 99",alignSelf:"stretch"}),Z=Object(G.a)("div")({gridColumn:"1 / 2",gridRow:"99 / 100",overflowY:"auto"}),$=p.m().uiSchema(S.m),_=function(e){var t=e.open,n=e.defaultValue,r=e.jsonSchema,o=e.uiSchemaLibrary,l=e.validator,b=e.onChange,h=e.onClose,p=Object(g.a)().t,m=H(),x=Object(K.a)(),v=Object(u.useState)(),C=Object(i.a)(v,2),k=C[0],y=C[1],w=Object(u.useMemo)((function(){return n?n.includes("\n")?n:JSON.stringify(JSON.parse(n),void 0,2):""}),[n]),J=Object(u.useState)(w),V=Object(i.a)(J,2),E=V[0],M=V[1],T=Object(u.useMemo)((function(){return null!==l&&void 0!==l?l:function(e){return Object(N.b)($,e,{context:Object(c.a)({},S.m,r)})}}),[l,r]),A=Object(u.useCallback)(Object(a.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(E&&0!==E.trim().length){e.next=4;break}return null===b||void 0===b||b(void 0),h(),e.abrupt("return");case 4:return e.t0=q.k,e.next=7,T(E);case 7:if(e.t1=e.sent,!(t=(0,e.t0)(e.t1))){e.next=12;break}return y(t.message),e.abrupt("return");case 12:null===b||void 0===b||b(E),h();case 14:case"end":return e.stop()}}),e)}))),[E,T,b,h]),P=Object(u.useCallback)(Object(a.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=w!==E,!e.t0){e.next=5;break}return e.next=4,x();case 4:e.t0=!e.sent;case 5:if(!e.t0){e.next=7;break}return e.abrupt("return");case 7:h();case 8:case"end":return e.stop()}}),e)}))),[E,w,x,h]),F=Object(u.useCallback)(function(){var e=Object(a.a)(s.a.mark((function e(t,n){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=w!==E,!e.t0){e.next=5;break}return e.next=4,x();case 4:e.t0=!e.sent;case 5:if(!e.t0){e.next=7;break}return e.abrupt("return");case 7:"backdropClick"!==n&&(null===h||void 0===h||h());case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),[E,w,x,h]);return Object(D.jsxs)(d.a,{open:t,onClose:F,maxWidth:"xl",fullWidth:!0,classes:{paper:m.dialogPaper},children:[Object(D.jsx)(f.a,{children:p("EditingUiSchema")}),Object(D.jsxs)(Q,{children:[Object(D.jsx)(X,{children:Object(D.jsx)(z.a,{value:E,onChange:M,uiSchemaLibrary:o})}),Object(D.jsx)(Z,{children:Object(D.jsx)(U.a,{component:"span",error:!0,children:k})})]}),Object(D.jsxs)(O.a,{children:[Object(D.jsx)(j.a,{onClick:A,color:"primary",children:p("Accept")}),Object(D.jsx)(j.a,{onClick:P,color:"primary",children:p("Cancel")})]})]})},ee=n(576),te=n(2543),ne=n(683),ae=n(1960),re=n(629),ce=n(2215),ie=n(166),oe=n(1267),se=Object(b.a)((function(e){return Object(l.a)({textField:{width:"40ch"},actionButton:{marginRight:e.spacing(1)}})})),ue=function(){var e=Object(a.a)(s.a.mark((function e(t,n){var a,c,i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,a=JSON.parse(t),e.next=7;break;case 4:return e.prev=4,e.t0=e.catch(0),e.abrupt("return",[{message:e.t0 instanceof Error?e.t0.toString():""}]);case 7:return c=Object(r.a)(Object(r.a)({},n),a),e.next=10,Object(N.b)(p.k().jsonSchema(),c);case 10:return i=e.sent,e.abrupt("return",i);case 12:case"end":return e.stop()}}),e,null,[[0,4]])})));return function(t,n){return e.apply(this,arguments)}}(),le=function(e){var t,n=e.definitionJsonSchema,c=e.onDefinitionJsonSchemaChange,o=Object(m.f)(),l=o.control,b=o.errors,d=o.getValues,O=o.setValue,h=o.register,f=Object(g.a)().t,p=se(),x=Object(E.b)(),v=x.jsonSchema,C=x.uiSchemaCommon,S=Object(u.useState)(!1),J=Object(i.a)(S,2),V=J[0],N=J[1],M=Object(u.useState)(!1),T=Object(i.a)(M,2),A=T[0],P=T[1],F=d("payloadSchemaDefinitionName"),I=Object(re.a)();Object(u.useEffect)((function(){h("settings")}),[h]);var R=Object(u.useCallback)((function(){N(!0)}),[N]),W=Object(u.useCallback)((function(e){var t=!e;if(!t&&e)try{var n=JSON.parse(e);t=!n||"object"===typeof n&&0===Object.keys(n).length}catch(r){return void I(f("InvalidJsonSchema"),r)}var a=d("payloadSchemaDefinitionName");!a&&t||(a||(a=Object(ee.w)(d("name"))),null===c||void 0===c||c(t?void 0:e,a))}),[d,c,I,f]),G=Object(u.useCallback)((function(){P(!0)}),[P]),U=Object(u.useMemo)((function(){if(F&&v)return n?Object(r.a)(Object(r.a)({},v),JSON.parse(n)):v}),[n,F,v]),q=Object(u.useMemo)((function(){return e=U,{payload:function(){var t=Object(a.a)(s.a.mark((function t(){var n,a;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=2;break}return t.abrupt("return","declare const payload: any;");case 2:return t.next=4,Object(ie.a)(e);case 4:return n=t.sent,t.next=7,Object(te.b)(n,"PayloadType",{ignoreMinAndMaxItems:!0});case 7:return a=t.sent,t.abrupt("return",a+"\n\ndeclare const payload: PayloadType;");case 9:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()};var e}),[U]),K=Object(u.useCallback)(function(){var e=Object(a.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ue(t,v));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[v]);return Object(D.jsxs)(ne.a,{freeVariableTypingProviders:q,children:[Object(D.jsxs)(y.a,{container:!0,spacing:3,children:[Object(D.jsxs)(y.a,{item:!0,xs:6,children:[Object(D.jsx)(m.a,{as:k.a,control:l,name:"name",label:f("Name"),className:p.textField,autoFocus:!0,InputLabelProps:{required:!0},variant:"standard",error:!!b.name,helperText:null===(t=b.name)||void 0===t?void 0:t.message}),Object(D.jsx)("input",{type:"hidden",name:"payloadSchemaDefinitionName",ref:h({setValueAs:function(e){return e||void 0}})})]}),Object(D.jsx)(y.a,{item:!0,xs:6,children:Object(D.jsxs)(y.a,{container:!0,direction:"row",justifyContent:"flex-end",children:[Object(D.jsx)(j.a,{className:p.actionButton,variant:"outlined",color:"inherit",onClick:R,startIcon:Object(D.jsx)(B.a,{}),children:f("EditJsonSchema")}),!!F&&Object(D.jsx)(j.a,{className:p.actionButton,variant:"outlined",color:"inherit",onClick:G,startIcon:Object(D.jsx)(Y.a,{}),children:f("EditUiSchema")})]})}),Object(D.jsx)(y.a,{item:!0,xs:12,children:Object(D.jsxs)(oe.b,{children:[Object(D.jsx)(oe.a,{label:f("Setters"),hasErrors:!!b.jsSetters,children:Object(D.jsx)(L,{path:"jsSetters"})}),Object(D.jsx)(oe.a,{label:f("Validators"),hasErrors:!!b.validators,children:Object(D.jsx)(w.a,{path:"validators"})})]})})]}),V&&Object(D.jsx)(ae.JsonSchemaEditorModal,{open:V,onClose:function(){return N(!1)},defaultValue:null!==n&&void 0!==n?n:ce.b,onChange:W,validator:K}),A&&Object(D.jsx)(_,{open:A,onClose:function(){return P(!1)},defaultValue:function(){var e=d("settings");return null===e||void 0===e?void 0:e.uiSchema}(),jsonSchema:U,uiSchemaLibrary:C,onChange:function(e){return function(e){var t,n=null!==(t=d("settings"))&&void 0!==t?t:{};O("settings",Object(r.a)(Object(r.a)({},n),{},{uiSchema:e}))}(null!==e&&void 0!==e?e:void 0)}})]})},be=n(1301),je=Object(b.a)((function(e){return Object(l.a)({paper:{backgroundColor:e.palette.background.default}})})),de=function(e){var t,n=e.open,a=e.defaultValue,o=e.definitionJsonSchema,s=e.onChange,l=e.onClose,b=je(),k=Object(m.f)(),y=Object(u.useMemo)((function(){var e,t,n=null===(e=k.getValues().actions)||void 0===e?void 0:e.map((function(e){return e.name})).filter((function(e){return e!==(null===a||void 0===a?void 0:a.name)}));return(t=n)?S.b.shape({name:S.b.fields.name.concat(p.m().defined().test({message:function(e){var t=e.value;return v.a.t("ActionTypeNameAlreadyExists",{name:t})},test:function(e){return!t.includes(e)}})),payloadSchemaDefinitionName:p.m()}):S.b}),[k,a]),w=Object(u.useState)(""),J=Object(i.a)(w,2),V=J[0],E=J[1],N=Object(u.useState)(o),M=Object(i.a)(N,2),P=M[0],F=M[1],I=Object(m.e)({mode:"onChange",reValidateMode:"onChange",defaultValues:null!==a&&void 0!==a?a:{},context:(t={},Object(c.a)(t,S.l,k.getValues("jsCommon")),Object(c.a)(t,S.m,(function(){var e=k.getValues("jsonSchema"),t=JSON.parse(null!==e&&void 0!==e?e:ce.a);return P!==o&&(P?t.definitions[V]=JSON.parse(P):delete t.definitions[V]),t})),t),resolver:Object(x.a)(y,{strict:!0,abortEarly:!1})}),R=I.control,W=I.handleSubmit,L=I.errors,Y=I.getValues,B=I.setValue,G=Object(g.a)().t,U=Object(A.b)(),q=Object(u.useCallback)((function(e){null===s||void 0===s||s(e,P),null===l||void 0===l||l()}),[P,s,l]),K=Object(u.useCallback)((function(e,t){var n=e?t:void 0;Y("payloadSchemaDefinitionName")!==n&&B("payloadSchemaDefinitionName",n,{shouldDirty:!0}),F(e),E(null!==n&&void 0!==n?n:"")}),[Y,B]);return Object(D.jsxs)(d.a,{open:n,fullWidth:!0,maxWidth:"md",classes:{paper:b.paper},children:[Object(D.jsx)(m.b,Object(r.a)(Object(r.a)({},I),{},{children:Object(D.jsx)("form",{onSubmit:W(q),children:Object(D.jsxs)(A.a,Object(r.a)(Object(r.a)({},U),{},{children:[Object(D.jsx)(f.a,{children:G("EditingActionType")}),Object(D.jsxs)(h.a,{style:{minWidth:"500px"},children:[Object(D.jsx)(le,{definitionJsonSchema:P,onDefinitionJsonSchemaChange:K}),Object(D.jsx)(T.a,{errors:L})]}),Object(D.jsxs)(O.a,{children:[Object(D.jsx)(j.a,{type:"submit",color:"primary",disabled:!U.canAccept,children:G("Accept")}),Object(D.jsx)(j.a,{onClick:l,color:"primary",children:G("Cancel")})]})]}))})})),Object(D.jsx)(C.DevTool,{control:R})]})},Oe=(t.default=de,function(){var e=Object(be.a)((function(e){var t=e.open,n=e.data,a=e.onChange,r=e.onClose;return Object(D.jsx)(D.Fragment,{children:!!n&&Object(D.jsx)(de,{open:t,defaultValue:n.defaultValue,definitionJsonSchema:n.definitionJsonSchema,onChange:function(e,t){return a({value:e,definitionJsonSchema:t})},onClose:r})})})),t=Object(i.a)(e,2),n=t[0],r=t[1],c=Object(u.useCallback)(function(){var e=Object(a.a)(s.a.mark((function e(t,n){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r({defaultValue:t,definitionJsonSchema:n});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),[r]);return[n,c]})}}]);
//# sourceMappingURL=18.2b8ceebf.chunk.js.map