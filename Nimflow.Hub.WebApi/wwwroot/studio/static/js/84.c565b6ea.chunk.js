(this["webpackJsonpnimflow-studio"]=this["webpackJsonpnimflow-studio"]||[]).push([[84],{1859:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var a=n(13),o=n(3),i=n(6),c=n(2344),r=n(2997),s=n(2059),l=n(2058),u=n(2948),d=n(1880),g=n(2083),f=n(3010),b=n(2999),j=n(35),p=n(800),O=n(1025),v=n(124),h=Object(r.a)((function(e){return Object(c.a)({smallAvatar:{width:25,height:25,border:function(t){return t.displayStandalone?void 0:"2px solid ".concat(e.palette.primary.main)},color:function(t){return t.displayStandalone?e.palette.text.primary:e.palette.text.secondary},backgroundColor:function(t){return t.displayStandalone?e.palette.background.default:e.palette.background.paper}},tagging:{width:16,height:16}})})),m=function(e){var t=e.value,n=e.onChange,c=e.children,r=e.displayEmptyTagging,m=h(e),y=Object(p.usePopupState)({variant:"popover",popupId:"taggingMenu"}),x=Object(i.useCallback)((function(e){y.close(),null===n||void 0===n||n(e)}),[n,y]);return Object(v.jsxs)(v.Fragment,{children:[Object(v.jsxs)(l.a,Object(o.a)(Object(o.a)({},Object(p.bindTrigger)(y)),{},{size:"small",children:[(Object(j.isPresent)(t)||r)&&Object(v.jsx)(b.a,{overlap:"circular",anchorOrigin:{vertical:"bottom",horizontal:"right"},badgeContent:Object(v.jsx)(f.a,{className:m.smallAvatar,children:Object(v.jsx)(O.a,{taggingType:t,className:m.tagging})}),children:c}),!Object(j.isPresent)(t)&&c]})),Object(v.jsx)(d.a,Object(o.a)(Object(o.a)({},Object(p.bindMenu)(y)),{},{children:[void 0].concat(Object(a.a)(O.d)).map((function(e,t){return Object(v.jsxs)(g.a,{onClick:function(){return x(e)},children:[Object(v.jsx)(u.a,{children:Object(v.jsx)(O.a,{taggingType:e,fontSize:"small"})}),Object(v.jsx)(s.a,{variant:"inherit",children:Object(O.b)(e)})]},t)}))}))]})}},2835:function(e,t,n){"use strict";n.r(t),n.d(t,"ContextTypeDiagram",(function(){return yt}));var a,o=n(4),i=n(3),c=n(1),r=n(2),s=n(12),l=n(15),u=n(19),d=n(13),g=n(0),f=n(8),b=n.n(f),j=n(6),p=n.n(j),O=n(2344),v=n(2997),h=n(1001),m=n.n(h),y=n(709),x=n(2079),k=n(649),C=n.n(k),I=n(3041),N=n(1051),P=n(2851),S=n(135),w=n(14),M=n(3013),T=n(35),L=n(630),D=n(498),R=n.n(D),A=n(1891),E=n.n(A),z=n(487),F=n.n(z),X=n(665),Y=n.n(X),B=n(2827),H=n.n(B),W=n(2919),Z=n(2011),V=n(2012),q=n(2013),J=n(2946),U=n(98),_=n(450),G=n(1177),K=Object(S.b)({key:"hoveredContextTypeNodeModelIdState",default:void 0}),Q=Object(S.b)({key:"selectedLinkIds",default:[]}),$=Object(S.b)({key:"selectedNodeIdsState",default:[]}),ee=Object(S.b)({key:"focusedNodeIdsState",default:[]}),te=n(124),ne=["port","onPortHovering","className"],ae=Object(v.a)((function(e){return Object(O.a)({portBody:{width:function(e){var t;return null!==(t=e.portSize)&&void 0!==t?t:G.b},height:function(e){var t;return null!==(t=e.portSize)&&void 0!==t?t:G.b},background:"rgba(128, 128, 128, 1)",opacity:.3},port:{width:"100%",height:"100%"}})})),oe=function(e){var t=e.port,n=e.onPortHovering,a=e.className,o=Object(U.a)(e,ne),c=ae(e),r=Object(S.i)(Q),s=Object(j.useCallback)((function(e){null===n||void 0===n||n(t,e),r((function(n){if(!e)return[];var a=Object.keys(t.links);return n.length===a.length&&a.every((function(e){return n.includes(e)}))?n:a}))}),[n,t,r]);return Object(te.jsx)("div",{className:Object(_.default)(c.portBody,a),onMouseEnter:function(){return s(!0)},onMouseLeave:function(){return s(!1)},children:Object(te.jsx)(h.PortWidget,Object(i.a)({className:c.port,port:t},o))})},ie=Object(v.a)((function(e){return Object(O.a)({root:{position:"relative",marginTop:20,marginBottom:20,cursor:"pointer",opacity:function(e){return e.unfocused?.2:1}},cardContainer:{position:"relative"},card:{backgroundColor:function(t){return t.selected?e.palette.action.selected:e.palette.background.paper}},inPort:{top:20,left:-G.b,position:"absolute"},outPort:{top:20,right:-G.b,position:"absolute"},headerRoot:{padding:"".concat(e.spacing(1)," ").concat(e.spacing(2))},contentRoot:{padding:"".concat(e.spacing(1)," ").concat(e.spacing(1))},actions:{display:"table",position:"absolute",paddingBottom:10,zIndex:100,width:"100%",textAlign:"right"},action:{marginTop:5,marginRight:10,color:e.palette.text.secondary,backgroundColor:e.palette.background.paper,"&:hover":{backgroundColor:Object(W.e)(e.palette.background.paper,.15)}}})})),ce=function(e){var t,n=e.node,a=e.engine,i=e.onPortHovering,c=e.onPanelHovering,r=e.title,s=e.titleTypographyProps,l=e.subheader,u=e.subheaderTypographyProps,d=e.avatar,g=e.actions,f=e.children,b=Object(S.f)(K),p=Object(o.a)(b,2),O=p[0],v=p[1],h=Object(S.h)(ee),m=Object(S.i)(Q),y=O===n.getID(),k=h.includes(n.getID()),C=ie({selected:null!==(t=e.selected)&&void 0!==t&&t,unfocused:h.length>0&&!k}),N=Object(j.useCallback)((function(){null===c||void 0===c||c(!0),v(n.getID()),m((function(e){var t=Object(w.I)(Object.values(n.getPorts()).flatMap((function(e){return Object.keys(e.links)})));return e.length===t.length&&t.every((function(t){return e.includes(t)}))?e:t}))}),[c,v,n,m]),P=Object(j.useCallback)((function(){null===c||void 0===c||c(!1);var e=n.getID();v((function(t){return t===e?void 0:t})),m((function(e){return e.length>0?[]:e}))}),[c,n,v,m]),M=Object(j.useCallback)((function(){n.dispatchCommand({type:"focusNode"})}),[n]);return Object(te.jsxs)("div",{className:C.root,children:[Object(te.jsxs)("div",{onMouseEnter:N,onMouseLeave:P,className:C.cardContainer,children:[Object(te.jsxs)(Z.a,{className:C.card,elevation:2,onDoubleClick:M,children:[Object(te.jsx)(V.a,{title:null!==r&&void 0!==r?r:n.title,titleTypographyProps:s,subheader:l,subheaderTypographyProps:u,avatar:d,classes:{root:C.headerRoot}}),!!f&&Object(te.jsxs)(te.Fragment,{children:[Object(te.jsx)(J.a,{}),Object(te.jsx)(q.a,{classes:{root:C.contentRoot},children:f})]})]}),!!g&&y&&Object(te.jsx)("div",{className:C.actions,children:g.map((function(e,t){var n=Object(te.jsx)(I.a,{onClick:function(t){return e.onClick(t)},size:"small",className:C.action,children:e.icon},t);return e.tooltip&&(n=Object(te.jsx)(x.a,{title:e.tooltip,children:n},t)),n}))})]}),n.inPort&&Object(te.jsx)(oe,{port:n.inPort,engine:a,onPortHovering:i,className:C.inPort}),n.outPort&&Object(te.jsx)(oe,{port:n.outPort,engine:a,onPortHovering:i,className:C.outPort})]})},re=n(3010),se=["className"],le=Object(v.a)((function(e){return Object(O.a)({avatar:{color:"light"===e.palette.mode?e.palette.background.default:"#fff",backgroundColor:e.palette.primary.main,width:e.spacing(4),height:e.spacing(4)}})})),ue=function(e){var t=e.className,n=Object(U.a)(e,se),a=le();return Object(te.jsx)(re.a,Object(i.a)({className:Object(_.default)(a.avatar,t)},n))},de=Object(v.a)((function(e){return Object(O.a)({responsePort:{top:"calc(50% - ".concat(4,"px)"),right:-8,position:"absolute"},response:{position:"relative",marginBottom:5},responseChipRoot:{width:"100%",backgroundColor:e.palette.background.paper},responseChipLabel:{width:"100%"}})})),ge=function(e){return Object(te.jsxs)(te.Fragment,{children:[Object(te.jsx)(R.a,Object(i.a)({"data-action-type":"edit"},e)),Object(te.jsx)(E.a,Object(i.a)({"data-action-type":"delete"},e))]})},fe=function(e){var t,n=e.engine,a=e.node,o=de(e),i=Object(j.useMemo)((function(){return[{icon:Object(te.jsx)(R.a,{}),onClick:function(){a.dispatchCommand({type:"edit"})}},{icon:Object(te.jsx)(F.a,{}),onClick:function(){a.dispatchCommand({type:"delete"})}}]}),[a]),c=Object(j.useCallback)((function(e,t){for(var n=e.target;n&&"svg"!==n.tagName;)n=n.parentNode;if(n){var o=n.getAttribute("data-action-type");o&&("edit"===o?a.dispatchCommand({type:"editResponse",responseName:t.name}):"delete"===o&&a.dispatchCommand({type:"deleteResponse",responseName:t.name}))}}),[a]);return Object(te.jsx)(ce,{engine:n,node:a,avatar:Object(te.jsx)(ue,{children:Object(te.jsx)(Y.a,{})}),actions:i,selected:a.isSelected(),children:null===(t=a.instance.validResponses)||void 0===t?void 0:t.map((function(e){var t=a.getResponsePort(e);return Object(te.jsxs)("div",{className:o.response,children:[Object(te.jsx)(L.a,{icon:Object(te.jsx)(H.a,{}),label:null===e||void 0===e?void 0:e.name,onDelete:function(t){return c(t,e)},deleteIcon:Object(te.jsx)(ge,{}),variant:"outlined",classes:{root:o.responseChipRoot,label:o.responseChipLabel}}),t&&Object(te.jsx)(oe,{port:t,engine:n,portSize:8,className:o.responsePort})]},e.name)}))})},be=n(1230),je=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(){return Object(r.a)(this,n),t.call(this,"taskType")}return Object(c.a)(n,[{key:"generateModel",value:function(e){var t,n=null!==(t=e.instanceId)&&void 0!==t?t:"",a=Object(i.a)({},e);return delete a.instanceId,new be.a(a,n)}},{key:"generateReactWidget",value:function(e){return Object(te.jsx)(fe,{engine:this.engine,node:e.model})}}]),n}(y.AbstractReactFactory),pe=n(1229),Oe=n(2058),ve=n(1512),he=n.n(ve),me=n(2999),ye=n(2828),xe=n.n(ye),ke=Object(v.a)((function(e){return Object(O.a)({smallAvatar:{width:25,height:25,border:"2px solid ".concat(e.palette.primary.main),color:e.palette.text.secondary,backgroundColor:e.palette.background.paper},initialAction:{width:16,height:16}})})),Ce=function(e){var t=e.isInitialAction,n=e.onClick,a=e.children,o=ke();return Object(te.jsxs)(Oe.a,{onClick:n,size:"small",children:[t&&Object(te.jsx)(me.a,{overlap:"circular",anchorOrigin:{vertical:"bottom",horizontal:"right"},badgeContent:Object(te.jsx)(re.a,{className:o.smallAvatar,children:Object(te.jsx)(xe.a,{className:o.initialAction})}),children:a}),!t&&a]})},Ie=function(e){var t=e.engine,n=e.node,a=Object(j.useCallback)((function(){n.dispatchCommand({type:"toggleInitialAction"})}),[n]),o=Object(j.useMemo)((function(){return[{icon:Object(te.jsx)(R.a,{}),onClick:function(){n.dispatchCommand({type:"edit"})}},{icon:Object(te.jsx)(F.a,{}),onClick:function(){n.dispatchCommand({type:"delete"})}}]}),[n]);return Object(te.jsx)(ce,{engine:t,node:n,avatar:Object(te.jsx)(Ce,{isInitialAction:n.isInitialAction,onClick:a,children:Object(te.jsx)(ue,{children:Object(te.jsx)(he.a,{})})}),actions:o,selected:n.isSelected()})},Ne=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(){return Object(r.a)(this,n),t.call(this,"actionType")}return Object(c.a)(n,[{key:"generateModel",value:function(e){var t,n,a=null!==(t=e.isInitialAction)&&void 0!==t&&t,o=null!==(n=e.instanceId)&&void 0!==n?n:"",c=Object(i.a)({},e);return delete c.isInitialAction,delete c.instanceId,new pe.a(c,o,a)}},{key:"generateReactWidget",value:function(e){return Object(te.jsx)(Ie,{engine:this.engine,node:e.model})}}]),n}(y.AbstractReactFactory),Pe=n(1372),Se=n(805),we=n(1389),Me=n(1816),Te=n.n(Me),Le=n(1859),De=function(e){var t=e.engine,n=e.node,a=Object(j.useCallback)((function(e){n.dispatchCommand({type:"setTagging",tagging:e})}),[n]);return Object(te.jsx)(ce,{engine:t,node:n,avatar:Object(te.jsx)(Le.a,{value:n.taggingType,onChange:a,children:Object(te.jsx)(ue,{children:Object(te.jsx)(Te.a,{})})}),selected:n.isSelected()})},Re=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(){return Object(r.a)(this,n),t.call(this,"state")}return Object(c.a)(n,[{key:"generateModel",value:function(e){var t,n=e.milestoneType,a=null!==(t=e.instanceId)&&void 0!==t?t:"",o=Object(i.a)({},e);return delete o.milestoneType,delete o.instanceId,new we.a(o,a,n)}},{key:"generateReactWidget",value:function(e){return Object(te.jsx)(De,{engine:this.engine,node:e.model})}}]),n}(y.AbstractReactFactory),Ae=n(1231),Ee=n(1513),ze=n.n(Ee),Fe=function(e){var t=e.engine,n=e.node,a=Object(j.useCallback)((function(e){n.dispatchCommand({type:"setTagging",tagging:e})}),[n]),o=Object(j.useMemo)((function(){return[{icon:Object(te.jsx)(R.a,{}),onClick:function(){n.dispatchCommand({type:"edit"})}},{icon:Object(te.jsx)(F.a,{}),onClick:function(){n.dispatchCommand({type:"delete"})}}]}),[n]);return Object(te.jsx)(ce,{engine:t,node:n,avatar:Object(te.jsx)(Le.a,{value:n.taggingType,onChange:a,children:Object(te.jsx)(ue,{children:Object(te.jsx)(ze.a,{})})}),actions:o,selected:n.isSelected()})},Xe=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(){return Object(r.a)(this,n),t.call(this,"selector")}return Object(c.a)(n,[{key:"generateModel",value:function(e){var t,n=e.milestoneType,a=null!==(t=e.instanceId)&&void 0!==t?t:"",o=Object(i.a)({},e);return delete o.milestoneType,delete o.instanceId,new Ae.a(o,a,n)}},{key:"generateReactWidget",value:function(e){return Object(te.jsx)(Fe,{engine:this.engine,node:e.model})}}]),n}(y.AbstractReactFactory),Ye=n(1182),Be=function(e){var t=e.path,n=e.link,o=e.forwardRef,c=e.factory,r=e.onSelection,s=e.extras,l=e.linkStatus,u=e.isOutgoing,d=l===a.selected||n.isSelected(),g=d?u?n.getSelectedOutgoingColor():n.getOptions().selectedColor:n.getOptions().color,f=p.a.cloneElement(c.generateLinkSegment(n,d,t),{ref:o,strokeOpacity:l===a.selected?.8:a.unfocused?.1:.3,stroke:g}),b=p.a.cloneElement(f,Object(i.a)(Object(i.a)({strokeLinecap:"round",onMouseLeave:function(){r(!1)},onMouseEnter:function(){r(!0)}},s),{},{ref:null,"data-linkid":n.getID(),strokeOpacity:l===a.selected?.1:0,strokeWidth:20,fill:"none"}));return Object(te.jsxs)("g",{children:[f,b]})};!function(e){e[e.normal=0]="normal",e[e.selected=1]="selected",e[e.unfocused=2]="unfocused"}(a||(a={}));var He=function(e){var t=e.linkId,n=e.point,o=e.previousPoint,i=e.color,c=e.selectedColor,r=e.linkStatus,s=n.x,l=n.y,u=o.x,d=o.y,g=90+180*Math.atan2(l-d,s-u)/Math.PI;return Object(te.jsx)("g",{className:"arrow",transform:"translate(".concat(s,", ").concat(l,")"),children:Object(te.jsx)("g",{style:{transform:"rotate(".concat(g,"deg)")},children:Object(te.jsx)("g",{transform:"translate(0, -5)",children:Object(te.jsx)("polygon",{points:"0,5 4,15 -4,15",fill:r===a.selected?c:i,opacity:r===a.selected?.8:a.unfocused?.1:.3,"data-linkid":t})})})})},We=function(e){return"".concat(e.x," ").concat(e.y)},Ze=function(e){return"M ".concat(We(e)," ")},Ve=function(e){return"L ".concat(We(e)," ")},qe=function(e,t,n){return"C ".concat(We(e),", ").concat(We(t),", ").concat(We(n)," ")},Je=function(e,t,n){var a=t.x-e.x,o=t.y-e.y,i=Math.sqrt(a*a+o*o);return Ue(e,t,Math.min(1,n/i))},Ue=function(e,t,n){return{x:e.x+(t.x-e.x)*n,y:e.y+(t.y-e.y)*n}},_e=function(e){var t,n,i,c=e.link,r=e.diagramEngine,s=Object(j.useState)(!1),l=Object(o.a)(s,2),u=l[0],d=l[1],g=Object(S.h)(K),f=Object(S.h)(Q),b=Object(S.h)($),O=Object(S.h)(ee),v=Object(j.useRef)([]),h=b.includes(null===(t=c.getSourcePort())||void 0===t?void 0:t.getNode().getID()),m=b.includes(null===(n=c.getTargetPort())||void 0===n?void 0:n.getNode().getID()),y=u||f.includes(c.getID())||h||m?a.selected:O.length>0?a.unfocused:a.normal,x=h||(null===(i=c.getSourcePort())||void 0===i?void 0:i.getNode().getID())===g;Object(j.useEffect)((function(){return v.current&&c.setRenderedPaths(v.current.map((function(e){return e.current})).filter(T.isPresent)),function(){return c.setRenderedPaths([])}}));var k=Object(j.useCallback)((function(e){d(e)}),[]),C=c.getPoints();if(C.length<=1)return c.setRenderedPaths([]),Object(te.jsx)("g",{});var I=c.getID(),N=c.getOptions(),P=C.map((function(e){return{x:e.getX(),y:e.getY()}})),w=P.length-1,M=P[w];P[w]=function(e,t,n){var a=t.x,o=t.y,i=e.x,c=e.y,r=i-a,s=c-o;if(Math.abs(s)<1e-4)return{x:i-n*Math.sign(r),y:c};if(Math.abs(r)<1e-4)return{x:i,y:c-n*Math.sign(s)};var l=Math.sqrt(r*r+s*s)-n,u=Math.atan2(s,r);return{x:a+l*Math.cos(u),y:o+l*Math.sin(u)}}(P[w],P[w-1],8);var L=function(e){for(var t=[],n=e.length-1,a=e[0],o="",i=1;i<n;i++){o=Ze(a);var c,r,s=e[i],l=e[i+1];c=Je(s,a,5),r=Je(s,l,5),o+=Ve(c);var u=Ue(c,s,.5),d=Ue(s,r,.5);o+=qe(u,d,r),a=r,t.push(o)}return o=Ze(a),o+=Ve(e[n]),t.push(o),t}(P);return v.current=L.map((function(){return p.a.createRef()})),Object(te.jsxs)("g",{"data-default-link-test":N.testName,children:[L.map((function(e,t){return Object(te.jsx)(Be,{path:e,diagramEngine:r,factory:r.getFactoryForLink(c),link:c,linkStatus:y,isOutgoing:x,forwardRef:v.current[t],onSelection:k,extras:{"data-linkid":I}},"link-".concat(t))})),Object(te.jsx)(He,{linkId:I,point:M,previousPoint:P[w-1],selectedColor:x?N.selectedOutgoingColor:N.selectedColor,color:N.color,linkStatus:y},"link-arrowhead")]})},Ge=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(){return Object(r.a)(this,n),t.call(this,"contextTypeLink")}return Object(c.a)(n,[{key:"generateModel",value:function(){return new Ye.a}},{key:"generateReactWidget",value:function(e){return Object(te.jsx)(_e,{link:e.model,diagramEngine:this.engine})}}]),n}(h.DefaultLinkFactory),Ke=n(1078),Qe=n(2829),$e=n.n(Qe),et=(n(556),function(e){if(e){for(var t={},n=0,a=Object.entries(e);n<a.length;n++){var i=Object(o.a)(a[n],2),c=i[0],r=i[1];switch("org.eclipse.".concat(c)){case"org.eclipse.elk.contentAlignment":case"org.eclipse.elk.nodeSize.constraints":case"org.eclipse.elk.nodeSize.options":case"org.eclipse.elk.portLabels.placement":case"org.eclipse.elk.layered.wrapping.cutting.cuts":case"org.eclipse.elk.layered.wrapping.validify.forbiddenIndices":case"org.eclipse.elk.nodeLabels.placement":if(Array.isArray(r)){t[c]=r.map((function(e){return""+e})).join(" ");break}t[c]=r;break;default:t[c]=r}}return t}}),tt=function(e){return e instanceof Se.a},nt=function(e,t){return new Ke.PointModel({link:t,position:new N.Point(e.x,e.y)})},at=function(){function e(t){Object(r.a)(this,e),this.options=void 0,this.options=t}return Object(c.a)(e,[{key:"redistribute",value:function(){var e=Object(u.a)(b.a.mark((function e(t){var n,a,o,i,c,r,s,l,u,d,f,j,p,O,v,h,m,y=this;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return b={algorithms:[this.options.algorithm],defaultLayoutOptions:et(this.options.layoutOptions)},n=new $e.a(b),a={},o=Object(w.C)((function(e){return e.instanceId}),t.getNodes().filter(tt)).map((function(e){var t,n,a=null===(t=(n=y.options).nodeLayoutOptions)||void 0===t?void 0:t.call(n,e);return{id:e.getID(),width:e.width,height:e.height,layoutOptions:et(a),ports:Object.values(e.getPorts()).map((function(t){return{id:t.getID(),height:t.height,width:t.width,x:t.getX()-e.getX(),y:t.getY()-e.getY()}}))}})),i=Object(w.C)((function(e){return e instanceof Ye.a?e.getInstanceId():"edge"}),t.getLinks().filter((function(e){return e.getSourcePort()&&e.getTargetPort()}))).map((function(e){var t,n;a[e.getID()]=!0;var o=null===(t=(n=y.options).linkLayoutOptions)||void 0===t?void 0:t.call(n,e);return{id:e.getID(),sources:[e.getSourcePort().getID()],targets:[e.getTargetPort().getID()],sections:[],layoutOptions:et(o)}})),e.next=6,n.layout({id:"root",children:o,edges:i});case 6:c=e.sent,r=Object(g.a)(c.children);try{for(r.s();!(s=r.n()).done;)l=s.value,t.getNode(l.id).setPosition(l.x,l.y)}catch(x){r.e(x)}finally{r.f()}if(this.options.includeLinks&&c.edges){u=Object(g.a)(c.edges);try{for(u.s();!(d=u.n()).done;){if(f=d.value,j=t.getLink(f.id),p=f.sections[0],O=[nt(p.startPoint,j)],p.bendPoints){v=Object(g.a)(p.bendPoints);try{for(v.s();!(h=v.n()).done;)m=h.value,O.push(nt(m,j))}catch(x){v.e(x)}finally{v.f()}}j.setPoints(O.concat(nt(p.endPoint,j)))}}catch(x){u.e(x)}finally{u.f()}}case 10:case"end":return e.stop()}var b}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();var ot=n(2928),it=n(992),ct=n(2062),rt=n(663),st=n.n(rt),lt=n(1989),ut=["nodes","onNodeSelected"],dt=Object(v.a)((function(e){return Object(O.a)({root:{position:"relative"},editorContainer:{position:"absolute",top:5,right:e.spacing(7),backgroundColor:e.palette.background.paper},button:{color:e.palette.text.secondary,backgroundColor:e.palette.background.paper,"&:hover":{backgroundColor:Object(W.e)(e.palette.background.paper,.15)}}})})),gt=function(e){var t=e.nodes,n=e.onNodeSelected,a=Object(U.a)(e,ut),c=Object(M.a)().t,r=dt(),s=Object(j.useState)(!1),l=Object(o.a)(s,2),u=l[0],d=l[1],g=Object(j.useMemo)((function(){return Object(w.C)((function(e){return"".concat(c(e.getType()),":").concat(e.title)}),t)}),[t,c]),f=Object(j.useCallback)((function(){d(!0)}),[]),b=Object(j.useCallback)((function(){d(!1)}),[]),p=Object(j.useCallback)((function(e,t){t&&(null===n||void 0===n||n(t),d(!1))}),[n]);return Object(te.jsx)(ot.a,{mouseEvent:"onMouseDown",touchEvent:"onTouchStart",onClickAway:b,children:Object(te.jsx)("div",Object(i.a)(Object(i.a)({},a),{},{children:Object(te.jsxs)("div",{className:r.root,children:[Object(te.jsx)(I.a,{className:r.button,onClick:f,size:"medium",children:Object(te.jsx)(st.a,{})}),Object(te.jsx)("div",{className:r.editorContainer,children:Object(te.jsx)(lt.Transition,{items:u,from:{width:0,opacity:0},enter:{width:300,opacity:1},leave:{width:0,opacity:0},reverse:u,children:function(e,t){return t&&Object(te.jsx)(lt.animated.div,{style:e,children:Object(te.jsx)(it.a,{options:g,getOptionLabel:function(e){return e.title},size:"small",groupBy:function(e){return c(e.getType())},onChange:p,renderInput:function(e){return Object(te.jsx)(ct.a,Object(i.a)(Object(i.a)({},e),{},{autoFocus:!0,variant:"outlined"}))}})})}})})]})}))})},ft=function(e,t){return t.filter((function(t){return t instanceof e}))},bt=n(143),jt=Object(v.a)((function(e){return Object(O.a)({canvas:{height:"100%",minHeight:"250px"},actionTypeNode:{color:e.palette.primary.main},taskTypeNode:{color:"rgb(0,177,235)"},canvasContainer:{height:"100%",width:"100%"},search:{position:"absolute",top:e.spacing(2),right:e.spacing(2)},layout:{position:"absolute",bottom:e.spacing(2),left:e.spacing(2),color:e.palette.text.secondary,backgroundColor:e.palette.background.default}})})),pt=function(e){var t,n={},a=Object(g.a)(e.getNodes());try{for(a.s();!(t=a.n()).done;){var o=t.value,i=1;o instanceof pe.a?i=0:(o instanceof we.a||o instanceof Ae.a)&&"final"===o.taggingType?i=1e4:o instanceof we.a?i=2:o instanceof Ae.a?i=3:o instanceof be.a&&(i=4),n[o.getID()]=i}}catch(v){a.e(v)}finally{a.f()}for(var c=Object(w.r)((function(e){return e.map((function(e){return e.getSourcePort().getNode()}))}),Object(w.j)((function(e){return e.getTargetPort().getNode().getID()}),e.getLinks().filter((function(e){return n[e.getSourcePort().getNode().getID()]<1e4})))),r=function(e){var t,n=Object(w.r)((function(e){return e.map((function(e){return e.getTargetPort().getNode()}))}),Object(w.j)((function(e){return e.getSourcePort().getNode().getID()}),e.getLinks())),a=[],o=[],i=function(e){var t=a.indexOf(e);return-1===t&&(t=a.length,a.push(e),o.push([])),t},c=Object(g.a)(ft(be.a,e.getNodes()));try{var r=function(){var e=t.value,a=i(e);Object(bt.a)(e,{getNeighbors:function(t){var a;return t instanceof be.a&&t!==e?[]:null!==(a=n[t.getID()])&&void 0!==a?a:[]},enterVertex:function(e){var t=e.currentVertex;t instanceof be.a&&o[a].push(i(t))}})};for(c.s();!(t=c.n()).done;)r()}catch(v){c.e(v)}finally{c.f()}for(var s=Object(bt.c)(o),l=s.components,u=s.adjacencyList,f=[],b=Object(w.c)(u),j=!0;j;){j=!1;for(var p=[],O=[],h=0;h<b.length;h++){var m=b[h];m&&0===m.length&&(O.push(h),b[h]=void 0,p.push.apply(p,Object(d.a)(l[h].map((function(e){return a[e]})))))}var y,x=Object(g.a)(b.filter(T.isPresent));try{for(x.s();!(y=x.n()).done;){var k,C=y.value,I=Object(g.a)(O);try{for(I.s();!(k=I.n()).done;){var N=k.value,P=C.indexOf(N);P>-1&&C.splice(P,1)}}catch(v){I.e(v)}finally{I.f()}}}catch(v){x.e(v)}finally{x.f()}p.length>0&&(f.unshift(p),j=!0)}return f}(e),s=0;s<r.length;s++){var l,u=Object(g.a)(r[s]);try{for(u.s();!(l=u.n()).done;){var f=l.value;n[f.getID()]=10*s+4}}catch(v){u.e(v)}finally{u.f()}}var b=function(t){var a,o=0,i=Object(g.a)(ft(we.a,e.getNodes()).filter((function(e){return n[e.getID()]===t+2})));try{for(i.s();!(a=i.n()).done;){var r=a.value,s=c[r.getID()];s&&s.some((function(e){return n[e.getID()]>t+2}))&&(n[r.getID()]=t+12,o++)}}catch(v){i.e(v)}finally{i.f()}for(var l=!0;l;){l=!1;var u,d=Object(g.a)(ft(Ae.a,e.getNodes()).filter((function(e){return n[e.getID()]===t+3})));try{for(d.s();!(u=d.n()).done;){var f=u.value,b=c[f.getID()];b&&b.some((function(e){return n[e.getID()]>t+3}))&&(n[f.getID()]=t+13,l=!0,o++)}}catch(v){d.e(v)}finally{d.f()}}return o},j=0,p=Number.MAX_VALUE,O=0;do{j=p,p=b(O),O+=10}while(p>0&&p<j);return n},Ot=function(){var e=Object(u.a)(b.a.mark((function e(t){var n,a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={},a=new at({algorithm:"layered",layoutOptions:{"elk.alignment":"LEFT","elk.partitioning.activate":!0,"elk.layered.feedbackEdges":!0,"elk.portConstraints":"FIXED_POS","elk.separateConnectedComponents":!1,"elk.interactiveLayout":!0,"elk.layered.spacing.nodeNodeBetweenLayers":60,"elk.spacing.edgeEdge":20,"elk.spacing.edgeNode":20,"elk.spacing.nodeNode":20,"elk.layered.spacing.edgeEdgeBetweenLayers":20,"elk.layered.spacing.edgeNodeBetweenLayers":20,"elk.edgeRouting":"ORTHOGONAL","elk.layered.layering.strategy":"INTERACTIVE"},nodeLayoutOptions:function(e){var a;0===Object.keys(n).length&&(n=pt(t));var o={"elk.partitioning.partition":null!==(a=n[e.getID()])&&void 0!==a?a:1};return delete n[e.getID()],o},includeLinks:!0}),e.next=4,a.redistribute(t);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),vt=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(){var e;return Object(r.a)(this,n),(e=t.call(this)).childStates=[],e}return Object(c.a)(n)}(h.DefaultDiagramState),ht=function(e,t){var n=e.getModel(),a={x:0,y:0,zoom:0},o=Object(i.a)({offsetX:[n.getOffsetX(),n.getOffsetX()],offsetY:[n.getOffsetY(),n.getOffsetY()],zoomLevel:[n.getZoomLevel(),n.getZoomLevel()]},t);P.a.fromTo(a,{x:o.offsetX[0],y:o.offsetY[0],zoom:o.zoomLevel[0]},{x:o.offsetX[1],y:o.offsetY[1],zoom:o.zoomLevel[1],duration:.5,ease:"power2",onUpdate:function(){n.setZoomLevel(a.zoom),n.setOffset(a.x,a.y),e.repaintCanvas()}})},mt=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:20,a=e.getTopLeft(),o=t.getTopLeft(),i=e.getBottomRight(),c=t.getBottomRight(),r=new N.Point(Math.min(a.x,o.x)-n,Math.min(a.y,o.y)-n),s=new N.Point(Math.max(i.x,c.x)+n,Math.max(i.y,c.y)+n),l=s.x-r.x,u=s.y-r.y;return new N.Rectangle(r,l,u)},yt=function(e){var t=e.actionTypes,n=e.taskTypes,a=e.selectors,i=e.taggings,c=e.initialActions,r=e.statesIncluded,s=e.visibleElementTypes,l=e.onNodeSelectionChanged,u=e.onNodeHighlighted,g=e.onActionTypeCommandInvoked,f=e.onStateCommandInvoked,b=e.onSelectorCommandInvoked,p=e.onTaskTypeCommandInvoked,O=e.onResponseTypeCommandInvoked,v=e.onSelectionChanged,k=e.onPinStatusesChanged,P=jt(),T=Object(M.a)().t,L=Object(j.useRef)(null),D=Object(S.i)($),R=Object(S.i)(ee),A=Object(j.useMemo)((function(){return new Pe.a({locked:!0})}),[]),E=Object(j.useMemo)((function(){var e=function(){var e=m()(),t=e.getNodeFactories();return t.registerFactory(new Ne),t.registerFactory(new je),t.registerFactory(new Re),t.registerFactory(new Xe),e.getLinkFactories().registerFactory(new Ge),e.getStateMachine().pushState(new vt),e}();return e.setModel(A),e}),[A]);Object(j.useEffect)((function(){R([])}),[R]);var z=Object(j.useCallback)((function(){var e;e=function(e){setTimeout((function(){var e=L.current;Ot(A).finally((function(){e&&(e.style.visibility="visible"),E.repaintCanvas()}))}),e?100:0)},"hidden"===document.visibilityState?document.addEventListener("visibilitychange",(function t(n){"visible"===document.visibilityState&&(document.removeEventListener("visibilitychange",t),e(!0))})):e(!1)}),[E,A]);Object(j.useEffect)((function(){var e=L.current;if(e){var o=A.pinStatuses,l=A.updateData(t,n,a,i,c,r,s);o!==A.pinStatuses&&(null===k||void 0===k||k(A.pinStatuses)),l&&(e.style.visibility="hidden"),E.repaintCanvas(),z()}}),[t,E,c,i,A,a,n,z,s,r,k]),Object(j.useEffect)((function(){var e={nodeSelectionChanged:function(e){null===l||void 0===l||l(e.node,e.isSelected);var t=A.getSelectedEntities().filter((function(e){return e instanceof h.NodeModel}));null===v||void 0===v||v(t),D(t.map((function(e){return e.getID()}))),e.isSelected||R([])},contextTypeNodeCommandInvoked:function(e){var t=e.command,n=e.node;if("focusNode"===t.type){var a=function(e){var t=Object(w.I)(Object.values(e.getPorts()).flatMap((function(e){return Object.values(e.getLinks())})));return[Object(w.I)(t.flatMap((function(t){var n=t.getSourcePort().getNode(),a=t.getTargetPort().getNode();return n===e?a:n}))),t]}(n),i=Object(o.a)(a,2),c=i[0];!function(e,t,n,a){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:20,i=a.getModel(),c=a.getCanvas(),r=a.getBoundingNodesRect([e].concat(Object(d.a)(t))),s=N.Polygon.boundingBoxFromPoints(n.flatMap((function(e){return e.getPoints()})).map((function(e){return e.getPosition()}))),l=mt(r,s,o),u=c.getBoundingClientRect(),g={x:u.left,y:u.top},f={x:g.x+i.getOffsetX(),y:g.y+i.getOffsetY()},b=c.clientWidth/l.getWidth(),j=c.clientHeight/l.getHeight(),p=Math.min(b<j?b:j,1),O=l.getTopLeft(),v={x:f.x+O.x*p,y:f.y+O.y*p},h=i.getOffsetX()+g.x-v.x,m=i.getOffsetY()+g.y-v.y;ht(a,{offsetX:[i.getOffsetX(),h],offsetY:[i.getOffsetY(),m],zoomLevel:[i.getZoomLevel(),100*p]})}(n,c,i[1],E),c.unshift(n),R(c.map((function(e){return e.getID()}))),null===u||void 0===u||u(n)}if(n instanceof pe.a)null===g||void 0===g||g(n.instance,t);else if(n instanceof we.a)null===f||void 0===f||f(n.instance,t);else if(n instanceof Ae.a)null===b||void 0===b||b(n.instance,t);else if(n instanceof be.a)if(Object(Se.b)(t)){var r=n.instance.validResponses.find((function(e){return e.name===t.responseName}));r&&(null===O||void 0===O||O(r,n.instance,t))}else null===p||void 0===p||p(n.instance,t)}},t=A.registerListener(e);return function(){A.deregisterListener(t)}}),[E,A,g,u,l,O,v,b,f,p,R,D]);var F=Object(j.useState)(),X=Object(o.a)(F,2)[1],Y=Object(j.useCallback)((function(e){var t=E.getMouseElement(e);t&&X(t)}),[E]),B=Object(j.useCallback)((function(e){!function(e,t){var n=t.getModel();n.clearSelection(),e.setSelected(!0);var a=t.getCanvas().getBoundingClientRect(),o=a.width,i=a.height,c=-n.getOffsetX(),r=-n.getOffsetX()+o,s=-n.getOffsetY(),l=-n.getOffsetY()+i,u=n.getZoomLevel()/100,d=e.getPosition(),g=d.x,f=d.y;f*=u;var b=(g*=u)+e.width*u,j=f+e.height*u,p=n.getOffsetX(),O=n.getOffsetY();b>r?p=-b-40+o:g<c&&(p=40-g),j>l?O=-j-40+i:f<s&&(O=40-f),n.getOffsetX()===p&&n.getOffsetY()===O||ht(t,{offsetX:[n.getOffsetX(),p],offsetY:[n.getOffsetY(),O]})}(e,E)}),[E]);return Object(te.jsxs)(te.Fragment,{children:[Object(te.jsx)("div",{ref:L,className:P.canvasContainer,onMouseOver:Y,children:Object(te.jsx)(y.CanvasWidget,{engine:E,className:P.canvas})}),Object(te.jsx)(gt,{nodes:E.getModel().getNodes(),className:P.search,onNodeSelected:B}),Object(te.jsx)(x.a,{title:T("PerformLayout"),children:Object(te.jsx)(I.a,{className:P.layout,onClick:z,size:"small",children:Object(te.jsx)(C.a,{fontSize:"small"})})})]})};t.default=yt}}]);
//# sourceMappingURL=84.c565b6ea.chunk.js.map